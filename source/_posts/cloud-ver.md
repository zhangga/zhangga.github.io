---
title: 云服务器被挖矿病毒感染！
date: 2019-03-26 19:51:40
tags:
  - 笔记
id: cloud-ver
categories:
  - 笔记
---

#### **记录下病毒感染的始末。从发现到折磨，再到最后解决的痛苦过程。总结教训，不能大意，还是得做好快照备份。**

一、3月13号发现服务器ssh连接困难，连上就掉线，根本无法操作，用top指令查看发现有进程名为：dblaunch高负载，占满cpu。没多想，联系腾讯云处理，最后给出的建议：做好快照，重启机器。腾讯帮忙注释掉了启动脚本中lampp中mysql的bin环境变量，现在来看，这个操作没任务作用。重启完后机器恢复正常，也就没再进一步追踪。

![云服务器被挖矿病毒感染！ - 第1张  | 张嘎](https://i1.wp.com/192.144.167.243/blog/wp-content/uploads/1-3.png?resize=640%2C111)

二、3月15号，公司下周去美国，需要搭建对外服务器在美国登陆，就部署到我的腾讯云服务器，由于我明天去日本的飞机，赶忙晚上部署服务器完毕，测试无恙，一切正常。

三、3月16号，在日本凌晨3点钟， 同事反应游戏服务器连不上，登陆ssh后台发现根本连不上， 再次联系腾讯云，最后还是强制重启解决，噩梦开始，由于人在日本，只能通过手机操作，没有别的办法，只能每天早上起床后第一件事就是重启机器，以保障美国方能正常展示游戏。

![云服务器被挖矿病毒感染！ - 第2张  | 张嘎](https://i0.wp.com/192.144.167.243/blog/wp-content/uploads/2-2.png?resize=640%2C436)

四、回国后开始排查问题，发现进程sustse跑满cpu，网上查看后才知道是被挖矿病毒感染，第一次服务器被病毒感染的经历。随后开始了各种尝试，试图删尽病毒，病毒的urlget地址为：http://107.174.47.156/mr.sh。在经过了各种对文件夹加权限，删除病毒文件及各种定时任务后，最后发现还是徒劳，不知道从什么地方病毒还是再次出现，腾讯官方给出的建议也是重装系统，因为你永远也保证不了病毒被删除干净，在这样的机器上继续使用的话，自己的内容越多，文件丢失的成本和风险越大，最后只能重装系统，重新部署环境。

五、经此一役和挖矿病毒的斗争，或者说被虐也好，教训就是，做好服务器的快照备份，数据无价，万一真的丢失了恢复不了，那是真崩了。还好这次没什么重大损失。
