<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>é˜¿é‡Œäº‘è½¬æˆ˜è…¾è®¯äº‘-å…¨çºªå½•</title>
    <url>/ali2tx/</url>
    <content><![CDATA[<div class=".article-gallery"><h1 id="æœºå™¨è¿ç§»å…¨è®°å½•ã€‚"><a href="#æœºå™¨è¿ç§»å…¨è®°å½•ã€‚" class="headerlink" title="æœºå™¨è¿ç§»å…¨è®°å½•ã€‚"></a>æœºå™¨è¿ç§»å…¨è®°å½•ã€‚</h1><p><a href="https://imgtu.com/i/hMnUVP"><a href="https://z3.ax1x.com/2021/08/27/hMnUVP.md.png" title="hMnUVP.md.png" class="gallery-item" style="box-shadow: none;"> <img src="https://z3.ax1x.com/2021/08/27/hMnUVP.md.png" alt="hMnUVP.md.png"></a></a></p>
<span id="more"></span>

<h3 id="1-JDK"><a href="#1-JDK" class="headerlink" title="1.JDK"></a>1.JDK</h3><p>/usr/local/java/ä¸‹ï¼Œæ”¾jdk11å’Œjdk1.8ã€‚defaultè½¯è¿æ¥åˆ°jdk11ã€‚</p>
<p>/etc/profile æ–‡ä»¶åŠ å…¥ç¯å¢ƒå˜é‡æŒ‡å‘defaultã€‚æ‰§è¡Œsource /etc/profile</p>
<h3 id="2-maven"><a href="#2-maven" class="headerlink" title="2.maven"></a>2.maven</h3><p>/usr/local/mvn/ä¸‹ï¼Œæ”¾mavenè§£å‹åŒ…ï¼ŒåŠ å…¥ç¯å¢ƒå˜é‡ã€‚</p>
<h3 id="3-cmake"><a href="#3-cmake" class="headerlink" title="3.cmake"></a>3.cmake</h3><p>/optä¸‹æ”¾cmakeçš„è§£å‹åŒ…ï¼ŒåŠ å…¥ç¯å¢ƒå˜é‡ã€‚</p>
<h3 id="4-xampp"><a href="#4-xampp" class="headerlink" title="4.xampp"></a>4.xampp</h3><p>/optä¸‹æ”¾xamppçš„å®‰è£…æ–‡ä»¶ï¼Œxampp-xxx.runæ–‡ä»¶ã€‚</p>
<p>chmod -R 755 xampp-linux-xxx-installer.run æ·»åŠ æ‰§è¡Œæƒé™ã€‚</p>
<p>./xampp-linux-xxx-installer.run æ‰§è¡Œå®‰è£…ã€‚</p>
<p>å®‰è£…çš„è¿‡ç¨‹å°±ä¸å¤šè¯´äº†ï¼Œä¹Ÿä¸ç”¨è®¾ç½®ä»€ä¹ˆï¼Œæ— éå°±æ˜¯é—®ä½ æ—¶å€™ç¡®å®šä¸€äº›é€‰é¡¹ï¼Œå‡ºç°æé—®ï¼Œç›´æ¥æŒ‰ å›è½¦ ä¸‹å»å³å¯ã€‚xamppé»˜è®¤å®‰è£…åœ¨/opt/lamppä¸‹</p>
<p>å®‰è£…å®Œæ¯•ä¹‹åï¼Œå¹¶æ²¡æœ‰è¿è¡Œï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨å¯åŠ¨xamppæœåŠ¡ï¼Œä¹Ÿå°±æ˜¯å¯åŠ¨apacheï¼Œftpå’Œmysqlè¿™äº›æœåŠ¡å™¨ã€‚ä½¿ç”¨å‘½ä»¤</p>
<p>/opt/lampp/lampp start</p>
<p>æ­¤æ—¶ï¼Œlamppç»„ä»¶å°±æˆåŠŸå¯åŠ¨äº†ï¼Œä½†å®ƒå¹¶ä¸æ˜¯æ¯æ¬¡éšç³»ç»Ÿå¯åŠ¨<br>è¾“å…¥ä»¥ä¸‹å‘½ä»¤<br>ln -s /opt/lampp/lampp /etc/rc.d/rc3.d/S99lampp<br>ln -s /opt/lampp/lampp /etc/rc.d/rc4.d/S99lampp<br>ln -s /opt/lampp/lampp /etc/rc.d/rc5.d/S99lampp</p>
<p>è¿™æ ·ï¼Œå°±éšç³»ç»Ÿå¯åŠ¨äº†ï¼</p>
<p>ç¯å¢ƒå®‰è£…å®Œäº†ï¼Œä½†æ˜¯MySQLçš„å¯†ç æ˜¯å¤šå°‘ï¼Œftpçš„è´¦å·å¯†ç ä¹Ÿæ˜¯å¤šå°‘ï¼Ÿæˆ‘ä»¬ä¸çŸ¥é“ï¼Œè¿™ä¸ªé»˜è®¤ä¸ºç©ºï¼Œè¿˜éœ€è¦æˆ‘ä»¬è‡ªå·±è®¾ç½®ã€‚ã€è¦å…ˆåœ¨æ–‡æœ¬ä¸Šé¢å†™å¥½å…ˆåœ¨å¤åˆ¶å®‰å…¨ç‚¹ï¼Œä¸ç„¶å¯†ç è®¾ç½®æˆä»€ä¹ˆè‡ªå·±éƒ½ä¸è®°å¾—äº†ã€‘è¾“å…¥å‘½ä»¤</p>
<p>sudo /opt/lampp/lampp security</p>
<p>å¦‚å›¾æ‰€ç¤º:ä»–ä¼šä¾æ¬¡è¦æ±‚ä½ </p>
<p>1ã€å…ˆè¾“å…¥xamppæ§åˆ¶é¢æ¿çš„å¯†ç ï¼ˆç”¨æˆ·åæ˜¯xamppï¼‰ï¼›</p>
<p>2ã€è¾“å…¥phpmyadminçš„å¯†ç ï¼ˆç”¨æˆ·åæ˜¯pmaï¼‰</p>
<p>3ã€è¾“å…¥mysqlçš„å¯†ç ï¼ˆç”¨æˆ·åæ˜¯rootï¼‰</p>
<p>4ã€è¾“å…¥ftpå¯†ç ï¼ˆç”¨æˆ·åæ˜¯daemonï¼Œé»˜è®¤ç«¯å£21ï¼‰</p>
<p>9ã€åœ¨æµè§ˆå™¨è¾“å…¥æœåŠ¡å™¨çš„ipè®¿é—®çœ‹ä¸€ä¸‹æˆåŠŸäº†æ²¡æœ‰ï¼Ÿ</p>
<p>ç”±äºæœåŠ¡å™¨è®¾ç½®äº†xamppä¸å…è®¸è¿œç¨‹è®¿é—®ï¼Œæ‰€ä»¥è¿œç¨‹ä¸èƒ½è®¿é—®éœ€è¦ä¿®æ”¹confæ–‡ä»¶</p>
<p>vi /opt/lampp/etc/extra/httpd-xampp.conf</p>
<p>å°†  Require local æ”¹æˆ Require all granted</p>
<p>/opt/lampp/lampp restart é‡å¯xampp</p>
<p>åˆ°æ­¤xamppå®‰è£…å®Œæˆ</p>
<p>mysqlæŒ‡ä»¤æ— æ³•æ‰§è¡Œï¼Œç®€å•çš„æ–¹æ³•æ˜¯å¯ä»¥ç›´æ¥å°†/opt/lampp/bin/ç›®å½•æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥ä½¿ç”¨mysqlå’Œmysqldumpå‘½ä»¤äº†ã€‚</p>
<p>æ‰“å¼€ ~/.bashrc æ–‡ä»¶<br>åœ¨æœ€åä¸€è¡ŒåŠ å…¥<br># PATH<br>export PATH=/opt/lampp/bin:$PATH<br>ä¿å­˜é€€å‡ºæ‰§è¡Œè¯¥æ–‡ä»¶ä¸­çš„å‘½ä»¤<br>source ~/.bashrc</p>
<p>ä¿®æ”¹/opt/lampp/etc/my.cnf é…ç½®æ–‡ä»¶ï¼Œå¼€æ”¾3306ç«¯å£ã€‚å¯èƒ½éœ€è¦é‡å¯æœåŠ¡å™¨ï¼Œæ³¨æ„æŸ¥çœ‹ä¸‹mysqlæ˜¯å¦å¯åŠ¨åœ¨33066ç«¯å£ä¸Šã€‚</p>
<h3 id="4-è¿ç§»wordpressã€‚"><a href="#4-è¿ç§»wordpressã€‚" class="headerlink" title="4.è¿ç§»wordpressã€‚"></a>4.è¿ç§»wordpressã€‚</h3><h3 id="5-redisè¿ç§»ã€‚"><a href="#5-redisè¿ç§»ã€‚" class="headerlink" title="5.redisè¿ç§»ã€‚"></a>5.redisè¿ç§»ã€‚</h3><h3 id="6-serverå’Œhtdocsè¿ç§»ã€‚"><a href="#6-serverå’Œhtdocsè¿ç§»ã€‚" class="headerlink" title="6.serverå’Œhtdocsè¿ç§»ã€‚"></a>6.serverå’Œhtdocsè¿ç§»ã€‚</h3><h2 id="7-mavenç§æœ‰ä»“åº“å’ŒSVNã€‚"><a href="#7-mavenç§æœ‰ä»“åº“å’ŒSVNã€‚" class="headerlink" title="7.mavenç§æœ‰ä»“åº“å’ŒSVNã€‚"></a>7.mavenç§æœ‰ä»“åº“å’ŒSVNã€‚</h2><p>8.nginxå®‰è£…<a href="https://www.cnblogs.com/wyd168/p/6636529.html">https://www.cnblogs.com/wyd168/p/6636529.html</a></p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ç½‘ç«™</tag>
      </tags>
  </entry>
  <entry>
    <title>APPå¼€å‘é€‰å‹</title>
    <url>/app-dev/</url>
    <content><![CDATA[<div class=".article-gallery"><h2 id="è¿™æ¬¡çœŸçš„æ˜¯ä»å…¥å‘åˆ°å¼ƒå‘ã€‚æœ€åè¿˜æ˜¯è§‰å¾—ä½¿ç”¨flutter"><a href="#è¿™æ¬¡çœŸçš„æ˜¯ä»å…¥å‘åˆ°å¼ƒå‘ã€‚æœ€åè¿˜æ˜¯è§‰å¾—ä½¿ç”¨flutter" class="headerlink" title="è¿™æ¬¡çœŸçš„æ˜¯ä»å…¥å‘åˆ°å¼ƒå‘ã€‚æœ€åè¿˜æ˜¯è§‰å¾—ä½¿ç”¨flutter"></a>è¿™æ¬¡çœŸçš„æ˜¯ä»å…¥å‘åˆ°å¼ƒå‘ã€‚æœ€åè¿˜æ˜¯è§‰å¾—ä½¿ç”¨flutter</h2><p>åœ¨ä½¿ç”¨weexåšäº†ä¸€ä¸ªç®€å•çš„åº”ç”¨ï¼Œè°ƒé€šé€šä¿¡å’Œèµ„æºåŠ è½½åï¼Œå‘ç°å‘è¿˜æ˜¯å¾ˆå¤šçš„ã€‚</p>
<p>ä¸»è¦weexé€‚åˆç”¨æ¥åšå•é¡µé¢çš„å¼€å‘ï¼Œå¼€å‘å®Œæ•´çš„APPè¿˜æ˜¯æœ‰ä¸€äº›å±€é™æ€§ï¼Œåœ¨æµè§ˆå™¨ç«¯è°ƒè¯•ä¹Ÿå­˜åœ¨é—®é¢˜ã€‚</p>
<p>ä¸»è¦è¿˜æ˜¯ç¤¾åŒºå’Œæ–‡æ¡£å¾ˆä¸é½å…¨ã€‚</p>
<p>ä¸ºä»€ä¹ˆé€‰æ‹©flutterå‘¢ï¼Ÿ</p>
<span id="more"></span>

<p>1.googleçˆ¸çˆ¸èƒŒä¹¦ã€‚</p>
<p>2.dartå¼€å‘ã€‚ï¼ˆè‡ªå·±å¯¹JSä¸ç†Ÿæ‚‰ã€‚å¸¸å¹´ä½¿ç”¨JAVAï¼‰</p>
<p>3.ideaï¼Œå’ŒæœåŠ¡å™¨ç«¯ç»Ÿä¸€IDEã€‚</p>
<p>4.flutterçš„ç†å¿µæ‰æ˜¯è·¨å¹³å°çš„æœ€ç»ˆè§£å†³æ–¹æ¡ˆã€‚</p>
<p>5.æ„Ÿè§‰ä¸èƒ½å†å¥½äº†ã€</p>
<p>psï¼šå°±åœ¨å‰å‡ å¤©ï¼ˆ2018.12.5ï¼‰å‡ºæ­£å¼1.0ç‰ˆæœ¬äº†</p>
<h2 id="åŸæ–‡ï¼š"><a href="#åŸæ–‡ï¼š" class="headerlink" title="åŸæ–‡ï¼š"></a>åŸæ–‡ï¼š</h2><p>æœ€è¿‘æœ‰åšä¸€æ¬¾APPçš„æƒ³æ³•ï¼Œè°ƒç ”ä¸‹å¼€å‘å·¥å…·é“¾ã€‚ä¸€ç›´åšæ¸¸æˆå¼€å‘ï¼Œå¼•æ“ç”¨è¿‡u3dï¼Œcocosï¼Œegretã€‚</p>
<p>æœ€ç»ˆå†³å®šä½¿ç”¨weexã€‚</p>
<p>å­¦ä¹ æ•´ç†ï¼š</p>
<p><a href="https://segmentfault.com/a/1190000011027225">https://segmentfault.com/a/1190000011027225</a></p>
<p>htmlï¼Œcssçš„åŸºç¡€çŸ¥è¯†ï¼›</p>
<p>Nodeï¼š<a href="http://www.runoob.com/nodejs/nodejs-tutorial.html">ã€ŠNode.js æ•™ç¨‹ã€‹</a><br>Vueï¼š<a href="https://cn.vuejs.org/v2/guide/">ã€ŠVue.jså®˜æ–¹æ•™ç¨‹ã€‹</a><br>ES6ï¼š<a href="http://es6.ruanyifeng.com/">ã€ŠECMAScript 6 å…¥é—¨ã€‹</a></p>
<p>è½¬è½½ï¼š<a href="https://www.jianshu.com/p/33246251cfae">https://www.jianshu.com/p/33246251cfae</a></p>
<h1 id="æµ…è°ˆNativeã€Web-Appã€Hybridã€ReactNativeå’ŒWEEXçš„ä¼˜åŠ£"><a href="#æµ…è°ˆNativeã€Web-Appã€Hybridã€ReactNativeå’ŒWEEXçš„ä¼˜åŠ£" class="headerlink" title="æµ…è°ˆNativeã€Web Appã€Hybridã€ReactNativeå’ŒWEEXçš„ä¼˜åŠ£"></a>æµ…è°ˆNativeã€Web Appã€Hybridã€ReactNativeå’ŒWEEXçš„ä¼˜åŠ£</h1><h1 id="ä¸€å¥è¯æ¦‚è¦"><a href="#ä¸€å¥è¯æ¦‚è¦" class="headerlink" title="ä¸€å¥è¯æ¦‚è¦"></a>ä¸€å¥è¯æ¦‚è¦</h1><blockquote>
<p>Nativeã€Web Appã€Hybridã€ReactNativeï¼ˆåé¢ä»¥RNç®€ç§°ï¼‰ã€WEEXé—´çš„å¼‚åŒç‚¹</p>
</blockquote>
<h1 id="APPå¸¸ç”¨å¼€å‘æ¨¡å¼ã€ç®€ä»‹ã€‘"><a href="#APPå¸¸ç”¨å¼€å‘æ¨¡å¼ã€ç®€ä»‹ã€‘" class="headerlink" title="APPå¸¸ç”¨å¼€å‘æ¨¡å¼ã€ç®€ä»‹ã€‘"></a>APPå¸¸ç”¨å¼€å‘æ¨¡å¼ã€ç®€ä»‹ã€‘</h1><p>æ­¤å¤„APPä¸ºåº”ç”¨ï¼Œapplicationï¼Œå¹¶éæˆ‘ä»¬é€šå¸¸è®²çš„æ‰‹æœºApp<br><a href="https://link.jianshu.com/?t=http://naotu.baidu.com/file/6af15fcbb72f89926043779811b1ea44?token=df0378691ecdcef2">å¸¸ç”¨çš„å‡ ç§APPå¼€å‘æ¨¡å¼-è„‘å›¾</a></p>
<h2 id="Native-App"><a href="#Native-App" class="headerlink" title="Native App"></a>Native App</h2><p>ä¼ ç»Ÿçš„åŸç”ŸAPPå¼€å‘æ¨¡å¼ï¼Œæœ‰IOSå’ŒAOSä¸¤å¤§ç³»ç»Ÿï¼Œéœ€è¦å„è‡ªè¯­è¨€å¼€å‘å„è‡ªAPPã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼šæ€§èƒ½å’Œä½“éªŒéƒ½æ˜¯æœ€å¥½çš„<br><strong>ç¼ºç‚¹</strong>ï¼šå¼€å‘å’Œå‘å¸ƒæˆæœ¬é«˜<br><strong>ä¸¾ä¸ªæ —å­</strong>ï¼š<a href="https://link.jianshu.com/?t=https://id.163.com/gj/">ç½‘æ˜“ç®¡å®¶APP</a> ï¼ˆTab1ï¼ŒTab2ï¼‰<br><strong>åº”ç”¨æŠ€æœ¯</strong>ï¼šSwiftï¼ŒOCï¼ŒJAVA</p>
<h2 id="WebApp"><a href="#WebApp" class="headerlink" title="WebApp"></a>WebApp</h2><p>ç§»åŠ¨ç«¯çš„ç½‘ç«™ï¼Œå¸¸è¢«ç§°ä¸ºH5åº”ç”¨ï¼Œè¯´ç™½äº†å°±æ˜¯ç‰¹å®šè¿è¡Œåœ¨ç§»åŠ¨ç«¯æµè§ˆå™¨ä¸Šçš„ç½‘ç«™åº”ç”¨ã€‚ä¸€èˆ¬æ³›æŒ‡ SPA(Single Page Application)æ¨¡å¼å¼€å‘å‡ºçš„ç½‘ç«™ï¼Œä¸MPAï¼ˆMulti-page Applicationï¼Œå†åé¢åšä»‹ç»ï¼‰å¯¹åº”ã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼šå¼€å‘å’Œå‘å¸ƒæˆæœ¬æœ€ä½<br><strong>ç¼ºç‚¹</strong>ï¼šæ€§èƒ½å’Œä½“éªŒä¸èƒ½è®²æ˜¯æœ€å·®çš„ï¼Œä½†ä¹Ÿå—åˆ°æµè§ˆå™¨å¤„ç†èƒ½åŠ›çš„é™åˆ¶ï¼Œå¤šæ¬¡ä¸‹è½½åŒæ ·ä¼šå ç”¨ç”¨æˆ·ä¸€å®šçš„æµé‡<br><strong>ä¸¾ä¸ªæ —å­</strong>ï¼š<a href="https://link.jianshu.com/?t=https://id.163.com/gj/">ç½‘æ˜“ç®¡å®¶APP</a>ï¼ˆTab3ï¼‰<br><strong>åº”ç”¨æŠ€æœ¯</strong>ï¼šReactJSï¼ŒRegularJSç­‰</p>
<h2 id="Hybrid-App"><a href="#Hybrid-App" class="headerlink" title="Hybrid App"></a>Hybrid App</h2><p>æ··åˆæ¨¡å¼ç§»åŠ¨åº”ç”¨ï¼Œä»‹äºweb-appã€native-appè¿™ä¸¤è€…ä¹‹é—´çš„appï¼Œå…¼å…·â€œNative Appè‰¯å¥½äº¤äº’ä½“éªŒçš„ä¼˜åŠ¿â€å’Œâ€œWeb Appè·¨å¹³å°å¼€å‘çš„ä¼˜åŠ¿â€ï¼ˆç™¾åº¦ç™¾ç§‘è§£é‡Šï¼‰</p>
<p>ä¸»è¦çš„åŸç†æ˜¯ï¼Œç”±Nativeé€šè¿‡JSBridgeç­‰æ–¹æ³•æä¾›ç»Ÿä¸€çš„APIï¼Œç„¶åç”¨HTML+CSSå®ç°ç•Œé¢ï¼ŒJSæ¥å†™é€»è¾‘ï¼Œè°ƒç”¨APIï¼Œæœ€ç»ˆçš„é¡µé¢åœ¨webviewä¸­æ˜¾ç¤ºï¼Œè¿™ç§æ¨¡å¼ä¸‹ï¼ŒAndroidã€iOSçš„APIä¸€èˆ¬æœ‰ä¸€è‡´æ€§ï¼ŒHybrid Appæ‰€æœ‰æœ‰è·¨å¹³å°æ•ˆæœã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼šå¼€å‘å’Œå‘å¸ƒéƒ½æ¯”è¾ƒæ–¹ä¾¿ï¼Œæ•ˆç‡ä»‹äºNative Appã€Web Appä¹‹é—´<br><strong>ç¼ºç‚¹</strong>ï¼šå­¦ä¹ èŒƒå›´è¾ƒå¹¿ï¼Œéœ€è¦åŸç”Ÿé…åˆ<br><strong>ä¸¾ä¸ªæ —å­</strong>ï¼š<a href="https://link.jianshu.com/?t=https://music.163.com/#/download">ç½‘æ˜“äº‘éŸ³ä¹</a>ï¼Œæˆ‘çˆ±æˆ‘å®¶App<br><strong>åº”ç”¨æŠ€æœ¯</strong>ï¼šPhoneGapï¼ŒAppCanï¼ŒWex5</p>
<h2 id="React-Native-App"><a href="#React-Native-App" class="headerlink" title="React Native App"></a>React Native App</h2><p>Facebookå‘ç°Hybrid Appå­˜åœ¨å¾ˆå¤šç¼ºé™·å’Œä¸è¶³ï¼Œäºæ˜¯å‘èµ·å¼€æºçš„ä¸€å¥—æ–°çš„APPå¼€å‘æ–¹æ¡ˆRN Appã€‚ã€‚ä½¿ç”¨JSXè¯­è¨€å†™åŸç”Ÿç•Œé¢ï¼Œjsé€šè¿‡JSBridgeè°ƒç”¨åŸç”ŸAPIæ¸²æŸ“UIäº¤äº’é€šä¿¡ã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼šæ•ˆç‡ä½“éªŒæ¥è¿‘Native Appï¼Œå‘å¸ƒå’Œå¼€å‘æˆæœ¬ä½äºNative App<br><strong>ç¼ºç‚¹</strong>ï¼šå­¦ä¹ æœ‰ä¸€å®šæˆæœ¬ï¼Œä¸”æ–‡æ¡£è¾ƒå°‘ï¼Œå…ä¸äº†è¸©å‘<br><strong>ä¸¾ä¸ªæ —å­</strong>ï¼šFacebookã€youtubeã€discordã€QQã€ç™¾åº¦ç­‰ç­‰</p>
<h2 id="WEEX-App"><a href="#WEEX-App" class="headerlink" title="WEEX App"></a>WEEX App</h2><p>é˜¿é‡Œå·´å·´å¼€å‘å›¢é˜Ÿåœ¨RNçš„æˆåŠŸæ¡ˆä¾‹ä¸Šï¼Œé‡æ–°è®¾è®¡å‡ºçš„ä¸€å¥—å¼€å‘æ¨¡å¼ï¼Œç«™åœ¨äº†å·¨äººè‚©è†€ä¸Šå¹¶æœ‰æ·˜å®å›¢é˜Ÿé¡¹ç›®åšå…»æ–™ï¼Œå¹¿å—å…³æ³¨ï¼Œ2016å¹´4æœˆæ­£å¼å¼€æºï¼Œå¹¶åœ¨v2.0ç‰ˆæœ¬å®˜æ–¹æ”¯æŒVue.jsï¼Œä¸RNåˆ†åº­æŠ—ç¤¼ã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼šå¼€å‘æ•ˆç‡å’Œä½“éªŒä¸Šè·ŸRNä¸ç›¸ä¸Šä¸‹ï¼Œå¹¶ä¸”è·¨å¹³å°æ€§æ›´å¼º<br><strong>ç¼ºç‚¹</strong>ï¼šåˆšåˆšèµ·æ­¥ï¼Œç¤¾åŒºæ²¡æœ‰RNæ´»è·ƒ<br><strong>ä¸¾ä¸ªæ —å­</strong>ï¼šæ·˜å®ã€å¤©çŒ«ã€é¥¿äº†ä¹ˆç­‰</p>
<h1 id="ç»§ç»­å‰–æ"><a href="#ç»§ç»­å‰–æ" class="headerlink" title="ç»§ç»­å‰–æ"></a>ç»§ç»­å‰–æ</h1><h2 id="Native-App-1"><a href="#Native-App-1" class="headerlink" title="Native App"></a>Native App</h2><p><a href="https://i2.wp.com/upload-images.jianshu.io/upload_images/1494908-70fa348f3db0fca7.png?w=640" title="APPå¼€å‘é€‰å‹ - ç¬¬1å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i2.wp.com/upload-images.jianshu.io/upload_images/1494908-70fa348f3db0fca7.png?w=640" alt="APPå¼€å‘é€‰å‹ - ç¬¬1å¼   | å¼ å˜"></a></p>
<p>Native Appæ˜¯ä¸€ç§åŸºäºæ™ºèƒ½æ‰‹æœºæœ¬åœ°æ“ä½œç³»ç»Ÿå¦‚iOSã€Androidã€WPå¹¶ä½¿ç”¨åŸç”Ÿç¨‹å¼ç¼–å†™è¿è¡Œçš„ç¬¬ä¸‰æ–¹åº”ç”¨ç¨‹åº,ä¹Ÿå«æœ¬åœ°appã€‚ä¸€èˆ¬ä½¿ç”¨çš„å¼€å‘è¯­è¨€ä¸ºJAVAã€C++ã€Objective-Cã€‚</p>
<p>è‡ªiOSå’ŒAndroidè¿™ä¸¤ä¸ªçš„æ‰‹æœºæ“ä½œç³»ç»Ÿå‘å¸ƒä»¥æ¥ï¼Œåœ¨äº’è”ç½‘ç•Œä»æ­¤å°±å¤šäº†ä¸€ä¸ªæ–°çš„åè¯ï¼šAppæ„ä¸ºè¿è¡Œåœ¨æ™ºèƒ½çš„ç§»åŠ¨ç»ˆç«¯è®¾å¤‡ç¬¬ä¸‰æ–¹åº”ç”¨ç¨‹åº)ã€‚</p>
<p>Native Appå› ä¸ºä½äºå¹³å°å±‚ä¸Šæ–¹ï¼Œå‘ä¸‹è®¿é—®å’Œå…¼å®¹çš„èƒ½åŠ›ä¼šæ¯”è¾ƒå¥½ä¸€äº›ï¼Œå¯ä»¥æ”¯æŒåœ¨çº¿æˆ–ç¦»çº¿ï¼Œæ¶ˆæ¯æ¨é€æˆ–æœ¬åœ°èµ„æºè®¿é—®ï¼Œæ‘„åƒæ‹¨å·åŠŸèƒ½çš„è°ƒå–ã€‚ä½†æ˜¯ç”±äºè®¾å¤‡ç¢ç‰‡åŒ–ï¼ŒAppçš„å¼€å‘æˆæœ¬è¦é«˜å¾ˆå¤šï¼Œç»´æŒå¤šä¸ªç‰ˆæœ¬çš„æ›´æ–°å‡çº§æ¯”è¾ƒéº»çƒ¦ï¼Œç”¨æˆ·çš„å®‰è£…é—¨æ§›ä¹Ÿæ¯”è¾ƒé«˜ã€‚ä½†æ˜¯æ¯”è¾ƒä¹è§‚çš„æ˜¯ï¼ŒAppStoreåŸ¹å…»äº†ä¸€ç§æ¯”è¾ƒå¥½çš„ç”¨æˆ·ä»˜è´¹æ¨¡å¼ï¼Œæ‰€ä»¥åœ¨Appleçš„ç”Ÿæ€åœˆé‡Œï¼Œå¼€å‘è€…çš„ç›ˆåˆ©æ¨¡å¼æ˜¯ä¸€ç§æ˜æœ—çŠ¶æ€ï¼Œå…¶ä»–marketä¹Ÿåœ¨å¾€è¿™æ¡è·¯ä¸Šé æ‹¢ã€‚</p>
<h3 id="ä¼˜åŠ¿"><a href="#ä¼˜åŠ¿" class="headerlink" title="ä¼˜åŠ¿"></a>ä¼˜åŠ¿</h3><p>1ã€ç›¸æ¯”äºå…¶å®ƒæ¨¡å¼ï¼Œæä¾›æœ€ä½³çš„ç”¨æˆ·ä½“éªŒï¼Œæœ€ä¼˜è´¨çš„ç”¨æˆ·ç•Œé¢ï¼Œæœ€åä¸½çš„äº¤äº’<br>2ã€é’ˆå¯¹ä¸åŒå¹³å°æä¾›ä¸åŒä½“éªŒ<br>3ã€å¯èŠ‚çœå¸¦å®½æˆæœ¬ï¼Œæ‰“å¼€é€Ÿåº¦æ›´å¿«<br>4ã€åŠŸèƒ½æœ€ä¸ºå¼ºå¤§,ç‰¹åˆ«æ˜¯åœ¨ä¸ç³»ç»Ÿäº¤äº’ä¸­,å‡ ä¹æ‰€æœ‰åŠŸèƒ½éƒ½èƒ½å®ç°</p>
<h3 id="åŠ£åŠ¿"><a href="#åŠ£åŠ¿" class="headerlink" title="åŠ£åŠ¿"></a>åŠ£åŠ¿</h3><p>1ã€é—¨æ§›é«˜ï¼ŒåŸç”Ÿå¼€å‘äººæ‰ç¨€ç¼ºï¼Œè‡³å°‘æ¯”å‰ç«¯å’Œåç«¯å°‘ï¼Œå¼€å‘ç¯å¢ƒæ˜‚è´µ<br>2ã€æ— æ³•è·¨å¹³å°ï¼Œå¼€å‘çš„æˆæœ¬æ¯”è¾ƒå¤§ï¼Œå„ä¸ªç³»ç»Ÿç‹¬ç«‹å¼€å‘<br>3ã€å‘å¸ƒæˆæœ¬é«˜ï¼Œéœ€è¦é€šè¿‡storeæˆ–marketçš„å®¡æ ¸ï¼Œå¯¼è‡´æ›´æ–°ç¼“æ…¢<br>4ã€ç»´æŒå¤šä¸ªç‰ˆæœ¬ã€å¤šä¸ªç³»ç»Ÿçš„æˆæœ¬æ¯”è¾ƒé«˜ï¼Œè€Œä¸”å¿…é¡»åšå…¼å®¹<br>5ã€åº”ç”¨å¸‚åœºé€æ¸é¥±å’Œï¼Œæ€ä¹ˆæ ·æŠ¢å ç”¨æˆ·æ—¶é—´éœ€è¦æŠ•å…¥å¤§é‡æ—¶é—´å’Œé‡‘é’±ï¼Œè¿™ä¹Ÿå¯¼è‡´â€œåƒµå°¸â€Appçš„å¢å¤š</p>
<h2 id="WebApp-1"><a href="#WebApp-1" class="headerlink" title="WebApp"></a>WebApp</h2><p><a href="https://i1.wp.com/upload-images.jianshu.io/upload_images/1494908-a16fa91905d4214e.png?w=640" title="APPå¼€å‘é€‰å‹ - ç¬¬2å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i1.wp.com/upload-images.jianshu.io/upload_images/1494908-a16fa91905d4214e.png?w=640" alt="APPå¼€å‘é€‰å‹ - ç¬¬2å¼   | å¼ å˜"></a></p>
<p>è¯´åˆ°Web Appä¸å°‘äººä¼šè”æƒ³åˆ°WAPï¼Œæˆ–è€…æœ‰äººè®¤ä¸ºï¼ŒWAPå°±æ˜¯WebAppï¼Œå…¶å®ä¸ç„¶ã€‚</p>
<p>WebAppä¸WAPæœ€ç›´æ¥çš„åŒºåˆ«å°±æ˜¯åŠŸèƒ½å±‚é¢ã€‚WAPæ›´ä¾§é‡ä½¿ç”¨ç½‘é¡µæŠ€æœ¯åœ¨ç§»åŠ¨ç«¯åšå±•ç¤ºï¼ŒåŒ…æ‹¬æ–‡å­—ã€åª’ä½“æ–‡ä»¶ç­‰ã€‚è€ŒWeb Appæ›´ä¾§é‡â€œåŠŸèƒ½â€ï¼Œæ˜¯ä½¿ç”¨ç½‘é¡µæŠ€æœ¯å®ç°çš„Appã€‚æ€»çš„æ¥è¯´ï¼ŒWeb Appå°±æ˜¯è¿è¡Œäºç½‘ç»œå’Œæ ‡å‡†æµè§ˆå™¨ä¸Šï¼ŒåŸºäºç½‘é¡µæŠ€æœ¯å¼€å‘å®ç°ç‰¹å®šåŠŸèƒ½çš„åº”ç”¨ã€‚</p>
<p>å“åº”å¼çš„å¤§éƒ¨åˆ†æŠ€æœ¯éƒ½æ˜¯ä¸ºå®ç°WebAppèƒ½é€‚é…å¤šç±»å®¢æˆ·ç«¯è€Œè®¾è®¡çš„ã€‚</p>
<p>Webç½‘ç«™ä¸€èˆ¬åˆ†ä¸¤ç§ï¼ŒMPA(Multi-page Application)å’ŒSPA(Single-page Application)ã€‚è€ŒWebAppä¸€èˆ¬æ³›æŒ‡SPAå½¢å¼å¼€å‘å‡ºçš„ç½‘ç«™ã€‚è¿™æ ·æ›´åƒæ˜¯ä¸€ä¸ªAppã€‚</p>
<h3 id="ä¼˜åŠ¿-1"><a href="#ä¼˜åŠ¿-1" class="headerlink" title="ä¼˜åŠ¿"></a>ä¼˜åŠ¿</h3><p>1ã€å¯ä»¥è·¨å¹³å°ï¼Œè°ƒè¯•æ–¹ä¾¿<br>2ã€æ— éœ€å®‰è£…ï¼Œä¸ä¼šå ç”¨æ‰‹æœºå†…å­˜ï¼Œè€Œä¸”æ›´æ–°é€Ÿåº¦æœ€å¿«<br>3ã€ä¸å­˜åœ¨å¤šç‰ˆæœ¬é—®é¢˜ï¼Œç»´æŠ¤æˆæœ¬ä½<br>4ã€ä¸´æ—¶å…¥å£ï¼Œå¯ä»¥éšæ„åµŒå…¥</p>
<h3 id="åŠ£åŠ¿-1"><a href="#åŠ£åŠ¿-1" class="headerlink" title="åŠ£åŠ¿"></a>åŠ£åŠ¿</h3><p>1ã€ä¾èµ–äºç½‘ç»œï¼Œç¬¬ä¸€æ¬¡è®¿é—®é¡µé¢é€Ÿåº¦æ…¢ï¼Œè€—è´¹æµé‡<br>2ã€å—é™äºæ‰‹æœºå’Œæµè§ˆå™¨æ€§èƒ½ï¼Œç”¨æˆ·ä½“éªŒç›¸è¾ƒäºå…¶ä»–æ¨¡å¼æœ€å·®<br>3ã€åŠŸèƒ½å—é™ï¼Œå¤§é‡ç§»åŠ¨ç«¯åŠŸèƒ½æ— æ³•å®ç°<br>4ã€å…¥å£å¼ºä¾èµ–äºç¬¬ä¸‰æ–¹æµè§ˆå™¨ï¼Œä¸”åªèƒ½ä»¥URLåœ°å€çš„å½¢å¼å­˜åœ¨ï¼Œå¯¼è‡´ç”¨æˆ·ç•™å­˜ç‡ä½ï¼ˆä¼˜ç‚¹å³ç¼ºç‚¹ï¼‰</p>
<h2 id="Hybird-App"><a href="#Hybird-App" class="headerlink" title="Hybird App"></a>Hybird App</h2><p><a href="https://i2.wp.com/upload-images.jianshu.io/upload_images/1494908-e8ed4f0375d2639b.png?w=640" title="APPå¼€å‘é€‰å‹ - ç¬¬3å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i2.wp.com/upload-images.jianshu.io/upload_images/1494908-e8ed4f0375d2639b.png?w=640" alt="APPå¼€å‘é€‰å‹ - ç¬¬3å¼   | å¼ å˜"></a></p>
<p>æ··åˆå¼€å‘ï¼Œä¹Ÿå°±æ˜¯åŠåŸç”ŸåŠWebçš„å¼€å‘æ¨¡å¼ï¼Œç”±åŸç”Ÿæä¾›ç»Ÿä¸€çš„APIç»™JSè°ƒç”¨ï¼Œå®é™…çš„ä¸»è¦é€»è¾‘æœ‰Htmlå’ŒJSæ¥å®Œæˆï¼Œæœ€ç»ˆæ˜¯æ”¾åœ¨webviewä¸­æ˜¾ç¤ºçš„ï¼Œæ‰€ä»¥åªéœ€è¦å†™ä¸€å¥—ä»£ç å³å¯è¾¾åˆ°è·¨å¹³å°æ•ˆæœï¼Œå¦å¤–ä¹Ÿå¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­è°ƒè¯•ï¼Œå¾ˆæ–¹ä¾¿ã€‚æœ€é‡è¦çš„æ˜¯åªéœ€è¦ä¸€ä¸ªå‰ç«¯äººå‘˜ç¨å¾®å­¦ä¹ ä¸‹JS apiçš„è°ƒç”¨å³å¯ã€‚</p>
<p>Hybird App çš„è¾ƒæ—©å®è·µè€…æ˜¯PhoneGapï¼Œéšåéåœ°å¼€èŠ±ï¼Œå¦‚Titaniumã€Salamaã€WeX5ã€Kerkeeå’Œå›½å†…çš„AppCanï¼Œé¡¹ç›®å„æœ‰å„çš„å®ç°æ–¹å¼ï¼Œå¤§è‡´çš„åŸç†åŸºæœ¬ç›¸åŒã€‚æœ‰å¹¸åœ¨AppCanä¸Šæµ·æ€»éƒ¨å‚ä¸è¿‡ä¸€æ®µæ—¶é—´çš„å­¦ä¹ ç ”ç©¶ï¼Œå¦‚ä¸‹å¤§è‡´ç®€ä»‹ï¼š</p>
<p>AppCanæ˜¯åŸºäºHTML5æŠ€æœ¯çš„Hybirdè·¨å¹³å°ç§»åŠ¨åº”ç”¨å¼€å‘å·¥å…·ã€‚å¼€å‘è€…åˆ©ç”¨HTML5+CSS3+JavaScriptæŠ€æœ¯ï¼Œé€šè¿‡AppCan IDEé›†æˆå¼€å‘ç³»ç»Ÿã€äº‘ç«¯æ‰“åŒ…å™¨ç­‰ï¼Œå¿«é€Ÿå¼€å‘å‡ºAndroidã€iOSã€WPå¹³å°ä¸Šçš„ç§»åŠ¨åº”ç”¨ã€‚</p>
<p>AppCançš„å¹³å°æ„æˆ</p>
<p><a href="https://i2.wp.com/upload-images.jianshu.io/upload_images/1494908-cd8c63378a612022.png?w=640" title="APPå¼€å‘é€‰å‹ - ç¬¬4å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i2.wp.com/upload-images.jianshu.io/upload_images/1494908-cd8c63378a612022.png?w=640" alt="APPå¼€å‘é€‰å‹ - ç¬¬4å¼   | å¼ å˜"></a></p>
<p>åœ¨å®é™…çš„APPå¼€å‘ä¸­ï¼ŒAppCanå¯ä»¥å®Œæˆå¤§éƒ¨åˆ†çš„å·¥ä½œé‡ï¼Œå¦‚å›¾ç¤ºï¼š</p>
<p><a href="https://i2.wp.com/upload-images.jianshu.io/upload_images/1494908-634591b2598fa8ad.png?w=640" title="APPå¼€å‘é€‰å‹ - ç¬¬5å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i2.wp.com/upload-images.jianshu.io/upload_images/1494908-634591b2598fa8ad.png?w=640" alt="APPå¼€å‘é€‰å‹ - ç¬¬5å¼   | å¼ å˜"></a></p>
<p>AppCanå°†APPåº•å±‚å¤æ‚çš„åŸç”ŸåŠŸèƒ½å°è£…åœ¨å¼•æ“ã€æ’ä»¶ä¸­ï¼Œå¼€å‘è€…ä»…éœ€è°ƒç”¨æ¥å£ã€æ‰“åŒ…ç¼–è¯‘ï¼Œå°±å¯ä»¥è·å¾—åŸç”ŸåŠŸèƒ½ï¼›çµæ´»çš„æ’ä»¶æ‰©å±•æœºåˆ¶ã€‚</p>
<p>å¼€å‘è€…å¯ä»¥åƒå¼€å‘WebAppä¸€æ ·å¼€å‘appçš„è§†è§‰UIï¼Œä»¥åŠç»å¤§éƒ¨åˆ†çš„äº¤äº’ï¼Œå½“éœ€è¦ä½¿ç”¨åŸç”ŸåŠŸèƒ½ï¼ˆå¦‚æ‘„åƒå¤´ï¼Œé™€èºä»ªç­‰åŠŸèƒ½ï¼‰æ—¶ï¼Œåªéœ€è¦è°ƒç”¨å®˜æ–¹çš„APIå°±å¯ä»¥è½»æ¾å®ç°Nativeçš„æ•ˆæœã€‚è‡³äºJSå’ŒNativeçš„é€šä¿¡ï¼Œå¸¸ç”¨çš„æœ‰URLç›‘å¬å’Œç»å¤§éƒ¨åˆ†Hybridå‚å•†ä½¿ç”¨çš„JSBridgeé€šä¿¡ï¼Œä¸¤è€…åŸç†ç›¸è¿‘ã€‚</p>
<p><a href="https://i1.wp.com/upload-images.jianshu.io/upload_images/1494908-400b4c6162d774f4.png?w=640" title="APPå¼€å‘é€‰å‹ - ç¬¬6å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i1.wp.com/upload-images.jianshu.io/upload_images/1494908-400b4c6162d774f4.png?w=640" alt="APPå¼€å‘é€‰å‹ - ç¬¬6å¼   | å¼ å˜"></a></p>
<p>JsBridgeé€šä¿¡ç®€å›¾</p>
<p>å…³äºJsBridgeçš„åŸç†è¯¦è§£ï¼Œå¯è§<a href="https://link.jianshu.com/?t=http://blog.csdn.net/xiangzhihong8/article/details/66970600">http://blog.csdn.net/xiangzhihong8/article/details/66970600</a></p>
<p>åœ¨Hybirdæ¦‚å¿µç››è¡Œçš„æ—¶å€™ï¼Œå›½å†…å¤–å„å¤§å…¬å¸ä¹Ÿå‚ä¸äº†æ¢ç´¢ï¼Œå›½å¤–ä»£è¡¨æœ‰Facebookã€googleã€äºšé©¬é€Šï¼Œå›½å†…çš„æœ‰è…¾è®¯ã€é˜¿é‡Œå·´å·´ã€ç½‘æ˜“ç­‰ï¼Œæ…¢æ…¢çš„ä»–ä»¬å‘ç°Hybirdä¸¥é‡å—é™äºWebViewçš„è§£ææ¸²æŸ“æ•ˆç‡ï¼Œäºæ˜¯Facebookå¼€å§‹äº†ä»–çš„ç±»åŸç”Ÿçš„ç ”ç©¶æ¢ç´¢ã€‚</p>
<h2 id="React-Native-App-1"><a href="#React-Native-App-1" class="headerlink" title="React Native App"></a>React Native App</h2><p><a href="https://i0.wp.com/upload-images.jianshu.io/upload_images/1494908-846d1bcbe4f9b505.png?w=640" title="APPå¼€å‘é€‰å‹ - ç¬¬7å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/upload-images.jianshu.io/upload_images/1494908-846d1bcbe4f9b505.png?w=640" alt="APPå¼€å‘é€‰å‹ - ç¬¬7å¼   | å¼ å˜"></a></p>
<p>è¯·ç§»é©¾ <a href="https://link.jianshu.com/?t=https://segmentfault.com/a/1190000010989345">ã€ç¬”è®°ã€‘React Native å¿«é€Ÿå…¥é—¨ç¬”è®°</a></p>
<h2 id="Weex-App"><a href="#Weex-App" class="headerlink" title="Weex App"></a>Weex App</h2><p><a href="https://i0.wp.com/upload-images.jianshu.io/upload_images/1494908-ec1e7c9c4de9f9c0.png?w=640" title="APPå¼€å‘é€‰å‹ - ç¬¬8å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/upload-images.jianshu.io/upload_images/1494908-ec1e7c9c4de9f9c0.png?w=640" alt="APPå¼€å‘é€‰å‹ - ç¬¬8å¼   | å¼ å˜"></a></p>
<p>è¯·ç§»é©¾<a href="https://link.jianshu.com/?t=https://segmentfault.com/a/1190000011027225">ç½‘æ˜“ä¸¥é€‰Appæ„Ÿå—Weexå¼€å‘</a></p>
<p>ä½œè€…ï¼šæœ¨ç¾½zwwill<br>é“¾æ¥ï¼š<a href="https://www.jianshu.com/p/33246251cfae">https://www.jianshu.com/p/33246251cfae</a><br>ä¾†æºï¼šç®€ä¹¦<br>ç®€ä¹¦è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ï¼Œä»»ä½•å½¢å¼çš„è½¬è½½éƒ½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒå¹¶æ³¨æ˜å‡ºå¤„ã€‚</p>
<p>çœŸçš„ä»å…¥é—¨åˆ°æ”¾å¼ƒï¼Œfluuter</p>
<p><a href="http://www.52im.net/thread-1870-1-1.html">http://www.52im.net/thread-1870-1-1.html</a></p>
<p><a href="https://www.jianshu.com/p/139c5074ae5d">https://www.jianshu.com/p/139c5074ae5d</a></p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>å‰ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title>è¯»ä¹¦ç¬”è®°-ç»“æ„åŒ–æˆ˜ç•¥æ€ç»´</title>
    <url>/booknote-mckinsey/</url>
    <content><![CDATA[<div class=".article-gallery"><h2 id="éº¦è‚¯é”¡äº”æ­¥æ³•"><a href="#éº¦è‚¯é”¡äº”æ­¥æ³•" class="headerlink" title="éº¦è‚¯é”¡äº”æ­¥æ³•"></a>éº¦è‚¯é”¡äº”æ­¥æ³•</h2><p><a href="https://github.com/zhangga/picx-images-hosting/raw/master/booknote-mckinsiy1.1ape0smxzn.webp" title="pic1" class="gallery-item" style="box-shadow: none;"> <img src="https://github.com/zhangga/picx-images-hosting/raw/master/booknote-mckinsiy1.1ape0smxzn.webp" alt="pic1"></a></p>
<ul>
<li>ä¸“å®¶æ€ç»´ï¼šâ€œæ€ä¹ˆåšâ€“å®æ–½çš„ç»†èŠ‚â€</li>
<li>æˆ˜ç•¥æ€ç»´ï¼šâ€œä¸ºä»€ä¹ˆâ€“è§£å†³ä»€ä¹ˆé—®é¢˜â€</li>
</ul>
<h3 id="1-å®šä¹‰é—®é¢˜"><a href="#1-å®šä¹‰é—®é¢˜" class="headerlink" title="1.å®šä¹‰é—®é¢˜"></a>1.å®šä¹‰é—®é¢˜</h3><p><a href="https://github.com/zhangga/picx-images-hosting/raw/master/booknote-mckinsiy2.3yeub8691a.webp" title="pic2" class="gallery-item" style="box-shadow: none;"> <img src="https://github.com/zhangga/picx-images-hosting/raw/master/booknote-mckinsiy2.3yeub8691a.webp" alt="pic2"></a></p>
<h3 id="2-ç»“æ„åŒ–åˆ†æ"><a href="#2-ç»“æ„åŒ–åˆ†æ" class="headerlink" title="2.ç»“æ„åŒ–åˆ†æ"></a>2.ç»“æ„åŒ–åˆ†æ</h3></div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>è¯»ä¹¦</tag>
      </tags>
  </entry>
  <entry>
    <title>è¯»ä¹¦ç¬”è®°</title>
    <url>/booknote/</url>
    <content><![CDATA[<div class=".article-gallery"><h1 id="ä¸€ã€Redis"><a href="#ä¸€ã€Redis" class="headerlink" title="ä¸€ã€Redis"></a>ä¸€ã€Redis</h1><p>1.ã€Šredisè®¾è®¡ä¸å®ç°ã€‹</p>
<p>2.ã€Šrediså¼€å‘ä¸è¿ç»´ã€‹</p>
<span id="more"></span>

<h1 id="äºŒã€MySQL"><a href="#äºŒã€MySQL" class="headerlink" title="äºŒã€MySQL"></a>äºŒã€MySQL</h1><p>1.ã€ŠMySQLæŠ€æœ¯å†…å¹•ï¼šInnoDBå­˜å‚¨å¼•æ“ã€‹</p>
<h1 id="ä¸‰ã€JAVA"><a href="#ä¸‰ã€JAVA" class="headerlink" title="ä¸‰ã€JAVA"></a>ä¸‰ã€JAVA</h1><p>0.ã€ŠEffective Javaã€‹</p>
<p>1.ã€ŠJavaç¨‹åºæ€§èƒ½ä¼˜åŒ–ã€‹</p>
<p>2.ã€ŠJavaæ•°æ®ç»“æ„å’Œç®—æ³•ã€‹</p>
<p>3.ã€Šé‡æ„ã€æ”¹å–„æ—¢æœ‰ä»£ç çš„è´¨é‡ã€‹</p>
<p>4.ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºï¼šJVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®ç°ã€‹</p>
<p>5.ã€ŠJavaå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹</p>
<p>6.ã€ŠJavaå¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹  å…ˆè¯»å®æˆ˜å†è¯»è‰ºæœ¯</p>
<p>7.ã€Šåˆ†å¸ƒå¼Javaåº”ç”¨ã€‹</p>
<p>8.ã€Šè‡ªå·±åŠ¨æ‰‹å†™JAVAè™šæ‹Ÿæœºã€‹ </p>
<p>9.ã€ŠSpringæºç æ·±åº¦è§£æã€‹</p>
<p>10.ã€Šæ·±å…¥æµ…å‡ºSpring Boot 2ã€‹</p>
<p>11.ã€ŠJVM G1 æºç åˆ†æå’Œè°ƒä¼˜ã€‹ <strong>æœªè¯»</strong></p>
<h1 id="å››ã€æŠ€æœ¯"><a href="#å››ã€æŠ€æœ¯" class="headerlink" title="å››ã€æŠ€æœ¯"></a>å››ã€æŠ€æœ¯</h1><p>1.ã€Šä»£ç ç®€æ´ä¹‹é“ã€‹</p>
<p>2.ã€Šå¤§è¯è®¾è®¡æ¨¡å¼ã€‹</p>
<p>3.ã€Šåƒåœ¾å›æ”¶çš„ç®—æ³•ä¸å®ç°ã€‹ <strong>50%</strong></p>
<p>4.ã€Šè…¾è®¯æ¸¸æˆå¼€å‘ç²¾ç²¹ã€‹ <strong>å‘¨æœ«è¯»</strong></p>
<p>5.ã€Šç‚¹çŸ³æˆé‡‘ã€‹ è¿‘æœŸ</p>
<p>6.ã€Šä»å°å·¥åˆ°ä¸“å®¶ã€‹ è¿‘æœŸ</p>
<p>7.ã€ŠClean Architecture: A Craftsmanâ€™s Guide to Software Structure and Design ã€‹ è´­ä¹¦æ¸…å•</p>
<p>8.ã€ŠDDIAï¼šDesigning Data-Intensive Applicationsã€‚ ã€‹ è´­ä¹¦æ¸…å•</p>
<h1 id="äº”ã€ç»¼åˆ"><a href="#äº”ã€ç»¼åˆ" class="headerlink" title="äº”ã€ç»¼åˆ"></a>äº”ã€ç»¼åˆ</h1><p>1.ã€Šä»é¢†å…ˆåˆ°æè‡´:äº’è”ç½‘æ—¶ä»£ä¸‹çš„åˆ›ä¸šã€åˆ›æ–°ä¸ç®¡ç†å“²å­¦ã€‹</p>
<p>2.ã€Šäººæœˆç¥è¯ã€‹</p>
<p>3.ã€Šå½±å“åŠ›ã€‹</p>
<p>4.ã€Šè‡ªæ§åŠ›ã€‹</p>
<p>5.ã€Šæƒ…å•†ã€‹å…¨6æœ¬ 1/6</p>
<p>6.ã€Šå¦‚ä½•é˜…è¯»ä¸€æœ¬ä¹¦ã€‹</p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>è¯»ä¹¦ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>cocos creatorä½¿ç”¨protobuf tsç‰ˆ</title>
    <url>/cc-proto/</url>
    <content><![CDATA[<div class=".article-gallery"><p>ä¸€ã€å®‰è£…npm nodejsä¸‹çš„åŒ…ç®¡ç†å™¨</p>
<p>å®˜ç½‘ï¼š<a href="https://nodejs.org/">https://nodejs.org</a>  ä¸‹è½½æœ€æ–°ç¨³å®šç‰ˆå®‰è£…ã€‚å¦‚node-v8.11.4-x64.msiã€‚</p>
<span id="more"></span>

<p>åŒå‡»å®‰è£…</p>
<p>ä¸€è·¯ç‚¹nextä¸‹å»ï¼Œå®‰è£…å®Œæˆã€‚</p>
<p>åœ¨nodejsæ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼šnode_cacheã€node_globalã€‚</p>
<p>ç„¶åè¿è¡Œä»¥ä¸‹ä¸¤æ¡å‘½ä»¤ï¼š</p>
<h3 id="npm-config-set-prefix-â€œD-IDE-nodejs-node-globalâ€"><a href="#npm-config-set-prefix-â€œD-IDE-nodejs-node-globalâ€" class="headerlink" title="npm config set prefix â€œD:\IDE\nodejs\node_globalâ€"></a>npm config set prefix â€œD:\IDE\nodejs\node_globalâ€</h3><h3 id="npm-config-set-cache-â€œD-IDE-nodejs-node-cacheâ€"><a href="#npm-config-set-cache-â€œD-IDE-nodejs-node-cacheâ€" class="headerlink" title="npm config set cache â€œD:\IDE\nodejs\node_cacheâ€"></a>npm config set cache â€œD:\IDE\nodejs\node_cacheâ€</h3><h3 id="npm-config-set-registry-http-registry-npm-taobao-org-é…ç½®é•œåƒç«™"><a href="#npm-config-set-registry-http-registry-npm-taobao-org-é…ç½®é•œåƒç«™" class="headerlink" title="npm config set registry=http://registry.npm.taobao.org  é…ç½®é•œåƒç«™"></a>npm config set registry=<a href="http://registry.npm.taobao.org/">http://registry.npm.taobao.org</a>  é…ç½®é•œåƒç«™</h3><p>é…ç½®å®Œåä½¿ç”¨npm config listæ˜¾ç¤ºæ‰€æœ‰é…ç½®ä¿¡æ¯ã€‚</p>
<h3 id="å¢åŠ ç¯å¢ƒå˜é‡NODE-PATH-å†…å®¹æ˜¯ï¼šD-IDE-nodejs-node-global-node-modules"><a href="#å¢åŠ ç¯å¢ƒå˜é‡NODE-PATH-å†…å®¹æ˜¯ï¼šD-IDE-nodejs-node-global-node-modules" class="headerlink" title="å¢åŠ ç¯å¢ƒå˜é‡NODE_PATH å†…å®¹æ˜¯ï¼šD:\IDE\nodejs\node_global\node_modules"></a>å¢åŠ ç¯å¢ƒå˜é‡NODE_PATH å†…å®¹æ˜¯ï¼šD:\IDE\nodejs\node_global\node_modules</h3><p>é‡å¯å‘½ä»¤è¡Œç”Ÿæ•ˆã€‚</p>
<p>äºŒã€å®‰è£…protobufjs</p>
<p>å‘½ä»¤è¡Œæ‰§è¡Œï¼šnpm init</p>
<p>ç„¶åå®‰è£…ï¼šnpm install protobufjs -g</p>
<p>å®‰è£…æˆåŠŸåï¼Œåœ¨nodejs\node_globalæ–‡ä»¶å¤¹ä¸‹æœ‰å¯¹åº”æ–‡ä»¶ã€‚</p>
<p>ä¸‰ã€ç”Ÿæˆjsã€tsæ–‡ä»¶</p>
<p>ç¼–å†™protoæ–‡ä»¶ã€‚</p>
<p>è¿›å…¥node_modules.binç›®å½•ï¼Œæˆ–è€…æ·»åŠ åˆ°ç¯å¢ƒå˜é‡pathé‡Œ<br>* ç¬¬ä¸€æ­¥ç”Ÿæˆjs:<br>* pbjs -t static-module -w commonjs -o test.js test.proto<br>* ç¬¬äºŒæ­¥ç”Ÿæˆts:<br>* pbts -o test.d.ts test.js</p>
<p>å››ã€é¡¹ç›®ä¸­ä½¿ç”¨proto</p>
<p>åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ï¼Œè¿è¡Œå‘½ä»¤</p>
<p>npm init</p>
<p>npm install protobufjs</p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>å‰ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title>äº‘æœåŠ¡å™¨è¢«æŒ–çŸ¿ç—…æ¯’æ„ŸæŸ“ï¼</title>
    <url>/cloud-ver/</url>
    <content><![CDATA[<div class=".article-gallery"><h4 id="è®°å½•ä¸‹ç—…æ¯’æ„ŸæŸ“çš„å§‹æœ«ã€‚ä»å‘ç°åˆ°æŠ˜ç£¨ï¼Œå†åˆ°æœ€åè§£å†³çš„ç—›è‹¦è¿‡ç¨‹ã€‚æ€»ç»“æ•™è®­ï¼Œä¸èƒ½å¤§æ„ï¼Œè¿˜æ˜¯å¾—åšå¥½å¿«ç…§å¤‡ä»½ã€‚"><a href="#è®°å½•ä¸‹ç—…æ¯’æ„ŸæŸ“çš„å§‹æœ«ã€‚ä»å‘ç°åˆ°æŠ˜ç£¨ï¼Œå†åˆ°æœ€åè§£å†³çš„ç—›è‹¦è¿‡ç¨‹ã€‚æ€»ç»“æ•™è®­ï¼Œä¸èƒ½å¤§æ„ï¼Œè¿˜æ˜¯å¾—åšå¥½å¿«ç…§å¤‡ä»½ã€‚" class="headerlink" title="è®°å½•ä¸‹ç—…æ¯’æ„ŸæŸ“çš„å§‹æœ«ã€‚ä»å‘ç°åˆ°æŠ˜ç£¨ï¼Œå†åˆ°æœ€åè§£å†³çš„ç—›è‹¦è¿‡ç¨‹ã€‚æ€»ç»“æ•™è®­ï¼Œä¸èƒ½å¤§æ„ï¼Œè¿˜æ˜¯å¾—åšå¥½å¿«ç…§å¤‡ä»½ã€‚"></a><strong>è®°å½•ä¸‹ç—…æ¯’æ„ŸæŸ“çš„å§‹æœ«ã€‚ä»å‘ç°åˆ°æŠ˜ç£¨ï¼Œå†åˆ°æœ€åè§£å†³çš„ç—›è‹¦è¿‡ç¨‹ã€‚æ€»ç»“æ•™è®­ï¼Œä¸èƒ½å¤§æ„ï¼Œè¿˜æ˜¯å¾—åšå¥½å¿«ç…§å¤‡ä»½ã€‚</strong></h4><p>ä¸€ã€3æœˆ13å·å‘ç°æœåŠ¡å™¨sshè¿æ¥å›°éš¾ï¼Œè¿ä¸Šå°±æ‰çº¿ï¼Œæ ¹æœ¬æ— æ³•æ“ä½œï¼Œç”¨topæŒ‡ä»¤æŸ¥çœ‹å‘ç°æœ‰è¿›ç¨‹åä¸ºï¼šdblaunché«˜è´Ÿè½½ï¼Œå æ»¡cpuã€‚æ²¡å¤šæƒ³ï¼Œè”ç³»è…¾è®¯äº‘å¤„ç†ï¼Œæœ€åç»™å‡ºçš„å»ºè®®ï¼šåšå¥½å¿«ç…§ï¼Œé‡å¯æœºå™¨ã€‚è…¾è®¯å¸®å¿™æ³¨é‡Šæ‰äº†å¯åŠ¨è„šæœ¬ä¸­lamppä¸­mysqlçš„binç¯å¢ƒå˜é‡ï¼Œç°åœ¨æ¥çœ‹ï¼Œè¿™ä¸ªæ“ä½œæ²¡ä»»åŠ¡ä½œç”¨ã€‚é‡å¯å®Œåæœºå™¨æ¢å¤æ­£å¸¸ï¼Œä¹Ÿå°±æ²¡å†è¿›ä¸€æ­¥è¿½è¸ªã€‚</p>
<p><a href="https://i1.wp.com/192.144.167.243/blog/wp-content/uploads/1-3.png?resize=640,111" title="äº‘æœåŠ¡å™¨è¢«æŒ–çŸ¿ç—…æ¯’æ„ŸæŸ“ï¼ - ç¬¬1å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i1.wp.com/192.144.167.243/blog/wp-content/uploads/1-3.png?resize=640,111" alt="äº‘æœåŠ¡å™¨è¢«æŒ–çŸ¿ç—…æ¯’æ„ŸæŸ“ï¼ - ç¬¬1å¼   | å¼ å˜"></a></p>
<p>äºŒã€3æœˆ15å·ï¼Œå…¬å¸ä¸‹å‘¨å»ç¾å›½ï¼Œéœ€è¦æ­å»ºå¯¹å¤–æœåŠ¡å™¨åœ¨ç¾å›½ç™»é™†ï¼Œå°±éƒ¨ç½²åˆ°æˆ‘çš„è…¾è®¯äº‘æœåŠ¡å™¨ï¼Œç”±äºæˆ‘æ˜å¤©å»æ—¥æœ¬çš„é£æœºï¼Œèµ¶å¿™æ™šä¸Šéƒ¨ç½²æœåŠ¡å™¨å®Œæ¯•ï¼Œæµ‹è¯•æ— æ™ï¼Œä¸€åˆ‡æ­£å¸¸ã€‚</p>
<p>ä¸‰ã€3æœˆ16å·ï¼Œåœ¨æ—¥æœ¬å‡Œæ™¨3ç‚¹é’Ÿï¼Œ åŒäº‹ååº”æ¸¸æˆæœåŠ¡å™¨è¿ä¸ä¸Šï¼Œç™»é™†sshåå°å‘ç°æ ¹æœ¬è¿ä¸ä¸Šï¼Œ å†æ¬¡è”ç³»è…¾è®¯äº‘ï¼Œæœ€åè¿˜æ˜¯å¼ºåˆ¶é‡å¯è§£å†³ï¼Œå™©æ¢¦å¼€å§‹ï¼Œç”±äºäººåœ¨æ—¥æœ¬ï¼Œåªèƒ½é€šè¿‡æ‰‹æœºæ“ä½œï¼Œæ²¡æœ‰åˆ«çš„åŠæ³•ï¼Œåªèƒ½æ¯å¤©æ—©ä¸Šèµ·åºŠåç¬¬ä¸€ä»¶äº‹å°±æ˜¯é‡å¯æœºå™¨ï¼Œä»¥ä¿éšœç¾å›½æ–¹èƒ½æ­£å¸¸å±•ç¤ºæ¸¸æˆã€‚</p>
<p><a href="https://i0.wp.com/192.144.167.243/blog/wp-content/uploads/2-2.png?resize=640,436" title="äº‘æœåŠ¡å™¨è¢«æŒ–çŸ¿ç—…æ¯’æ„ŸæŸ“ï¼ - ç¬¬2å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/192.144.167.243/blog/wp-content/uploads/2-2.png?resize=640,436" alt="äº‘æœåŠ¡å™¨è¢«æŒ–çŸ¿ç—…æ¯’æ„ŸæŸ“ï¼ - ç¬¬2å¼   | å¼ å˜"></a></p>
<p>å››ã€å›å›½åå¼€å§‹æ’æŸ¥é—®é¢˜ï¼Œå‘ç°è¿›ç¨‹sustseè·‘æ»¡cpuï¼Œç½‘ä¸ŠæŸ¥çœ‹åæ‰çŸ¥é“æ˜¯è¢«æŒ–çŸ¿ç—…æ¯’æ„ŸæŸ“ï¼Œç¬¬ä¸€æ¬¡æœåŠ¡å™¨è¢«ç—…æ¯’æ„ŸæŸ“çš„ç»å†ã€‚éšåå¼€å§‹äº†å„ç§å°è¯•ï¼Œè¯•å›¾åˆ å°½ç—…æ¯’ï¼Œç—…æ¯’çš„urlgetåœ°å€ä¸ºï¼š<a href="http://107.174.47.156/mr.sh%E3%80%82%E5%9C%A8%E7%BB%8F%E8%BF%87%E4%BA%86%E5%90%84%E7%A7%8D%E5%AF%B9%E6%96%87%E4%BB%B6%E5%A4%B9%E5%8A%A0%E6%9D%83%E9%99%90%EF%BC%8C%E5%88%A0%E9%99%A4%E7%97%85%E6%AF%92%E6%96%87%E4%BB%B6%E5%8F%8A%E5%90%84%E7%A7%8D%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E5%90%8E%EF%BC%8C%E6%9C%80%E5%90%8E%E5%8F%91%E7%8E%B0%E8%BF%98%E6%98%AF%E5%BE%92%E5%8A%B3%EF%BC%8C%E4%B8%8D%E7%9F%A5%E9%81%93%E4%BB%8E%E4%BB%80%E4%B9%88%E5%9C%B0%E6%96%B9%E7%97%85%E6%AF%92%E8%BF%98%E6%98%AF%E5%86%8D%E6%AC%A1%E5%87%BA%E7%8E%B0%EF%BC%8C%E8%85%BE%E8%AE%AF%E5%AE%98%E6%96%B9%E7%BB%99%E5%87%BA%E7%9A%84%E5%BB%BA%E8%AE%AE%E4%B9%9F%E6%98%AF%E9%87%8D%E8%A3%85%E7%B3%BB%E7%BB%9F%EF%BC%8C%E5%9B%A0%E4%B8%BA%E4%BD%A0%E6%B0%B8%E8%BF%9C%E4%B9%9F%E4%BF%9D%E8%AF%81%E4%B8%8D%E4%BA%86%E7%97%85%E6%AF%92%E8%A2%AB%E5%88%A0%E9%99%A4%E5%B9%B2%E5%87%80%EF%BC%8C%E5%9C%A8%E8%BF%99%E6%A0%B7%E7%9A%84%E6%9C%BA%E5%99%A8%E4%B8%8A%E7%BB%A7%E7%BB%AD%E4%BD%BF%E7%94%A8%E7%9A%84%E8%AF%9D%EF%BC%8C%E8%87%AA%E5%B7%B1%E7%9A%84%E5%86%85%E5%AE%B9%E8%B6%8A%E5%A4%9A%EF%BC%8C%E6%96%87%E4%BB%B6%E4%B8%A2%E5%A4%B1%E7%9A%84%E6%88%90%E6%9C%AC%E5%92%8C%E9%A3%8E%E9%99%A9%E8%B6%8A%E5%A4%A7%EF%BC%8C%E6%9C%80%E5%90%8E%E5%8F%AA%E8%83%BD%E9%87%8D%E8%A3%85%E7%B3%BB%E7%BB%9F%EF%BC%8C%E9%87%8D%E6%96%B0%E9%83%A8%E7%BD%B2%E7%8E%AF%E5%A2%83%E3%80%82">http://107.174.47.156/mr.shã€‚åœ¨ç»è¿‡äº†å„ç§å¯¹æ–‡ä»¶å¤¹åŠ æƒé™ï¼Œåˆ é™¤ç—…æ¯’æ–‡ä»¶åŠå„ç§å®šæ—¶ä»»åŠ¡åï¼Œæœ€åå‘ç°è¿˜æ˜¯å¾’åŠ³ï¼Œä¸çŸ¥é“ä»ä»€ä¹ˆåœ°æ–¹ç—…æ¯’è¿˜æ˜¯å†æ¬¡å‡ºç°ï¼Œè…¾è®¯å®˜æ–¹ç»™å‡ºçš„å»ºè®®ä¹Ÿæ˜¯é‡è£…ç³»ç»Ÿï¼Œå› ä¸ºä½ æ°¸è¿œä¹Ÿä¿è¯ä¸äº†ç—…æ¯’è¢«åˆ é™¤å¹²å‡€ï¼Œåœ¨è¿™æ ·çš„æœºå™¨ä¸Šç»§ç»­ä½¿ç”¨çš„è¯ï¼Œè‡ªå·±çš„å†…å®¹è¶Šå¤šï¼Œæ–‡ä»¶ä¸¢å¤±çš„æˆæœ¬å’Œé£é™©è¶Šå¤§ï¼Œæœ€ååªèƒ½é‡è£…ç³»ç»Ÿï¼Œé‡æ–°éƒ¨ç½²ç¯å¢ƒã€‚</a></p>
<p>äº”ã€ç»æ­¤ä¸€å½¹å’ŒæŒ–çŸ¿ç—…æ¯’çš„æ–—äº‰ï¼Œæˆ–è€…è¯´è¢«è™ä¹Ÿå¥½ï¼Œæ•™è®­å°±æ˜¯ï¼Œåšå¥½æœåŠ¡å™¨çš„å¿«ç…§å¤‡ä»½ï¼Œæ•°æ®æ— ä»·ï¼Œä¸‡ä¸€çœŸçš„ä¸¢å¤±äº†æ¢å¤ä¸äº†ï¼Œé‚£æ˜¯çœŸå´©äº†ã€‚è¿˜å¥½è¿™æ¬¡æ²¡ä»€ä¹ˆé‡å¤§æŸå¤±ã€‚</p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ç½‘ç«™</tag>
      </tags>
  </entry>
  <entry>
    <title>Debugging Go compiler performance in a large codebase[zz]</title>
    <url>/debug-go-compiler/</url>
    <content><![CDATA[<div class=".article-gallery"><p>zz: <a href="https://incident.io/blog/go-build-faster">https://incident.io/blog/go-build-faster</a></p>
<p>As <a href="https://incident.io/blog/monolith">weâ€™ve talked about before</a>, our app is a monolith: all our backend code lives together and gets compiled into a single binary. One of the reasons I prefer monolithic architectures is that they make it much easier to focus on shipping features without having to spend much time thinking about where code should live and how to get all the data you need together quickly.</p>
<p>However, Iâ€™m not going to claim there arenâ€™t disadvantages too. One of those is compile times. Because all the backend code needs to be built into a single artefact, the time it takes to do that inevitably increases as the amount of code to compile grows.</p>
<p>Thatâ€™s bad for shipping quickly: a slower build means it takes longer to get code from â€œpull request mergedâ€ to â€œrunning for customersâ€. Itâ€™s also bad for developer experience: time spent waiting for the compiler isnâ€™t productive time, and it can really break your flow.</p>
<p>While <a href="https://incident.io/blog/festive-macbooks">faster MacBooks can make a big difference</a>, we can also apply some performance-optimising tools that come with Golang to figure out where the bottlenecks are and remove them!</p>
<h2 id="Visualising-the-build-process"><a href="#Visualising-the-build-process" class="headerlink" title="Visualising the build process"></a>Visualising the build process</h2><p>The first thing to note is that the Go compiler caches previously-compiled code, so to get a clearer picture of the <em>worst case</em> scenario, I cleared that cache before each run, using <code>go cache -clean</code>.</p>
<p>Looking at the docs, there are a few interesting-looking flags you can pass to <code>go build</code>:</p>
<ul>
<li><code>-debug-actiongraph</code> - this tells you what the compiler is doing at different points, and can be inspected with <a href="https://github.com/icio/actiongraph">https://github.com/icio/actiongraph</a>.</li>
<li><code>-debug-trace</code> - this produces a trace, which can be visualised in a tool like <a href="https://ui.perfetto.dev/#!/viewer">Perfetto</a></li>
</ul>
<p>I found the trace view felt more familiar: at <a href="http://incident.io/">incident.io</a> we debug things by reading traces <em>all the time</em>, and the Perfetto UI is really familiar if youâ€™ve had to optimise JavaScript performance with the Chrome DevTools before.</p>
<p>So, with a clean cache, I ran <code>go build ./cmd/app/ -debug-trace=tmp/trace.json</code>, and dropped that into Perfetto:</p>
<p><a href="https://incident.io/_next/image?url=https://cdn.sanity.io/images/oqy5aexb/production/b145104608fe8490391ffc0a4047167e34a12e45-2648x1516.png?q=75&fit=clip&auto=format&w=3840&q=75" title="img" class="gallery-item" style="box-shadow: none;"> <img src="https://incident.io/_next/image?url=https://cdn.sanity.io/images/oqy5aexb/production/b145104608fe8490391ffc0a4047167e34a12e45-2648x1516.png?q=75&fit=clip&auto=format&w=3840&q=75" alt="img"></a></p>
<p>Well, that is pretty, but what does it tell us? Broadly thereâ€™s three phases:</p>
<ol>
<li>Planning: up at the top-left, thereâ€™s a bunch of short spans which are the compiler figuring out which packages import which other packages, and planning out the build. This is pretty quick!</li>
<li>Next thereâ€™s a <em>really dense</em> set of spans: this is almost entirely compiling external dependencies. This uses all 8 cores and isnâ€™t all that interesting to us: these packages donâ€™t change much and therefore the build cache should be very effective at avoiding recompiling them.</li>
<li>At about 25s in, we finally start compiling our own code. This code has a lot more dependencies between packages, which creates those gaps where every package waiting to be compiled imports something that is currently being compiled, and so has to wait.</li>
</ol>
<p>At this point, thereâ€™s only really one path to making this faster: eliminating as much of the empty space in the trace where thereâ€™s only one or two cores doing any work.</p>
<p>The first thing to tackle is the turquoise span Iâ€™ve circled. Thatâ€™s a package called <code>./pkg/domain</code>, which defines a struct for each table in our database. Things like:</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Incident</span> struct &#123;</span><br><span class="line">  <span class="variable constant_">ID</span> <span class="built_in">string</span></span><br><span class="line">  <span class="title class_">Name</span> <span class="built_in">string</span></span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>It makes sense that a <em>lot</em> of our code will import that package: if youâ€™re using the database, you need to! It also makes sense that itâ€™s a relatively big package, since we have around 250 tables. Once you add in the <a href="https://incident.io/blog/code-generation#builders">builders we generate</a>, that gets up to around 800 files, containing almost 100k lines of code.</p>
<p>To speed things up there were two strategies I tried:</p>
<h2 id="Start-sooner-finish-sooner"><a href="#Start-sooner-finish-sooner" class="headerlink" title="Start sooner, finish sooner"></a>Start sooner, finish sooner</h2><p>The first option I tried at this point was removing dependencies from <code>pkg/domain</code>, so the compiler could get started on building it sooner.</p>
<p>We were already using a great little linter called <code>depguard</code> to set rules that help us avoid import cycles. I started off setting an ultra-strict rule, saying <code>pkg/domain</code> cannot import anything except the standard library:</p>
<p><a href="https://incident.io/_next/image?url=https://cdn.sanity.io/images/oqy5aexb/production/58a6bc56a12beb19c09887c55f07455e3fe744df-1594x1074.png?q=75&fit=clip&auto=format&w=3840&q=75" title="img" class="gallery-item" style="box-shadow: none;"> <img src="https://incident.io/_next/image?url=https://cdn.sanity.io/images/oqy5aexb/production/58a6bc56a12beb19c09887c55f07455e3fe744df-1594x1074.png?q=75&fit=clip&auto=format&w=3840&q=75" alt="img"></a></p>
<p>This produced a <em>long</em> list of violations! Working through those one-by-one let me check each of the packages we were importing and either add them to the <code>allow</code> list, or figure out how to break that dependency.</p>
<p>After breaking each dependency I cleared the cache and did a fresh build to see if the trace had really changed much. The biggest improvement was removing the dependency on <a href="https://github.com/yuin/goldmark">yuin/goldmark</a>, a markdown parsing library, which allowed these two large packages to be compiled in parallel, and got <code>pkg/domain</code> started at around 15s in, rather than 25s!</p>
<p><a href="https://incident.io/_next/image?url=https://cdn.sanity.io/images/oqy5aexb/production/4063c53eff31d8458b730265277e711dada2d686-2656x1462.png?q=75&fit=clip&auto=format&w=3840&q=75" title="img" class="gallery-item" style="box-shadow: none;"> <img src="https://incident.io/_next/image?url=https://cdn.sanity.io/images/oqy5aexb/production/4063c53eff31d8458b730265277e711dada2d686-2656x1462.png?q=75&fit=clip&auto=format&w=3840&q=75" alt="img"></a></p>
<h2 id="Break-it-up"><a href="#Break-it-up" class="headerlink" title="Break it up"></a>Break it up</h2><p>That helped a lot with the worst case compile without anything cached. Luckily, thatâ€™s not all that common: a more frequent situation is that someone has changed a file inside <code>pkg/domain</code>. In that case, the compiler will recompile that package <em>plus anything that imports it</em>, which here means pretty much the whole app! A trace of that looks something like this:</p>
<p><a href="https://incident.io/_next/image?url=https://cdn.sanity.io/images/oqy5aexb/production/978bb9ee4a6228f6329ea7fe5b1bd27bf61970c8-3600x542.png?q=75&fit=clip&auto=format&w=3840&q=75" title="img" class="gallery-item" style="box-shadow: none;"> <img src="https://incident.io/_next/image?url=https://cdn.sanity.io/images/oqy5aexb/production/978bb9ee4a6228f6329ea7fe5b1bd27bf61970c8-3600x542.png?q=75&fit=clip&auto=format&w=3840&q=75" alt="img"></a></p>
<p>Look at all those sad, bored CPUs not doing anything while weâ€™re building <code>pkg/domain</code>!</p>
<p>The only solution here is to make this package smaller. At first that seemed like a pretty complex task: there are lots of bidirectional relationships between different structs in this code for good reason! For example, we have code like this:</p>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// in incident.go</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Incident</span> struct &#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="title class_">IncidentUpdates</span> []*<span class="title class_">IncidentUpdate</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// in incident_update.go</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">IncidentUpdate</span> struct &#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="title class_">Incident</span> *<span class="title class_">Incident</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This lets us write code that loads both an incident with all its updates, or an update with the incident it belongs to. Splitting these across two packages creates an import cycle.</p>
<p>Thatâ€™s just one example - splitting this package up seemed like a recipe for nasty import cycles and unhappy engineers.</p>
<p>Luckily, there was another axis to split this code along: app code vs test code. We <a href="https://incident.io/blog/code-generation#matchers">generate type-safe <code>gomega</code> matchers</a> for each of these domain types, to make writing tests like this really simple:</p>
<p><a href="https://incident.io/_next/image?url=https://cdn.sanity.io/images/oqy5aexb/production/ae6d4d76526bacf5a0f1b698937d547b279c42a4-1102x578.png?q=75&fit=clip&auto=format&w=3840&q=75" title="img" class="gallery-item" style="box-shadow: none;"> <img src="https://incident.io/_next/image?url=https://cdn.sanity.io/images/oqy5aexb/production/ae6d4d76526bacf5a0f1b698937d547b279c42a4-1102x578.png?q=75&fit=clip&auto=format&w=3840&q=75" alt="img"></a></p>
<p>Thatâ€™s a big chunk of code that could live in a separate package, that will only be imported by tests. Moving those out into <code>pkg/domain/matchers</code> reduced the time to compile <code>pkg/domain</code> by about 30%, which adds up pretty quickly when that package get rebuilt 10-20 times a day across the team.</p>
<p>That same example now looks like this:</p>
<p><a href="https://incident.io/_next/image?url=https://cdn.sanity.io/images/oqy5aexb/production/be4a5b2c81b238dda65376921db0ef02b58e8257-1120x578.png?q=75&fit=clip&auto=format&w=3840&q=75" title="img" class="gallery-item" style="box-shadow: none;"> <img src="https://incident.io/_next/image?url=https://cdn.sanity.io/images/oqy5aexb/production/be4a5b2c81b238dda65376921db0ef02b58e8257-1120x578.png?q=75&fit=clip&auto=format&w=3840&q=75" alt="img"></a></p>
<h2 id="What-did-I-learn"><a href="#What-did-I-learn" class="headerlink" title="What did I learn?"></a>What did I learn?</h2><p>Developer tools like compilers can feel strange and scary if (like me) youâ€™ve never really taken a look at what theyâ€™re doing. When you find something annoying about them, like a slow build or a dodgy error message itâ€™s all <em>just more code</em> that you can use your normal skills and tools to work on.</p>
<p>Your teammates will appreciate it ğŸ«¶</p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>go</tag>
      </tags>
  </entry>
  <entry>
    <title>Debugging Remotely with Go in Kubernetes[zz]</title>
    <url>/debug-remote-go-k8s/</url>
    <content><![CDATA[<div class=".article-gallery"><p>zz: <a href="https://alexsniffin.medium.com/debugging-remotely-in-kubernetes-with-go-fda4f3332316">https://alexsniffin.medium.com/debugging-remotely-in-kubernetes-with-go-fda4f3332316</a></p>
<p>Proper testing can be difficult and even seem impossible. Following best practices to test your code is a good start, but youâ€™re still going to run into edge cases where things arenâ€™t as expected. One challenge in particular, is being able to accurately simulate your deployments remote environment.</p>
<p>Figuring out the inconsistencies to why your program works on your local machine but not on another machine can be painstakingly frustrating. Maybe itâ€™s the version of your compiler, your operating system, configuration, or certain dependencies that were missedâ€” etcetera-etcetera.</p>
<p>This has been a common problem with software development and why the rise of <a href="https://www.ibm.com/topics/containerization">virtualization and containerization have become so popular, especially in cloud-based applications</a>. Even so, things can still go wrong with your VMâ€™s and containers.</p>
<p>Letâ€™s take a look into how debugging your applicationâ€™s runtime in itâ€™s deployed environment can help you quickly find the root cause to what isnâ€™t working as expected. For this example weâ€™ll use Go to write the application and deploy it to Kubernetes in a Docker container.</p>
<h1 id="Example-Code"><a href="#Example-Code" class="headerlink" title="Example Code"></a>Example Code</h1><p>Lets create a simple API that can calculate a value in the Fibonacci sequence that we want to be able to debug. Iâ€™ll be using <a href="https://github.com/go-chi/chi">Chi</a> as the router and then use the <a href="https://pkg.go.dev/net/http@go1.19.3">stdlib</a> to run the server. Iâ€™ve tried to keep the example simple, you can checkout the <a href="https://github.com/alexsniffin/go-blog3-example">repo</a> to see all of the code.</p>
<p>Letâ€™s first create a handler that takes a query parameter of n and calls the Fibonacci function.</p>
<iframe src="https://alexsniffin.medium.com/media/ab6e886ad4073a10f0ee293e70940f46" allowfullscreen="" frameborder="0" height="307" width="680" title="Blog3Example1_1.go" class="fp n gf dv bg" scrolling="no" style="box-sizing: inherit; top: 0px; width: 680px; height: 307px; position: absolute; left: 0px;"></iframe>

<p>Then for the Fibonacci function, I wrote the <a href="https://www.geeksforgeeks.org/what-is-memoization-a-complete-tutorial/">memoized</a> implementation.</p>
<iframe src="https://alexsniffin.medium.com/media/8a2375ee5e2710f323efc71d9763427b" allowfullscreen="" frameborder="0" height="329" width="680" title="Blog3Example1_1.go" class="fp n gf dv bg" scrolling="no" style="box-sizing: inherit; top: 0px; width: 680px; height: 329px; position: absolute; left: 0px;"></iframe>

<h1 id="Remote-Debugging"><a href="#Remote-Debugging" class="headerlink" title="Remote Debugging"></a>Remote Debugging</h1><p>To debug the container weâ€™ll need to set up remote debugging, to do this, we can use the popular Go debugger <a href="https://github.com/derekparker/delve">Delve</a>. Delve supports attaching to a process and will allow us to introspect our application in the runtime. To debug, Delve is supported in a few IDEâ€™s and editors including <a href="https://blog.jetbrains.com/go/2019/02/06/debugging-with-goland-getting-started/">GoLand</a> and <a href="https://code.visualstudio.com/docs/languages/go#_debugging">VS Code</a>. For this example Iâ€™ll be using GoLand.</p>
<p>Weâ€™ll need a Dockerfile which has the Delve binary in it which weâ€™ll be able to remotely execute the application binary. The command Iâ€™ll be using is:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dlv --listen=:40000 --headless=true --api-version=2 --log exec ./example</span><br></pre></td></tr></table></figure>

<p>Where the listening port is 40,000 and it points to the example binary. The complete Dockerfile downloads Delve, builds the app, and starts the Delve process.</p>
<iframe src="https://alexsniffin.medium.com/media/55081a02d05948e449d3bc87c0d1541c" allowfullscreen="" frameborder="0" height="637" width="680" title="Blog3Example1_3.debug.Dockerfile" class="fp n gf dv bg" scrolling="no" style="box-sizing: inherit; top: 0px; width: 680px; height: 637px; position: absolute; left: 0px;"></iframe>

<p>When running the container, we want to make sure we set the binded ports to map with what weâ€™re using for the example app and Delve. The following build and run commands will work for this example.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker build -t go-blog3-example -f .\debug.Dockerfile .</span><br><span class="line">docker run -p 8080:8080 -p 40000:40000 --name example go-blog3-example:latest</span><br></pre></td></tr></table></figure>

<p>Similarly, we can use the interface in GoLand to do this too.</p>
<p><a href="https://miro.medium.com/v2/resize:fit:700/1*LRql3LDD2wVDg1jgLz3V_g.png" title="docker in goland" class="gallery-item" style="box-shadow: none;"> <img src="https://miro.medium.com/v2/resize:fit:700/1*LRql3LDD2wVDg1jgLz3V_g.png" alt="docker in goland"></a></p>
<p>Now for the fun part, lets remotely connect! In GoLand we can do this by creating a new Run configuration with the Go Remote option.</p>
<p><a href="https://miro.medium.com/v2/resize:fit:211/1*ElWmHRQ1vlOoZ_IVnUDi_Q.png" title="run configuration for go remote" class="gallery-item" style="box-shadow: none;"> <img src="https://miro.medium.com/v2/resize:fit:211/1*ElWmHRQ1vlOoZ_IVnUDi_Q.png" alt="run configuration for go remote"></a></p>
<p>Then using the following settings.</p>
<p><a href="https://miro.medium.com/v2/resize:fit:700/1*_xrt7a_nDH0kZQ3bfahoeQ.png" title="go remote settings" class="gallery-item" style="box-shadow: none;"> <img src="https://miro.medium.com/v2/resize:fit:700/1*_xrt7a_nDH0kZQ3bfahoeQ.png" alt="go remote settings"></a></p>
<p>With the container running, we should be able to remotely start the debugging session.</p>
<p><a href="https://miro.medium.com/v2/resize:fit:588/1*BV7-2OOWvPpwgN8i55LYyA.png" title="debug window" class="gallery-item" style="box-shadow: none;"> <img src="https://miro.medium.com/v2/resize:fit:588/1*BV7-2OOWvPpwgN8i55LYyA.png" alt="debug window"></a></p>
<p>Awesome! Thatâ€™s it but now lets see how we can utilize this through Kubernetes with a pod to debug the container in the same environment that it normally runs in.</p>
<h1 id="Debugging-the-Pod"><a href="#Debugging-the-Pod" class="headerlink" title="Debugging the Pod"></a>Debugging the Pod</h1><p>Lets say we currently already have the container running normally as a Deployment and itâ€™s currently receiving traffic. Weâ€™ve noticed that thereâ€™s odd behavior happening and we canâ€™t accurately replicate whatâ€™s happening locally. For this, weâ€™ll want to stand up a new pod along side our current deployment and start debugging.</p>
<p>To do this, we can add the new container as a standalone pod from the normal deployment. If you have additional resources that youâ€™ll need, youâ€™ll want to be sure to include them too. You can do that with kubectl apply, your Kubernetes package manager or CD tool.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt; kubectl run example --image=asniffin/go-blog3-example:latest --namespace=blog</span><br><span class="line">pod/example created</span><br></pre></td></tr></table></figure>

<p>We should be able to check the state of the pod and see itâ€™s running.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt; kubectl describe pod example --namespace=blog</span><br><span class="line">...</span><br><span class="line">Conditions:</span><br><span class="line">  Type              Status</span><br><span class="line">  Initialized       True</span><br><span class="line">  Ready             True</span><br><span class="line">  ContainersReady   True</span><br><span class="line">  PodScheduled      True</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>Then checking the logs, we can see that itâ€™s listening for a connection.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt; kubectl logs example --namespace=blog</span><br><span class="line">API server listening at: [::]:40000</span><br><span class="line">2022-11-23T18:37:00Z warning layer=rpc Listening for remote connections (connections are not authenticated nor encrypted)</span><br><span class="line">2022-11-23T18:37:00Z info layer=debugger launching process with args: [./example]</span><br></pre></td></tr></table></figure>

<p>Now to debug from our local machine, we need to tunnel to the pod with the correct ports and protocol. To do this, we can use the port-forward kubectl command provided our pod and ports.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt; kubectl port-forward pods/example 8080:8080 40000:40000 --namespace=blog</span><br><span class="line">Forwarding from 127.0.0.1:8080 -&gt; 8080</span><br><span class="line">Forwarding from [::1]:8080 -&gt; 8080</span><br><span class="line">Forwarding from 127.0.0.1:40000 -&gt; 40000</span><br><span class="line">Forwarding from [::1]:40000 -&gt; 40000</span><br></pre></td></tr></table></figure>

<p>Now when running the remote debugger we should be able to connect and start debugging! Letâ€™s try with sending a request to the fib endpoint.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt; curl http://localhost:8080/fib?n=10</span><br><span class="line">55</span><br></pre></td></tr></table></figure>

<p><a href="https://miro.medium.com/v2/resize:fit:621/1*YngWz7M0Y419StR8H2G9nQ.png" title="debug window from kubernetes" class="gallery-item" style="box-shadow: none;"> <img src="https://miro.medium.com/v2/resize:fit:621/1*YngWz7M0Y419StR8H2G9nQ.png" alt="debug window from kubernetes"></a></p>
<p>Nice ğŸ˜! We can see that weâ€™re able to both debug and send requests to the pod. With this, we can accurately debug the container and pod in the same environment where itâ€™s deployed and with all of itâ€™s remote resources. Remember to remove your pod when youâ€™ve finished!</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt; kubectl delete pod example --namespace=blog</span><br><span class="line">pod &quot;example&quot; deleted</span><br></pre></td></tr></table></figure>

<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>Debugging is an effective tool that every developer should keep on their tool belt. When itâ€™s difficult to simulate your applications environment, being able to accurately pinpoint the root cause to a problem can prove to be difficult. Remotely debugging your application lets you quickly introspect the runtime and observe the behavior of your application.</p>
<p>Thanks for reading!</p>
<p><em>Disclaimer: Doing this in production should be done with caution, probably best left in a development or QA environment!</em></p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>go</tag>
      </tags>
  </entry>
  <entry>
    <title>è®¾è®¡æ¨¡å¼ç¬”è®°</title>
    <url>/design-mode/</url>
    <content><![CDATA[<div class=".article-gallery"><p>1.ç®€å•å·¥å‚æ¨¡å¼</p>
<p>2.ç­–ç•¥æ¨¡å¼</p>
<span id="more"></span>

<p>ç­–ç•¥æ¨¡å¼æ˜¯ä¸€ç§å®šä¹‰ä¸€ç³»åˆ—ç®—æ³•çš„æ–¹æ³•ï¼Œä»æ¦‚å¿µä¸Šæ¥çœ‹ï¼Œæ‰€æœ‰è¿™äº›ç®—æ³•å®Œæˆçš„éƒ½æ˜¯ç›¸åŒçš„å·¥ä½œï¼Œåªæ˜¯å®ç°ä¸åŒï¼Œå®ƒå¯ä»¥ä»¥ç›¸åŒçš„æ–¹å¼è°ƒç”¨æ‰€æœ‰çš„ç®—æ³•ï¼Œå‡å°‘äº†å„ç§ç®—æ³•ç±»ä¸ä½¿ç”¨ç®—æ³•ç±»ä¹‹é—´çš„è€¦åˆã€‚</p>
<p>ç­–ç•¥æ¨¡å¼çš„Strategyç±»å±‚æ¬¡ä¸ºContextå®šä¹‰äº†ä¸€ç³»åˆ—çš„å¯ä¾›é‡ç”¨çš„ç®—æ³•æˆ–è¡Œä¸ºã€‚ç»§æ‰¿æœ‰åŠ©äºæå–å‡ºè¿™äº›ç®—æ³•ä¸­çš„å…¬å…±åŠŸèƒ½ã€‚</p>
<p>3.å•ä¸€èŒè´£åŸåˆ™</p>
<p>è§„åˆ™æ€»æ˜¯å¾ˆç¾å¥½ï¼Œå‘µå‘µ</p>
<p>å°±ä¸€ä¸ªç±»è€Œè¨€ï¼Œåº”è¯¥ä»…æœ‰ä¸€ä¸ªå¼•èµ·å®ƒå˜åŒ–çš„åŸå› ã€‚</p>
<p>å¦‚æœä¸€ä¸ªç±»æ‰¿æ‹…çš„èŒè´£è¿‡å¤šï¼Œå°±ç­‰äºæŠŠè¿™äº›èŒè´£è€¦åˆåœ¨ä¸€èµ·ï¼Œä¸€ä¸ªèŒè´£çš„å˜åŒ–å¯èƒ½ä¼šå‰Šå¼±æˆ–è€…æŠ‘åˆ¶è¿™ä¸ªç±»å®Œæˆå…¶ä»–èŒè´£çš„èƒ½åŠ›ã€‚è¿™ç§è€¦åˆä¼šå¯¼è‡´è„†å¼±çš„è®¾è®¡ï¼Œå½“å˜åŒ–å‘ç”Ÿæ—¶ï¼Œè®¾è®¡ä¼šé­å—åˆ°æ„æƒ³ä¸åˆ°çš„ç ´åã€‚</p>
<p>è½¯ä»¶è®¾è®¡çœŸæ­£è¦åšçš„è®¸å¤šå†…å®¹ï¼Œå°±æ˜¯å‘ç°èŒè´£å¹¶æŠŠé‚£äº›èŒè´£ç›¸äº’åˆ†ç¦»ã€‚</p>
<p>å¦‚æœä½ èƒ½å¤Ÿæƒ³åˆ°å¤šäºä¸€ä¸ªçš„åŠ¨æœºå»æ”¹å˜ä¸€ä¸ªç±»ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»å°±å…·æœ‰å¤šäºä¸€ä¸ªçš„èŒè´£ã€‚</p>
<p>4.å¼€æ”¾-å°é—­åŸåˆ™</p>
<p>å¼€æ”¾-å°é—­åŸåˆ™ï¼Œæ˜¯è¯´è½¯ä»¶å®ä½“ï¼ˆç±»ã€æ¨¡å—ã€å‡½æ•°ç­‰ç­‰ï¼‰åº”è¯¥å¯ä»¥æ‰©å±•ï¼Œä½†æ˜¯ä¸å¯ä¿®æ”¹ã€‚</p>
<p>å¯¹äºæ‰©å±•æ˜¯å¼€æ”¾çš„ï¼Œå¯¹äºæ›´æ”¹æ˜¯å°é—­çš„ã€‚</p>
<p>æ— è®ºæ¨¡å—æ˜¯å¤šä¹ˆå°é—­ï¼Œéƒ½ä¼šå­˜åœ¨ä¸€äº›æ— æ³•å¯¹ä¹‹å°é—­çš„å˜åŒ–ã€‚æ—¢ç„¶ä¸å¯èƒ½å®Œå…¨å°é—­ï¼Œè®¾è®¡äººå‘˜å¿…é¡»å¯¹äºä»–è®¾è®¡çš„æ¨¡å—åº”è¯¥å¯¹å“ªç§å˜åŒ–å°é—­åšå‡ºé€‰æ‹©ã€‚ä»–å¿…é¡»å…ˆçŒœæµ‹å‡ºæœ€æœ‰å¯èƒ½å‘ç”Ÿçš„å˜åŒ–ç§ç±»ï¼Œç„¶åæ„é€ æŠ½è±¡æ¥éš”ç¦»é‚£äº›å˜åŒ–ã€‚</p>
<p>ç­‰åˆ°å˜åŒ–å‘ç”Ÿæ—¶ç«‹å³é‡‡å–è¡ŒåŠ¨ã€‚</p>
<p>å¼€å‘äººå‘˜åº”è¯¥ä»…å¯¹ç¨‹åºä¸­å‘ˆç°å‡ºé¢‘ç¹å˜åŒ–çš„é‚£äº›éƒ¨åˆ†åšå‡ºæŠ½è±¡ï¼Œç„¶è€Œï¼Œå¯¹äºåº”ç”¨ç¨‹åºä¸­çš„æ¯ä¸ªéƒ¨åˆ†åˆ»æ„è¿›è¡ŒæŠ½è±¡åŒæ ·ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚æ‹’ç»ä¸æˆç†Ÿçš„æŠ½è±¡å’ŒæŠ½è±¡æœ¬èº«ä¸€æ ·é‡è¦ã€‚</p>
<p>5.ä¾èµ–å€’è½¬åŸåˆ™</p>
<p>é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½å±‚æ¨¡å—ï¼Œä¸¤ä¸ªéƒ½åº”è¯¥ä¾èµ–æŠ½è±¡ã€‚</p>
<p>æŠ½è±¡ä¸åº”è¯¥ä¾èµ–ç»†èŠ‚ï¼Œç»†èŠ‚åº”è¯¥ä¾èµ–æŠ½è±¡ã€‚</p>
<p>é‡Œæ°ä»£æ¢åŸåˆ™ï¼šå­ç±»å‹å¿…é¡»èƒ½å¤Ÿæ›¿æ¢æ‰å®ƒä»¬çš„çˆ¶ç±»å‹ã€‚</p>
<p>6.è£…é¥°æ¨¡å¼</p>
<p>è£…é¥°æ¨¡å¼ï¼šåŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ï¼Œå°±å¢åŠ åŠŸèƒ½æ¥è¯´ï¼Œè£…é¥°æ¨¡å¼æ¯”ç”Ÿæˆå­ç±»æ›´ä¸ºçµæ´»ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Personç©¿è¡£æœä¸ºä¾‹ï¼š</span><br><span class="line">abstract class Show &#123;</span><br><span class="line"></span><br><span class="line">public abstract void show();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Persion : Show &#123;</span><br><span class="line"></span><br><span class="line">public override void show() &#123; å…·ä½“å®ç° &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">abstract class Decorator : Show &#123;</span><br><span class="line"></span><br><span class="line">protected Show show;</span><br><span class="line"></span><br><span class="line">public void setDecorator(Show show) &#123;</span><br><span class="line"></span><br><span class="line">this.show = show;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public override void show() &#123;</span><br><span class="line"></span><br><span class="line">if (show != null) &#123;</span><br><span class="line"></span><br><span class="line">show.show();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class DecoratorA : Decorator &#123;</span><br><span class="line"></span><br><span class="line">public override void show() &#123; super.show(); å…·ä½“å®ç°; &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">è£…é¥°æ¨¡å¼ï¼š</span><br><span class="line"></span><br><span class="line">Person p = new Person();</span><br><span class="line"></span><br><span class="line">DecoratorA da = new DecoratorA();</span><br><span class="line"></span><br><span class="line">DecoratorB db = new DecoratorB();</span><br><span class="line"></span><br><span class="line">DecoratorC dc = new DecoratorC();</span><br><span class="line"></span><br><span class="line">da.setDecorator(p);</span><br><span class="line"></span><br><span class="line">db.setDecorator(da);</span><br><span class="line"></span><br><span class="line">dc.setDecorator(db);</span><br><span class="line"></span><br><span class="line">dc.show();</span><br></pre></td></tr></table></figure>

<p>7.ä»£ç†æ¨¡å¼</p>
<p>ä»£ç†æ¨¡å¼ï¼šä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚</p>
<figure class="highlight plaintext"><figcaption><span>class Subject &#123;</span></figcaption><table><tr><td class="code"><pre><span class="line">public abstract void request();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class RealSubject : Subject &#123;</span><br><span class="line"></span><br><span class="line">public override void request() &#123;å®ç°&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Proxy : Subject &#123;</span><br><span class="line"></span><br><span class="line">RealSubject realSubject;</span><br><span class="line"></span><br><span class="line">public override void request() &#123;</span><br><span class="line"></span><br><span class="line">realSubject.request();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Client:</span><br><span class="line"></span><br><span class="line">Proxy proxy = new Proxy();</span><br><span class="line"></span><br><span class="line">proxy.request();</span><br></pre></td></tr></table></figure>

<p>8.å·¥å‚æ–¹æ³•æ¨¡å¼</p>
<p>9.åŸå‹æ¨¡å¼</p>
<p>å¯¹è±¡æ‹·è´ã€‚æ·±æ‹·è´ã€‚æµ…æ‹·è´ã€‚</p>
<p>10.æ¨¡æ¿æ–¹æ³•æ¨¡å¼</p>
<p>11.è¿ªç±³ç‰¹æ³•åˆ™</p>
<p>è¿ªç±³ç‰¹æ³•åˆ™ï¼šå¦‚æœä¸¤ä¸ªç±»ä¸å¿…å½¼æ­¤ç›´æ¥é€šä¿¡ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªç±»å°±ä¸åº”å½“å‘ç”Ÿç›´æ¥çš„ç›¸äº’ä½œç”¨ã€‚å¦‚æœå…¶ä¸­ä¸€ä¸ªç±»éœ€è¦è°ƒç”¨å¦ä¸€ä¸ªç±»çš„æŸä¸€ä¸ªæ–¹æ³•çš„è¯ï¼Œå¯ä»¥é€šè¿‡ç¬¬ä¸‰è€…è½¬å‘è¿™ä¸ªè°ƒç”¨ã€‚</p>
<p>å¼ºè°ƒç±»ä¹‹é—´çš„æ¾è€¦åˆã€‚</p>
<p>12.å¤–è§‚æ¨¡å¼</p>
<p>13.å»ºé€ è€…æ¨¡å¼</p>
<p>å»ºé€ è€…æ¨¡å¼ï¼šå°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚</p>
<p>å»ºé€ è€…æ¨¡å¼æ˜¯åœ¨å½“åˆ›å»ºå¤æ‚å¯¹è±¡çš„ç®—æ³•åº”è¯¥ç‹¬ç«‹äºè¯¥å¯¹è±¡çš„ç»„æˆéƒ¨åˆ†ä»¥åŠå®ƒä»¬çš„è£…é…æ–¹å¼æ—¶é€‚ç”¨çš„æ¨¡å¼ã€‚</p>
<p>14.è§‚å¯Ÿè€…æ¨¡å¼</p>
<p>å½“ä¸€ä¸ªå¯¹è±¡çš„æ”¹å˜éœ€è¦åŒæ—¶æ”¹å˜å…¶ä»–å¯¹è±¡ï¼Œè€Œä¸”å®ƒä¸çŸ¥é“å…·ä½“æœ‰å¤šå°‘å¯¹è±¡æœ‰å¾…æ”¹å˜æ—¶ï¼Œåº”è¯¥è€ƒè™‘ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼ã€‚</p>
<p>ä¸€ä¸ªæŠ½è±¡æ¨¡å‹æœ‰ä¸¤ä¸ªæ–¹é¢ï¼Œå…¶ä¸­ä¸€æ–¹é¢ä¾èµ–äºå¦ä¸€æ–¹é¢ï¼Œè¿™æ—¶ç”¨è§‚å¯Ÿè€…æ¨¡å¼å¯ä»¥å°†è¿™ä¸¤è€…å°è£…åœ¨ç‹¬ç«‹çš„å¯¹è±¡ä¸­ä½¿å®ƒä»¬å„è‡ªç‹¬ç«‹åœ°æ”¹å˜å’Œå¤ç”¨ã€‚</p>
<p>æ€»ç»“ï¼šè§‚å¯Ÿè€…æ¨¡å¼æ‰€åšçš„å·¥ä½œå…¶å®å°±æ˜¯åœ¨è§£é™¤è€¦åˆã€‚è®©è€¦åˆçš„åŒæ–¹éƒ½ä¾èµ–äºæŠ½è±¡ï¼Œè€Œä¸æ˜¯ä¾èµ–äºå…·ä½“ã€‚ä»è€Œä½¿å¾—å„è‡ªçš„å˜åŒ–éƒ½ä¸ä¼šå½±å“å¦ä¸€è¾¹çš„å˜åŒ–ã€‚</p>
<p>C#çš„å§”æ‰˜delegate</p>
<p>å§”æ‰˜å°±æ˜¯ä¸€ç§å¼•ç”¨æ–¹æ³•çš„ç±»å‹ã€‚ä¸€æ—¦ä¸ºå§”æ‰˜åˆ†é…äº†æ–¹æ³•ï¼Œå§”æ‰˜å°†ä¸è¯¥æ–¹æ³•å…·æœ‰å®Œå…¨ç›¸åŒçš„è¡Œä¸ºã€‚å§”æ‰˜æ–¹æ³•çš„ä½¿ç”¨å¯ä»¥åƒå…¶ä»–ä»»ä½•æ–¹æ³•ä¸€æ ·ï¼Œå…·æœ‰å‚æ•°å’Œè¿”å›å€¼ã€‚å§”æ‰˜å¯ä»¥çœ‹åšæ˜¯å¯¹å‡½æ•°çš„æŠ½è±¡ï¼Œæ˜¯å‡½æ•°çš„ç±»ï¼Œå§”æ‰˜çš„å®ä¾‹å°†ä»£è¡¨ä¸€ä¸ªå…·ä½“çš„å‡½æ•°ã€‚</p>
<p>ä¸€ä¸ªå§”æ‰˜å¯ä»¥æ­è½½å¤šä¸ªæ–¹æ³•ï¼Œæ‰€æœ‰æ–¹æ³•è¢«ä¾æ¬¡å”¤èµ·ã€‚å¯ä»¥ä½¿å¾—å§”æ‰˜å¯¹è±¡æ‰€æ­è½½çš„æ–¹æ³•å¹¶ä¸éœ€è¦å±äºåŒä¸€ä¸ªç±»ã€‚</p>
<p>å§”æ‰˜å¯¹è±¡æ‰€æ­è½½çš„æ‰€æœ‰æ–¹æ³•å¿…é¡»å…·æœ‰ç›¸åŒçš„åŸå½¢å’Œå½¢å¼ï¼Œä¹Ÿå°±æ˜¯æ‹¥æœ‰ç›¸åŒçš„å‚æ•°åˆ—è¡¨å’Œè¿”å›å€¼ç±»å‹ã€‚</p>
<p>15.æŠ½è±¡å·¥å‚æ¨¡å¼</p>
<p>æŠ½è±¡å·¥å‚æ¨¡å¼ï¼šæä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–ç›¸äº’ä¾èµ–å¯¹è±¡çš„æ¥å£ï¼Œè€Œæ— éœ€æŒ‡å®šå®ƒä»¬å…·ä½“çš„ç±»ã€‚</p>
<p>16.çŠ¶æ€æ¨¡å¼</p>
<p>çŠ¶æ€æ¨¡å¼ï¼šå½“ä¸€ä¸ªå¯¹è±¡çš„å†…åœ¨çŠ¶æ€æ”¹å˜æ—¶å…è®¸æ”¹å˜å…¶è¡Œä¸ºï¼Œè¿™ä¸ªå¯¹è±¡çœ‹èµ·æ¥åƒæ˜¯æ”¹å˜äº†å…¶ç±»ã€‚</p>
<p>çŠ¶æ€æ¨¡å¼ä¸»è¦è§£å†³çš„æ˜¯å½“æ§åˆ¶ä¸€ä¸ªå¯¹è±¡çŠ¶æ€è½¬æ¢çš„æ¡ä»¶è¡¨è¾¾å¼è¿‡äºå¤æ‚æ—¶çš„æƒ…å†µã€‚æŠŠçŠ¶æ€çš„åˆ¤æ–­é€»è¾‘è½¬ç§»åˆ°è¡¨ç¤ºä¸åŒçŠ¶æ€çš„ä¸€ç³»åˆ—ç±»å½“ä¸­ï¼Œå¯ä»¥æŠŠå¤æ‚çš„åˆ¤æ–­é€»è¾‘ç®€åŒ–ã€‚</p>
<p>17.é€‚é…å™¨æ¨¡å¼</p>
<p>é€‚é…å™¨æ¨¡å¼ï¼šå°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ¥å£ã€‚Adapteræ¨¡å¼ä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»å¯ä»¥ä¸€èµ·å·¥ä½œäº†ã€‚</p>
<p>18.å¤‡å¿˜å½•æ¨¡å¼</p>
<p>å¤‡å¿˜å½•ï¼šåœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ã€‚è¿™æ ·ä»¥åå°±å¯å°†è¯¥å¯¹è±¡æ¢å¤åˆ°åŸå…ˆä¿å­˜çš„çŠ¶æ€ã€‚</p>
<p>19.ç»„åˆæ¨¡å¼</p>
<p>ç»„åˆæ¨¡å¼ï¼šå°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ä»¥è¡¨ç¤ºâ€œéƒ¨åˆ†-æ•´ä½“â€çš„å±‚æ¬¡ç»“æ„ã€‚ç»„åˆæ¨¡å¼ä½¿å¾—ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§ã€‚</p>
<p>20.è¿­ä»£å™¨æ¨¡å¼</p>
<p>è¿­ä»£å™¨æ¨¡å¼ï¼šæä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚</p>
<p>21.å•ä¾‹æ¨¡å¼</p>
<p>å•ä¾‹æ¨¡å¼ï¼šä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ã€‚</p>
<p>å•ä¾‹æ¨¡å¼å’Œé™æ€å·¥å…·ç±»Staticæ–¹æ³•çš„åŒºåˆ«ï¼šé™æ€å·¥å…·ç±»ä¸ä¿å­˜çŠ¶æ€ï¼Œä»…æä¾›ä¸€äº›é™æ€æ–¹æ³•æˆ–é™æ€å±æ€§æ¥è®©ä½ ä½¿ç”¨ï¼Œè€Œå•ä¾‹ç±»æ˜¯æœ‰çŠ¶æ€çš„ã€‚é™æ€å·¥å…·ç±»ä¸èƒ½ç”¨äºç»§æ‰¿å¤šæ€ï¼Œè€Œå•ä¾‹è™½ç„¶å®ä¾‹å”¯ä¸€ï¼Œå´æ˜¯å¯ä»¥æœ‰å­ç±»æ¥ç»§æ‰¿ã€‚é™æ€ç±»åªä¸è¿‡æ˜¯ä¸€äº›æ–¹æ³•å±æ€§çš„é›†åˆï¼Œè€Œå•ä¾‹å´æ˜¯æœ‰ç€å”¯ä¸€çš„å¯¹è±¡å®ä¾‹ã€‚</p>
<h3 id="1ã€æ‡’æ±‰å¼ï¼Œçº¿ç¨‹ä¸å®‰å…¨"><a href="#1ã€æ‡’æ±‰å¼ï¼Œçº¿ç¨‹ä¸å®‰å…¨" class="headerlink" title="1ã€æ‡’æ±‰å¼ï¼Œçº¿ç¨‹ä¸å®‰å…¨"></a>1ã€æ‡’æ±‰å¼ï¼Œçº¿ç¨‹ä¸å®‰å…¨</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public class Singleton &#123;  </span><br><span class="line">    private static Singleton instance;  </span><br><span class="line">    private Singleton ()&#123;&#125;  </span><br><span class="line">  </span><br><span class="line">    public static Singleton getInstance() &#123;  </span><br><span class="line">    if (instance == null) &#123;  </span><br><span class="line">        instance = new Singleton();  </span><br><span class="line">    &#125;  </span><br><span class="line">    return instance;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2ã€æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨"><a href="#2ã€æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨" class="headerlink" title="2ã€æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨"></a>2ã€æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public class Singleton &#123;  </span><br><span class="line">    private static Singleton instance;  </span><br><span class="line">    private Singleton ()&#123;&#125;  </span><br><span class="line">    public static synchronized Singleton getInstance() &#123;  </span><br><span class="line">    if (instance == null) &#123;  </span><br><span class="line">        instance = new Singleton();  </span><br><span class="line">    &#125;  </span><br><span class="line">    return instance;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3ã€é¥¿æ±‰å¼"><a href="#3ã€é¥¿æ±‰å¼" class="headerlink" title="3ã€é¥¿æ±‰å¼"></a>3ã€é¥¿æ±‰å¼</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public class Singleton &#123;  </span><br><span class="line">    private static Singleton instance = new Singleton();  </span><br><span class="line">    private Singleton ()&#123;&#125;  </span><br><span class="line">    public static Singleton getInstance() &#123;  </span><br><span class="line">    return instance;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4ã€åŒæ£€é”-åŒé‡æ ¡éªŒé”ï¼ˆDCLï¼Œå³-double-checked-lockingï¼‰"><a href="#4ã€åŒæ£€é”-åŒé‡æ ¡éªŒé”ï¼ˆDCLï¼Œå³-double-checked-lockingï¼‰" class="headerlink" title="4ã€åŒæ£€é”/åŒé‡æ ¡éªŒé”ï¼ˆDCLï¼Œå³ double-checked lockingï¼‰"></a>4ã€åŒæ£€é”/åŒé‡æ ¡éªŒé”ï¼ˆDCLï¼Œå³ double-checked lockingï¼‰</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public class Singleton &#123;  </span><br><span class="line">    private volatile static Singleton singleton;    // åŠ volatileçš„ä½œç”¨ï¼Œé˜²æ­¢singletonå˜é‡åœ¨newçš„æ—¶å€™å¼•ç”¨é€ƒé€¸</span><br><span class="line">    private Singleton ()&#123;&#125;  </span><br><span class="line">    public static Singleton getSingleton() &#123;  </span><br><span class="line">    if (singleton == null) &#123;  </span><br><span class="line">        synchronized (Singleton.class) &#123;  </span><br><span class="line">        if (singleton == null) &#123;  </span><br><span class="line">            singleton = new Singleton();  </span><br><span class="line">        &#125;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">    return singleton;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5ã€ç™»è®°å¼-é™æ€å†…éƒ¨ç±»"><a href="#5ã€ç™»è®°å¼-é™æ€å†…éƒ¨ç±»" class="headerlink" title="5ã€ç™»è®°å¼/é™æ€å†…éƒ¨ç±»"></a>5ã€ç™»è®°å¼/é™æ€å†…éƒ¨ç±»</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public class Singleton &#123;  </span><br><span class="line">    private static class SingletonHolder &#123;  </span><br><span class="line">    private static final Singleton INSTANCE = new Singleton();  </span><br><span class="line">    &#125;  </span><br><span class="line">    private Singleton ()&#123;&#125;  </span><br><span class="line">    public static final Singleton getInstance() &#123;  </span><br><span class="line">    return SingletonHolder.INSTANCE;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6ã€æšä¸¾"><a href="#6ã€æšä¸¾" class="headerlink" title="6ã€æšä¸¾"></a>6ã€æšä¸¾</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public enum Singleton &#123;  </span><br><span class="line">    INSTANCE;  </span><br><span class="line">    public void whateverMethod() &#123;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>22.æ¡¥æ¥æ¨¡å¼</p>
<p>åˆæˆ/èšåˆå¤ç”¨åŸåˆ™ï¼šå°½é‡ä½¿ç”¨åˆæˆ/èšåˆï¼Œå°½é‡ä¸è¦ä½¿ç”¨ç±»ç»§æ‰¿ã€‚ç»„åˆä¼˜äºç»§æ‰¿ã€‚</p>
<p>æ¡¥æ¥æ¨¡å¼ï¼šå°†æŠ½è±¡éƒ¨åˆ†ä¸å®ƒçš„å®ç°éƒ¨åˆ†åˆ†ç¦»ï¼Œä½¿å®ƒä»¬éƒ½å¯ä»¥ç‹¬ç«‹çš„å˜åŒ–ã€‚</p>
<p>23.å‘½ä»¤æ¨¡å¼</p>
<p>24.èŒè´£é“¾æ¨¡å¼</p>
<p>èŒè´£é“¾æ¨¡å¼ï¼šä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚å°†è¿™ä¸ªå¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚</p>
<p>25.ä¸­ä»‹è€…æ¨¡å¼</p>
<p>26.äº«å…ƒæ¨¡å¼</p>
<p>27.è§£é‡Šå™¨æ¨¡å¼</p>
<p>è§£é‡Šå™¨æ¨¡å¼ï¼šç»™å®šä¸€ä¸ªè¯­è¨€ï¼Œå®šä¹‰å®ƒçš„æ–‡æ³•çš„ä¸€ç§è¡¨ç¤ºï¼Œå¹¶å®šä¹‰ä¸€ä¸ªè§£é‡Šå™¨ï¼Œè¿™ä¸ªè§£é‡Šå™¨ä½¿ç”¨è¯¥è¡¨ç¤ºæ¥è§£é‡Šè¯­è¨€ä¸­çš„å¥å­ã€‚</p>
<p>28.è®¿é—®è€…æ¨¡å¼</p>
<p>è®¿é—®è€…æ¨¡å¼ï¼šè¡¨ç¤ºä¸€ä¸ªä½œç”¨äºæŸå¯¹è±¡ç»“æ„ä¸­çš„å„å…ƒç´ æ“ä½œã€‚å®ƒä½¿ä½ å¯ä»¥åœ¨ä¸æ”¹å˜å„å…ƒç´ çš„ç±»çš„å‰æä¸‹å®šä¹‰ä½œç”¨äºè¿™äº›å…ƒç´ çš„æ–°æ“ä½œã€‚</p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>è¯»ä¹¦ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>å®¹å™¨çš„ç½‘ç»œæ¨¡å¼</title>
    <url>/docker-net/</url>
    <content><![CDATA[<div class=".article-gallery"><h3 id="Bridge"><a href="#Bridge" class="headerlink" title="Bridge"></a>Bridge</h3><p>ç‹¬ç«‹netnséš”ç¦»äº†ç½‘ç»œï¼Œå®¹å™¨é—´ç½‘ç»œä¸äº’ç›¸å½±å“ï¼Œå®¹å™¨å†…çš„IPåœ°å€æ˜¯ç§æœ‰ç½‘æ®µï¼Œä»…æœ¬åœ°å¯è§ï¼Œé€šè¿‡NATä¸å¤–éƒ¨äº¤äº’</p>
<p>Bridge æ¨¡å¼å¯ä»¥çœ‹ä½œæœåŠ¡è¢«æ”¾åœ¨ä¸€ä¸ªç‹¬ç«‹çš„ç½‘ç»œç©ºé—´é‡Œï¼Œå®ƒçš„ IP æ˜¯ä¸€ä¸ªè™šæ‹Ÿ IPï¼Œä»»ä½•çš„ç«¯å£éƒ½æ˜¯å¯ä»¥ä½¿ç”¨çš„ã€‚ä½†æ˜¯å¯¹å¤–æä¾›æœåŠ¡çš„æ—¶å€™ï¼Œéœ€è¦é€šè¿‡ NAT è½¬å‘ã€‚</p>
<span id="more"></span>

<p>éœ€è¦è¿›è¡Œçš„é…ç½®ï¼š</p>
<ul>
<li><p>é…ç½®æœåŠ¡ä¿¡æ¯ä¸­éœ€è¦å¡«å†™ä¸€ä¸ªæœåŠ¡ä¸»ç«¯å£</p>
</li>
<li><p>é…ç½®ä»¥åçš„å®ä¾‹åˆ—è¡¨ï¼š</p>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒBridge æ¨¡å¼ä¸‹çš„å®ä¾‹ä¼šæœ‰ä¸åŒçš„ NodeIP å’Œå†…éƒ¨ IPï¼Œå†…éƒ¨ IP æ˜¯ä¸€ä¸ªè™šæ‹Ÿ IPï¼Œå®ƒé€šè¿‡ NAT è½¬å‘æ˜ å°„åˆ° NodeIPã€‚å†…éƒ¨ç«¯å£æ˜¯é…ç½®çš„å›ºå®šç«¯å£ï¼Œè®¿é—®ç«¯å£æ˜¯åŠ¨æ€é…ç½®çš„è½¬å‘ç«¯å£ã€‚</p>
</li>
</ul>
<h3 id="Host"><a href="#Host" class="headerlink" title="Host"></a>Host</h3><p>æ ‡å‡†çš„Hostç½‘ç»œ</p>
<p>Host æ¨¡å¼ä½¿ç”¨çš„æ˜¯å®¿ä¸»æœºçš„ç«¯å£ï¼Œç›¸æ¯” Bridge è€Œè¨€ï¼Œå°‘äº†ä¸€æ¬¡å†…æ ¸æ ˆçš„è°ƒç”¨ï¼Œä¹Ÿæ²¡æœ‰ NAT è½¬å‘çš„æŸè€—ã€‚å¯¹äºé«˜ååï¼Œæˆ–æœ‰å¤§æ–‡ä»¶ä¼ è¾“çš„ä¸šåŠ¡æœåŠ¡è€Œè¨€ï¼ŒBridge æ¨¡å¼ä¸ç¬¦åˆæ€§èƒ½è¦æ±‚ï¼Œæ‰€ä»¥æ¶æ„ç»„åˆæ¨å‡ºæ¥äº† Host æ¨¡å¼ã€‚</p>
<p>åœ¨  Host æ¨¡å¼ä¸‹ï¼ŒæœåŠ¡ç«¯å£éƒ½æ˜¯å¹³å°è‡ªåŠ¨åˆ†é…çš„ï¼Œå› æ­¤ä¸åŒçš„å®ä¾‹ç«¯å£å¯èƒ½ä¸åŒã€‚å¹³å°ä¼šæ ¹æ®æ¯å°æœºå™¨çš„å¯ç”¨ç«¯å£ï¼ŒæŒ‰ç…§æœåŠ¡çš„éœ€è¦ï¼Œåˆ†é…ç»™å®ä¾‹å¯¹åº”çš„ç«¯å£å¹¶ä¿å­˜åœ¨ç¯å¢ƒå˜é‡ä¸­ï¼Œä» PORT0 å¼€å§‹ä¿å­˜ã€‚</p>
<p>ä¾‹å¦‚ï¼ŒæœåŠ¡éœ€è¦ä¸€ä¸ªç«¯å£ï¼ˆé…ç½®çš„æ˜¯ 4608ï¼‰ï¼Œå¹³å°ä¼šåˆ†é…ä¸¤ä¸ªå¯ç”¨ç«¯å£ï¼ˆ9001ã€9002ï¼‰ï¼Œå†™åˆ°ç¯å¢ƒå˜é‡ PORT0 å’Œ PORT1 ä¸­ï¼Œå› æ­¤éœ€è¦æœåŠ¡è‡ªå·±è¿›è¡ŒåŠ¨æ€çš„é…ç½®å’Œæ›¿æ¢ã€‚</p>
<p>åœ¨ç¯å¢ƒå˜é‡ä¸­ï¼Œâ€$IS_HOST_NETWORKâ€ == â€œ1â€ è¡¨ç¤º Host æ¨¡å¼ã€‚</p>
<h3 id="Auto-Host"><a href="#Auto-Host" class="headerlink" title="Auto Host"></a>Auto Host</h3><p>é€šè¿‡hookbindé‡æ˜ å°„bindçš„ç«¯å£å·ï¼Œå…¶ä»–è¡Œä¸ºåŒHost</p>
<p>åœ¨ä¸Šé¢çš„ Host æ¨¡å¼ä¸­ï¼Œå¹³å°æŠŠåŠ¨æ€åˆ†é…ç«¯å£çš„ä½¿ç”¨æƒä¸‹æ”¾ç»™äº†åº”ç”¨ï¼Œéœ€è¦åº”ç”¨è‡ªå·±è¿›è¡Œå¤æ‚çš„é…ç½®ï¼Œå¹¶åœ¨åº”ç”¨ä¸­åŠ¨æ€ä¿®æ”¹é…ç½®ï¼Œæœ‰æ¯”è¾ƒé«˜çš„ç»´æŠ¤æˆæœ¬ã€‚å¦å¤–ï¼Œå¦‚æœé€‰æ‹© Host æ¨¡å¼ï¼Œä½†æ˜¯ä¾æ—§æŒ‰ç…§ Bridge çš„æ–¹å¼è¿›è¡Œé…ç½®ï¼Œåˆ™æœ‰äº§ç”Ÿç«¯å£å†²çªçš„é£é™©ã€‚äºæ˜¯æ¶æ„ç»„åˆæ¨å‡ºäº† Auto Host æ¨¡å¼ã€‚</p>
<p>Auto Host æ¨¡å¼çš„åšæ³•æ˜¯åœ¨å†…æ ¸å±‚å¯¹ syscall çš„ listen api è¿›è¡Œæˆªè·ï¼Œç„¶åæ›¿æ¢ä¸ŠåŠ¨æ€åˆ†é…çš„ç«¯å£ã€‚</p>
<p>Auto Host æ¨¡å¼éœ€è¦è¿›è¡Œçš„é…ç½®ä¸ Bridge æ¨¡å¼æœ‰ä¸¤ç‚¹ä¸åŒï¼š</p>
<ul>
<li>é€‰æ‹©ä¸åŒçš„æ¨¡å¼</li>
<li>éœ€è¦é…ç½®çš„ç«¯å£æ•°ä¸ Host æ¨¡å¼ç›¸åŒï¼Œæ˜¯ Bridge æ¨¡å¼çš„ä¸¤å€ï¼ŒBridge æ¨¡å¼åªè¦é…ç½® uwsgi çš„ç«¯å£ï¼Œè¿™è¾¹éœ€è¦ uwsgi å’Œ nginx çš„ç«¯å£</li>
</ul>
<p>Auto Host æ¨¡å¼å¯åŠ¨ä»¥åçš„å®ä¾‹åˆ—è¡¨ï¼Œè¿™è¾¹ç”±äºä¸éœ€è¦è¿›è¡Œ NAT è½¬å‘ï¼Œå› æ­¤ NodeIP å’Œ å†…éƒ¨ IPæ˜¯ä¸€æ ·çš„ï¼Œ9003 å’Œ 9006 æ˜¯å¹³å°åŠ¨æ€åˆ†é…çš„ç«¯å£ã€‚</p>
<p><strong>ä»¥ä¸‹å…¨æ–‡ä»…è®¨è®ºBridgeç½‘ç»œæ¨¡å¼ï¼ŒHostç½‘ç»œçš„éš”ç¦»æ€§ä»¥åŠåŠŸèƒ½æ‰©å±•æ€§è¿œä¸å¦‚Bridgeï¼Œä¸”Bridgeåœ¨BPFåŠ é€Ÿåï¼Œ</strong>æ€§èƒ½ç•¥é«˜äºHostç½‘ç»œã€‚</p>
</div>]]></content>
      <categories>
        <category>æœåŠ¡å™¨æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œ</tag>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title>å®¹å™¨ä¸‹è®¾ç½®æ­£ç¡®çš„GOMAXPROCS</title>
    <url>/docker-setgomax/</url>
    <content><![CDATA[<div class=".article-gallery"><h1 id="é‡åˆ°é—®é¢˜"><a href="#é‡åˆ°é—®é¢˜" class="headerlink" title="é‡åˆ°é—®é¢˜"></a>é‡åˆ°é—®é¢˜</h1><p>è·‘åœ¨k8så®¹å™¨çš„æˆ˜æ–—éªŒè¯æœåŠ¡å¯åŠ¨äº†æ¯”resource limitæ›´å¤šçš„worker</p>
<p><code>runtime.GOMAXPROCS</code> é»˜è®¤è®¾ç½®ä¸ºç‰©ç†æ ¸å¿ƒæ•°ã€‚ä½†å½“åœ¨åŠ äº†resource limitçš„å®¹å™¨ä¸‹ <code>runtime.GOMAXPROCS()</code> è·å¾—çš„ä¸æ˜¯è¢«é™é¢çš„ï¼Œä¾ç„¶æ˜¯å®¿ä¸»æœºå™¨çš„ç‰©ç†æ ¸å¿ƒæ•°ã€‚</p>
<p>å½“GOMAXPROCSè¶…è¿‡äº†å…¶åˆ†é…çš„é…é¢æ—¶ï¼Œå¯èƒ½å¯¼è‡´ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œè°ƒåº¦å¼€é”€ï¼Œå› ä¸ºæ›´å¤šçš„ goroutines è¯•å›¾åœ¨æœ‰é™çš„ CPU æ—¶é—´ç‰‡ä¸Šè¿è¡Œã€‚</p>
<h1 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h1><p>uberå¼€æºçš„<a href="https://github.com/uber-go/automaxprocs">https://github.com/uber-go/automaxprocs</a></p>
<p>è‡ªåŠ¨å°†GOMAXPROCSè®¾ç½®åˆ°å®¹å™¨ä¸‹è¢«é™é¢çš„cpuæ•°</p>
<h1 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h1><p>import _ â€œgo.uber.org/automaxprocsâ€</p>
<h1 id="é€‚ç”¨åœºæ™¯"><a href="#é€‚ç”¨åœºæ™¯" class="headerlink" title="é€‚ç”¨åœºæ™¯"></a>é€‚ç”¨åœºæ™¯</h1><p>å½“ä½ çš„ç¨‹åºæ˜¯è®¡ç®—å¯†é›†å‹æˆ–è€…éœ€è¦æœ‰å›ºå®šworkeræ•°çš„ç±»å‹æ—¶ï¼Œå¹¶ä¸”è¦éƒ¨ç½²åˆ°å®¹å™¨ç¯å¢ƒä¸­æ—¶ï¼Œå¯ä»¥å‚è€ƒä¸Šé¢çš„æ–¹æ³•æ¥è§£å†³<code>GOMAXPROCS</code> å’Œcpué™é¢ä¸åŒ¹é…çš„é—®é¢˜</p>
<p>å‚è€ƒ</p>
<p><a href="https://nemre.medium.com/is-your-go-application-really-using-the-correct-number-of-cpu-cores-20915d2b6ccb">https://nemre.medium.com/is-your-go-application-really-using-the-correct-number-of-cpu-cores-20915d2b6ccb</a></p>
<p><a href="https://segmentfault.com/a/1190000043930543">https://segmentfault.com/a/1190000043930543</a></p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨Goè¯­è¨€å¼€å‘eBPFç¨‹åº</title>
    <url>/goebpf/</url>
    <content><![CDATA[<div class=".article-gallery"><p>åŸæ–‡åœ°å€ï¼š<a href="https://tonybai.com/2022/07/19/develop-ebpf-program-in-go/">https://tonybai.com/2022/07/19/develop-ebpf-program-in-go/</a></p>
<h1 id="ä½¿ç”¨Goè¯­è¨€å¼€å‘eBPFç¨‹åº"><a href="#ä½¿ç”¨Goè¯­è¨€å¼€å‘eBPFç¨‹åº" class="headerlink" title="ä½¿ç”¨Goè¯­è¨€å¼€å‘eBPFç¨‹åº"></a>ä½¿ç”¨Goè¯­è¨€å¼€å‘eBPFç¨‹åº</h1><ul>
<li>ä¸ƒæœˆ 19, 2022</li>
<li><a href="https://tonybai.com/2022/07/19/develop-ebpf-program-in-go/#respond">0 æ¡è¯„è®º</a></li>
</ul>
<p><a href="https://tonybai.com/wp-content/uploads/develop-ebpf-program-in-go-1.png" title="img" class="gallery-item" style="box-shadow: none;"> <img src="https://tonybai.com/wp-content/uploads/develop-ebpf-program-in-go-1.png" alt="img"></a></p>
<p><a href="https://tonybai.com/2022/07/19/develop-ebpf-program-in-go">æœ¬æ–‡æ°¸ä¹…é“¾æ¥</a> â€“ <a href="https://tonybai.com/2022/07/19/develop-ebpf-program-in-go">https://tonybai.com/2022/07/19/develop-ebpf-program-in-go</a></p>
<p>åœ¨å‰é¢çš„<a href="https://tonybai.com/2022/07/05/develop-hello-world-ebpf-program-in-c-from-scratch">ã€Šä½¿ç”¨Cè¯­è¨€ä»å¤´å¼€å‘ä¸€ä¸ªHello Worldçº§åˆ«çš„eBPFç¨‹åºã€‹</a>ä¸€æ–‡ä¸­ï¼Œæˆ‘ä»¬è¯¦ç»†è¯´æ˜äº†å¦‚ä½•åŸºäºCè¯­è¨€å’Œlibbpfåº“ä»å¤´å¼€å‘ä¸€ä¸ªeBPFç¨‹åº(åŒ…æ‹¬å…¶ç”¨æˆ·æ€éƒ¨åˆ†)ã€‚é‚£ç¯‡æ–‡ç« æ˜¯åç»­æœ‰å…³eBPFç¨‹åºå¼€å‘æ–‡ç« çš„åŸºç¡€ï¼Œå› ä¸ºåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ— è®ºeBPFç¨‹åºçš„ç”¨æˆ·æ€éƒ¨åˆ†ç”¨ä»€ä¹ˆè¯­è¨€å¼€å‘ï¼Œè¿è¡Œäºå†…æ ¸æ€çš„eBPFç¨‹åºå†…æ ¸æ€éƒ¨åˆ†è¿˜æ˜¯å¿…é¡»ç”±Cè¯­è¨€å¼€å‘çš„ã€‚è¿™æ ·ä¸€æ¥ï¼Œå…¶ä»–ç¼–ç¨‹è¯­è¨€åªèƒ½æ‹¼ä¸€ä¸‹å¦‚ä½•è®©eBPFç¨‹åºçš„ç”¨æˆ·æ€éƒ¨åˆ†çš„å¼€å‘æ›´ä¸ºç®€å•äº†ï¼ŒGoè¯­è¨€ä¹Ÿä¸ä¾‹å¤–ã€‚</p>
<p>åœ¨Goç¤¾åŒºä¸­ï¼Œç›®å‰æœ€ä¸ºæ´»è·ƒçš„ç”¨äºå¼€å‘eBPFç”¨æˆ·æ€éƒ¨åˆ†çš„Go eBPFåŒ…è«è¿‡äºciliumé¡¹ç›®å¼€æºçš„<a href="https://github.com/cilium/ebpf/">cilium/ebpf</a>ï¼Œciliumé¡¹ç›®èƒŒåçš„<a href="https://isovalent.com/">Isovalentå…¬å¸</a>ä¹Ÿæ˜¯eBPFæŠ€æœ¯åœ¨äº‘åŸç”Ÿé¢†åŸŸåº”ç”¨çš„ä¸»è¦æ¨æ‰‹ä¹‹ä¸€ã€‚</p>
<p>æœ¬æ–‡æˆ‘ä»¬å°±æ¥è¯´è¯´<strong>åŸºäºcilium/ebpfå¼€å‘eBPFç¨‹åºçš„å¥—è·¯</strong>ï¼</p>
<h3 id="ä¸€-æ¢ç´¢cilium-ebpfé¡¹ç›®ç¤ºä¾‹"><a href="#ä¸€-æ¢ç´¢cilium-ebpfé¡¹ç›®ç¤ºä¾‹" class="headerlink" title="ä¸€. æ¢ç´¢cilium/ebpfé¡¹ç›®ç¤ºä¾‹"></a>ä¸€. æ¢ç´¢cilium/ebpfé¡¹ç›®ç¤ºä¾‹</h3><p>cilium/ebpfé¡¹ç›®å€Ÿé‰´äº†<a href="https://github.com/libbpf/libbpf-bootstrap">libbpf-boostrap</a>çš„æ€è·¯ï¼Œé€šè¿‡ä»£ç ç”Ÿæˆä¸bpfç¨‹åºå†…åµŒçš„æ–¹å¼æ„å»ºeBPFç¨‹åºç”¨æˆ·æ€éƒ¨åˆ†ã€‚ä¸ºäº†ææ¸…æ¥šåŸºäºcilium/ebpfå¼€å‘ebpfç¨‹åºçš„å¥—è·¯ï¼Œæˆ‘ä»¬å…ˆæ¥æ¢ç´¢ä¸€ä¸‹cilium/ebpfé¡¹ç›®æä¾›çš„ç¤ºä¾‹ä»£ç ã€‚</p>
<p>æˆ‘ä»¬é¦–å…ˆæ¥ä¸‹è½½å’Œçœ‹çœ‹ebpfçš„ç¤ºä¾‹çš„ç»“æ„ã€‚</p>
<ul>
<li>ä¸‹è½½cilium/ebpfé¡¹ç›®</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ git clone https://github.com/cilium/ebpf.git</span><br><span class="line">Cloning into &#x27;ebpf&#x27;...</span><br><span class="line">remote: Enumerating objects: 7054, done.</span><br><span class="line">remote: Counting objects: 100% (183/183), done.</span><br><span class="line">remote: Compressing objects: 100% (112/112), done.</span><br><span class="line">remote: Total 7054 (delta 91), reused 124 (delta 69), pack-reused 6871</span><br><span class="line">Receiving objects: 100% (7054/7054), 10.91 MiB | 265.00 KiB/s, done.</span><br><span class="line">Resolving deltas: 100% (4871/4871), done.</span><br></pre></td></tr></table></figure>

<ul>
<li>æ¢ç´¢ebpfé¡¹ç›®ç¤ºä¾‹ä»£ç ç»“æ„</li>
</ul>
<p>ebpfç¤ºä¾‹åœ¨examplesç›®å½•ä¸‹ï¼Œæˆ‘ä»¬ä»¥tracepoint_in_cä¸ºä¾‹çœ‹çœ‹å…¶ç»„ç»‡å½¢å¼ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$tree tracepoint_in_c</span><br><span class="line">tracepoint_in_c</span><br><span class="line">â”œâ”€â”€ bpf_bpfeb.go</span><br><span class="line">â”œâ”€â”€ bpf_bpfeb.o</span><br><span class="line">â”œâ”€â”€ bpf_bpfel.go</span><br><span class="line">â”œâ”€â”€ bpf_bpfel.o</span><br><span class="line">â”œâ”€â”€ main.go</span><br><span class="line">â””â”€â”€ tracepoint.c</span><br><span class="line"></span><br><span class="line">0 directories, 6 files</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®ç»éªŒåˆ¤æ–­ï¼Œè¿™é‡Œé¢çš„tracepoint.cå¯¹åº”çš„æ˜¯ebpfç¨‹åºå†…æ ¸æ€éƒ¨åˆ†ï¼Œè€Œmain.goå’Œbpf_bpfel.go/bpf_bpfeb.goåˆ™æ˜¯ebpfç¨‹åºç”¨æˆ·æ€éƒ¨åˆ†ï¼Œè‡³äºbpf_bpfeb.o/bpf_bpfel.oåº”è¯¥æ˜¯æŸç§ä¸­é—´ç›®æ ‡æ–‡ä»¶ã€‚é€šè¿‡readelf -a bpf_bpfeb.oæŸ¥çœ‹è¯¥ä¸­é—´æ–‡ä»¶ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$readelf -a bpf_bpfeb.o</span><br><span class="line">ELF Header:</span><br><span class="line">  Magic:   7f 45 4c 46 02 02 01 00 00 00 00 00 00 00 00 00</span><br><span class="line">  Class:                             ELF64</span><br><span class="line">  Data:                              2&#x27;s complement, big endian</span><br><span class="line">  Version:                           1 (current)</span><br><span class="line">  OS/ABI:                            UNIX - System V</span><br><span class="line">  ABI Version:                       0</span><br><span class="line">  Type:                              REL (Relocatable file)</span><br><span class="line">  Machine:                           Linux BPF</span><br><span class="line">  Version:                           0x1</span><br><span class="line">  Entry point address:               0x0</span><br><span class="line">  Start of program headers:          0 (bytes into file)</span><br><span class="line">  Start of section headers:          1968 (bytes into file)</span><br><span class="line">  Flags:                             0x0</span><br><span class="line">  Size of this header:               64 (bytes)</span><br><span class="line">  Size of program headers:           0 (bytes)</span><br><span class="line">  Number of program headers:         0</span><br><span class="line">  Size of section headers:           64 (bytes)</span><br><span class="line">  Number of section headers:         13</span><br><span class="line">  Section header string table index: 1</span><br><span class="line">... ...</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªå†…å«linux bpfå­—èŠ‚ç çš„elfæ–‡ä»¶(Machine: Linux BPF)ã€‚</p>
<p>é˜…è¯»äº†cilium/ebpfçš„ç›¸å…³æ–‡æ¡£ï¼Œæˆ‘ææ˜ç™½äº†è¿™å‡ ä¸ªæ–‡ä»¶çš„å…³ç³»ï¼Œç”¨ä¸‹é¢ç¤ºæ„å›¾å‘ˆç°ç»™å¤§å®¶ï¼š</p>
<p><a href="https://tonybai.com/wp-content/uploads/develop-ebpf-program-in-go-2.png" title="img" class="gallery-item" style="box-shadow: none;"> <img src="https://tonybai.com/wp-content/uploads/develop-ebpf-program-in-go-2.png" alt="img"></a></p>
<p>ebpfç¨‹åºçš„æºç æ–‡ä»¶(æ¯”å¦‚å›¾ä¸­tracepoint.c)ç»è¿‡bpf2go(cilium/ebpfæä¾›çš„ä¸€ä¸ªä»£ç ç”Ÿæˆå·¥å…·)è¢«ç¼–è¯‘(bpf2goè°ƒç”¨clang)ä¸ºebpfå­—èŠ‚ç æ–‡ä»¶bpf_bpfeb.o(å¤§ç«¯)å’Œbpf_bpfel.o(å°ç«¯)ï¼Œç„¶åbpf2goä¼šåŸºäºebpfå­—èŠ‚ç æ–‡ä»¶ç”Ÿæˆbpf_bpfeb.goæˆ–bpf_bpfel.goï¼Œebpfç¨‹åºçš„å­—èŠ‚ç ä¼šä»¥äºŒè¿›åˆ¶æ•°æ®çš„å½¢å¼å†…åµŒåˆ°è¿™ä¸¤ä¸ªgoæºæ–‡ä»¶ä¸­ï¼Œä»¥bpf_bpfel.goä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¶ä»£ç ä¸­æ‰¾åˆ°ä¸‹é¢å†…å®¹(åˆ©ç”¨<a href="https://tonybai.com/2021/02/25/some-changes-in-go-1-16">go:embedç‰¹æ€§</a>)ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//go:embed bpf_bpfel.o</span><br><span class="line">var _BpfBytes []byte</span><br></pre></td></tr></table></figure>

<p>main.goåˆ™æ˜¯ebpfç¨‹åºç”¨æˆ·æ€éƒ¨åˆ†çš„ä¸»ç¨‹åºï¼Œå°†main.goä¸bpf_bpfeb.goæˆ–bpf_bpfel.goä¹‹ä¸€ä¸€èµ·ç¼–è¯‘å°±å½¢æˆäº†ebpfç¨‹åºã€‚</p>
<p>æœ‰äº†å¯¹cilium/ebpfé¡¹ç›®ç¤ºä¾‹çš„åˆæ­¥æ¢ç´¢åï¼Œæˆ‘ä»¬æ¥æ„å»ºebpfç¤ºä¾‹ä»£ç ã€‚</p>
<h3 id="äºŒ-æ„å»ºebpfç¤ºä¾‹ä»£ç "><a href="#äºŒ-æ„å»ºebpfç¤ºä¾‹ä»£ç " class="headerlink" title="äºŒ. æ„å»ºebpfç¤ºä¾‹ä»£ç "></a>äºŒ. æ„å»ºebpfç¤ºä¾‹ä»£ç </h3><p>cilium/ebpfæä¾›äº†ä¾¿åˆ©çš„æ„å»ºè„šæœ¬ï¼Œæˆ‘ä»¬åªéœ€åœ¨ebpf/examplesä¸‹é¢æ‰§è¡Œâ€make -C ..â€å³å¯è¿›è¡Œç¤ºä¾‹ä»£ç çš„æ„å»ºã€‚</p>
<p>makeæ„å»ºè¿‡ç¨‹ä¼šåŸºäºquay.io/cilium/ebpf-builderé•œåƒå¯åŠ¨æ„å»ºå®¹å™¨ï¼Œä¸è¿‡åœ¨å›½å†…çš„ç«¥é‹éœ€è¦åƒä¸‹é¢ä¸€æ ·å¯¹Makefileå†…å®¹åšä¸€ä¸ç‚¹ä¿®æ”¹ï¼Œå¢åŠ GOPROXYç¯å¢ƒå˜é‡ï¼Œå¦åˆ™wallå¤–çš„go moduleæ— æ³•æ‹‰å–ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$git diff ../Makefile</span><br><span class="line">diff --git a/Makefile b/Makefile</span><br><span class="line">index 3a1da88..d7b1712 100644</span><br><span class="line">--- a/Makefile</span><br><span class="line">+++ b/Makefile</span><br><span class="line">@@ -48,6 +48,7 @@ container-all:</span><br><span class="line">        $&#123;CONTAINER_ENGINE&#125; run --rm $&#123;CONTAINER_RUN_ARGS&#125; \</span><br><span class="line">                -v &quot;$&#123;REPODIR&#125;&quot;:/ebpf -w /ebpf --env MAKEFLAGS \</span><br><span class="line">                --env CFLAGS=&quot;-fdebug-prefix-map=/ebpf=.&quot; \</span><br><span class="line">+               --env GOPROXY=&quot;https://goproxy.io&quot; \</span><br><span class="line">                --env HOME=&quot;/tmp&quot; \</span><br><span class="line">                &quot;$&#123;IMAGE&#125;:$&#123;VERSION&#125;&quot; \</span><br><span class="line">                $(MAKE) all</span><br></pre></td></tr></table></figure>

<p>è¿™ä¹‹åå†æ‰§è¡Œæ„å»ºå°±ä¼šé¡ºåˆ©å¾—åˆ°æˆ‘ä»¬æ‰€è¦çš„ç»“æœï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ cd examples</span><br><span class="line">$ make -C ..</span><br><span class="line">make: Entering directory &#x27;/root/go/src/github.com/cilium/ebpf&#x27;</span><br><span class="line">docker run --rm  --user &quot;0:0&quot; \</span><br><span class="line">    -v &quot;/root/go/src/github.com/cilium/ebpf&quot;:/ebpf -w /ebpf --env MAKEFLAGS \</span><br><span class="line">    --env CFLAGS=&quot;-fdebug-prefix-map=/ebpf=.&quot; \</span><br><span class="line">    --env GOPROXY=&quot;https://goproxy.io&quot; \</span><br><span class="line">    --env HOME=&quot;/tmp&quot; \</span><br><span class="line">    &quot;quay.io/cilium/ebpf-builder:1648566014&quot; \</span><br><span class="line">    make all</span><br><span class="line">make: Entering directory &#x27;/ebpf&#x27;</span><br><span class="line">find . -type f -name &quot;*.c&quot; | xargs clang-format -i</span><br><span class="line">go generate ./cmd/bpf2go/test</span><br><span class="line">go: downloading golang.org/x/sys v0.0.0-20210906170528-6f6e22806c34</span><br><span class="line">Compiled /ebpf/cmd/bpf2go/test/test_bpfel.o</span><br><span class="line">Stripped /ebpf/cmd/bpf2go/test/test_bpfel.o</span><br><span class="line">Wrote /ebpf/cmd/bpf2go/test/test_bpfel.go</span><br><span class="line">Compiled /ebpf/cmd/bpf2go/test/test_bpfeb.o</span><br><span class="line">Stripped /ebpf/cmd/bpf2go/test/test_bpfeb.o</span><br><span class="line">Wrote /ebpf/cmd/bpf2go/test/test_bpfeb.go</span><br><span class="line">go generate ./internal/sys</span><br><span class="line">enum AdjRoomMode</span><br><span class="line">enum AttachType</span><br><span class="line">enum Cmd</span><br><span class="line">enum FunctionId</span><br><span class="line">enum HdrStartOff</span><br><span class="line">enum LinkType</span><br><span class="line">enum MapType</span><br><span class="line">enum ProgType</span><br><span class="line">enum RetCode</span><br><span class="line">enum SkAction</span><br><span class="line">enum StackBuildIdStatus</span><br><span class="line">enum StatsType</span><br><span class="line">enum XdpAction</span><br><span class="line">struct BtfInfo</span><br><span class="line">... ...</span><br><span class="line">attr ProgRun</span><br><span class="line">attr RawTracepointOpen</span><br><span class="line">cd examples/ &amp;&amp; go generate ./...</span><br><span class="line">go: downloading github.com/cilium/ebpf v0.8.2-0.20220424153111-6da9518107a8</span><br><span class="line">go: downloading golang.org/x/sys v0.0.0-20211001092434-39dca1131b70</span><br><span class="line">Compiled /ebpf/examples/cgroup_skb/bpf_bpfel.o</span><br><span class="line">Stripped /ebpf/examples/cgroup_skb/bpf_bpfel.o</span><br><span class="line">Wrote /ebpf/examples/cgroup_skb/bpf_bpfel.go</span><br><span class="line">Compiled /ebpf/examples/cgroup_skb/bpf_bpfeb.o</span><br><span class="line">Stripped /ebpf/examples/cgroup_skb/bpf_bpfeb.o</span><br><span class="line">Wrote /ebpf/examples/cgroup_skb/bpf_bpfeb.go</span><br><span class="line">Compiled /ebpf/examples/fentry/bpf_bpfeb.o</span><br><span class="line">Stripped /ebpf/examples/fentry/bpf_bpfeb.o</span><br><span class="line">Wrote /ebpf/examples/fentry/bpf_bpfeb.go</span><br><span class="line">Compiled /ebpf/examples/fentry/bpf_bpfel.o</span><br><span class="line">Stripped /ebpf/examples/fentry/bpf_bpfel.o</span><br><span class="line">Wrote /ebpf/examples/fentry/bpf_bpfel.go</span><br><span class="line">Compiled /ebpf/examples/kprobe/bpf_bpfel.o</span><br><span class="line">Stripped /ebpf/examples/kprobe/bpf_bpfel.o</span><br><span class="line">Wrote /ebpf/examples/kprobe/bpf_bpfel.go</span><br><span class="line">Stripped /ebpf/examples/uretprobe/bpf_bpfel_x86.o</span><br><span class="line">... ...</span><br><span class="line">Wrote /ebpf/examples/uretprobe/bpf_bpfel_x86.go</span><br><span class="line">ln -srf testdata/loader-clang-14-el.elf testdata/loader-el.elf</span><br><span class="line">ln -srf testdata/loader-clang-14-eb.elf testdata/loader-eb.elf</span><br><span class="line">make: Leaving directory &#x27;/ebpf&#x27;</span><br><span class="line">make: Leaving directory &#x27;/root/go/src/github.com/cilium/ebpf&#x27;</span><br></pre></td></tr></table></figure>

<p>ä»¥uretprobeä¸‹é¢çš„ebpfä¸ºä¾‹ï¼Œæˆ‘ä»¬è¿è¡Œä¸€ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$go run -exec sudo uretprobe/*.go</span><br><span class="line">2022/06/05 18:23:23 Listening for events..</span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€ä¸€ä¸ªæ–°çš„terminalï¼Œç„¶ååœ¨ç”¨æˆ·homeç›®å½•ä¸‹æ‰§è¡Œvi .bashrcã€‚åœ¨ä¸Šé¢çš„uretprobeç¨‹åºçš„æ‰§è¡Œçª—å£æˆ‘ä»¬èƒ½çœ‹åˆ°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">2022/06/05 18:24:34 Listening for events..</span><br><span class="line">2022/06/05 18:24:42 /bin/bash:readline return value: vi .bashrc</span><br></pre></td></tr></table></figure>

<p>è¿™å°±è¡¨æ˜uretprobeä¸‹é¢çš„ebpfç¨‹åºå¦‚é¢„æœŸåœ°æ‰§è¡Œäº†ã€‚</p>
<h3 id="ä¸‰-ä½¿ç”¨cilium-ebpfä¸ºå‰æ–‡çš„Hello-World-eBPFç¨‹åºå¼€å‘ç”¨æˆ·æ€éƒ¨åˆ†"><a href="#ä¸‰-ä½¿ç”¨cilium-ebpfä¸ºå‰æ–‡çš„Hello-World-eBPFç¨‹åºå¼€å‘ç”¨æˆ·æ€éƒ¨åˆ†" class="headerlink" title="ä¸‰. ä½¿ç”¨cilium/ebpfä¸ºå‰æ–‡çš„Hello World eBPFç¨‹åºå¼€å‘ç”¨æˆ·æ€éƒ¨åˆ†"></a>ä¸‰. ä½¿ç”¨cilium/ebpfä¸ºå‰æ–‡çš„Hello World eBPFç¨‹åºå¼€å‘ç”¨æˆ·æ€éƒ¨åˆ†</h3><p>æœ‰äº†å¯¹cilium/ebpfç¤ºä¾‹ç¨‹åºçš„åˆæ­¥äº†è§£ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥ä¸ºå‰é¢çš„<a href="https://tonybai.com/2022/07/05/develop-hello-world-ebpf-program-in-c-from-scratch">ã€Šä½¿ç”¨Cè¯­è¨€ä»å¤´å¼€å‘ä¸€ä¸ªHello Worldçº§åˆ«çš„eBPFç¨‹åºã€‹</a>ä¸€æ–‡ä¸­çš„é‚£ä¸ªhelloworld ebpfç¨‹åºå¼€å‘ç”¨æˆ·æ€éƒ¨åˆ†ã€‚</p>
<p>å›é¡¾ä¸€ä¸‹é‚£ä¸ªhello world ebpfç¨‹åºçš„Cæºç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// github.com/bigwhite/experiments/tree/master/ebpf-examples/helloworld-go/helloworld.bpf.c</span><br><span class="line">#include &lt;linux/bpf.h&gt;</span><br><span class="line">#include &lt;bpf/bpf_helpers.h&gt;</span><br><span class="line"></span><br><span class="line">SEC(&quot;tracepoint/syscalls/sys_enter_execve&quot;)</span><br><span class="line"></span><br><span class="line">int bpf_prog(void *ctx) &#123;</span><br><span class="line">  char msg[] = &quot;Hello, World!&quot;;</span><br><span class="line">  bpf_printk(&quot;invoke bpf_prog: %s\n&quot;, msg);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">char LICENSE[] SEC(&quot;license&quot;) = &quot;Dual BSD/GPL&quot;;</span><br></pre></td></tr></table></figure>

<p>å½“è¿™ä¸ªebpfç¨‹åºè¢«åŠ è½½åˆ°å†…æ ¸ä¸­åï¼Œæ¯å½“execveè¿™ä¸ªç³»ç»Ÿè°ƒç”¨è¢«æ‰§è¡Œï¼Œè¯¥ebpfç¨‹åºéƒ½ä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œæˆ‘ä»¬å°±ä¼šåœ¨/sys/kernel/debug/tracing/trace_pipeä¸­çœ‹åˆ°å¯¹åº”çš„æ—¥å¿—è¾“å‡ºã€‚</p>
<h4 id="1-ä½¿ç”¨bpf2goå°†ebpfæ ¸å¿ƒæ€ç¨‹åºè½¬æ¢ä¸ºGoä»£ç "><a href="#1-ä½¿ç”¨bpf2goå°†ebpfæ ¸å¿ƒæ€ç¨‹åºè½¬æ¢ä¸ºGoä»£ç " class="headerlink" title="1. ä½¿ç”¨bpf2goå°†ebpfæ ¸å¿ƒæ€ç¨‹åºè½¬æ¢ä¸ºGoä»£ç "></a>1. ä½¿ç”¨bpf2goå°†ebpfæ ¸å¿ƒæ€ç¨‹åºè½¬æ¢ä¸ºGoä»£ç </h4><p>æ ¹æ®æˆ‘ä»¬åœ¨å‰é¢æ¢ç´¢cilium/ebpfç¤ºä¾‹ç¨‹åºæ—¶æ‰€å¾—åˆ°çš„â€œå¥—è·¯â€ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥ç¬¬ä¸€ä¸ªè¦åšçš„å°±æ˜¯å°†helloworld.bpf.cè½¬æ¢ä¸ºGoä»£ç æ–‡ä»¶ï¼Œè¿™ä¸€è½¬æ¢è¿‡ç¨‹ä¸å¯ç¼ºå°‘çš„å·¥å…·å°±æ˜¯cilium/ebpfæä¾›çš„bpf2goå·¥å…·ï¼Œæˆ‘ä»¬å…ˆæ¥å®‰è£…ä¸€ä¸‹è¯¥å·¥å…·ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$go install github.com/cilium/ebpf/cmd/bpf2go@latest</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨bpf2goå·¥å…·å°†helloworld.ebpf.cè½¬æ¢ä¸ºå¯¹åº”çš„goæºæ–‡ä»¶ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$GOPACKAGE=main bpf2go -cc clang-10 -cflags &#x27;-O2 -g -Wall -Werror&#x27; -target bpfel,bpfeb bpf helloworld.bpf.c -- -I /home/tonybai/test/ebpf/libbpf/include/uapi -I /usr/local/bpf/include -idirafter /usr/local/include -idirafter /usr/lib/llvm-10/lib/clang/10.0.0/include -idirafter /usr/include/x86_64-linux-gnu -idirafter /usr/include</span><br><span class="line"></span><br><span class="line">Compiled /home/tonybai/go/src/github.com/bigwhite/experiments/ebpf-examples/helloworld-go/bpf_bpfel.o</span><br><span class="line">Stripped /home/tonybai/go/src/github.com/bigwhite/experiments/ebpf-examples/helloworld-go/bpf_bpfel.o</span><br><span class="line">Wrote /home/tonybai/go/src/github.com/bigwhite/experiments/ebpf-examples/helloworld-go/bpf_bpfel.go</span><br><span class="line">Compiled /home/tonybai/go/src/github.com/bigwhite/experiments/ebpf-examples/helloworld-go/bpf_bpfeb.o</span><br><span class="line">Stripped /home/tonybai/go/src/github.com/bigwhite/experiments/ebpf-examples/helloworld-go/bpf_bpfeb.o</span><br><span class="line">Wrote /home/tonybai/go/src/github.com/bigwhite/experiments/ebpf-examples/helloworld-go/bpf_bpfeb.go</span><br></pre></td></tr></table></figure>

<p>ä¸è¿‡è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯bpf2goå‘½ä»¤è¡Œåé¢çš„ä¸€ç³»åˆ—æä¾›ç»™clangç¼–è¯‘å™¨çš„å¤´æ–‡ä»¶å¼•ç”¨è·¯å¾„å‚è€ƒäº†<a href="https://tonybai.com/2022/07/05/develop-hello-world-ebpf-program-in-c-from-scratch">ã€Šä½¿ç”¨Cè¯­è¨€ä»å¤´å¼€å‘ä¸€ä¸ªHello Worldçº§åˆ«çš„eBPFç¨‹åºã€‹</a>ä¸€æ–‡ä¸­çš„Makefileã€‚å¦‚æœæŒ‰ç…§è¿™äº›å¤´æ–‡ä»¶è·¯å¾„æ¥å¼•ç”¨ï¼Œè™½ç„¶bpf2goè½¬æ¢å¯ä»¥æˆåŠŸï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦ä¾èµ–å¹¶å®‰è£…libbpfè¿™ä¸ªåº“ï¼Œè¿™æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚</p>
<p>cilium/ebpfåœ¨examplesä¸­æä¾›äº†ä¸€ä¸ªheadersç›®å½•ï¼Œè¿™ä¸ªç›®å½•ä¸­åŒ…å«äº†å¼€å‘ebpfç¨‹åºç”¨æˆ·æ€éƒ¨åˆ†æ‰€éœ€çš„æ‰€æœ‰å¤´æ–‡ä»¶ï¼Œæˆ‘ä»¬ä½¿ç”¨å®ƒä½œä¸ºæˆ‘ä»¬çš„å¤´æ–‡ä»¶å¼•ç”¨è·¯å¾„ã€‚ä¸è¿‡è¦æƒ³åŸºäºè¿™ä¸ªheadersç›®å½•æ„å»ºebpfï¼Œæˆ‘ä»¬éœ€è¦å°†helloworld.bpf.cä¸­çš„åŸå¤´æ–‡ä»¶includeè¯­å¥ç”±ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#include &lt;linux/bpf.h&gt;</span><br><span class="line">#include &lt;bpf/bpf_helpers.h&gt;</span><br></pre></td></tr></table></figure>

<p>æ”¹ä¸ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#include &quot;common.h&quot;</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥æˆ‘ä»¬å†æ¥æ‰§è¡Œbpf2goå·¥å…·è¿›è¡Œè½¬æ¢ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$GOPACKAGE=main bpf2go -cc clang-10 -cflags &#x27;-O2 -g -Wall -Werror&#x27; -target bpfel,bpfeb bpf helloworld.bpf.c -- -I /home/tonybai/go/src/github.com/cilium/ebpf/examples/headers</span><br><span class="line"></span><br><span class="line">Compiled /home/tonybai/go/src/github.com/bigwhite/experiments/ebpf-examples/helloworld-go/bpf_bpfel.o</span><br><span class="line">Stripped /home/tonybai/go/src/github.com/bigwhite/experiments/ebpf-examples/helloworld-go/bpf_bpfel.o</span><br><span class="line">Wrote /home/tonybai/go/src/github.com/bigwhite/experiments/ebpf-examples/helloworld-go/bpf_bpfel.go</span><br><span class="line">Compiled /home/tonybai/go/src/github.com/bigwhite/experiments/ebpf-examples/helloworld-go/bpf_bpfeb.o</span><br><span class="line">Stripped /home/tonybai/go/src/github.com/bigwhite/experiments/ebpf-examples/helloworld-go/bpf_bpfeb.o</span><br><span class="line">Wrote /home/tonybai/go/src/github.com/bigwhite/experiments/ebpf-examples/helloworld-go/bpf_bpfeb.go</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬çœ‹åˆ°bpf2goé¡ºåˆ©ç”Ÿæˆebpfå­—èŠ‚ç ä¸å¯¹åº”çš„Goæºæ–‡ä»¶ã€‚</p>
<h4 id="2-æ„å»ºhelloworld-ebpfç¨‹åºç”¨æˆ·æ€éƒ¨åˆ†"><a href="#2-æ„å»ºhelloworld-ebpfç¨‹åºç”¨æˆ·æ€éƒ¨åˆ†" class="headerlink" title="2. æ„å»ºhelloworld ebpfç¨‹åºç”¨æˆ·æ€éƒ¨åˆ†"></a>2. æ„å»ºhelloworld ebpfç¨‹åºç”¨æˆ·æ€éƒ¨åˆ†</h4><p>ä¸‹é¢æ˜¯å‚è€ƒcilium/ebpfç¤ºä¾‹è€Œæ„å»ºçš„helloword ebpfç¨‹åºç”¨æˆ·æ€éƒ¨åˆ†çš„main.goæºç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// github.com/bigwhite/experiments/ebpf-examples/helloworld-go/main.go</span><br><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">    &quot;log&quot;</span><br><span class="line">    &quot;os&quot;</span><br><span class="line">    &quot;os/signal&quot;</span><br><span class="line">    &quot;syscall&quot;</span><br><span class="line"></span><br><span class="line">    &quot;github.com/cilium/ebpf/link&quot;</span><br><span class="line">    &quot;github.com/cilium/ebpf/rlimit&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    stopper := make(chan os.Signal, 1)</span><br><span class="line">    signal.Notify(stopper, os.Interrupt, syscall.SIGTERM)</span><br><span class="line"></span><br><span class="line">    // Allow the current process to lock memory for eBPF resources.</span><br><span class="line">    if err := rlimit.RemoveMemlock(); err != nil &#123;</span><br><span class="line">        log.Fatal(err)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Load pre-compiled programs and maps into the kernel.</span><br><span class="line">    objs := bpfObjects&#123;&#125;</span><br><span class="line">    if err := loadBpfObjects(&amp;objs, nil); err != nil &#123;</span><br><span class="line">        log.Fatalf(&quot;loading objects: %s&quot;, err)</span><br><span class="line">    &#125;</span><br><span class="line">    defer objs.Close()</span><br><span class="line"></span><br><span class="line">    //SEC(&quot;tracepoint/syscalls/sys_enter_execve&quot;)</span><br><span class="line">    // attach to xxx</span><br><span class="line">    kp, err := link.Tracepoint(&quot;syscalls&quot;, &quot;sys_enter_execve&quot;, objs.BpfProg, nil)</span><br><span class="line">    if err != nil &#123;</span><br><span class="line">        log.Fatalf(&quot;opening tracepoint: %s&quot;, err)</span><br><span class="line">    &#125;</span><br><span class="line">    defer kp.Close()</span><br><span class="line"></span><br><span class="line">    log.Printf(&quot;Successfully started! Please run \&quot;sudo cat /sys/kernel/debug/tracing/trace_pipe\&quot; to see output of the BPF programs\n&quot;)</span><br><span class="line"></span><br><span class="line">    // Wait for a signal and close the perf reader,</span><br><span class="line">    // which will interrupt rd.Read() and make the program exit.</span><br><span class="line">    &lt;-stopper</span><br><span class="line">    log.Println(&quot;Received signal, exiting program..&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬çŸ¥é“ä¸€ä¸ªebpfç¨‹åºæœ‰å‡ ä¸ªå…³é”®ç»„æˆï¼š</p>
<ul>
<li>ebpfç¨‹åºæ•°æ®</li>
<li>mapï¼šç”¨äºç”¨æˆ·æ€ä¸å†…æ ¸æ€çš„æ•°æ®äº¤äº’</li>
<li>æŒ‚æ¥ç‚¹(attach point)</li>
</ul>
<p>æ ¹æ®<a href="https://github.com/cilium/ebpf/blob/master/ARCHITECTURE.md">cilium/ebpfæ¶æ„</a>çš„è¯´æ˜ï¼ŒebpfåŒ…å°†å‰ä¸¤éƒ¨åˆ†æŠ½è±¡ä¸ºäº†ä¸€ä¸ªæ•°æ®ç»“æ„bpfObjectsï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// github.com/bigwhite/experiments/ebpf-examples/helloworld-go/bpf_bpfel.go</span><br><span class="line"></span><br><span class="line">// bpfObjects contains all objects after they have been loaded into the kernel.</span><br><span class="line">//</span><br><span class="line">// It can be passed to loadBpfObjects or ebpf.CollectionSpec.LoadAndAssign.</span><br><span class="line">type bpfObjects struct &#123;</span><br><span class="line">    bpfPrograms</span><br><span class="line">    bpfMaps</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬çœ‹åˆ°ï¼Œmainå‡½æ•°é€šè¿‡ç”Ÿæˆçš„loadBpfObjectså‡½æ•°å°†ebpfç¨‹åºåŠ è½½åˆ°å†…æ ¸ï¼Œå¹¶å¡«å……bpfObjectsç»“æ„ï¼Œä¸€æ—¦åŠ è½½bpfç¨‹åºæˆåŠŸï¼Œåç»­æˆ‘ä»¬ä¾¿å¯ä»¥ä½¿ç”¨bpfObjectsç»“æ„ä¸­çš„å­—æ®µæ¥å®Œæˆå…¶ä½™æ“ä½œï¼Œæ¯”å¦‚é€šè¿‡linkåŒ…çš„å‡½æ•°å°†bpfç¨‹åºä¸ç›®æ ‡æŒ‚èŠ‚ç‚¹å¯¹æ¥åœ¨ä¸€èµ·(å¦‚æ–‡ä¸­çš„link.Tracepointå‡½æ•°ï¼‰ï¼Œè¿™æ ·æŒ‚æ¥åï¼Œbpfæ‰èƒ½åœ¨å¯¹åº”çš„äº‹ä»¶å‘ç”Ÿåè¢«å›è°ƒæ‰§è¡Œã€‚</p>
<p>ä¸‹é¢ç¼–è¯‘æ‰§è¡Œä¸€ä¸‹è¯¥helloworldç¤ºä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$go run -exec sudo main.go bpf_bpfel.go</span><br><span class="line">[sudo] password for tonybai:</span><br><span class="line">2022/06/05 14:12:40 Successfully started! Please run &quot;sudo cat /sys/kernel/debug/tracing/trace_pipe&quot; to see output of the BPF programs</span><br></pre></td></tr></table></figure>

<p>ä¹‹åæ–°æ‰“å¼€ä¸€ä¸ªçª—å£ï¼Œæ‰§è¡Œsudo cat /sys/kernel/debug/tracing/trace_pipeï¼Œå½“execveè¢«è°ƒç”¨æ—¶ï¼Œæˆ‘ä»¬å°±èƒ½çœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„æ—¥å¿—è¾“å‡ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;...&gt;-551077  [000] .... 6062226.208943: 0: invoke bpf_prog: Hello, World!</span><br><span class="line">&lt;...&gt;-551077  [000] .... 6062226.209098: 0: invoke bpf_prog: Hello, World!</span><br><span class="line">&lt;...&gt;-551079  [007] .... 6062226.215421: 0: invoke bpf_prog: Hello, World!</span><br><span class="line">&lt;...&gt;-551079  [007] .... 6062226.215578: 0: invoke bpf_prog: Hello, World!</span><br><span class="line">&lt;...&gt;-554756  [007] .... 6063476.785212: 0: invoke bpf_prog: Hello, World!</span><br><span class="line">&lt;...&gt;-554756  [007] .... 6063476.785378: 0: invoke bpf_prog: Hello, World!</span><br></pre></td></tr></table></figure>

<h4 id="3-ä½¿ç”¨go-generateæ¥é©±åŠ¨bpf2goçš„è½¬æ¢"><a href="#3-ä½¿ç”¨go-generateæ¥é©±åŠ¨bpf2goçš„è½¬æ¢" class="headerlink" title="3. ä½¿ç”¨go generateæ¥é©±åŠ¨bpf2goçš„è½¬æ¢"></a>3. ä½¿ç”¨go generateæ¥é©±åŠ¨bpf2goçš„è½¬æ¢</h4><p>åœ¨ç”Ÿæˆä»£ç æ–¹é¢ï¼ŒGoå·¥å…·é“¾åŸç”Ÿæä¾›äº†go generateå·¥å…·ï¼Œcilium/ebpfçš„examplesä¸­ä¹Ÿæ˜¯åˆ©ç”¨go generateæ¥é©±åŠ¨bpf2goå°†bpfç¨‹åºè½¬æ¢ä¸ºGoæºæ–‡ä»¶çš„ï¼Œè¿™é‡Œæˆ‘ä»¬ä¹Ÿæ¥åšä¸€ä¸‹æ”¹é€ ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬åœ¨main.goçš„mainå‡½æ•°ä¸Šé¢å¢åŠ ä¸€è¡Œgo:generateæŒ‡ç¤ºè¯­å¥ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// github.com/bigwhite/experiments/ebpf-examples/helloworld-go/main.go</span><br><span class="line"></span><br><span class="line">// $BPF_CLANG, $BPF_CFLAGS and $BPF_HEADERS are set by the Makefile.</span><br><span class="line">//go:generate bpf2go -cc $BPF_CLANG -cflags $BPF_CFLAGS -target bpfel,bpfeb bpf helloworld.bpf.c -- -I $BPF_HEADERS</span><br><span class="line">func main() &#123;</span><br><span class="line">    stopper := make(chan os.Signal,  1)</span><br><span class="line">    ... ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å½“æˆ‘ä»¬æ˜¾å¼æ‰§è¡Œgo generateè¯­å¥æ—¶ï¼Œgo generateä¼šæ‰«æåˆ°è¯¥æŒ‡ç¤ºè¯­å¥ï¼Œå¹¶æ‰§è¡Œåé¢çš„å‘½ä»¤ã€‚è¿™é‡Œä½¿ç”¨äº†å‡ ä¸ªå˜é‡ï¼Œå˜é‡æ˜¯å®šä¹‰åœ¨Makefileä¸­çš„ã€‚å½“ç„¶å¦‚æœä½ ä¸æƒ³ä½¿ç”¨Makefileï¼Œä¹Ÿå¯ä»¥å°†å˜é‡æ›¿æ¢ä¸ºç›¸åº”çš„å€¼ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨Makefileï¼Œä¸‹é¢æ˜¯Makefileçš„å†…å®¹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// github.com/bigwhite/experiments/ebpf-examples/helloworld-go/Makefile</span><br><span class="line"></span><br><span class="line">CLANG ?= clang-10</span><br><span class="line">CFLAGS ?= -O2 -g -Wall -Werror</span><br><span class="line"></span><br><span class="line">LIBEBPF_TOP = /home/tonybai/go/src/github.com/cilium/ebpf</span><br><span class="line">EXAMPLES_HEADERS = $(LIBEBPF_TOP)/examples/headers</span><br><span class="line"></span><br><span class="line">all: generate</span><br><span class="line"></span><br><span class="line">generate: export BPF_CLANG=$(CLANG)</span><br><span class="line">generate: export BPF_CFLAGS=$(CFLAGS)</span><br><span class="line">generate: export BPF_HEADERS=$(EXAMPLES_HEADERS)</span><br><span class="line">generate:</span><br><span class="line">    go generate ./...</span><br></pre></td></tr></table></figure>

<p>æœ‰äº†è¯¥Makefileåï¼Œæˆ‘ä»¬æ‰§è¡Œmakeå‘½ä»¤ä¾¿å¯ä»¥æ‰§è¡Œbpf2goå¯¹bpfç¨‹åºçš„è½¬æ¢ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$make</span><br><span class="line">go generate ./...</span><br><span class="line">Compiled /home/tonybai/go/src/github.com/bigwhite/experiments/ebpf-examples/helloworld-go/bpf_bpfel.o</span><br><span class="line">Stripped /home/tonybai/go/src/github.com/bigwhite/experiments/ebpf-examples/helloworld-go/bpf_bpfel.o</span><br><span class="line">Wrote /home/tonybai/go/src/github.com/bigwhite/experiments/ebpf-examples/helloworld-go/bpf_bpfel.go</span><br><span class="line">Compiled /home/tonybai/go/src/github.com/bigwhite/experiments/ebpf-examples/helloworld-go/bpf_bpfeb.o</span><br><span class="line">Stripped /home/tonybai/go/src/github.com/bigwhite/experiments/ebpf-examples/helloworld-go/bpf_bpfeb.o</span><br><span class="line">Wrote /home/tonybai/go/src/github.com/bigwhite/experiments/ebpf-examples/helloworld-go/bpf_bpfeb.go</span><br></pre></td></tr></table></figure>

<h3 id="å››-å°ç»“"><a href="#å››-å°ç»“" class="headerlink" title="å››. å°ç»“"></a>å››. å°ç»“</h3><p>æœ¬æ–‡æˆ‘ä»¬è®²è§£äº†å¦‚ä½•åŸºäºcilium/ebpfåŒ…æ¥å¼€å‘ebpfçš„ç”¨æˆ·æ€éƒ¨åˆ†ã€‚</p>
<p>ebpfå€Ÿé‰´äº†libbpfçš„æ€è·¯ï¼Œé€šè¿‡ç”Ÿæˆä»£ç ä¸æ•°æ®å†…åµŒçš„æ–¹å¼æ¥æ„å»ºebpfçš„ç”¨æˆ·æ€éƒ¨åˆ†ã€‚</p>
<p>ebpfæä¾›äº†bpf2goå·¥å…·ï¼Œå¯ä»¥å°†bpfçš„Cæºç è½¬æ¢ä¸ºç›¸åº”çš„goæºç ã€‚</p>
<p>ebpfå°†bpfç¨‹åºæŠ½è±¡ä¸ºbpfObjectsï¼Œé€šè¿‡ç”Ÿæˆçš„loadBpfObjectså®Œæˆbpfç¨‹åºåŠ è½½åˆ°å†…æ ¸çš„è¿‡ç¨‹ï¼Œç„¶ååˆ©ç”¨ebpfåº“æä¾›çš„è¯¸å¦‚linkä¹‹ç±»çš„åŒ…å®ç°ebpfä¸å†…æ ¸äº‹ä»¶çš„å…³è”ã€‚</p>
<p>ebpfåŒ…çš„ç©æ³•è¿˜æœ‰å¾ˆå¤šï¼Œè¿™ä¸€ç¯‡ä»…ä»…æ˜¯ä¸ºäº†æ‰“å¥½åŸºç¡€ï¼Œåœ¨åç»­æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è¿˜ä¼šé’ˆå¯¹å„ç§ç±»å‹çš„bpfç¨‹åºåšè¿›ä¸€æ­¥å­¦ä¹ å’Œè¯´æ˜ã€‚</p>
<p>æœ¬æ–‡ä»£ç å¯ä»¥åœ¨<a href="https://github.com/bigwhite/experiments/tree/master/ebpf-examples/helloworld-go">è¿™é‡Œ</a>ä¸‹è½½ã€‚</p>
<h3 id="æ— -å‚è€ƒèµ„æ–™"><a href="#æ— -å‚è€ƒèµ„æ–™" class="headerlink" title="æ— . å‚è€ƒèµ„æ–™"></a>æ— . å‚è€ƒèµ„æ–™</h3><ul>
<li><a href="https://www.ebpf.top/post/ebpf_go/">ä½¿ç”¨Goè¯­è¨€ç®¡ç†å’Œåˆ†å‘ebpfç¨‹åº</a> â€“ <a href="https://www.ebpf.top/post/ebpf_go/">https://www.ebpf.top/post/ebpf_go/</a></li>
<li><a href="https://lpc.events/event/4/contributions/449/attachments/239/529/A_pure_Go_eBPF_library.pdf">A Pure Go eBPF library</a> â€“ <a href="https://lpc.events/event/4/contributions/449/attachments/239/529/A_pure_Go_eBPF_library.pdf">https://lpc.events/event/4/contributions/449/attachments/239/529/A_pure_Go_eBPF_library.pdf</a></li>
<li><a href="https://github.com/cilium/ebpf/blob/master/ARCHITECTURE.md">cilium ebpf library architecture</a> â€“ <a href="https://github.com/cilium/ebpf/blob/master/ARCHITECTURE.md">https://github.com/cilium/ebpf/blob/master/ARCHITECTURE.md</a></li>
</ul>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>æœåŠ¡å™¨</tag>
      </tags>
  </entry>
  <entry>
    <title>macä¸‹.netç¯å¢ƒé—®é¢˜</title>
    <url>/dotnet-env/</url>
    <content><![CDATA[<div class=".article-gallery"><h1 id="å®˜æ–¹æ–‡æ¡£"><a href="#å®˜æ–¹æ–‡æ¡£" class="headerlink" title="å®˜æ–¹æ–‡æ¡£"></a>å®˜æ–¹æ–‡æ¡£</h1><ul>
<li><a href="https://learn.microsoft.com/zh-cn/dotnet/core/runtime-discovery/troubleshoot-app-launch?pivots=os-macos">https://learn.microsoft.com/zh-cn/dotnet/core/runtime-discovery/troubleshoot-app-launch?pivots=os-macos</a></li>
</ul>
<p>æˆ‘é‡åˆ°çš„é—®é¢˜æ˜¯macä¸Šè£…äº†å¤šä¸ª.netç¯å¢ƒï¼Œåœ¨Riderä¸‹è¿è¡Œ.netç¨‹åºæŠ¥é”™ï¼Œ.NET location: Not foundã€‚</p>
<h1 id="netç›¸å…³è·¯å¾„"><a href="#netç›¸å…³è·¯å¾„" class="headerlink" title=".netç›¸å…³è·¯å¾„"></a>.netç›¸å…³è·¯å¾„</h1><ol>
<li><p>Macä¸‹.netçš„å®‰è£…è·¯å¾„åœ¨è¯¥æ–‡ä»¶ä¸‹</p>
<p><code>/etc/dotnet/install_location</code></p>
</li>
<li><p>æˆ‘çš„ç”µè„‘ä¸Šä¸¤ä¸ª.netçš„è·¯å¾„åœ¨</p>
<ul>
<li>/usr/local/share/dotnet/</li>
<li>~/.dotnet</li>
</ul>
</li>
<li><p>åˆ é™¤ä¸€ä¸ªå¤šä½™çš„ï¼Œåªä¿ç•™ä¸€ä¸ª</p>
</li>
</ol>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>etcd goå®¢æˆ·ç«¯æ— æ³•æ­£å¸¸è¿æ¥</title>
    <url>/etcd_go_proxy/</url>
    <content><![CDATA[<div class=".article-gallery"><h1 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h1><p>golangé¡¹ç›®åœ¨Windowsä¸‹å¼€å‘æ²¡é—®é¢˜ï¼Œæ¢åˆ°Linuxä¸‹å‘ç°etcdæ— æ³•è¿æ¥ã€‚</p>
<h1 id="é—®é¢˜æ’æŸ¥"><a href="#é—®é¢˜æ’æŸ¥" class="headerlink" title="é—®é¢˜æ’æŸ¥"></a>é—®é¢˜æ’æŸ¥</h1><ol>
<li>æ’æŸ¥ç½‘ç»œã€‚Linuxæœºå™¨å’ŒetcdæœåŠ¡ä¹‹å‰ç½‘ç»œæ˜¯é€šçš„</li>
<li>æ’æŸ¥etcdç”¨æˆ·åï¼Œå¯†ç ã€‚ä½¿ç”¨etcdctlå‘ç°æ˜¯èƒ½æ­£å¸¸è·å–å€¼çš„</li>
<li>é™çº§etcd clientV3ç‰ˆæœ¬ï¼Œé™åˆ°ä¹‹å‰ç¡®è®¤æ²¡é—®é¢˜çš„ç‰ˆæœ¬ï¼Œå‘ç°è¿˜æ˜¯ä¸è¡Œ</li>
<li>åŸºæœ¬ç¡®è®¤æ˜¯è¿™å°Linuxæœºå™¨æœ‰ä¸€äº›ä»€ä¹ˆç‰¹åˆ«çš„è®¾ç½®</li>
<li>åœ¨æœ¬åœ°å®‰è£…LinuxæœåŠ¡ï¼Œå‘ç°æ— è®ºæ˜¯å¦å¼€å¯å¯†ç éªŒè¯ï¼Œéƒ½èƒ½è¿æ¥æœ¬åœ°etcdæœåŠ¡</li>
<li>ç¡®è®¤æ˜¯ç½‘ç»œçš„é—®é¢˜</li>
<li>æ£€æŸ¥å‘ç°å¼€å¯äº†HTTP_PROXYå’ŒHTTPS_PROXYï¼Œå…³é—­åå¯ä»¥æ­£ç¡®è¿æ¥è¿œç¨‹etcdæœåŠ¡<h1 id="é—®é¢˜åŸå› "><a href="#é—®é¢˜åŸå› " class="headerlink" title="é—®é¢˜åŸå› "></a>é—®é¢˜åŸå› </h1>é—®äº†ä¸‹gpt goClientå’Œetcdctlä¹‹å‰çš„åŒºåˆ«ï¼Œå›ç­”å¦‚ä¸‹ï¼š</li>
</ol>
<p>ä½ é‡åˆ°çš„ç°è±¡æ˜¯ï¼š</p>
<p>ç³»ç»Ÿè®¾ç½®äº† HTTP_PROXYï¼ˆæˆ– http_proxyï¼‰ç¯å¢ƒå˜é‡ã€‚<br>ç”¨ Go çš„ etcd clientï¼ˆå¦‚ go.etcd.io/etcd/client/v3ï¼‰è¿æ¥ etcd å¤±è´¥ã€‚<br>ä½†ç”¨ etcdctl å‘½ä»¤è¡Œå·¥å…·å´èƒ½æ­£å¸¸è¿æ¥ã€‚<br>è¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ªåœ¨ä¼ä¸š/äº‘ç¯å¢ƒä¸‹å¾ˆå¸¸è§çš„æƒ…å†µï¼Œä¸‹é¢è¯¦ç»†è§£é‡ŠåŸå› å’Œè§£å†³åŠæ³•ã€‚</p>
<p>åŸå› åˆ†æ<br>Go çš„ etcd client é»˜è®¤éµå¾ª HTTP(S)_PROXY ç¯å¢ƒå˜é‡ã€‚<br>Go 1.4+ çš„ http(s) åº“ä¼šè‡ªåŠ¨è¯»å– HTTP_PROXYã€HTTPS_PROXYã€NO_PROXY ç­‰å˜é‡ï¼ŒæŠŠæ‰€æœ‰ HTTPã€HTTPS è¯·æ±‚é€šè¿‡ä»£ç†è½¬å‘ã€‚<br>è™½ç„¶ etcd client é»˜è®¤æ˜¯ gRPCï¼Œä½†åº•å±‚ç”¨çš„ net/http/transportï¼Œä¾ç„¶ä¼šè¯»å–ä»£ç†ç¯å¢ƒå˜é‡ã€‚<br>etcdctl é»˜è®¤ä¸èµ°ä»£ç†ã€‚<br>etcdctl ç”¨è‡ªå·±çš„ dial æ–¹å¼ï¼Œä¸ç†ä¼š HTTP_PROXYã€‚<br>etcd èŠ‚ç‚¹é€šå¸¸åœ¨å†…ç½‘ï¼Œèµ°ä»£ç†ä¼šå¤±è´¥ã€‚<br>è§£å†³æ–¹æ³•<br>æ–¹æ¡ˆ1ï¼šè®¾ç½® NO_PROXY<br>è®© Go client ç›´è¿å†…ç½‘ etcdï¼Œä¸èµ°ä»£ç†ï¼Œéœ€è¦è®¾ç½® NO_PROXY å˜é‡ï¼ŒæŒ‡å®š etcd çš„ IP/åŸŸå/ç«¯å£ï¼š</p>
<p>å‡è®¾ etcd åœ°å€ä¸º 10.37.55.13:2369</p>
<p>bash<br>export NO_PROXY=10.37.55.13,127.0.0.1,localhost<br>æˆ–è€…ï¼ˆå¦‚æœç«¯å£ä¹Ÿè¦åŒºåˆ†ï¼Œå¯ä»¥å†™æˆå¦‚ä¸‹ï¼Œä½†ä¸€èˆ¬åªå¡«ä¸»æœºï¼‰ï¼š</p>
<p>bash<br>export NO_PROXY=10.37.55.13,10.37.55.13:2369,127.0.0.1,localhost<br>ä½ å¯ä»¥æŠŠè¿™å¥åŠ åˆ°ä½ çš„æœåŠ¡å¯åŠ¨è„šæœ¬å‰é¢ï¼Œæˆ–è€…åœ¨ shell é‡Œå…¨å±€è®¾ç½®ã€‚</p>
<p>æ–¹æ¡ˆ2ï¼šGo ä»£ç é‡Œç¦ç”¨ä»£ç†<br>å¦‚æœä½ ä¸èƒ½æˆ–ä¸æƒ³æ”¹ç¯å¢ƒå˜é‡ï¼Œå¯ä»¥åœ¨ä»£ç é‡Œç¦ç”¨ä»£ç†ã€‚ä¾‹å¦‚ï¼š</p>
<p>Go<br>import (<br>    â€œnet/httpâ€<br>    â€œgo.etcd.io/etcd/client/v3â€<br>)</p>
<p>tr := http.DefaultTransport.(*http.Transport).Clone()<br>tr.Proxy = nil // ç¦ç”¨ä»£ç†</p>
<p>cli, err := clientv3.New(clientv3.Config{<br>    Endpoints:   []string{â€œ<a href="http://10.37.55.13:2369&quot;}">http://10.37.55.13:2369&quot;}</a>,<br>    DialTimeout: 5 * time.Second,<br>    DialOptions: []grpc.DialOption{<br>        grpc.WithContextDialer(func(ctx context.Context, addr string) (net.Conn, error) {<br>            d := net.Dialer{}<br>            return d.DialContext(ctx, â€œtcpâ€, addr)<br>        }),<br>    },<br>})<br>ä¸è¿‡ç›´æ¥è®¾ç½® NO_PROXY æ›´ç®€å•ã€‚</p>
<p>æ€»ç»“<br>etcdctl ä¸å— HTTP_PROXY å½±å“ï¼›Go etcd client ä¼šè¢« HTTP_PROXY å½±å“ã€‚<br>è§£å†³æ–¹æ¡ˆï¼šè®¾ç½® NO_PROXY åŒ…å«ä½  etcd çš„ IP/åŸŸåã€‚<br>æ¨èæ–¹æ³•ï¼šåœ¨ä½ çš„ shell æˆ–æœåŠ¡å¯åŠ¨è„šæœ¬é‡ŒåŠ ä¸Š export NO_PROXY=â€¦ã€‚</p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>UE</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨Flutterè¿›è¡ŒAPPå¼€å‘æµç¨‹</title>
    <url>/flutter-dev/</url>
    <content><![CDATA[<div class=".article-gallery"><p><a href="https://imgtu.com/i/hBsVC6"><a href="https://z3.ax1x.com/2021/09/01/hBsVC6.md.png" title="hBsVC6.md.png" class="gallery-item" style="box-shadow: none;"> <img src="https://z3.ax1x.com/2021/09/01/hBsVC6.md.png" alt="hBsVC6.md.png"></a></a></p>
<h1 id="èµ„æºåŠ è½½ï¼š"><a href="#èµ„æºåŠ è½½ï¼š" class="headerlink" title="èµ„æºåŠ è½½ï¼š"></a>èµ„æºåŠ è½½ï¼š</h1><h3 id="1-æœ¬åœ°"><a href="#1-æœ¬åœ°" class="headerlink" title="1.æœ¬åœ°"></a>1.æœ¬åœ°</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">static const String DEFAULT_USER_ICON = &#x27;static/images/logo.png&#x27;;</span><br><span class="line">Image.asset(AppICons.DEFAULT_USER_ICON, width: AppICons.USER_ICON_WIDTH, height: AppICons.USER_ICON_HEIGHT),</span><br></pre></td></tr></table></figure>

<h3 id="2-iconfontã€‚-https-www-iconfont-cn"><a href="#2-iconfontã€‚-https-www-iconfont-cn" class="headerlink" title="2.iconfontã€‚ https://www.iconfont.cn/"></a>2.iconfontã€‚ <a href="https://www.iconfont.cn/">https://www.iconfont.cn/</a></h3><p>åœ¨iconfontç½‘ç«™ä¸Šä¼ èµ„æºã€‚ä¸‹è½½åˆ°æœ¬åœ°ï¼Œæ”¾å…¥é¡¹ç›®èµ„æºæ–‡ä»¶å¤¹ä¸‹ã€‚</p>
<p>pubspec.yamlä¸­é…ç½®ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">fonts:</span><br><span class="line">  - family: myIconFont</span><br><span class="line">    fonts:</span><br><span class="line">      - asset: static/font/iconfont.ttf</span><br></pre></td></tr></table></figure>

<h3 id="3-UIç¼–è¾‘å™¨ã€‚-https-norbert515-github-io-widget-maker-website"><a href="#3-UIç¼–è¾‘å™¨ã€‚-https-norbert515-github-io-widget-maker-website" class="headerlink" title="3.UIç¼–è¾‘å™¨ã€‚ https://norbert515.github.io/widget_maker/website/"></a>3.UIç¼–è¾‘å™¨ã€‚ <a href="https://norbert515.github.io/widget_maker/website/">https://norbert515.github.io/widget_maker/website/</a></h3><p><a href="https://github.com/Norbert515/flutter_ide">https://github.com/Norbert515/flutter_ide</a></p>
<p>é¡¹ç›®ä¸­ä½¿ç”¨ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">static const String FONT_FAMILY = &#x27;myIconFont&#x27;;</span><br><span class="line">static const IconData LOGIN_USER = const IconData(0xe652, fontFamily: AppICons.FONT_FAMILY);</span><br><span class="line">iconData: AppICons.LOGIN_USER,</span><br></pre></td></tr></table></figure>

<h1 id="åŸå‹å¼€å‘ï¼š"><a href="#åŸå‹å¼€å‘ï¼š" class="headerlink" title="åŸå‹å¼€å‘ï¼š"></a>åŸå‹å¼€å‘ï¼š</h1><p><a href="https://www.xiaopiu.com/">https://www.xiaopiu.com/</a></p>
<p>åœ¨ä¸Šé¢è®¾è®¡å¼€å‘ï¼Œç„¶åå¯¼å‡ºåˆ°æœ¬åœ°ï¼Œå¯ä»¥æŸ¥çœ‹é‡Œé¢çš„èµ„æºæ–‡ä»¶ã€‚</p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>å‰ç«¯</tag>
      </tags>
  </entry>
  <entry>
    <title>æœåŠ¡å™¨äº‘åŸºç¡€è®¾æ–½ä»‹ç»</title>
    <url>/game-server-cloud/</url>
    <content><![CDATA[<div class=".article-gallery"><p>æœåŠ¡å™¨äº‘åŸºç¡€è®¾æ–½ä»‹ç»</p>
<ul>
<li><h1 id="ä¸ªäººä»‹ç»"><a href="#ä¸ªäººä»‹ç»" class="headerlink" title="ä¸ªäººä»‹ç»"></a>ä¸ªäººä»‹ç»</h1></li>
</ul>
<p>å¤§å®¶å¥½ï¼Œæˆ‘å«å¼ æ³½å¼ºï¼Œå¾ˆè£å¹¸èƒ½æ¥åˆ°è¿™é‡Œå’Œå¤§å®¶ä¸€èµ·åˆ†äº«æœ‰å…³æ¸¸æˆæœåŠ¡å™¨çš„ä¸€äº›ç”Ÿäº§ç¯å¢ƒä¸‹çš„åº”ç”¨å’Œæ¡ˆä¾‹ï¼Œå¸Œæœ›å¤§å®¶å¯¹çº¿ä¸Šç¯å¢ƒçš„æŠ€æœ¯æ–¹æ¡ˆå’Œé€‰å‹æœ‰ä¸€ä¸ªåˆæ­¥çš„äº†è§£ï¼Œè¿™æ ·å¹³æ—¶åœ¨å­¦æ ¡åšä¸€äº›è¯¾è®¾æˆ–é¡¹ç›®çš„æ—¶å€™ï¼Œå¯¹äºæŠ€æœ¯æ–¹æ¡ˆå¤šä¸€äº›é€‰æ‹©ï¼Œæˆ–è€…è¯´å¯ä»¥æ›´æ¥è¿‘çœŸå®ç¯å¢ƒã€‚</p>
<p>å…ˆåšä¸ªç®€å•çš„è‡ªæˆ‘ä»‹ç»å§ã€‚</p>
<span id="more"></span>

<p>ä»æ¯•ä¸šåˆ°ç°åœ¨ä¸€ç›´åœ¨åšæ¸¸æˆåç«¯çš„å¼€å‘ï¼Œåšè¿‡å¤šç§ä¸åŒç±»å‹çš„æ¸¸æˆï¼Œåƒä¼‘é—²/å¡ç‰Œ/MMO/å¼€æ”¾å¤§ä¸–ç•Œï¼Œæ—©æœŸåšè¿‡é¡µæ¸¸ï¼Œåæ¥ä¸»è¦éƒ½æ˜¯åšæ‰‹æ¸¸ã€‚åšè¿‡åƒä¸‡çº§ç”¨æˆ·çš„æ¸¸æˆï¼Œä¹Ÿåšä¸ªæ²¡ä¸Šçº¿å°±æ‹‰å®çš„é¡¹ç›®ã€‚ç»´æŠ¤è¿‡ä¸åŒç¯å¢ƒçš„çº¿ä¸Šé¡¹ç›®ï¼Œä»æœ€æ—©çš„ç‰©ç†æœºä¸Šçš„é¡¹ç›®åˆ°äº‘æœåŠ¡ï¼Œä»¥åŠè¿‘ä¸¤å¹´æ¯”è¾ƒç«çš„å®¹å™¨åŒ–æœåŠ¡ã€‚è¿™äº›ä¹Ÿæ˜¯ä»Šå¤©åˆ†äº«çš„ä¸»é¢˜ã€‚</p>
<p>æˆ‘æ˜¯å»å¹´å¤å¤©åŠ å…¥å­—èŠ‚è·³åŠ¨çš„ï¼Œåœ¨å­—èŠ‚åšæ¸¸æˆå’Œä¹‹å‰æœ€å¤§çš„åŒºåˆ«å°±æ˜¯ï¼Œèº«è¾¹éƒ½æ˜¯ä¸€äº›ä¼˜ç§€çš„åŒäº‹ï¼Œç ”å‘çš„æ°›å›´éå¸¸å¥½ï¼Œç®¡ç†ä¹Ÿæ›´æ‰å¹³åŒ–ã€‚ç°åœ¨åœ¨æŠ€æœ¯ä¸­å¿ƒå‘¢ï¼Œåœ¨åšçš„ä¹Ÿæ˜¯ä¸€äº›æ›´æœ‰æŒ‘æˆ˜çš„äº‹æƒ…ï¼Œå¾—ç›ŠäºæŠ–éŸ³å’Œå¤´æ¡çš„æµé‡å§ï¼Œç°åœ¨åšçš„æ‰€æœ‰é¡¹ç›®éƒ½æ˜¯ç›´æ¥é¢å‘ç”¨æˆ·çš„ï¼Œå’Œç”¨æˆ·çš„è·ç¦»æ›´è¿‘äº†ã€‚</p>
<p>é‚£ä»æ¯•ä¸šåˆ°ç°åœ¨æ€»ç»“æ”¶è·å‘¢ï¼Œé¦–å…ˆæ˜¯æ‹¥æœ‰äº†å¼ºè€…çš„å‘å‹ï¼Œé‚£ä»Šå¤©å’Œå¤§å®¶æ¥ä¸€èµ·æ¢è®¨å¦‚ä½•æ‹¥æœ‰å¼ºè€…çš„å‘å‹å—ï¼Ÿé‚£æ˜¾ç„¶ä¸æ˜¯å•Šï¼Œè¦ä¸å“è·‘ä¸€å †åŒå­¦äº†ï¼Œä»Šå¤©ä¸»è¦æ˜¯å’Œå¤§å®¶ä¸€èµ·åˆ†äº«ä¸‹å¦‚ä½•å˜å¾—æ›´å¼ºï¼Œå€Ÿç€è¿™æ¬¡åˆ†äº«å¸Œæœ›èƒ½ç»“è¯†æ›´å¤šçš„åŒå­¦ï¼Œä¹ŸæœŸå¾…å¤§å®¶ä»¥åèƒ½æ¥åˆ°å­—èŠ‚ä¸€èµ·åšæ›´æœ‰è¶£çš„æ¸¸æˆã€‚</p>
<p>åœ¨æ­£å¼å¼€å§‹å‰ï¼Œå…ˆèŠä¸€äº›æ¸¸æˆæœåŠ¡å™¨ç ”å‘æ–¹é¢çš„é—®é¢˜å§ï¼Œè¿™ä¹Ÿæ˜¯å¹³æ—¶åœ¨æ ¡æ‹›çš„æ—¶å€™å¾ˆå¤šåŒå­¦ç»å¸¸ä¼šé—®çš„ï¼Œæ¯”å¦‚ï¼Œä½ ä»¬åšæ¸¸æˆæœåŠ¡å™¨ç”¨ä»€ä¹ˆè¯­è¨€å•Šï¼Ÿä»¥æˆ‘æ¥è§¦å’Œäº†è§£åˆ°çš„æ¸¸æˆå‚å•†æ¥çœ‹ï¼Œä¸è´Ÿè´£ä»»çš„è¯´ï¼Œæ¯•ç«Ÿæ˜¯ä¸€ä¸ªæ„Ÿå®˜ä¸Šçš„æ„Ÿå—ï¼Œæ²¡æœ‰å…·ä½“çš„æ•°æ®ç»Ÿè®¡ã€‚å¤§è‡´æƒ…å†µæ˜¯è¿™æ ·çš„ï¼ŒåŒ—äº¬ï¼Œå¤§éƒ¨åˆ†æ¸¸æˆå‚å•†ï¼Œ80%ä»¥ä¸Šéƒ½æ˜¯javaï¼Œæœ€è¿‘å¼€å§‹æœ‰ä¸€äº›golangçš„æ¸¸æˆæœåŠ¡å™¨äº†ï¼Œä¸»è¦æ˜¯ä¼‘é—²ç±»æˆ–slgç±»ï¼Œå‰©ä¸‹çš„ä¸»è¦å°±æ˜¯c++ã€‚å—æ–¹æ¥è¯´ï¼Œä¸»è¦æ˜¯ä¸Šæµ·æ­å·æ·±åœ³å¹¿å·ï¼Œä»¥è…¾è®¯ç½‘æ˜“ä¸ºä»£è¡¨çš„ä¸»è¦æ˜¯c++ã€‚æ€»çš„æ¥è¯´ä¸»è¦è¿˜æ˜¯ä»¥javaå’Œc++ä¸ºä¸»ã€‚å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼Œæ¸¸æˆæœåŠ¡å™¨ä½¿ç”¨åˆ°çš„æŠ€æœ¯æ ˆéƒ½æœ‰å“ªäº›ï¼Ÿè¿™ä¸ªå¯ä»¥è¯´æ¯ä¸ªé¡¹ç›®ä½¿ç”¨åˆ°çš„æŠ€æœ¯æ ˆæ—¢ä¸åŒä¹Ÿç›¸åŒï¼Œä¸åŒä¸»è¦ä½“ç°åœ¨ï¼Œæ¸¸æˆçš„å“ç±»å¤ªå¤šäº†ï¼Œä¸åŒçš„æ¸¸æˆç±»å‹é€‚åˆçš„æ¡†æ¶ä¸å¤ªä¸€æ ·ï¼Œæ¯”å¦‚ä¼‘é—²æ¸¸æˆå¼±äº¤äº’å’ŒMMOäº¤äº’æ€§å¼ºçš„ï¼Œä¸€èˆ¬ä½¿ç”¨çš„æ¡†æ¶ä¸ä¸€æ ·ï¼Œå†æ¯”å¦‚FPSç­‰ä¸€äº›ç«æŠ€ç±»çš„æ¸¸æˆåˆä¸ä¸€æ ·ï¼Œå†åŠ ä¸Šæ¯ä¸ªå…¬å¸æˆ–è€…å·¥ä½œå®¤å› ä¸ºä¸€äº›å†å²åŸå› ï¼Œæ¡†æ¶ä¹Ÿä¸ä¸€æ ·ã€‚ä½†æ˜¯ä»å¦å¤–ä¸€ä¸ªå±‚é¢è¯´ï¼Œè¿™äº›ä¸åŒçš„æ¡†æ¶åŸºæœ¬ä¸Šéƒ½æ˜¯å¯¹åº•å±‚ç»„ä»¶çš„å°è£…ï¼Œè€Œç”±äºæ¸¸æˆæœåŠ¡å™¨æ˜¯ç½‘ç»œåº”ç”¨ï¼Œé‚£åº•å±‚ç»„ä»¶ä¸»è¦é›†ä¸­åœ¨ç½‘ç»œå’Œå­˜å‚¨ä»¥åŠçº¿ç¨‹è°ƒåº¦ä¸Šï¼Œå…³äºè¿™äº›å‘¢å…¶å®å¤§å­¦è¯¾ç¨‹ä¸Šéƒ½æœ‰æ¶‰åŠï¼Œé‚£å…¶å®å¤§å®¶åªè¦æŠŠåŸºç¡€ç†è®ºçŸ¥è¯†å­¦å¥½ï¼Œä¸ç®¡å“ªä¸ªé¡¹ç›®ä½¿ç”¨ä»€ä¹ˆæ¡†æ¶éƒ½èƒ½å¾ˆå¿«ä¸Šæ‰‹ã€‚é‚£å…·ä½“åˆ°ç½‘ç»œç»„ä»¶ä¸Šï¼Œå¤§å®¶å¦‚æœæƒ³å»å­¦ä¹ çš„è¯ï¼Œå¯ä»¥çœ‹ä¸‹javaçš„nettyåº“ï¼Œæ•°æ®åº“çš„è¯mysql/mongodb/redisäº†ï¼Œç‰¹åˆ«æ˜¯redisæ¨èå¤§å®¶å»å­¦ä¹ ä¸‹ã€‚</p>
<h1 id="åˆ†äº«æ¦‚è¿°"><a href="#åˆ†äº«æ¦‚è¿°" class="headerlink" title="åˆ†äº«æ¦‚è¿°"></a>åˆ†äº«æ¦‚è¿°</h1><p>é‚£æ­£å¼å¼€å§‹ä»Šå¤©çš„åˆ†äº«ä¹‹å‰å‘¢ï¼Œå…ˆå¤§æ¦‚ä»‹ç»ä¸‹åˆ†äº«çš„æ•´ä½“å†…å®¹ï¼Œå¸Œæœ›é€šè¿‡è¿™æ¬¡åˆ†äº«ï¼Œè®©å¤§å®¶å°½å¯èƒ½å¤šçš„äº†è§£åˆ°çœŸå®çš„çº¿ä¸Šç¯å¢ƒä¸­æœåŠ¡å™¨çš„æ–¹æ¡ˆå’ŒåŸç†ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼Œè®¡ç®—/å­˜å‚¨å’Œç½‘ç»œç­‰æ–¹é¢ï¼Œä¸»è¦åˆ†äº«çš„ä¾§é‡ç‚¹æ˜¯ä»‹ç»ä»–ä»¬çš„åŸç†å’Œç‰¹æ€§ï¼Œä»¥åŠå®é™…çš„åº”ç”¨ï¼Œä¸ä¼šè¿‡å¤šçš„æ¶‰åŠåˆ°å…·ä½“ä½¿ç”¨æ–¹é¢ï¼Œå› ä¸ºå¦‚ä½•ä½¿ç”¨è¿™ä¸ªä¸œè¥¿å³ä½¿ä½ ç°åœ¨çœ‹äº†ï¼Œå¯èƒ½åƒäº†æ™šé¥­åå°±å¿˜äº†ï¼Œè€Œä¸”ä½¿ç”¨çš„è¯ç›¸ä¿¡ä»¥åå¤§å®¶é‡åˆ°å…·ä½“æ¡ˆä¾‹è¦å»å®æ“çš„æ—¶å€™å»ç›¸åº”çš„å®˜ç½‘ä¸€çœ‹å°±èƒ½ä¸Šæ‰‹ã€‚ä»Šå¤©ä¸»è¦æ˜¯å’Œå¤§å®¶ä¸€èµ·äº†è§£ä¸‹ä»–ä»¬èƒŒåçš„åŸç†å’Œç‰¹æ€§ä»¥åŠä¸€äº›çœŸå®çš„æ¡ˆä¾‹ï¼Œè¿™æ ·åœ¨ä½ ä»¬ä»¥åå­¦æ ¡çš„ä¸€äº›é¡¹ç›®ä¸­å¯ä»¥å¤šä¸€äº›æŠ€æœ¯é€‰å‹çš„å‚è€ƒï¼Œæ›´æ¥è¿‘äºçº¿ä¸Šç¯å¢ƒã€‚</p>
<p>æˆ‘ä»¬é¦–å…ˆä¼šä»‹ç»ä¸‹äº‘æœåŠ¡çš„æ¦‚è¿°ï¼Œçœ‹ä¸‹æˆ‘ä»¬åœ¨æ¸¸æˆç ”å‘ä¸­ç¢°åˆ°äº†å“ªäº›é—®é¢˜ï¼Œäº‘æœåŠ¡æ˜¯å¦é€‚åˆæˆ‘ä»¬ï¼Œå¸®åŠ©æˆ‘ä»¬è§£å†³äº†è¿™äº›é—®é¢˜ã€‚</p>
<p>æ¥ä¸‹æ¥ä¼šè¯¦ç»†çš„ä»‹ç»ä¸€äº›äº‘åŸºç¡€æœåŠ¡ï¼Œä»¥åŠä»–ä»¬åœ¨æ¸¸æˆæœåŠ¡å™¨ä¸­çš„åº”ç”¨ã€‚</p>
<p>æœ€åæˆ‘ä»¬é€šè¿‡ä¸Šé¢äº†è§£åˆ°çš„æŠ€æœ¯æ–¹æ¡ˆï¼Œå»æ€è€ƒæ€»ç»“ä¸€ä¸‹å…·ä½“æŸä¸ªç±»å‹æ¸¸æˆæœåŠ¡å™¨æ¡ˆä¾‹çš„ä½¿ç”¨ã€‚</p>
<ul>
<li><h1 id="äº‘æœåŠ¡å™¨æ¦‚è¿°"><a href="#äº‘æœåŠ¡å™¨æ¦‚è¿°" class="headerlink" title="äº‘æœåŠ¡å™¨æ¦‚è¿°"></a>äº‘æœåŠ¡å™¨æ¦‚è¿°</h1></li>
</ul>
<p>è®¾æƒ³ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬ç°åœ¨æœ‰ä¸€æ¬¾äº§å“æˆ–æ¸¸æˆè¦å‘å¸ƒï¼Œé‚£æˆ‘ä»¬éœ€è¦è€ƒè™‘å“ªäº›æ–¹é¢å‘¢ï¼Ÿ</p>
<p>é¦–å…ˆæˆ‘ä»¬åœ¨è‡ªå·±çš„å¼€å‘æœºä¸Šå¼€å‘å®Œæˆï¼Œå¹¶ä¸”æµ‹è¯•é€šè¿‡ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è¦å¯¹ç”¨æˆ·æä¾›æœåŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©å°†æœåŠ¡è¿è¡Œåœ¨æˆ‘ä»¬çš„å¼€å‘æœºä¸Šï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç§æ–¹æ¡ˆï¼Œæˆ‘ä»¬éƒ½çŸ¥é“è¿™ç§æ–¹æ¡ˆå¤ªè‰ç‡ï¼Œå…·ä½“è‰ç‡åœ¨å“ªäº›æ–¹é¢å‘¢ï¼Ÿç¨³å®šæ€§ä¸å¤Ÿï¼Œæˆ‘ä»¬çš„ç”µè„‘å¯èƒ½ç”¨æ¥ç©æ¸¸æˆï¼Œç©æ¸¸æˆæœ‰çš„æ—¶å€™è¿˜ä¼šæ­»æœºï¼Œå®¿èˆè¿˜å¯èƒ½ä¼šåœç”µã€‚å®‰å…¨æ€§ä¸å¤Ÿï¼Œæˆ‘ä»¬ç”µè„‘è¿˜è¿è¡Œäº†ä¸€äº›å’Œåº”ç”¨æœ¬èº«æ— å…³çš„å…¶ä»–ç¨‹åºã€‚æ‰©å±•æ€§ä¹Ÿä¸å¤Ÿï¼Œå¦‚æœæˆ‘ä»¬æ¸¸æˆçš„ç”¨æˆ·å¤šäº†ï¼Œcpuï¼Œå†…å­˜ä¸å¤Ÿäº†ï¼Œæˆ‘ä»¬å‡çº§ç”µè„‘ç¡¬ä»¶ï¼Œå¦‚æœæˆ‘ä»¬æ¸¸æˆç”¨æˆ·åˆæµå¤±äº†ï¼Œèµ„æºåˆæº¢å‡ºäº†ï¼Œæˆ‘ä»¬ä¸èƒ½ä¸€ç›´æ¢ç”µè„‘å§ã€‚å¦ä¸€ç§æ–¹æ¡ˆï¼Œæˆ‘ä»¬æŠŠæœåŠ¡éƒ¨ç½²åœ¨ä¸“ç”¨çš„æœåŠ¡å™¨æœºæˆ¿å†…ï¼Œç¨³å®šæ€§å’Œå®‰å…¨æ€§æ¯”æˆ‘ä»¬å¼€å‘æœºä¸Šå¥½å¾ˆå¤šäº†ï¼Œä½†æ˜¯æ‰©å±•æ€§è¿˜æ˜¯ä¸å¤Ÿï¼Œä¸»è¦å—é™äºç¡¬ä»¶ï¼Œå·²ç»å›½é™…åŒ–éƒ¨ç½²é—®é¢˜ã€‚è¿˜æœ‰å°±æ˜¯ç»´æŠ¤æ€§æ–¹é¢ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±å»ç›‘æ§æœºå™¨çš„çŠ¶æ€ï¼ŒåŒ…æ‹¬å†…å­˜ï¼Œcpuï¼Œç½‘ç»œç­‰ã€‚é‚£ä¹ˆæœ‰ä»€ä¹ˆæ–¹æ¡ˆèƒ½è§£å†³æˆ‘ä»¬ä¸Šé¢æåˆ°çš„è¿™äº›é—®é¢˜å‘¢ï¼Ÿäº‘æœåŠ¡å™¨ï¼Œå¤§å®¶è‚¯å®šéƒ½æœ‰ä¸€äº›äº†è§£ã€‚é‚£æˆ‘ä»¬æ¥ä¸‹æ¥å°±æ·±å…¥äº†è§£ä¸‹äº‘æœåŠ¡å™¨çš„ç‰¹æ€§ã€‚</p>
<ul>
<li><strong>äº‘æœåŠ¡æ˜¯ä»€ä¹ˆï¼Ÿ</strong></li>
</ul>
<p>äº‘æœåŠ¡æ˜¯å°†æ•°æ®ä¸­å¿ƒèµ„æºè™šæ‹ŸåŒ–ï¼Œé€šè¿‡äº’è”ç½‘æä¾›ç»™å¤§å®¶ä½¿ç”¨ã€‚äº‘æœåŠ¡çš„è¿™å¥å®šä¹‰éå¸¸ç®€å•ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸¤ä¸ªä¸»è¦çš„åè¯ï¼Œä¸€ä¸ªæ˜¯æ•°æ®ä¸­å¿ƒï¼Œé‚£æ•°æ®ä¸­å¿ƒåˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ•°æ®ä¸­å¿ƒæŒ‡çš„å°±æ˜¯è®¡ç®—ï¼Œå­˜å‚¨ï¼Œç½‘ç»œç­‰ã€‚å¦ä¸€ä¸ªæ˜¯è™šæ‹ŸåŒ–ï¼Œä»€ä¹ˆæ˜¯è™šæ‹ŸåŒ–å‘¢ï¼Ÿè¿™ä¸ªæ¥ä¸‹æ¥æˆ‘ä»¬ä¼šè¯¦ç»†ä»‹ç»ã€‚å›¾ä¸Šæ˜¯å›½å†…å¸¸ç”¨çš„äº‘æœåŠ¡ä¾›åº”å•†ï¼šè…¾è®¯äº‘ï¼Œé˜¿é‡Œäº‘ï¼Œå­—èŠ‚äº‘ã€‚å¯ä»¥çœ‹åˆ°ä»–ä»¬æä¾›çš„äº§å“å’ŒæœåŠ¡éå¸¸å¤šï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä¹Ÿä¼šä»‹ç»ä¸‹ä¸»è¦çš„åŸºç¡€äº‘æœåŠ¡è®¾æ–½ï¼Œä»¥åŠä»–ä»¬åœ¨æ¸¸æˆä¸­çš„åº”ç”¨ã€‚</p>
<ul>
<li><strong>äº‘è®¡ç®—çš„å†å²</strong></li>
</ul>
<p>æˆ‘ä»¬é¦–å…ˆæ¥äº†è§£ä¸‹äº‘è®¡ç®—çš„å†å²ï¼Œå¯¹ä»–çš„å‘å±•æœ‰ä¸ªåŸºæœ¬çš„æ¦‚å¿µã€‚äº‘è®¡ç®—å‘å±•è¿‡ç¨‹ä¸­æœ‰è¿™ä¹ˆå‡ ä¸ªé‡è¦çš„èŠ‚ç‚¹ã€‚é¦–å…ˆæ˜¯è™šæ‹ŸåŒ–ç†è®ºçš„æå‡ºå’Œå‘å±•ï¼Œè™šæ‹ŸåŒ–æŠ€æœ¯ä¸€ä¼šæˆ‘ä»¬ä¼šæ ¹æ®ä¸åŒçš„è¿ç”¨å…·ä½“å±•å¼€ä»‹ç»ã€‚ç„¶åæ˜¯è™šæ‹ŸåŒ–æŠ€æœ¯çš„è½åœ°ï¼Œå…¶ä¸­æœ€é‡è¦çš„2001å¹´åŸºäºx86çš„VMçš„è¯ç”Ÿï¼Œæ„å‘³ç€å¯ä»¥åœ¨ä¸€å°ç‰©ç†æœºä¸Šè¿è¡Œå¤šä¸ªè™šæ‹Ÿæœºï¼Œå¯åŠ¨é€Ÿåº¦å’Œå¼¹æ€§è¿œè¶…è™šæ‹Ÿæœºã€‚å¦ä¸€ä¸ªæ˜¯KVMçš„å‡ºç°ï¼ŒéšåKVMæ¨¡å—çš„æºç è¢«çº³å…¥Linuxå†…æ ¸ï¼Œæ˜¯ç°åœ¨æœ€å¸¸ç”¨çš„æœåŠ¡å™¨è™šæ‹Ÿæœºã€‚åœ¨è™šæ‹ŸåŒ–æŠ€æœ¯æˆç†Ÿä»¥åï¼Œäº‘è®¡ç®—æ‰çœŸæ­£å‡ºç°ï¼Œæ­¤æ—¶åŸºäºè™šæ‹ŸæœºæŠ€æœ¯è¯ç”Ÿäº†å¾ˆå¤šäº‘è®¡ç®—äº§å“ï¼ŒåŒ…æ‹¬IaaS,PaaS,SaaS,FaaS,å…¬æœ‰äº‘,ç§æœ‰äº‘ç­‰ã€‚æ¥ä¸‹æ¥å°±æ˜¯è¿‘å‡ å¹´å¤§ç«çš„å®¹å™¨æŠ€æœ¯ï¼Œå®¹å™¨æŠ€æœ¯å¯¹è½¯ä»¶å¼€å‘è¡Œä¸šå’Œå¾®æœåŠ¡çš„å‘å±•æœ‰ç€æ·±è¿œçš„å½±å“ï¼Œæœ€åå°±æ˜¯k8såœ¨å®¹å™¨ç¼–æ’å¤§æˆ˜çš„èƒœå‡ºã€‚</p>
<ul>
<li><strong>äº‘æœåŠ¡çš„åˆ†ç±»</strong></li>
</ul>
<p>ä¸€åˆ‡çš†æœåŠ¡ï¼Œä»–æ˜¯å°†åŸºäºäº‘çš„ï¼Œä»¥è½¯ä»¶ä¸ºä¸»ä½“è¿›è¡Œäº¤ä»˜çš„ITèµ„æºã€‚æˆ‘ä»¬æ¥çœ‹æœ€åº•å±‚çš„æ•°æ®ä¸­å¿ƒï¼ŒåŒ…æ‹¬æœåŠ¡å™¨ï¼Œå­˜å‚¨ï¼Œç½‘ç»œç­‰ï¼Œåœ¨è¿™ä¹‹ä¸Šé€šè¿‡è™šæ‹ŸåŒ–ä¹‹åä½œä¸ºè™šæ‹Ÿæœºï¼Œç„¶åå†è£…ä¸Šæ“ä½œç³»ç»Ÿï¼Œè¿™å°±æ˜¯ä¸€å°æœ€åŸºç¡€çš„äº‘æœåŠ¡å™¨äº†ï¼Œè¿™å°±å«åŸºç¡€è®¾æ–½å³æœåŠ¡IaaSï¼Œåœ¨è¿™åŸºç¡€ä¹‹ä¸Šå‘¢ï¼Œæˆ‘ä»¬å¯ä»¥å†åŠ ä¸Šæ•°æ®åº“ï¼Œä¸­é—´ä»¶ç­‰ä¸€äº›å·¥å…·ï¼Œä½œä¸ºå¼€å‘å¹³å°æä¾›æœåŠ¡ï¼Œè¿™ä¸ªå°±å«å¹³å°å³æœåŠ¡PaaSã€‚å†å¾€ä¸Šå‘¢ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¼€å‘åº”ç”¨ï¼ŒæŠŠåº”ç”¨æ‹¿å‡ºæ¥ç»™ç”¨æˆ·æä¾›æœåŠ¡ï¼Œè¿™ä¸ªå°±å«è½¯ä»¶å³æœåŠ¡SaaSã€‚æˆ‘ä»¬å¤§æ¦‚çŸ¥é“äº†è¿™ä¸‰ç±»äº‘æœåŠ¡ï¼Œå¦‚æœæŠŠè¿™ä¸‰ç±»æœåŠ¡ä¸¾ä¸ªå…·ä½“çš„ä¾‹å­å‘¢ï¼ŒIaaSå°±å¥½æ¯”ä¸€ä¸ªåœ°å—ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªåœ°å—ä¸Šä¿®å»ºä»»ä½•å»ºç­‘ï¼Œè‡ªç”±åº¦æ¯”è¾ƒé«˜ï¼Œä½†æ˜¯éœ€è¦æˆ‘ä»¬æœ‰å¾ˆå¼ºçš„åŠ¨æ‰‹èƒ½åŠ›ã€‚PaaSå‘¢ï¼Œå°±å¥½æ¯”åœ¨åœ°å—ä¸Šå·²ç»ç»™æˆ‘ä»¬ä¿®å¥½äº†ä¸€äº›å»ºç­‘ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„ä½¿ç”¨ç”¨é€”æ¥è‡ªå·±è£…ä¿®äº†ï¼Œè¿™ä¸ªå°±æ¯”è¾ƒé€‚åˆæœ‰ä¸€å®šåŠ¨æ‰‹èƒ½åŠ›çš„ã€‚æœ€åSaaSå‘¢ï¼Œå°±å¥½æ¯”å›¾ä¹¦é¦†ï¼Œé£Ÿå ‚ä¹‹ç±»çš„ï¼Œå¯ä»¥ç›´æ¥æä¾›æœåŠ¡äº†ï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨å°±å¯ä»¥äº†ã€‚æˆ‘ä»¬å†æ¥çœ‹ä¸‹ï¼Œéƒ½æœ‰å“ªäº›å‚å•†æ¥æä¾›è¿™äº›äº‘æœåŠ¡å‘¢ï¼Ÿé¦–å…ˆæ˜¯åŸºç¡€è®¾æ–½åŒ…æ‹¬å›½å¤–çš„äºšé©¬é€Šï¼ŒGoogleï¼Œå¾®è½¯äº†ï¼Œå›½å†…çš„é˜¿é‡Œï¼Œè…¾è®¯ï¼Œåä¸ºã€‚å­—èŠ‚å‘¢ç°åœ¨ä¸»è¦è¿˜æ˜¯æä¾›ç§æœ‰äº‘ä¸ºä¸»ï¼ŒæœåŠ¡å…¬å¸å†…éƒ¨ã€‚å¹³å°æœåŠ¡å‘¢ï¼Œå¤§éƒ¨åˆ†æä¾›åŸºç¡€æœåŠ¡çš„éƒ½æä¾›å¹³å°æœåŠ¡ï¼Œåƒæˆ‘ä»¬åˆšå¼€å§‹æ”¾çš„äº‘å‚å•†é‚£å¼ å›¾ç‰‡é‡Œä¸€æ ·ï¼Œå­—èŠ‚ä¹Ÿæä¾›äº†å¾ˆå¤šå¹³å°æœåŠ¡ã€‚æœ€åæ˜¯è½¯ä»¶æœåŠ¡ï¼Œè¿™ä¸ªå¤§å®¶æ˜¯å¤§å®¶å¹³æ—¶æ—¥å¸¸ç”Ÿæ´»ä¸­æ¥è§¦æœ€å¤šçš„äº†ã€‚</p>
<ul>
<li><strong>ä»€ä¹ˆæ˜¯****PaaS</strong></li>
</ul>
<p>é‚£ä»€ä¹ˆæ˜¯PaaSå‘¢ï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä»¬å•ç‹¬æŠŠè¿™ä¸ªæ‹¿å‡ºæ¥è¯´å‘¢ï¼Œå› ä¸ºiaaså’ŒSaaSæ¯”è¾ƒå¥½ç†è§£ï¼ŒIaaSå°±æ˜¯CPUå†…å­˜è¿™äº›æœåŠ¡å™¨èµ„æºï¼ŒSaaSå°±æ˜¯è½¯ä»¶æœåŠ¡ã€‚PaaSæ˜¯æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­æ¥è§¦æœ€å¤šçš„ï¼Œä»–æ˜¯ä»¥ä¾¿åˆ©å¼€å‘è€…ä¸ºç›®æ ‡çš„ä¸­é—´ä»¶ã€‚æˆ‘ä»¬å†å›å¤´æ€è€ƒä¸‹ï¼Œæˆ‘ä»¬æœ€å¼€å§‹æå‡ºçš„é—®é¢˜ï¼Œæˆ‘ä»¬çŸ¥é“äº†åœ¨æœ¬åœ°å‘å¸ƒæˆ‘ä»¬çš„æ¸¸æˆæœåŠ¡å™¨ç¨³å®šæ€§ä¸å¤Ÿï¼Œç‰©ç†æœºä¸Šå‘å¸ƒä¸€æ¬¡æ€§æŠ•å…¥æˆæœ¬å’Œç»´æŠ¤æˆæœ¬æ¯”è¾ƒé«˜ï¼Œç°åœ¨æˆ‘ä»¬æƒ³å°†æœåŠ¡å™¨å‘å¸ƒåˆ°äº‘ä¸Šï¼Œåº”è¯¥é‡‡ç”¨å“ªç§æ–¹æ¡ˆå‘¢ï¼Ÿæˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹IaaSï¼Œäº‘æœåŠ¡å™¨ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘è€ƒè™‘cpuï¼Œå†…å­˜è¿™äº›ï¼Œè¿˜å¾—å®‰è£…æˆ‘ä»¬çš„ç¯å¢ƒï¼Œjavaå¼€å‘çš„éœ€è¦å®‰è£…jdkï¼Œç”¨åˆ°æ•°æ®åº“çš„è¯ï¼Œæˆ‘ä»¬è¿˜å¾—å®‰è£…æ•°æ®åº“ï¼Œè¿™äº›ç¯å¢ƒé…ç½®å¥½äº†ä¹‹åæ‰èƒ½è¿è¡Œæˆ‘ä»¬çš„ä»£ç ã€‚é‚£PaaSå‘¢ï¼ŒPaaSå°±æ˜¯ç»™æˆ‘ä»¬æä¾›å¥½äº†å¼€å‘å¹³å°ï¼Œæˆ‘ä»¬ç›´æ¥å¯ä»¥å†™ä»£ç è¿è¡Œäº†ï¼Œéœ€è¦çš„ç¯å¢ƒéƒ½å·²ç»å®‰è£…å¥½äº†ï¼Œå¯¹å¼€å‘è€…æ¥è¯´çœŸçš„å¾ˆå‹å¥½ã€‚é‚£SaaSå‘¢ï¼Œç›´æ¥é¢å‘ç”¨æˆ·æä¾›æœåŠ¡ï¼Œæ¯”å¦‚æˆ‘è¿™æ¬¡çš„PPTä¸»è¦å°±æ˜¯åœ¨é£ä¹¦docä¸Šåœ¨çº¿å†™çš„ã€‚é€šè¿‡ä»–ä»¬è¿™äº›ç‰¹æ€§å‘¢ï¼Œæˆ‘ä»¬å°±èƒ½çŸ¥é“ä»–ä»¬é¢å‘æœåŠ¡çš„ç¾¤ä½“äº†ï¼ŒPaaSé¢å‘è¿ç»´å·¥ç¨‹å¸ˆï¼Œiaasé¢å‘è½¯ä»¶å¼€å‘è€…ï¼ŒSaaSé¢å‘çš„æ˜¯ç”¨æˆ·ã€‚</p>
<ul>
<li><strong>äº‘æœåŠ¡çš„ä¼˜åŠ¿</strong></li>
</ul>
<p>é‚£æˆ‘ä»¬åˆ°ç°åœ¨å¯¹äº‘æœåŠ¡æœ‰äº†ä¸€ä¸ªæ¦‚æ‹¬æ€§çš„äº†è§£ä¹‹åå‘¢ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹ä»–æœ‰å“ªäº›ä¼˜åŠ¿å‘¢ï¼Ÿ</p>
<p>æŒ‰éœ€çµæ´»é…ç½®ï¼šæ ¹æ®æˆ‘ä»¬ç”¨æˆ·çš„é‡çº§é¢„ä¼°èµ„æºçš„é…ç½®ï¼Œç”³è¯·äº‘æœåŠ¡å™¨ã€‚</p>
<p>ç®€åŒ–å®¹é‡ç®¡ç†ï¼šå¦‚æœæˆ‘ä»¬åº”ç”¨çš„äººæ•°æ¯”é¢„æœŸé«˜äº†æˆ–ä½äº†ï¼Œæˆ‘ä»¬éƒ½èƒ½æ‰©ç¼©å®¹æˆ‘ä»¬çš„æœºå™¨ï¼Œç°åœ¨äº‘å‚å•†éƒ½æ”¯æŒåœ¨çº¿æ‰©ç¼©å®¹äº†ã€‚</p>
<ul>
<li><h1 id="åŸºç¡€äº‘æœåŠ¡åŠåº”ç”¨"><a href="#åŸºç¡€äº‘æœåŠ¡åŠåº”ç”¨" class="headerlink" title="åŸºç¡€äº‘æœåŠ¡åŠåº”ç”¨"></a>åŸºç¡€äº‘æœåŠ¡åŠåº”ç”¨</h1></li>
</ul>
<p>ç°åœ¨æˆ‘ä»¬å¯¹äº‘æœåŠ¡æœ‰äº†ä¸€ä¸ªå¤§æ¦‚çš„äº†è§£ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬é’ˆå¯¹æ€§çš„ä»‹ç»ä¸€äº›åŸºç¡€äº‘æœåŠ¡ä»¥åŠä»–ä»¬åœ¨æ¸¸æˆä¸­çš„åº”ç”¨ã€‚ä¸»è¦åŒ…æ‹¬è®¡ç®—ç±»çš„ï¼Œäº‘ä¸»æœºï¼Œå®¹å™¨ï¼Œå‡½æ•°æœåŠ¡ï¼Œä»¥åŠç½‘ç»œç±»çš„VPCï¼Œè´Ÿè½½å‡è¡¡ã€‚å­˜å‚¨ç±»çš„æˆ‘ä»¬ä»Šå¤©å°±ä¸ä»‹ç»äº†ï¼Œæ˜å¤©æˆ‘ä»¬çš„åŒäº‹æœ‰ä¸€ä¸ªéå¸¸é«˜è´¨é‡çš„åˆ†äº«ï¼Œæ¬¢è¿å¤§å®¶åˆ°æ—¶å€™å‚åŠ ã€‚</p>
<ul>
<li><strong>è™šæ‹ŸåŒ–æŠ€æœ¯</strong></li>
</ul>
<p>é‚£åœ¨ä»‹ç»äº‘æœåŠ¡ä¹‹å‰å‘¢ï¼Œæˆ‘ä»¬é¦–å…ˆè¦äº†è§£ä¸‹ä¸Šé¢æåˆ°è¿‡çš„è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œè¿™æ˜¯äº‘æœåŠ¡çš„åŸºç¡€ã€‚è™šæ‹ŸåŒ–æŠ€æœ¯æ˜¯æŒ‡é€šè¿‡èµ„æºç®¡ç†æŠ€æœ¯ï¼Œå°†è®¡ç®—æœºçš„å®ä½“èµ„æºåˆ†å‰²æˆå‡ ä¸ªç‹¬ç«‹çš„ç¯å¢ƒã€‚</p>
<p>å¯¹äºä¸€å°ç”µè„‘æ¥è¯´ï¼Œæˆ‘ä»¬å¾ˆç†Ÿæ‚‰äº†ï¼Œå¯ä»¥ç®€å•çš„åˆ’åˆ†ä¸ºä¸‰å±‚ï¼Œä»ä¸‹åˆ°ä¸Šåˆ†åˆ«æ˜¯ç‰©ç†ç¡¬ä»¶å±‚ï¼Œæ“ä½œç³»ç»Ÿå±‚ï¼Œåº”ç”¨ç¨‹åºå±‚ã€‚å¯¹ç‰©ç†èµ„æºçš„è™šæ‹Ÿåˆ’åˆ†æœ‰ä¸¤ç§è‘—åçš„æ–¹æ¡ˆï¼Œå·¦è¾¹çš„æ˜¯1å‹ï¼šç›´æ¥å‡Œé©¾äºç¡¬ä»¶ä¹‹ä¸Šï¼Œæ„å»ºå‡ºå¤šä¸ªéš”ç¦»çš„æ“ä½œç³»ç»Ÿç¯å¢ƒã€‚å³è¾¹çš„æ˜¯2å‹ï¼šä¾èµ–äºå®¿ä¸»æ“ä½œç³»ç»Ÿï¼Œåœ¨å…¶ä¸Šæ„å»ºå‡ºå¤šä¸ªéš”ç¦»çš„æ“ä½œç³»ç»Ÿç¯å¢ƒã€‚è¿™ä¸¤ç±»æ–¹æ¡ˆåœ¨åŸç†ä¸ŠåŒºåˆ«æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿç¬¬ä¸€ç§vmmæ˜¯å®Œå…¨æ¨¡æ‹Ÿäº†æ•´ä¸ªcpuæŒ‡ä»¤é›†ï¼Œå°†è™šæ‹Ÿæœºçš„æ“ä½œç›´æ¥è½¬åŒ–æˆcpuæŒ‡ä»¤é›†æ‰§è¡Œï¼Œç¬¬äºŒç§vmmåœ¨è™šæ‹Ÿæœºæ“ä½œç³»ç»Ÿå’Œè®¡ç®—æœºä¹‹å‰æ‰®æ¼”äº†ä¸€ä¸ªæ¡¥æ¢çš„ä½œç”¨ï¼Œå°†è™šæ‹Ÿæœºè¦æ‰§è¡Œçš„æ“ä½œç¿»è¯‘æˆcpuæŒ‡ä»¤åœ¨è®¡ç®—æœºä¸Šæ‰§è¡Œï¼Œè¿™ä¸¤ä¸ªçš„åŒºåˆ«æœ‰ç‚¹åƒè§£é‡Šæ€§è¯­è¨€å’Œç¼–è¯‘æ€§è¯­è¨€çš„åŒºåˆ«ã€‚åƒæˆ‘ä»¬åœ¨ç”µè„‘ä¸Šç»å¸¸å®‰è£…çš„è™šæ‹Ÿæœºæ˜¯ç¬¬äºŒç±»çš„ï¼Œä»–æ˜¯ä¾èµ–äºå®¿ä¸»æ“ä½œç³»ç»Ÿçš„ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸‹ç°åœ¨äº‘æœåŠ¡ä¸Šä¸»è¦ä½¿ç”¨çš„KVMï¼Œä»–æ˜¯å¼€æºçš„ï¼Œå¹¶ä¸”å·²ç»é›†æˆè¿›Linuxå†…æ ¸äº†ï¼Œå¯ä»¥è®¤ä¸ºlinuxå†…æ ¸æœ¬èº«å°±æ˜¯ä¸€ä¸ªvmmã€‚ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°KVMæœ¬èº«åŸºäºç¡¬ä»¶è¾…åŠ©è™šæ‹ŸåŒ–åªè´Ÿè´£è™šæ‹ŸåŒ–cpuå’Œå†…å­˜ï¼Œä½†æ˜¯ä¸€å°è®¡ç®—æœºä¸åªæœ‰cpuå’Œå†…å­˜ï¼Œè¿˜æœ‰å„ç§ioè®¾å¤‡ï¼ŒQEMUè´Ÿè´£è¿™äº›è®¾å¤‡çš„è™šæ‹ŸåŒ–ã€‚</p>
<ul>
<li><strong>äº‘æœåŠ¡å™¨</strong></li>
</ul>
<p>æˆ‘ä»¬çŸ¥é“äº†ä¸€å°ç‰©ç†æœºå¦‚æœé€šè¿‡è™šæ‹ŸåŒ–æŠ€æœ¯å½¢æˆå¤šå°ç¯å¢ƒéš”ç¦»çš„è™šæ‹Ÿæœºä¹‹åï¼Œæˆ‘ä»¬ç°åœ¨å°†ä¹‹å‰çš„æ¸¸æˆæœåŠ¡å™¨å‘å¸ƒåˆ°äº‘æœåŠ¡å™¨ä¸Šï¼Œå°±æ¸…æ¥šäº†æ›´å¤šçš„ç»†èŠ‚ã€‚äº‘æœåŠ¡æœ‰å“ªäº›ä¼˜åŠ¿å‘¢ï¼Ÿäº‘æœåŠ¡æœ‰å“ªäº›è§„æ ¼é€‚åˆæˆ‘ä»¬çš„æœåŠ¡å™¨å‘¢ï¼ŸAIè®­ç»ƒï¼Œç°åœ¨å¾ˆå¤šç«æŠ€æ¸¸æˆï¼ŒåŒ…æ‹¬æ£‹ç‰Œç±»çš„AIéƒ½æ˜¯æœºå™¨å­¦ä¹ äº†ï¼Œè¿™æ ·çš„æœºå™¨äººæ“ä½œæ›´ç¬¦åˆæ­£å¸¸ç©å®¶çš„æ€ç»´ï¼Œæé«˜äº†æ¸¸æˆç©å®¶çš„ä½“éªŒã€‚å½“ç„¶å¦‚æœåœ¨å­—èŠ‚å‘å¸ƒäº‘æœåŠ¡å™¨çš„è¯ï¼Œä¹Ÿå¯ä»¥å‘å¸ƒåœ¨æˆ‘ä»¬æ¯ä¸ªäººçš„devboxä¸Šï¼Œæ¯ä¸ªç¨‹åºéƒ½ä¼šæœ‰çš„ä¸€å°äº‘æœåŠ¡å™¨ï¼Œæ–¹ä¾¿æˆ‘ä»¬æœ‰çš„æ—¶å€™è°ƒè¯•ã€‚</p>
<ul>
<li><strong>åº”ç”¨</strong></li>
</ul>
<p>ä»¥ä¸€ä¸ªMMOæ¸¸æˆä¸ºä¾‹å§ã€‚æˆ‘ä»¬åœ¨å¼€æ–°æœçš„æ—¶å€™ï¼Œåªéœ€è¦æ–°å¢äº‘æœåŠ¡å™¨å°±å¯ä»¥äº†ï¼Œå¦‚æœä¸€äº›æœåŠ¡å™¨çš„ç©å®¶æ´»è·ƒäººæ•°å°‘äº†ä¹‹åï¼Œæˆ‘ä»¬åœ¨éœ€è¦è¿›è¡Œåˆæœçš„æ—¶å€™ï¼Œåªéœ€è¦ä¸‹æ‰å‡ å°äº‘æœåŠ¡å™¨å°±å¥½äº†ã€‚æ•°æ®åº“å‘¢ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ç›´æ¥ç”¨paasæœåŠ¡æä¾›çš„å³å¯ï¼Œæˆ‘ä»¬ä¸éœ€è¦å»éƒ¨ç½²å®‰è£…æ•°æ®äº†ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨å³å¯ã€‚ç°åœ¨æˆ‘ä»¬å°†åº”ç”¨éƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨ä¸Šå°±ç¨³å®šå’Œæ–¹ä¾¿äº†å¾ˆå¤šã€‚</p>
<ul>
<li><strong>å®¹å™¨</strong></li>
</ul>
<p>åœ¨äº†è§£äº†ä½¿ç”¨äº‘æœåŠ¡å™¨æ¥éƒ¨ç½²æˆ‘ä»¬çš„åº”ç”¨åï¼Œå·²ç»åŸºæœ¬èƒ½æ»¡è¶³ä¹‹å‰æˆ‘ä»¬ç¢°åˆ°çš„é—®é¢˜äº†ã€‚é‚£åœ¨å®é™…çš„å¼€å‘ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬ç»å¸¸åˆä¼šç¢°åˆ°æ–°çš„é—®é¢˜ï¼Œæ¯”å¦‚æœåŠ¡åœ¨æˆ‘ä»¬çš„å¼€å‘æœºä¸Šå¯ä»¥è¿è¡Œï¼Œä½†æ˜¯å‘å¸ƒåˆ°æœåŠ¡å™¨ä¸Šå´ä¸èƒ½è¿è¡Œäº†ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬æœ¬åœ°å¼€å‘çš„ç¯å¢ƒå’Œçº¿ä¸Šç¯å¢ƒæ˜¯ä¸åŒçš„ï¼Œä¾èµ–çš„å·¥å…·åŒ…å’Œé…ç½®ä¹Ÿæ˜¯ä¸åŒçš„ï¼Œæ¯”å¦‚æˆ‘ä»¬æœ¬åœ°çš„å¼€å‘æœºä¸Šä½¿ç”¨çš„jdkå¯èƒ½æ˜¯11ï¼Œçº¿ä¸Šå®‰è£…çš„jdkæ˜¯1.8ï¼Œæˆ‘ä»¬åœ¨å¼€å‘ä¸­ä½¿ç”¨äº†11çš„ä¸€äº›æ–°ç‰¹æ€§æ¯”å¦‚varå˜é‡ï¼Œåœ¨æœ¬åœ°å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯çº¿ä¸Š1.8çš„å°±ä¼šæŠ¥é”™ã€‚è¿˜æœ‰å¦ä¸€ç§æƒ…å†µï¼Œæœ¬æ¥æˆ‘ä»¬çš„æœåŠ¡è¿è¡Œçš„éå¸¸ç¨³å®šï¼Œä½†æ˜¯åœ¨ç‰ˆæœ¬å‡çº§äº†ä¹‹åå´å‡ºç°é—®é¢˜äº†ï¼Œæ¯”å¦‚æˆ‘ä»¬å°†mysqlä»5.7å‡çº§åˆ°äº†8.0ï¼Œä½¿ç”¨äº†8.0çš„ä¸€äº›ç‰¹æ€§ï¼Œæ¯”å¦‚ç”¨renameç›´æ¥ä¿®æ”¹åˆ—åï¼Œè¿™æ ·åœ¨5.7ä¸Šå°±ä¼šå¤±è´¥ã€‚è¿™äº›ä¾‹å­æœ€ä¸»è¦çš„é—®é¢˜è¿˜æ˜¯ç¯å¢ƒçš„å·®å¼‚ï¼Œé‚£ä¸ºä»€ä¹ˆä¼šæœ‰è¿™äº›ç¯å¢ƒçš„å·®å¼‚å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºæˆ‘ä»¬çš„å‘å¸ƒæµç¨‹æ˜¯æˆ‘ä»¬å°†æˆ‘ä»¬ç¼–å†™çš„ä»£ç ç¼–è¯‘æˆæœ€ç»ˆè¿è¡Œçš„äº§ç‰©ï¼Œæ¯”å¦‚exeæˆ–jaråŒ…waråŒ…ï¼Œæˆ‘ä»¬å°†æœ€ç»ˆäº§ç‰©ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šï¼Œè¿è¡Œç¯å¢ƒå’Œä¾èµ–ä½¿ç”¨çš„æ˜¯æˆ‘ä»¬äº‘æœåŠ¡ä¸Šçš„é…ç½®ï¼Œæˆ‘ä»¬åœ¨æ–°åŠ äº‘æœåŠ¡å™¨æˆ–å‡çº§é…ç½®çš„æ—¶å€™å¯èƒ½é€ æˆç¯å¢ƒä¸ä¸€è‡´çš„æƒ…å†µã€‚é‚£é’ˆå¯¹è¿™ç§æƒ…å†µå‘¢ï¼Œå®¹å™¨æŠ€æœ¯çš„å‡ºç°æä¾›äº†å¦ä¸€ç§æ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥å°†æœ€ç»ˆäº§ç‰©å’Œæˆ‘ä»¬çš„ç¯å¢ƒä¾èµ–ä¸€èµ·æ‰“åŒ…ï¼Œç„¶åéƒ¨ç½²ä¸Šçº¿ï¼Œè¿™æ ·ä¸€å¥—æµç¨‹èµ°å®Œï¼Œæ‰€æœ‰çš„ç¯å¢ƒå’Œä¾èµ–éƒ½æ˜¯ä¸€è‡´çš„ï¼Œè¿™æ˜¯å®¹å™¨åŒ–æŠ€æœ¯å‡ºç°æœ€å¤§çš„ç‰¹æ€§ã€‚</p>
<p>ä½†æ˜¯è¿™ä¸ªæµç¨‹æœ€ç»ˆå¦‚ä½•å®ç°çš„å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥å€Ÿé‰´ä¸‹å‰ç«¯çš„æµç¨‹ï¼Œå‰ç«¯æ˜¯åœ¨u3dæˆ–è€…ueä¸Šå¼€å‘ï¼Œç„¶åæ‰“åŒ…æˆæ¸¸æˆåŒ…ï¼Œå®‰å“çš„è¯æ˜¯apkï¼Œiosçš„è¯æ˜¯ipaï¼Œç„¶åå°†æ¸¸æˆåŒ…å‘å¸ƒåˆ°åº”ç”¨å•†åº—ï¼Œappstoreæˆ–googlestoreä¸Šï¼Œç”¨æˆ·ç›´æ¥ä¸‹è½½å®‰è£…åå°±å¯ä»¥ä½¿ç”¨äº†ã€‚é‚£æˆ‘ä»¬åç«¯æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥å‘¢ï¼Œå°†jar/exeè¿™äº›æœ€ç»ˆäº§ç‰©å¸¦ä¸Šç¯å¢ƒä¸€èµ·æ‰“åŒ…å‘å¸ƒåˆ°è¿œç¨‹åº”ç”¨å•†åº—é‡Œé¢ï¼ŒæœåŠ¡å™¨åªéœ€è¦ä¸‹è½½å®‰è£…è¿è¡Œå°±å¯ä»¥äº†ã€‚è¿™å°±æ˜¯å®¹å™¨æä¾›çš„æ ‡å‡†äº¤ä»˜è§£å†³æ–¹æ¡ˆã€‚</p>
<p>å®¹å™¨å¦å¤–ä¸€ä¸ªæœ€å¤§çš„ç‰¹æ€§æ˜¯é€šè¿‡æ‰“åŒ…è£…ç®±çš„æ€æƒ³è¿›è¡Œåº”ç”¨ç¨‹åºçº§åˆ«çš„éš”ç¦»ï¼Œå¯ä»¥åœ¨ä¸€å°äº‘æœåŠ¡å™¨ä¸Šè¿è¡Œå¤šä¸ªç¯å¢ƒç›¸äº’éš”ç¦»çš„åº”ç”¨ï¼Œå·²è¾¾åˆ°å¯¹èµ„æºçš„æè‡´åˆ©ç”¨ã€‚</p>
<p>å®¹å™¨çš„å·¥ä½œåŸç†ï¼Œå®¹å™¨çš„è™šæ‹ŸåŒ–ä¸æ˜¯æ¨¡æ‹Ÿäº†æ•´ä¸ªæ“ä½œç³»ç»Ÿï¼Œä»–åªæ˜¯éš”ç¦»äº†åº”ç”¨çš„ç¯å¢ƒï¼Œä½¿ç”¨çš„è¿˜æ˜¯å®¿ä¸»æœºçš„æ“ä½œç³»ç»Ÿï¼Œéå¸¸è½»é‡çº§ã€‚</p>
<ul>
<li><strong>å®¹å™¨ç¼–æ’</strong></li>
</ul>
<p>é€šè¿‡æˆ‘ä»¬ä¹‹å‰å¯¹å®¹å™¨çš„ä»‹ç»ï¼ŒçŸ¥é“å®¹å™¨è‡ªèº«çš„ä»·å€¼ä¸»è¦æ˜¯æä¾›äº†æ ‡å‡†åŒ–çš„äº¤ä»˜ï¼Œæ‰“åŒ…å’Œåˆ†å‘çš„ä½œç”¨ï¼Œå’Œè½»é‡çº§çš„åº”ç”¨ç¯å¢ƒéš”ç¦»ï¼Œä½†æ˜¯å¦‚æœä¸å½¢æˆè§„æ¨¡åŒ–çš„æ•ˆåº”ï¼Œæ˜¯æ— æ³•å‘æŒ¥å‡ºå¯¹èµ„æºåˆ©ç”¨çš„ä¼˜åŠ¿çš„ï¼Œé‚£å½¢æˆè§„æ¨¡åŒ–æ•ˆåº”æœ€å¤§çš„é—®é¢˜å°±æ˜¯å®¹å™¨çš„è°ƒåº¦å’Œç¼–æ’ä¸Šåº”è¯¥å¦‚ä½•è¿›è¡Œï¼Œæ‰€è°“ç¼–æ’å°±æ˜¯ä¸åŒåº”ç”¨çš„å®¹å™¨é—´çš„å…³ç³»çš„ç»„ç»‡ã€‚é‚£åœ¨è¿™äº›ç¼–æ’å·¥å…·ä¸­ä½¿ç”¨æœ€å¹¿æ³›çš„å°±æ˜¯æˆ‘ä»¬è¦ä»‹ç»çš„k8sï¼Œk8sæ˜¯ä»€ä¹ˆï¼Œä»–æœ¬èº«æ˜¯ä¸€ä¸ªè·¨ä¸»æœºçš„å®¹å™¨ç¼–æ’å·¥å…·ï¼Œä»–ä½¿ç”¨ç½‘ç»œå°†å¤šä¸ªä¸»æœºæ„å»ºæˆç»Ÿä¸€çš„é›†ç¾¤ï¼Œä¸»èŠ‚ç‚¹ä½œä¸ºæ§åˆ¶ä¸­å¿ƒï¼Œè´Ÿè´£ç®¡ç†æ•´ä¸ªé›†ç¾¤ç³»ç»Ÿï¼Œå…¶ä»–èŠ‚ç‚¹ä¸ºå·¥ä½œèŠ‚ç‚¹ï¼Œå·¥ä½œèŠ‚ç‚¹ä»¥podçš„å½¢å¼è¿è¡ŒæœåŠ¡ï¼Œè¿™ç§æœåŠ¡ä¸€èˆ¬éƒ½æ˜¯è®¡ç®—æœåŠ¡ã€‚æ€»ç»“æ¥è¯´k8sç¼–æ’å·¥å…·ä¸»è¦æä¾›äº†å®¹å™¨é—´éƒ¨ç½²ï¼Œæ›´æ–°ï¼Œä¼¸ç¼©çš„ç®¡ç†æœåŠ¡ï¼Œä»¥åŠå®¹å™¨å‘¨è¾¹çš„ç¼–æ’æ¯”å¦‚ç½‘ç»œå­˜å‚¨ç­‰ã€‚k8sæœ€ä¸»è¦çš„ç‰¹æ€§å°±æ˜¯å£°æ˜å¼apiï¼Œæˆ‘ä»¬åªéœ€è¦å‘Šè¯‰ä»–æˆ‘ä»¬é¢„æœŸçš„ç»“æœæ˜¯ä»€ä¹ˆæ ·å°±å¯ä»¥ï¼Œå‰©ä½™çš„äº‹æƒ…å…¨éƒ¨äº¤ç»™k8sæ¥å®Œæˆã€‚k8sçš„æ§åˆ¶å™¨æ¨¡å¼æ¥è´Ÿè´£å®ç°ç”¨æˆ·æœŸæœ›çš„çŠ¶æ€ï¼Œå› æ­¤æˆ‘ä»¬ç”¨k8sä¸¾ä¾‹æ¥è¯´ï¼Œå¤§æ¦‚å°±æ˜¯æˆ‘ä»¬å‘Šè¯‰k8sï¼Œæˆ‘ä»¬å¸Œæœ›è¿è¡Œä¸¤ä¸ªpodï¼Œpodå¦‚ä½•å»ä¸‹è½½é•œåƒï¼Œä¸‹è½½å®Œåè¿™ä¸ªpodå…·ä½“è¿è¡Œåœ¨é›†ç¾¤ä¸­çš„å“ªä¸ªèŠ‚ç‚¹ä¸Šï¼Œä¸‡ä¸€podæ‰€åœ¨çš„èŠ‚ç‚¹å®•æœºäº†ï¼Œå¦‚ä½•å†é‡æ–°å¯åŠ¨èµ·æ¥ç­‰ç­‰è¿™äº›ï¼Œç»Ÿç»Ÿäº¤ç»™k8sæ¥è§£å†³ã€‚æˆ‘ä»¬ä½¿ç”¨å£°æ˜å¼apiçš„å½¢å¼å°±æ˜¯é€šè¿‡jsonæ–‡ä»¶æˆ–yamlæ–‡ä»¶æ¥ç»„ç»‡å£°æ˜å¼apiå³å¯ï¼Œå’Œdockerfileä¸€æ ·ç®€å•ã€‚</p>
<p>åˆ°è¿™é‡Œå¯èƒ½å¤§å®¶ä¼šæœ‰ä¸ªç–‘é—®ï¼Œæˆ‘ä»¬ä¹‹å‰ä»‹ç»äº†å®¹å™¨ï¼Œç°åœ¨åœ¨è¯´å®¹å™¨ç¼–æ’ï¼Œä½†æ˜¯ä»–æœ¬èº«è°ƒåº¦çš„ä¸æ˜¯å®¹å™¨è€Œæ˜¯podï¼Œé‚£podåˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿpodæ˜¯k8sä¸Šè¿è¡Œåº”ç”¨çš„æœ€å°å•ä½ï¼Œpodæ˜¯ä¸€åˆ°å¤šä¸ªå®¹å™¨çš„é›†åˆï¼Œè¿™äº›å®¹å™¨å…±äº«networkï¼ŒIPCï¼Œutsï¼Œè¿™äº›ä¸»è¦æ˜¯å’Œç½‘ç»œé€šä¿¡å’Œä¸»æœºåç›¸å…³çš„åç§°ç©ºé—´ï¼Œè¿˜å¯ä»¥å…±äº«æ•°æ®å·ï¼Œæˆ‘ä»¬ä¹‹å‰ä»‹ç»è¿‡å®¹å™¨é—´çš„æ–‡ä»¶æ˜¯ç›¸äº’éš”ç¦»çš„ï¼Œé‚£podé—´çš„å¤šä¸ªå®¹å™¨æ˜¯å¦‚ä½•å®ç°å…±äº«çš„å‘¢ï¼Œæ¯ä¸ªpodä¸Šéƒ½ä¼šå¯åŠ¨ä¸€ä¸ªåŸºç¡€å®¹å™¨ï¼Œå«pod infrastructureï¼Œä»–ä¸»è¦è´Ÿè´£åˆ›å»ºè¿™äº›å…±äº«çš„åç§°ç©ºé—´ï¼Œä»¥åŠç»‘å®šæ•°æ®å·ï¼Œè¿™æ ·åœ¨è¿™ä¸ªpodä¸Šè¿è¡Œçš„å…¶ä»–å®¹å™¨å°±å¯ä»¥å…±äº«è¿™äº›äº†ã€‚mountå’Œuseræ˜¯éš”ç¦»çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£æˆpodæ˜¯ä¸€ç»„ç´§å¯†ç›¸å…³çš„å®¹å™¨ç»„æˆçš„ï¼Œä½†äº‹å®ä¸Šå¯èƒ½æˆ‘ä»¬ä¸€ä¸ªpodå°±åªè·‘ä¸€ä¸ªå®¹å™¨ã€‚ä¸€èˆ¬æˆ‘ä»¬ä¸å»ºè®®ä¸€ä¸ªpodä¸Šè·‘å¤šä¸ªå®¹å™¨ï¼Œé™¤éæ˜¯å¿…é¡»çš„ï¼Œæ¯”å¦‚sidecaræ¨¡å¼ï¼Œæˆ‘ä»¬ä½¿ç”¨ipcè¿›ç¨‹é—´é€šä¿¡ï¼Œæé«˜æ€§èƒ½ï¼Œæ¯”å¦‚æˆ‘ä»¬æ¯ä¸ªpodä¸Šå¯ä»¥è·‘ä¸€äº›æ—¥å¿—é‡‡é›†çš„æœåŠ¡ï¼Œæˆ–è€…æ€§èƒ½åˆ†æçš„æœåŠ¡ï¼Œé‚£è¿™äº›å¦‚æœéƒ¨ç½²æˆä¸åŒçš„podçš„è¯ï¼Œå°±éœ€è¦é€šè¿‡networkè¿›è¡Œé€šä¿¡å‘¢ï¼Œæˆ‘ä»¬è¿™æ—¶å€™å¯ä»¥é€‰æ‹©ä»¥sidecarçš„æ¨¡å¼å°†ä»–ä»¬éƒ¨ç½²æˆä¸€ä¸ªpodã€‚</p>
<p>æœ‰äº†è¿™äº›åŸºç¡€äº†è§£ä¹‹åï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸‹k8sçš„åŸºç¡€æ¶æ„ã€‚æˆ‘ä»¬åˆšæ‰æåˆ°è¿‡ä¸€ä¸ªk8sçš„ç³»ç»Ÿä¸»è¦ç”±ä¸¤ç±»ç»“æ„ç»„æˆï¼Œä¸€ä¸ªæ˜¯æ§åˆ¶èŠ‚ç‚¹ï¼Œå¦ä¸€ä¸ªå«è®¡ç®—èŠ‚ç‚¹ï¼Œä¸»è¦æ˜¯æ¥è¿è¡Œæˆ‘ä»¬çš„ç¨‹åºçš„ã€‚ä¸€èˆ¬æ¥è¯´æ§åˆ¶èŠ‚ç‚¹1ä¸ªå°±èƒ½å®ç°åŠŸèƒ½äº†ï¼Œä½†æ˜¯è¿™æ ·æ§åˆ¶èŠ‚ç‚¹å°±æˆä¸ºäº†å•ç‚¹é—®é¢˜ï¼Œå®é™…ä¸­æˆ‘ä»¬ä¸€èˆ¬ä¹Ÿä¼šéƒ¨ç½²ä¸‰ä¸ªæ§åˆ¶èŠ‚ç‚¹ï¼Œå› ä¸ºä»–å…¶ä¸­ä½¿ç”¨çš„etcdä½¿ç”¨raftåè®®ï¼Œè¿›è¡Œé€‰ä¸¾æ—¶æœ€å¥½ä¸å°‘äºä¸‰ä¸ªèŠ‚ç‚¹ã€‚é‚£è®¡ç®—èŠ‚ç‚¹æŒ‰ç…§æˆ‘ä»¬çš„éœ€æ±‚æ¥éƒ¨ç½²ç›¸åº”çš„æ•°é‡å³å¯ã€‚æ§åˆ¶èŠ‚ç‚¹å‘¢ä¸»è¦ç”±è¿™å‡ ä¸ªç»„æˆï¼Œapiserveræ•´ä¸ªk8sç¨‹åºçš„å…¥å£ï¼Œæ‰€æœ‰æ•°æ®çš„å‡ºå…¥éƒ½é€šè¿‡apiserverå®Œæˆã€‚controler managerå°±æ˜¯åˆšæ‰æåˆ°çš„æ§åˆ¶å™¨æ¨¡å¼ï¼Œéƒ½æ”¾åœ¨è¿™é‡Œã€‚scheduleræ˜¯è´Ÿè´£è°ƒåº¦ç”¨æˆ·æˆ–æ§åˆ¶å™¨åˆ›å»ºçš„æ–°çš„èŠ‚ç‚¹ï¼Œç©¶ç«Ÿè¿™ä¸ªpodè¯¥è¿è¡Œåœ¨å“ªä¸ªèŠ‚ç‚¹ä¸Šå‘¢ï¼Œå°±æ˜¯æœ‰schedulerå†³å®šçš„ã€‚etcdæ˜¯ç”¨æ¥ç”¨æ¥å­˜å‚¨æœåŠ¡çš„çŠ¶æ€ï¼Œä»–æ˜¯é€šè¿‡raftåè®®æ¥æ„å»ºçš„æ”¯æŒkvå­˜å‚¨çš„ä¸€è‡´æ€§æ•°æ®åº“ã€‚å†çœ‹è®¡ç®—èŠ‚ç‚¹ï¼Œæ¯ä¸ªè®¡ç®—èŠ‚ç‚¹ä¸Šéƒ½ä¼šè¿è¡Œè¿™æ ·ä¸‰ä¸ªç»„ä»¶ï¼Œä¸€ä¸ªæ˜¯kubeletï¼Œæ˜¯apiserverçš„å®¢æˆ·ç«¯ï¼Œè´Ÿè´£å’Œapiserveré€šä¿¡ï¼Œæ¥æ”¶apiserverçš„scheduleråˆ†å‘çš„ç”±è‡ªå·±è´Ÿè´£æ‰§è¡Œçš„ä»»åŠ¡ã€‚åˆ›å»ºå®Œpodåéœ€è¦å’Œå…¶ä»–podè¿›è¡Œé€šä¿¡ï¼Œkube-proxyè¿›è¡Œçš„ï¼Œä»–è¿˜è´Ÿè´£ä½å±‚çº§çš„æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡ã€‚æœ€åå°±æ˜¯æˆ‘ä»¬çœŸæ­£è¿è¡Œçš„å®¹å™¨äº†ã€‚k8så¯ä»¥è¿è¡Œåœ¨ç‰©ç†æœºï¼Œè™šæ‹Ÿæœºï¼Œå…¬æœ‰äº‘ç§æœ‰äº‘ä¸Šé¢ã€‚</p>
<ul>
<li><strong>VM vs Docker</strong></li>
</ul>
<p>ä»‹ç»äº†vmå’Œdockeråæˆ‘ä»¬æ¥çœ‹ä¸‹è¿™ä¸¤ä¸ªä¸»è¦çš„åŒºåˆ«çš„ã€‚</p>
<p>å®¹å™¨å’Œè™šæ‹Ÿæœºèµ°çš„æ˜¯å®Œå…¨ä¸åŒçš„è·¯çº¿ï¼Œè™šæ‹Ÿæœºçš„ç›®æ ‡æ˜¯è™šæ‹ŸåŒ–å‡ºä¸€å°å®Œæ•´çš„è®¡ç®—æœºï¼Œæ‹¥æœ‰åº•å±‚çš„ç‰©ç†ç¡¬ä»¶ï¼Œæ“ä½œç³»ç»Ÿï¼Œåº”ç”¨ç¨‹åºæ‰§è¡Œæ‰€éœ€çš„ç¯å¢ƒã€‚ä¸ºäº†è®©è™šæ‹Ÿæœºè¾¾åˆ°èƒ½æ¨¡æ‹ŸçœŸå®ç‰©ç†æœºä¸Šè¿è¡Œçš„ç¯å¢ƒï¼Œvmmåšäº†å¾ˆå¤šç¹é‡çš„äº‹æƒ…ï¼Œä½†å…¶å®å¯¹äºåº”ç”¨ç¨‹åºæ¥è¯´è¿™å¥—ç¯å¢ƒå¯ä»¥è¯´æ˜¯æœ‰ç”¨ä½†æ˜¯åˆä¸å®Œå…¨æœ‰ç”¨ï¼Œåº”ç”¨ç¨‹åºåªéœ€è¦ç‹¬ç«‹çš„åº”ç”¨æ‰§è¡Œç¯å¢ƒå°±å¯ä»¥äº†ã€‚è¿™æ ·åšæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿè™šæ‹Ÿå‡ºä¸€å°è®¡ç®—æœºçš„ä»£ä»·æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œå¯èƒ½ä¸€å°ç‰©ç†æœºä¸Šè™šæ‹Ÿå‡º10å°è™šæ‹Ÿæœºå°±éå¸¸åƒåŠ›äº†ï¼Œä½†æ˜¯è™šæ‹Ÿå‡ºä¸Šç™¾ä¸ªç‹¬ç«‹çš„æ‰§è¡Œç¯å¢ƒå´éå¸¸è½»æ¾ï¼Œå¦å¤–ä¸€å°è™šæ‹Ÿæœºçš„å¯åŠ¨è¿œè¿œæ¯”å®¹å™¨çš„å¯åŠ¨è¦æ…¢å¾ˆå¤šã€‚å¦å¤–å®¹å™¨çš„ç¨‹åºä»£ç æŒ‡ä»¤ä¸éœ€è¦ç¿»è¯‘ï¼Œå°±å¯ä»¥ç›´æ¥åœ¨cpuä¸Šè¿è¡Œï¼Œå› ä¸ºå¤§å®¶å…¶å®å…¬ç”¨çš„æ˜¯åŒä¸€ä¸ªæ“ä½œç³»ç»Ÿï¼Œåªæ˜¯è¿›è¡Œäº†è½¯ä»¶å±‚é¢ä¸Šçš„é€»è¾‘éš”ç¦»ï¼Œæ€§èƒ½æ›´å¥½ã€‚ç¼ºç‚¹å‘¢å°±æ˜¯éš”ç¦»æ€§æ¯”è™šæ‹Ÿæœºè¦å·®ï¼Œä¸€æ—¦åˆ©ç”¨å†…æ ¸æ¼æ´å‘èµ·æ”»å‡»ï¼Œç¨‹åºçªç ´å®¹å™¨é™åˆ¶ï¼Œå®ç°é€ƒé€¸ï¼Œå±æœºå®¿ä¸»è®¡ç®—æœºï¼Œå°±ä¼šå½±å“åˆ°æ•´å°ç‰©ç†æœºä¸Šçš„æ‰€æœ‰å®¹å™¨ã€‚</p>
<ul>
<li><strong>åº”ç”¨</strong></li>
</ul>
<p>æˆ‘ä»¬éƒ½çŸ¥é“ä¼ ç»Ÿæ¸¸æˆä¸åƒappä¸€æ ·æœ‰é‚£ä¹ˆé«˜çš„æ—¥æ´»ï¼Œçºµè§‚æ¸¸æˆçš„ç”Ÿå‘½å‘¨æœŸæˆ‘ä»¬å‘ç°å¤§éƒ¨åˆ†æ¸¸æˆéƒ½ä¼šæœ‰ä»–çš„ä¸€ä¸ªå³°å€¼æ—¶é—´ç‚¹ï¼Œè€Œä¸”å¤§éƒ¨åˆ†æ¸¸æˆçš„ç”Ÿå‘½å‘¨æœŸå¯èƒ½ä¹Ÿä¸æ˜¯å¾ˆé•¿ï¼Œè€Œä¸”åœ¨ä¸€äº›èŠ‚æ—¥æ´»åŠ¨çš„æ—¶å€™ä¼´éšç€æ¸¸æˆä¸­çš„æ´»åŠ¨ï¼Œåœ¨çº¿äººæ•°ä¼šè¿…é€Ÿæ”€é«˜ï¼Œå³ä½¿æŒ‰å¤©çš„æ—¶é—´æ¥è§‚å¯Ÿï¼Œä¹Ÿä¼šå‘ç°æ¸¸æˆä¼šæœ‰ä¸€ä¸ªæ˜æ˜¾çš„é«˜å³°å’Œä½è°·ï¼Œä»¥ä»Šå¹´æŠ–éŸ³å’Œæ˜¥æ™šçš„åˆä½œä¸ºä¾‹ï¼ŒèŠ’æœæ–—åœ°ä¸»åœ¨æŠ–éŸ³ä¸»ä¼šåœºçš„éœ²å‡ºå¸¦æ¥äº†å¤§é‡çš„ç”¨æˆ·ï¼Œè€Œä¸”ç”±äºæ˜¥æ™šçº¢åŒ…é›¨çš„è¿™ç§ç¬æ—¶é«˜æµé‡çš„ç©æ³•ï¼Œç»™æ¸¸æˆéƒ¨ç½²å¸¦æ¥äº†æ›´å¤šçš„æŒ‘æˆ˜ï¼Œå¦‚æœæ˜¯ä¼ ç»Ÿçš„äº‘æœåŠ¡å™¨çš„è¯ï¼Œé‚£æˆ‘ä»¬å¯èƒ½äº‹å…ˆå°±éœ€è¦å‡†å¤‡å¤§é‡çš„æœåŠ¡å™¨äº†ï¼Œè€Œä¸”ç­‰æ˜¥æ™šæ´»åŠ¨è¿‡åç©å®¶ä¸€å®šä¼šé€æ¸å›å½’åˆ°ä¸€ä¸ªæ­£å¸¸çš„æ°´å¹³ï¼Œé‚£è¿™äº›ç©ºé—²çš„æœåŠ¡å™¨å½’è¿˜ä¹Ÿæ˜¯ä¸€ä¸ªé—®é¢˜ã€‚é‚£å¾—ç›Šäºå­—èŠ‚äº‘æä¾›çš„å®¹å™¨åŒ–æœåŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥åšåˆ°å¿«é€Ÿçš„å“åº”ï¼Œè¾¾åˆ°è¿…é€Ÿè‡ªåŠ¨æ‰©ç¼©å®¹çš„è¦æ±‚ï¼Œè¿›ä¸€æ­¥æ§åˆ¶æˆæœ¬ã€‚åœ¨å‡ ä¸ªçƒ­ç‚¹æœåŠ¡ä¸Šï¼Œæ¯”å¦‚ç‰Œå±€æœåŠ¡ï¼Œè¿™ä¸ªæ˜¯é¢‘ç¹åˆ›å»ºå’Œé”€æ¯çš„ï¼Œä¸ºäº†åº”å¯¹æ˜¥æ™šçš„æµé‡ï¼Œå•ä¸ªæœåŠ¡çš„å®¹å™¨å°±è¾¾åˆ°äº†å‡ ç™¾ä¸ªï¼Œè¿™ä¸ªå¦‚æœæ˜¯éƒ¨ç½²åœ¨ä¼ ç»Ÿçš„äº‘æœåŠ¡å™¨ä¸Šï¼Œæˆæœ¬ä¼šæ¯”å®¹å™¨é«˜å¾ˆå¤šã€‚</p>
<ul>
<li><strong>å‡½æ•°æœåŠ¡</strong></li>
</ul>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ä»‹ç»ä¸‹å‡½æ•°æœåŠ¡ï¼Œè¿™ä¸ªå¯èƒ½å¤§å®¶å¹³æ—¶äº†è§£çš„æ¯”è¾ƒå°‘ï¼Œå‡½æ•°æœåŠ¡ä¹Ÿå«æ— æœåŠ¡å™¨æ¶æ„ï¼Œä»–ä¸åŒäºæˆ‘ä»¬ä¸Šé¢ä»‹ç»çš„äº‘æœåŠ¡æä¾›å®Œæ•´çš„åº”ç”¨åŠŸèƒ½ï¼Œåªæ˜¯æä¾›åº”ç”¨ä¸­æŸä¸ªåŠŸèƒ½çš„æœåŠ¡ã€‚è¿™é‡Œçš„æ— æœåŠ¡å™¨æŒ‡çš„ä¸æ˜¯æ²¡æœ‰äº‘æœåŠ¡å™¨ï¼Œè€Œæ˜¯æ— éœ€æˆ‘ä»¬å…³å¿ƒäº‘æœåŠ¡å™¨ã€‚é‚£å…·ä½“ä»–æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿå›å¿†ä¸‹æˆ‘ä»¬ä¹‹å‰ä»‹ç»çš„IaaS,PaaSå¹³å°ï¼Œæˆ‘ä»¬å‘å¸ƒåº”ç”¨çš„æ—¶å€™éœ€è¦å°†æˆ‘ä»¬çš„å¯æ‰§è¡Œç¨‹åºå‘å¸ƒåˆ°æœåŠ¡å™¨ä¸Šï¼Œç„¶åå¯åŠ¨è¿è¡Œï¼Œæˆ‘ä»¬æ‹¥æœ‰çš„æ˜¯å¯¹åå°æœåŠ¡å™¨çš„æƒé™ï¼Œè¿™ä¹Ÿæ„å‘³ç€æˆ‘ä»¬éœ€è¦å»å…³å¿ƒæœåŠ¡å™¨çš„çŠ¶æ€ï¼ŒåŒ…æ‹¬æˆ‘ä»¬ä¹‹å‰æåˆ°çš„è¿è¡Œç¯å¢ƒï¼Œè´Ÿè½½å‡è¡¡å’Œå®¹é‡ç­‰ç­‰ï¼Œé‚£å¦‚æœæˆ‘ä»¬çš„æŸäº›æœåŠ¡æ˜¯ä¸€äº›éå¸¸è½»é‡çº§çš„å‘¢ï¼Ÿå¯èƒ½è¿™ä¸ªæœåŠ¡çš„åŠŸèƒ½å¼€å‘æ¯”æˆ‘ä»¬å»éƒ¨ç½²å’Œç®¡ç†çš„æˆæœ¬è¿˜é«˜ï¼Œé‚£å°±å¯ä»¥é€‰æ‹©å‡½æ•°æœåŠ¡ï¼Œæˆ‘ä»¬çœ‹å‡½æ•°æœåŠ¡çš„äº‘æœåŠ¡å™¨å’Œä¹‹å‰ç›¸æ¯”ä½äºæ›´åç«¯äº†ï¼Œè¿™ä¸ªä¸ä»£è¡¨äº‘æœåŠ¡æ²¡äº†ï¼Œåªæ˜¯ä¸éœ€è¦æˆ‘ä»¬å…³å¿ƒäº†ï¼Œè¿™äº›æœåŠ¡å™¨çš„çŠ¶æ€åˆå‚å•†æ ¹æ®æˆ‘ä»¬çš„éœ€æ±‚æ¥è°ƒæ•´ï¼Œæˆ‘ä»¬åªéœ€è¦å°†ä»£ç ä¸Šä¼ åˆ°æŒ‡å®šçš„åœ°æ–¹ï¼Œä¸€èˆ¬å°±æ˜¯svnæˆ–gitlabäº†ï¼Œä¸Šä¼ ä¹‹åä¸€èˆ¬é€šè¿‡äº‹ä»¶æ¥è§¦å‘ä»£ç æ‰“åŒ…å’Œæ‰§è¡Œï¼Œäº‹ä»¶ä¸€èˆ¬åŒ…æ‹¬æœ‰å¯¹è±¡å­˜å‚¨äº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´æ£€æµ‹åˆ°æœ‰ä»£ç ä¸Šä¼ äº†ï¼Œæˆ–è€…æ˜¯ä¸€äº›æŒ‡ä»¤äº‹ä»¶ï¼Œæ¯”å¦‚æ‰‹åŠ¨è§¦å‘ç­‰ã€‚è¿™æ ·ä»£ç å°±åœ¨åå°æœåŠ¡å™¨æ‰§è¡Œäº†ã€‚ç›¸æ¯”ä¹‹å‰æˆ‘ä»¬ç°åœ¨åªéœ€è¦ä¸Šä¼ ä»£ç å°±å¯ä»¥äº†ï¼Œç¯å¢ƒå’Œé«˜å¯ç”¨è¿™äº›å°±ä¸éœ€è¦æˆ‘ä»¬å…³å¿ƒäº†ã€‚è€Œä¸”å‡½æ•°æœåŠ¡ä¸€èˆ¬æ˜¯æŒ‰éœ€æ”¶è´¹ï¼Œå°±æ˜¯ä»£ç çœŸæ­£è¿è¡Œçš„æ—¶å€™æ‰æ”¶è´¹ã€‚</p>
<ul>
<li><strong>åº”ç”¨</strong></li>
</ul>
<p>è¿™ä¿©æ¸¸æˆå¯èƒ½å¤§éƒ¨åˆ†åŒå­¦éƒ½æœ‰ç©è¿‡å§ï¼Œå°¤å…¶æ˜¯ä¸Šé¢çš„åŸç¥ï¼Œä¸‹é¢è¿™ä¸ªæ˜¯æœå¤•å…‰å¹´è‡ªç ”çš„èˆªæµ·ç‹ã€‚ç°åœ¨å¾ˆå¤šæ¸¸æˆéƒ½æœ‰è‡ªæ‹åˆ†äº«åŠŸèƒ½ï¼Œæˆ‘ä»¬ä¼šä¸Šä¼ åˆ†äº«è‡ªå·±åœ¨æ¸¸æˆä¸­çš„ä¸€äº›å›¾ç‰‡ï¼Œæˆ–è€…ä¸Šä¼ ä¸€äº›æ¸¸æˆä¸­çš„é«˜å…‰æ—¶åˆ»è§†é¢‘ã€‚é‚£è¿™ä¸ªä¸Šä¼ æœåŠ¡å°±å¯ä»¥ä½¿ç”¨å‡½æ•°æœåŠ¡ï¼Œæˆ‘ä»¬å°†å›¾ç‰‡ï¼Œè§†é¢‘ä¸Šä¼ è‡³åå°å¯¹è±¡å­˜å‚¨ï¼Œä¸Šä¼ æˆåŠŸäº‹ä»¶è§¦å‘æˆ‘ä»¬çš„å‡½æ•°æœåŠ¡ï¼ŒåŒ…æ‹¬æ£€æµ‹å›¾ç‰‡æˆ–è§†é¢‘ä¸­æ˜¯å¦æœ‰ä¸€äº›è¿è§„æˆ–æ•æ„Ÿä¿¡æ¯ï¼Œç„¶åå°†æ–‡ä»¶è¿›è¡Œå‹ç¼©å›ä¼ ã€‚è¿™æ ·æˆ‘ä»¬ä¸éœ€è¦å…³å¿ƒæˆ‘ä»¬è¿™ä¸ªæœåŠ¡å¯ä»¥æ‰¿è½½å¤šå°‘qpsï¼Œè¿™äº›æœ‰æœåŠ¡æä¾›å•†æ¥è¿›è¡ŒåŠ¨æ€è°ƒæ•´ï¼Œè€Œä¸”åªæœ‰åœ¨å‡½æ•°æä¾›æœåŠ¡çš„æ—¶å€™æˆ‘ä»¬æ‰æŒ‰éœ€ä»˜è´¹ï¼ŒèŠ‚çœäº†æˆæœ¬ã€‚</p>
<ul>
<li><strong>VPC</strong></li>
</ul>
<p>è™šæ‹Ÿç§æœ‰äº‘ï¼Œè¿™ä¸ªåå­—å¯èƒ½ä¼šè®©æˆ‘ä»¬æ„Ÿè§‰æ€ä¹ˆäº‘æœåŠ¡é‡Œé¢è¿˜æœ‰äº‘å‘¢ï¼Ÿé‚£ä»–å…¶å®æ˜¯äº‘é‡Œé¢çš„å±€åŸŸç½‘ã€‚æˆ‘ä»¬ç±»æ¯”ä¸‹æœ¬åœ°å±€åŸŸç½‘ï¼Œæœ¬åœ°å±€åŸŸç½‘å¤§å®¶æ¯”è¾ƒç†Ÿæ‚‰äº†ï¼Œæ¯”å¦‚æˆ‘ä»¬åŠ¨ç”»å­¦é™¢æ˜¯ä¸€ä¸ªå­ç½‘ï¼Œå…¶ä»–ä¸åŒçš„å­¦é™¢ä¹Ÿæ˜¯ä¸åŒçš„å­ç½‘ï¼Œä¸åŒçš„å­ç½‘ä¹‹é—´é€šè¿‡è·¯ç”±ç»„æˆäº†æ•´ä¸ªå­¦æ ¡çš„å±€åŸŸç½‘ã€‚vpcå°±ç›¸å½“äºäº‘æœåŠ¡ä¸Šçš„å±€åŸŸç½‘ï¼Œæˆ‘ä»¬ä¸åŒçš„æœåŠ¡åœ¨åŒä¸€ä¸ªå­ç½‘ä¸‹ï¼Œæ¯”å¦‚ä¹‹å‰æˆ‘ä»¬æåˆ°çš„æ¸¸æˆæœåŠ¡å™¨åœ¨åŒä¸€ä¸ªå­ç½‘ä¸‹ï¼Œå­˜å‚¨æœåŠ¡åœ¨å¦ä¸€ä¸ªå­ç½‘ä¸‹ï¼Œä½†ä»–ä»¬æ•´ä½“åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘ä¸‹ï¼Œè¿™æ ·ä¿è¯äº†é€šä¿¡çš„æ•ˆç‡å’Œå®‰å…¨æ€§ã€‚</p>
<ul>
<li><strong>SLB</strong></li>
</ul>
<p>éšç€æˆ‘ä»¬çš„æ¸¸æˆè¶Šæ¥è¶Šç«ï¼Œæˆ‘ä»¬æœåŠ¡å™¨ä¸èƒ½éƒ¨ç½²åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šï¼Œä¸€ä¸ªæ˜¯éšç€ç¡¬ä»¶éœ€æ±‚çš„å¢é«˜ï¼Œæˆæœ¬ä¹Ÿåœ¨ç¿»å€ï¼Œå•å°æœåŠ¡å™¨ä¹Ÿæœ‰æ€§èƒ½çš„ç“¶é¢ˆã€‚å¦ä¸€ä¸ªåªæœ‰ä¸€å°ï¼ŒæœåŠ¡å™¨ä¸èƒ½ä¿è¯é«˜å¯ç”¨ï¼ŒæœåŠ¡å™¨ä¸€æ—¦å®•æœºäº†ï¼Œæ•´ä¸ªæœåŠ¡å°±ä¸å¯ç”¨äº†ã€‚æˆ‘ä»¬ä¹‹å‰æåˆ°çš„ä¾‹å­ä¸­å‘¢ï¼Œå¤§éƒ¨åˆ†å…¶å®éƒ½åšæˆä¸€ä¸ªå­ç½‘ï¼Œç”±å¤šå°æœåŠ¡å™¨ç»„æˆï¼Œé‚£slbå°±è´Ÿè´£å¯¹å¤šå°äº‘æœåŠ¡å™¨è¿›è¡Œæµé‡åˆ†å‘å’Œè´Ÿè½½å‡è¡¡ã€‚æˆ‘ä»¬æ¥ä¸‹æ¥çœ‹ä¸‹slbå·¥ä½œçš„æµç¨‹ï¼Œæ¸¸æˆçš„è¯·æ±‚å‘é€åˆ°slbæœåŠ¡loadbalancerï¼Œloadbalancerä¹Ÿå¯ä»¥æ˜¯å¤šå°éƒ¨ç½²ï¼Œå®Œå…¨æ¶ˆé™¤å•ç‚¹çš„éšæ‚£ã€‚ç„¶åloadbalanceræ ¹æ®æˆ‘ä»¬å®šä¹‰çš„è´Ÿè½½å‡è¡¡ç­–ç•¥å’Œè½¬å‘è§„åˆ™ï¼Œå°†è¯·æ±‚è½¬å‘åˆ°æˆ‘ä»¬åç«¯çš„ä¸åŒä¸šåŠ¡æœåŠ¡å™¨ï¼Œä¸šåŠ¡æœåŠ¡å™¨ä¹Ÿæ˜¯å¤šå°éƒ¨ç½²ï¼Œæ²¡æœ‰å•ç‚¹é—®é¢˜ï¼Œä¸šåŠ¡æœåŠ¡å¤„ç†å®Œè¯·æ±‚åï¼Œå°†æ¶ˆæ¯ç»“æœè¿”å›ç»™loadbalancerï¼Œå†æœ‰loadbalancerè¿”å›ç»™å‰ç«¯ã€‚</p>
<p>é‚£slbé™¤äº†æµé‡åˆ†å‘ä¹‹å¤–è¿˜æä¾›äº†å¾ˆå¤šå…¶ä»–ç‰¹æ€§ï¼ŒåŒ…æ‹¬è™šæ‹ŸæœåŠ¡IPåœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåç«¯æ‰€æœ‰çš„æœåŠ¡èŠ‚ç‚¹è§†ä¸ºåŒä¸€ä¸ªè™šæ‹ŸæœåŠ¡å¯¹å¤–æä¾›ï¼Œä¿è¯äº†é«˜æ€§èƒ½å’Œé«˜å¯ç”¨çš„æœåŠ¡æ± ã€‚æˆ‘ä»¬è¿˜å¯ä»¥è‡ªå®šä¹‰æˆ‘ä»¬çš„åè®®è½¬å‘è§„åˆ™ï¼Œæ¯”å¦‚ä¸€äº›æˆ˜æ–—åè®®è½¬å‘åˆ°æˆ˜æ–—æœåŠ¡å™¨é›†ç¾¤ï¼Œæ¶ˆè´¹åè®®è½¬å‘åˆ°æ”¯ä»˜æœåŠ¡å™¨é›†ç¾¤ç­‰ã€‚è¿˜å¯ä»¥è‡ªå®šä¹‰è°ƒåº¦è§„åˆ™ï¼Œæ¯”å¦‚ä¼˜å…ˆä½¿ç”¨åŒåœ°åŒºçš„æœåŠ¡é›†ç¾¤ï¼Œæˆ–è€…æœ€ç©ºé—²çš„æœåŠ¡é›†ç¾¤ç­‰ã€‚è¿˜æä¾›äº†å¥åº·æ£€æµ‹ï¼Œæ–°å¢æœåŠ¡å™¨å’Œåˆ é™¤æœåŠ¡å™¨çš„æ—¶å€™ï¼Œslbè‡ªåŠ¨ä»å¯ç”¨èŠ‚ç‚¹ä¸­åŠ å…¥æˆ–åˆ é™¤ï¼Œæé«˜åº”ç”¨æ•´ä½“æœåŠ¡èƒ½åŠ›ã€‚é˜²æŠ¤èƒ½åŠ›ï¼Œé˜²DDoSæ”»å‡»ï¼Œè¿˜å¯ä»¥æ·»åŠ SSLè¯ä¹¦ï¼Œè¿™æ ·httpsçš„è¯·æ±‚ï¼Œå°±ä¸éœ€è¦æˆ‘ä»¬åœ¨ä¸šåŠ¡æœåŠ¡å™¨ä¸­å•ç‹¬å¤„ç†äº†ã€‚å¦å¤–å°±æ˜¯å¤šåŒºåŸŸå®¹ç¾ï¼Œè¿™æ ·å³ä½¿æˆ‘ä»¬çš„æŸä¸€ä¸ªæœºæˆ¿å‡ºç°é—®é¢˜ï¼Œä¹Ÿä¸ä¼šå½±å“æˆ‘ä»¬æœåŠ¡çš„æ•´ä½“å¯ç”¨æ€§ã€‚</p>
<ul>
<li><strong>åº”ç”¨</strong></li>
</ul>
<p>ä»¥æˆ‘ä¹‹å‰åšè¿‡çš„ä¸€ä¸ªå¡ç‰Œæ¸¸æˆä¸¾ä¾‹ï¼Œåœ¨å…¶ä¸­åº”ç”¨åˆ°å¤šå°slbçš„æœåŠ¡ï¼Œä¸€ä¸ªæ˜¯æ¸¸æˆæ›´æ–°çš„æœåŠ¡ï¼Œåœ¨è¿™ä¸ªæœåŠ¡ä¸­åŒ…æ‹¬äº†å¤šå°è´Ÿè´£åœ¨æ¸¸æˆä¸­ä¸€äº›éœ€è¦èµ„æºçƒ­æ›´çš„åœ°æ–¹ï¼Œslbå°†èµ„æºæ›´æ–°çš„è¯·æ±‚å‘é€åˆ°è´Ÿè½½æ¯”è¾ƒä½çš„åå°webæœåŠ¡ä¸Šã€‚å¦ä¸€ä¸ªæ˜¯æ¸¸æˆè¿è¡ŒæœåŠ¡ï¼Œæ‰€æœ‰æ¸¸æˆè¿è¡ŒæœåŠ¡çš„èŠ‚ç‚¹éƒ½æŒ‚åœ¨è¿™ä¸ªslbä¸‹é¢ï¼Œslbè´Ÿè´£å°†ç©å®¶è¯·æ±‚åˆ†å‘åˆ°å¯¹åº”çš„æœåŠ¡å™¨ä¸Šã€‚é¦–å…ˆé€šè¿‡ä¸åŒçš„slbè¿›è¡Œäº†ä¸šåŠ¡æ–¹é¢çš„åˆ†æµï¼Œä¸åŒçš„slbå†…éƒ¨æœ‰ä¸åŒçš„æœåŠ¡å™¨å»è´Ÿè´£å¤„ç†è¯·æ±‚ï¼Œè¿™æ ·æå¤§çš„æå‡äº†ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ï¼Œä¸šåŠ¡ä¹‹é—´å‘¢ä¹Ÿç›¸äº’éš”ç¦»ã€‚ç„¶åæ¯ä¸ªæœåŠ¡ä¹‹å†…å‘¢ä¹Ÿæ˜¯éƒ¨ç½²äº†å¤šå°èŠ‚ç‚¹ï¼Œä¿è¯äº†æœåŠ¡çš„é«˜å¯ç”¨ã€‚</p>
<ul>
<li><h1 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h1></li>
</ul>
<p><a href="https://segmentfault.com/a/1190000022739178?from=from_parent_mindnote">https://segmentfault.com/a/1190000022739178?from=from_parent_mindnote</a></p>
<p><a href="https://main.qcloudimg.com/raw/document/product/pdf/375_12015_cn.pdf?from=from_parent_mindnote">https://main.qcloudimg.com/raw/document/product/pdf/375_12015_cn.pdf?from=from_parent_mindnote</a></p>
<p><a href="https://imgtu.com/i/5tm5HP"><a href="https://z3.ax1x.com/2021/10/17/5tm5HP.png" title="5tm5HP.png" class="gallery-item" style="box-shadow: none;"> <img src="https://z3.ax1x.com/2021/10/17/5tm5HP.png" alt="5tm5HP.png"></a></a><br><a href="https://imgtu.com/i/5tm74S"><a href="https://z3.ax1x.com/2021/10/17/5tm74S.png" title="5tm74S.png" class="gallery-item" style="box-shadow: none;"> <img src="https://z3.ax1x.com/2021/10/17/5tm74S.png" alt="5tm74S.png"></a></a><br><a href="https://imgtu.com/i/5tmb9g"><a href="https://z3.ax1x.com/2021/10/17/5tmb9g.png" title="5tmb9g.png" class="gallery-item" style="box-shadow: none;"> <img src="https://z3.ax1x.com/2021/10/17/5tmb9g.png" alt="5tmb9g.png"></a></a><br><a href="https://imgtu.com/i/5tmTN8"><a href="https://z3.ax1x.com/2021/10/17/5tmTN8.png" title="5tmTN8.png" class="gallery-item" style="box-shadow: none;"> <img src="https://z3.ax1x.com/2021/10/17/5tmTN8.png" alt="5tmTN8.png"></a></a><br><a href="https://imgtu.com/i/5tmoAf"><a href="https://z3.ax1x.com/2021/10/17/5tmoAf.png" title="5tmoAf.png" class="gallery-item" style="box-shadow: none;"> <img src="https://z3.ax1x.com/2021/10/17/5tmoAf.png" alt="5tmoAf.png"></a></a></p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>æ‚ä¹±</tag>
      </tags>
  </entry>
  <entry>
    <title>åƒåœ¾å›æ”¶å™¨G1è¯¦è§£</title>
    <url>/garbage-first/</url>
    <content><![CDATA[<div class=".article-gallery"><p>è½¬è½½è‡ªï¼š<a href="https://www.cnblogs.com/yanl55555/p/13366387.html">JVMä¸ƒå¤§åƒåœ¾å›æ”¶å™¨ä¸‹ç¯‡G1(Garbage First)</a></p>
<h1 id="G1å›æ”¶å™¨-åŒºåŸŸåŒ–åˆ†ä»£å¼"><a href="#G1å›æ”¶å™¨-åŒºåŸŸåŒ–åˆ†ä»£å¼" class="headerlink" title="G1å›æ”¶å™¨:åŒºåŸŸåŒ–åˆ†ä»£å¼"></a>G1å›æ”¶å™¨:åŒºåŸŸåŒ–åˆ†ä»£å¼</h1><p><strong>æ—¢ç„¶æˆ‘ä»¬å·²ç»æœ‰äº†å‰é¢å‡ ä¸ªå¼ºå¤§çš„GCï¼Œä¸ºä»€ä¹ˆè¿˜è¦å‘å¸ƒGarbage First ï¼ˆG1ï¼‰GCï¼Ÿ</strong><br>â€ƒâ€ƒåŸå› å°±åœ¨äºåº”ç”¨ç¨‹åºæ‰€åº”å¯¹çš„ä¸šåŠ¡è¶Šæ¥è¶Šåºå¤§ã€å¤æ‚ï¼Œç”¨æˆ·è¶Šæ¥è¶Šå¤šï¼Œæ²¡æœ‰GCå°±ä¸èƒ½ä¿è¯åº”ç”¨ç¨‹åºæ­£å¸¸è¿›è¡Œï¼Œè€Œç»å¸¸é€ æˆSTWçš„GCåˆè·Ÿä¸ä¸Šå®é™…çš„éœ€æ±‚ï¼Œæ‰€ä»¥æ‰ä¼šä¸æ–­åœ°å°è¯•å¯¹GCè¿›è¡Œä¼˜åŒ–ã€‚G1 ï¼ˆGarbageä¸€Firstï¼‰ åƒåœ¾å›æ”¶å™¨æ˜¯åœ¨Java7 update4ä¹‹åå¼•å…¥çš„ä¸€ä¸ªæ–°çš„åƒåœ¾å›æ”¶å™¨ï¼Œæ˜¯å½“ä»Šæ”¶é›†å™¨æŠ€æœ¯å‘å±•çš„æœ€å‰æ²¿æˆæœä¹‹ä¸€ã€‚<br>â€ƒâ€ƒä¸æ­¤åŒæ—¶ï¼Œä¸ºäº†é€‚åº”ç°åœ¨ä¸æ–­æ‰©å¤§çš„å†…å­˜å’Œä¸æ–­å¢åŠ çš„å¤„ç†å™¨æ•°é‡ï¼Œè¿›ä¸€æ­¥é™ä½æš‚åœæ—¶é—´ï¼ˆpause timeï¼‰ ï¼ŒåŒæ—¶å…¼é¡¾è‰¯å¥½çš„ååé‡ã€‚<br>â€ƒâ€ƒå®˜æ–¹ç»™G1è®¾å®šçš„ç›®æ ‡æ˜¯åœ¨å»¶è¿Ÿå¯æ§ï¼ˆä½æš‚åœï¼‰çš„æƒ…å†µä¸‹è·å¾—å°½å¯èƒ½é«˜çš„ååé‡ï¼ˆé«˜ååï¼‰ï¼Œæ‰€ä»¥æ‰æ‹…å½“èµ·â€œå…¨åŠŸèƒ½æ”¶é›†å™¨â€çš„é‡ä»»ä¸æœŸæœ›ã€‚</p>
<span id="more"></span>

<h2 id="ä¸ºä»€ä¹ˆåå­—å«åšGarbage-First-ï¼ˆG1ï¼‰å‘¢ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆåå­—å«åšGarbage-First-ï¼ˆG1ï¼‰å‘¢ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆåå­—å«åšGarbage First ï¼ˆG1ï¼‰å‘¢ï¼Ÿ"></a><strong>ä¸ºä»€ä¹ˆåå­—å«åšGarbage First ï¼ˆG1ï¼‰å‘¢ï¼Ÿ</strong></h2><ul>
<li>å› ä¸ºG1æ˜¯ä¸€ä¸ªå¹¶è¡Œå›æ”¶å™¨ï¼Œå®ƒæŠŠå †å†…å­˜åˆ†å‰²ä¸ºå¾ˆå¤šä¸ç›¸å…³çš„åŒºåŸŸï¼ˆRegionï¼‰ ï¼ˆç‰©ç†ä¸Š ä¸è¿ç»­çš„ï¼‰ã€‚ä½¿ç”¨ä¸åŒçš„Regionæ¥è¡¨ç¤ºEdenã€å¹¸å­˜è€…0åŒºï¼Œå¹¸å­˜è€…1åŒºï¼Œè€å¹´ä»£ç­‰ã€‚</li>
<li>G1 GCæœ‰è®¡åˆ’åœ°é¿å…åœ¨æ•´ä¸ªJava å †ä¸­è¿›è¡Œå…¨åŒºåŸŸçš„åƒåœ¾æ”¶é›†ã€‚G1è·Ÿè¸ªå„ä¸ªRegion é‡Œé¢çš„åƒåœ¾å †ç§¯çš„ä»·å€¼å¤§å°ï¼ˆå›æ”¶æ‰€è·å¾—çš„ç©ºé—´å¤§å°ä»¥åŠå›æ”¶æ‰€éœ€æ—¶é—´çš„ç»éªŒå€¼ï¼‰ï¼Œåœ¨åå°ç»´æŠ¤ä¸€ä¸ªä¼˜å…ˆåˆ—è¡¨ï¼Œæ¯æ¬¡æ ¹æ®å…è®¸çš„æ”¶é›†æ—¶é—´ï¼Œä¼˜å…ˆå›æ”¶ä»·å€¼æœ€å¤§çš„Regionã€‚</li>
<li>ç”±äºè¿™ç§æ–¹å¼çš„ä¾§é‡ç‚¹åœ¨äºå›æ”¶åƒåœ¾æœ€å¤§é‡çš„åŒºé—´ï¼ˆRegionï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»™G1ä¸€ä¸ªåå­—ï¼šåƒåœ¾ä¼˜å…ˆï¼ˆGarbage Firstï¼‰ ã€‚</li>
<li>G1 ï¼ˆGarbageä¸€Firstï¼‰ æ˜¯ä¸€æ¬¾é¢å‘æœåŠ¡ç«¯åº”ç”¨çš„åƒåœ¾æ”¶é›†å™¨ï¼Œä¸»è¦é’ˆå¯¹é…å¤‡å¤šæ ¸CPUåŠå¤§å®¹é‡å†…å­˜çš„æœºå™¨ï¼Œä»¥æé«˜æ¦‚ç‡æ»¡è¶³GCåœé¡¿æ—¶é—´çš„åŒæ—¶ï¼Œè¿˜å…¼å…·é«˜ååé‡çš„æ€§èƒ½ç‰¹å¾ã€‚</li>
<li>åœ¨JDK1. 7ç‰ˆæœ¬æ­£å¼å¯ç”¨ï¼Œç§»é™¤äº†Experimentalçš„æ ‡è¯†ï¼Œæ˜¯JDK 9ä»¥åçš„é»˜è®¤åƒåœ¾å›æ”¶å™¨ï¼Œå–ä»£äº†CMSå›æ”¶å™¨ä»¥åŠParallel + Parallel 0ldç»„åˆã€‚è¢«Oracleå®˜æ–¹ç§°ä¸ºâ€œå…¨åŠŸèƒ½çš„åƒåœ¾æ”¶é›†å™¨â€ ã€‚</li>
<li>ä¸æ­¤åŒæ—¶ï¼ŒCMSå·²ç»åœ¨JDK 9ä¸­è¢«æ ‡è®°ä¸ºåºŸå¼ƒï¼ˆdeprecatedï¼‰ ã€‚</li>
<li>G1åœ¨jdk8ä¸­è¿˜ä¸æ˜¯é»˜è®¤çš„åƒåœ¾å›æ”¶å™¨ï¼Œéœ€è¦ä½¿ç”¨ä¸€XXï¼š +UseG1GCæ¥å¯ç”¨ã€‚</li>
</ul>
<h2 id="G1åƒåœ¾å›æ”¶å™¨ä¼˜åŠ¿"><a href="#G1åƒåœ¾å›æ”¶å™¨ä¼˜åŠ¿" class="headerlink" title="G1åƒåœ¾å›æ”¶å™¨ä¼˜åŠ¿"></a>G1åƒåœ¾å›æ”¶å™¨ä¼˜åŠ¿</h2><p>ä¸å…¶ä»–GCæ”¶é›†å™¨ç›¸æ¯”ï¼ŒG1ä½¿ç”¨äº†å…¨æ–°çš„åˆ†åŒºç®—æ³•ï¼Œå…¶ç‰¹ç‚¹å¦‚ä¸‹æ‰€ç¤ºï¼šå››ä¸ªç‰¹ç‚¹ï¼š</p>
<ul>
<li>å¹¶è¡Œä¸å¹¶å‘<ul>
<li>â¢å¹¶è¡Œæ€§ï¼š G1åœ¨å›æ”¶æœŸé—´ï¼Œå¯ä»¥æœ‰å¤šä¸ªGcçº¿ç¨‹åŒæ—¶å·¥ä½œï¼Œæœ‰æ•ˆåˆ©ç”¨å¤šæ ¸è®¡ç®—èƒ½åŠ›ã€‚æ­¤æ—¶ç”¨æˆ·çº¿ç¨‹STW</li>
<li>â¢å¹¶å‘æ€§ï¼š G1æ‹¥æœ‰ä¸åº”ç”¨ç¨‹åºäº¤æ›¿æ‰§è¡Œçš„èƒ½åŠ›ï¼Œéƒ¨åˆ†å·¥ä½œå¯ä»¥å’Œåº”ç”¨ç¨‹åºåŒæ—¶æ‰§è¡Œï¼Œå› æ­¤ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œä¸ä¼šåœ¨æ•´ä¸ªå›æ”¶é˜¶æ®µå‘ç”Ÿå®Œå…¨é˜»å¡åº”ç”¨ç¨‹åºçš„æƒ…å†µ</li>
</ul>
</li>
<li>åˆ†ä»£æ”¶é›†<ul>
<li>â¢ä»åˆ†ä»£ä¸Šçœ‹ï¼ŒG1ä¾ç„¶å±äºåˆ†ä»£å‹åƒåœ¾å›æ”¶å™¨ï¼Œå®ƒä¼šåŒºåˆ†å¹´è½»ä»£å’Œè€å¹´ä»£ï¼Œå¹´è½»ä»£ä¾ç„¶æœ‰EdenåŒºå’ŒSurvivoråŒºã€‚ä½†ä»å †çš„ç»“æ„ä¸Šçœ‹ï¼Œå®ƒä¸è¦æ±‚æ•´ä¸ªEdenåŒºã€å¹´è½»ä»£æˆ–è€…è€å¹´ä»£éƒ½æ˜¯è¿ç»­çš„ï¼Œä¹Ÿä¸å†åšæŒå›ºå®šå¤§å°å’Œå›ºå®šæ•°é‡ã€‚</li>
<li>â¢å°†å †ç©ºé—´åˆ†ä¸ºè‹¥å¹²ä¸ªåŒºåŸŸï¼ˆRegionï¼‰ ï¼Œè¿™äº›åŒºåŸŸä¸­åŒ…å«äº†é€»è¾‘ä¸Šçš„å¹´è½»ä»£å’Œè€å¹´ä»£ã€‚</li>
<li>â¢å’Œä¹‹å‰çš„å„ç±»å›æ”¶å™¨ä¸åŒï¼Œå®ƒåŒæ—¶å…¼é¡¾å¹´è½»ä»£å’Œè€å¹´ä»£ã€‚å¯¹æ¯”å…¶ä»–å›æ”¶å™¨ï¼Œæˆ–è€…å·¥ä½œåœ¨å¹´è½»ä»£ï¼Œæˆ–è€…å·¥ä½œåœ¨è€å¹´ä»£ï¼›</li>
</ul>
</li>
</ul>
<p><a href="https://img2020.cnblogs.com/blog/1846149/202007/1846149-20200723144423293-687202683.png" title="img" class="gallery-item" style="box-shadow: none;"> <img src="https://img2020.cnblogs.com/blog/1846149/202007/1846149-20200723144423293-687202683.png" alt="img"></a><a href="https://img2020.cnblogs.com/blog/1846149/202007/1846149-20200723144442615-1696089988.png" title="img" class="gallery-item" style="box-shadow: none;"> <img src="https://img2020.cnblogs.com/blog/1846149/202007/1846149-20200723144442615-1696089988.png" alt="img"></a></p>
<ul>
<li><p>ç©ºé—´æ•´åˆ</p>
</li>
<li><ul>
<li>â¢CMSï¼š â€œæ ‡è®°ä¸€æ¸…é™¤â€ç®—æ³•ã€å†…å­˜ç¢ç‰‡ã€è‹¥å¹²æ¬¡Gcåè¿›è¡Œä¸€æ¬¡ç¢ç‰‡æ•´ç†</li>
<li>â¢G1å°†å†…å­˜åˆ’åˆ†ä¸ºä¸€ä¸ªä¸ªçš„regionã€‚ å†…å­˜çš„å›æ”¶æ˜¯ä»¥regionä½œä¸ºåŸºæœ¬å•ä½çš„ã€‚Regionä¹‹é—´æ˜¯å¤åˆ¶ç®—æ³•ã€‚</li>
<li>ä½†æ•´ä½“ä¸Šå®é™…å¯çœ‹ä½œæ˜¯æ ‡è®°ä¸€å‹ç¼©ï¼ˆMarkä¸€Compactï¼‰ç®—æ³•ï¼Œä¸¤ç§ç®—æ³•éƒ½å¯ä»¥é¿å…å†…å­˜ç¢ç‰‡ã€‚è¿™ç§ç‰¹æ€§æœ‰åˆ©äºç¨‹åºé•¿æ—¶é—´è¿è¡Œï¼Œåˆ†é…å¤§å¯¹è±¡æ—¶ä¸ä¼šå› ä¸ºæ— æ³•æ‰¾åˆ°è¿ç»­å†…å­˜ç©ºé—´è€Œæå‰è§¦å‘ä¸‹ä¸€æ¬¡GCã€‚å°¤å…¶æ˜¯å½“Javaå †éå¸¸å¤§çš„æ—¶å€™ï¼ŒG1çš„ä¼˜åŠ¿æ›´åŠ æ˜æ˜¾ã€‚</li>
</ul>
</li>
<li><p>å¯é¢„æµ‹çš„åœé¡¿æ—¶é—´æ¨¡å‹ï¼ˆå³ï¼šè½¯å®æ—¶soft realä¸€timeï¼‰</p>
<p>ï¼š è¿™æ˜¯G1ç›¸å¯¹äºCMSçš„å¦ä¸€å¤§ä¼˜åŠ¿ï¼ŒG1é™¤äº†è¿½æ±‚ä½åœé¡¿å¤–ï¼Œè¿˜èƒ½å»ºç«‹å¯é¢„æµ‹çš„åœé¡¿æ—¶é—´æ¨¡å‹ï¼Œèƒ½è®©ä½¿ç”¨è€…æ˜ç¡®æŒ‡å®šåœ¨ä¸€ä¸ªé•¿åº¦ä¸ºMæ¯«ç§’çš„æ—¶é—´ç‰‡æ®µå†…ï¼Œæ¶ˆè€—åœ¨åƒåœ¾æ”¶é›†ä¸Šçš„æ—¶é—´ä¸å¾—è¶…è¿‡Næ¯«ç§’ã€‚</p>
<ul>
<li>â¢ç”±äºåˆ†åŒºçš„åŸå› ï¼ŒG1å¯ä»¥åªé€‰å–éƒ¨åˆ†åŒºåŸŸè¿›è¡Œå†…å­˜å›æ”¶ï¼Œè¿™æ ·ç¼©å°äº†å›æ”¶çš„èŒƒå›´ï¼Œå› æ­¤å¯¹äºå…¨å±€åœé¡¿æƒ…å†µçš„å‘ç”Ÿä¹Ÿèƒ½å¾—åˆ°è¾ƒå¥½çš„æ§åˆ¶ã€‚</li>
<li>â¢G1è·Ÿè¸ªå„ä¸ªRegioné‡Œé¢çš„åƒåœ¾å †ç§¯çš„ä»·å€¼å¤§å°ï¼ˆå›æ”¶æ‰€è·å¾—çš„ç©ºé—´å¤§å°ä»¥ åŠå›æ”¶æ‰€éœ€æ—¶é—´çš„ç»éªŒå€¼ï¼‰ï¼Œåœ¨åå°ç»´æŠ¤ä¸€ä¸ªä¼˜å…ˆåˆ—è¡¨ï¼Œæ¯æ¬¡æ ¹æ®å…è®¸çš„æ”¶é›†æ—¶é—´ï¼Œä¼˜å…ˆå›æ”¶ä»·å€¼æœ€å¤§çš„Regionã€‚ä¿è¯äº†G1 æ”¶é›†å™¨åœ¨æœ‰é™çš„æ—¶é—´å†…å¯ä»¥è·å–å°½å¯èƒ½é«˜çš„æ”¶é›†æ•ˆç‡ã€‚</li>
<li>â¢ç›¸æ¯”äºCMSGCï¼ŒG1æœªå¿…èƒ½åšåˆ°CMSåœ¨æœ€å¥½æƒ…å†µä¸‹çš„å»¶æ—¶åœé¡¿ï¼Œä½†æ˜¯æœ€å·®æƒ…å†µè¦.å¥½å¾ˆå¤šã€‚</li>
</ul>
</li>
</ul>
<h2 id="G1ç¼ºç‚¹"><a href="#G1ç¼ºç‚¹" class="headerlink" title="G1ç¼ºç‚¹"></a>G1ç¼ºç‚¹</h2><ul>
<li>ç›¸è¾ƒäºCMSï¼ŒG1è¿˜ä¸å…·å¤‡å…¨æ–¹ä½ã€å‹å€’æ€§ä¼˜åŠ¿ã€‚æ¯”å¦‚åœ¨ç”¨æˆ·ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼ŒG1æ— è®ºæ˜¯ä¸ºäº†åƒåœ¾æ”¶é›†äº§ç”Ÿçš„å†…å­˜å ç”¨ï¼ˆFootprintï¼‰ è¿˜æ˜¯ç¨‹åºè¿è¡Œæ—¶çš„é¢å¤–æ‰§è¡Œè´Ÿè½½ï¼ˆoverloadï¼‰ éƒ½è¦æ¯”CMSè¦é«˜ã€‚</li>
<li>ä»ç»éªŒä¸Šæ¥è¯´ï¼Œåœ¨å°å†…å­˜åº”ç”¨ä¸ŠCMSçš„è¡¨ç°å¤§æ¦‚ç‡ä¼šä¼˜äºG1ï¼Œè€ŒG1åœ¨å¤§å†…å­˜åº”ç”¨ï¼Œä¸Šåˆ™å‘æŒ¥å…¶ä¼˜åŠ¿ã€‚å¹³è¡¡ç‚¹åœ¨6ä¸€8GBä¹‹é—´ã€‚</li>
</ul>
<h2 id="G1å‚æ•°è®¾ç½®"><a href="#G1å‚æ•°è®¾ç½®" class="headerlink" title="G1å‚æ•°è®¾ç½®"></a>G1å‚æ•°è®¾ç½®</h2><ul>
<li>-XXï¼š+UseG1GC æ‰‹åŠ¨æŒ‡å®šä½¿ç”¨G1æ”¶é›†å™¨æ‰§è¡Œå†…å­˜å›æ”¶ä»»åŠ¡ã€‚</li>
<li>-XXï¼šG1HeapRegionSize è®¾ç½®æ¯ä¸ªRegionçš„å¤§å°ã€‚å€¼æ˜¯2çš„å¹‚ï¼ŒèŒƒå›´æ˜¯1MB åˆ°32MBä¹‹é—´ï¼Œç›®æ ‡æ˜¯æ ¹æ®æœ€å°çš„Javaå †å¤§å°åˆ’åˆ†å‡ºçº¦2048ä¸ªåŒºåŸŸã€‚é»˜è®¤æ˜¯å †å†…å­˜çš„1/2000ã€‚</li>
<li>-XXï¼šMaxGCPauseMillis è®¾ç½®æœŸæœ›è¾¾åˆ°çš„æœ€å¤§Gcåœé¡¿æ—¶é—´æŒ‡æ ‡ï¼ˆJVMä¼šå°½åŠ›å®ç°ï¼Œä½†ä¸ä¿è¯è¾¾åˆ°ï¼‰ã€‚é»˜è®¤å€¼æ˜¯200ms</li>
<li>-xXï¼šParallelGCThread è®¾ç½®sTw.å·¥ä½œçº¿ç¨‹æ•°çš„å€¼ã€‚æœ€å¤šè®¾ç½®ä¸º8</li>
<li>-XXï¼šConcGCThreads è®¾ç½®å¹¶å‘æ ‡è®°çš„çº¿ç¨‹æ•°ã€‚å°†nè®¾ç½®ä¸ºå¹¶è¡Œåƒåœ¾å›æ”¶çº¿ç¨‹æ•°ï¼ˆParallelGCThreadsï¼‰çš„1/4å·¦å³ã€‚</li>
<li>-XXï¼šIni tiatingHeapOccupancyPercent è®¾ç½®è§¦å‘å¹¶å‘GCå‘¨æœŸçš„Javaå †å ç”¨ç‡é˜ˆå€¼ã€‚è¶…è¿‡æ­¤å€¼ï¼Œå°±è§¦å‘GCã€‚é»˜è®¤å€¼æ˜¯45ã€‚</li>
</ul>
<h2 id="G1å›æ”¶å™¨çš„å¸¸è§æ“ä½œæ­¥éª¤"><a href="#G1å›æ”¶å™¨çš„å¸¸è§æ“ä½œæ­¥éª¤" class="headerlink" title="G1å›æ”¶å™¨çš„å¸¸è§æ“ä½œæ­¥éª¤"></a>G1å›æ”¶å™¨çš„å¸¸è§æ“ä½œæ­¥éª¤</h2><p>G1çš„è®¾è®¡åŸåˆ™å°±æ˜¯ç®€åŒ–JVMæ€§èƒ½è°ƒä¼˜ï¼Œå¼€å‘äººå‘˜åªéœ€è¦ç®€å•çš„ä¸‰æ­¥å³å¯å®Œæˆè°ƒä¼˜ï¼š</p>
<ul>
<li>ç¬¬ä¸€æ­¥ï¼šå¼€å¯G1åƒåœ¾æ”¶é›†å™¨</li>
<li>ç¬¬äºŒæ­¥ï¼šè®¾ç½®å †çš„æœ€å¤§å†…å­˜</li>
<li>ç¬¬ä¸‰æ­¥ï¼šè®¾ç½®æœ€å¤§çš„åœé¡¿æ—¶é—´</li>
</ul>
<p>G1ä¸­æä¾›äº†ä¸‰ç§åƒåœ¾å›æ”¶æ¨¡å¼ï¼š YoungGCã€ Mixed GCå’ŒFull GCï¼Œ åœ¨ä¸åŒçš„æ¡ä»¶ä¸‹è¢«è§¦å‘ã€‚ï¼ˆåæ–‡è¯¦ç»†è®²ï¼‰</p>
<p><a href="https://img2020.cnblogs.com/blog/1846149/202007/1846149-20200723143818066-1702622040.png" title="img" class="gallery-item" style="box-shadow: none;"> <img src="https://img2020.cnblogs.com/blog/1846149/202007/1846149-20200723143818066-1702622040.png" alt="img"></a></p>
<h2 id="G1é€‚ç”¨åœºæ™¯"><a href="#G1é€‚ç”¨åœºæ™¯" class="headerlink" title="G1é€‚ç”¨åœºæ™¯"></a>G1é€‚ç”¨åœºæ™¯</h2><ul>
<li>é¢å‘æœåŠ¡ç«¯åº”ç”¨ï¼Œé’ˆå¯¹å…·æœ‰å¤§å†…å­˜ã€å¤šå¤„ç†å™¨çš„æœºå™¨ã€‚ï¼ˆåœ¨æ™®é€šå¤§å°çš„å †é‡Œè¡¨ç°å¹¶ä¸æƒŠå–œï¼‰</li>
<li>æœ€ä¸»è¦çš„åº”ç”¨æ˜¯éœ€è¦ä½GCå»¶è¿Ÿï¼Œå¹¶å…·æœ‰å¤§å †çš„åº”ç”¨ç¨‹åºæä¾›è§£å†³æ–¹æ¡ˆï¼›</li>
<li>å¦‚ï¼šåœ¨å †å¤§å°çº¦6GBæˆ–æ›´å¤§æ—¶ï¼Œå¯é¢„æµ‹çš„æš‚åœæ—¶é—´å¯ä»¥ä½äº0.5ç§’ï¼› ï¼ˆ G1é€šè¿‡æ¯æ¬¡åªæ¸…ç†ä¸€éƒ¨åˆ†è€Œä¸æ˜¯å…¨éƒ¨çš„Regionçš„å¢é‡å¼æ¸…ç†æ¥ä¿è¯æ¯æ¬¡GCåœé¡¿æ—¶é—´ä¸ä¼šè¿‡é•¿ï¼‰ã€‚</li>
<li>ç”¨æ¥æ›¿æ¢æ‰JDK1.5ä¸­çš„CMSæ”¶é›†å™¨ï¼› åœ¨ä¸‹é¢çš„æƒ…å†µæ—¶ï¼Œä½¿ç”¨G1å¯èƒ½æ¯”CMSå¥½ï¼š<br>â‘ è¶…è¿‡50%çš„Javaå †è¢«æ´»åŠ¨æ•°æ®å ç”¨ï¼›<br>â‘¡å¯¹è±¡åˆ†é…é¢‘ç‡æˆ–å¹´ä»£æå‡é¢‘ç‡å˜åŒ–å¾ˆå¤§ï¼›<br>â‘¢GCåœé¡¿æ—¶é—´è¿‡é•¿ï¼ˆé•¿äº0. 5è‡³1ç§’ï¼‰ã€‚</li>
<li>HotSpotåƒåœ¾æ”¶é›†å™¨é‡Œï¼Œé™¤äº†G1ä»¥å¤–ï¼Œå…¶ä»–çš„åƒåœ¾æ”¶é›†å™¨ä½¿ç”¨å†…ç½®çš„JVMçº¿ç¨‹æ‰§è¡ŒGCï¼ˆçº¿ç¨‹ä¼˜å…ˆçº§ä½ï¼‰çš„å¤šçº¿ç¨‹æ“ä½œ</li>
<li>è€ŒG1 GCå¯ä»¥é‡‡ç”¨åº”ç”¨çº¿ç¨‹æ‰¿æ‹…åå°è¿è¡Œçš„GCå·¥ä½œï¼Œå³å½“JVMçš„GCçº¿ç¨‹å¤„ç†é€Ÿåº¦æ…¢æ—¶ï¼Œç³»ç»Ÿä¼šè°ƒç”¨åº”ç”¨ç¨‹åºçº¿ç¨‹å¸®åŠ©åŠ é€Ÿåƒåœ¾å›æ”¶è¿‡ç¨‹ã€‚</li>
</ul>
<h2 id="åˆ†åŒºregion-åŒ–æ•´ä¸ºé›¶"><a href="#åˆ†åŒºregion-åŒ–æ•´ä¸ºé›¶" class="headerlink" title="åˆ†åŒºregion,åŒ–æ•´ä¸ºé›¶"></a>åˆ†åŒºregion,åŒ–æ•´ä¸ºé›¶</h2><p>ä½¿ç”¨G1æ”¶é›†å™¨æ—¶ï¼Œå®ƒå°†æ•´ä¸ªJavaå †åˆ’åˆ†æˆçº¦2048ä¸ªå¤§å°ç›¸åŒçš„ç‹¬ç«‹Regionå—ï¼Œæ¯ä¸ªRegionå—å¤§å°æ ¹æ®å †ç©ºé—´çš„å®é™…å¤§å°è€Œå®šï¼Œæ•´ä½“è¢«æ§åˆ¶åœ¨1MBåˆ°32MBä¹‹é—´ï¼Œä¸”ä¸º2çš„Næ¬¡å¹‚ï¼Œå³1MBï¼Œ 2MBï¼Œ 4MBï¼Œ 8MBï¼Œ 1 6MBï¼Œ 32MBã€‚</p>
<p>å¯ä»¥é€šè¿‡ä¸€ XXï¼šG1HeapRegionSizeè®¾å®šã€‚æ‰€æœ‰çš„Regionå¤§å°ç›¸åŒï¼Œä¸”åœ¨JVMç”Ÿå‘½å‘¨æœŸå†…ä¸ä¼šè¢«æ”¹å˜ã€‚</p>
<p>è™½ç„¶è¿˜ä¿ç•™æœ‰æ–°ç”Ÿä»£å’Œè€å¹´ä»£çš„æ¦‚å¿µï¼Œä½†æ–°ç”Ÿä»£å’Œè€å¹´ä»£ä¸å†æ˜¯ç‰©ç†éš”ç¦»çš„äº†ï¼Œå®ƒä»¬éƒ½æ˜¯ä¸€éƒ¨åˆ†Region ï¼ˆä¸éœ€è¦è¿ç»­ï¼‰çš„é›†åˆã€‚é€šè¿‡Regionçš„åŠ¨æ€åˆ†é…æ–¹å¼å®ç°é€»è¾‘_ä¸Šçš„è¿ç»­ã€‚</p>
<p><a href="https://img2020.cnblogs.com/blog/1846149/202007/1846149-20200723150834993-49164173.png" title="img" class="gallery-item" style="box-shadow: none;"> <img src="https://img2020.cnblogs.com/blog/1846149/202007/1846149-20200723150834993-49164173.png" alt="img"></a></p>
<ul>
<li>ä¸€ä¸ªregion æœ‰å¯èƒ½å±äºEdenï¼Œ Survivor æˆ–è€…Old/Tenured å†…å­˜åŒºåŸŸã€‚ä½†æ˜¯ä¸€ä¸ªregionåªå¯èƒ½å±äºä¸€ä¸ªè§’è‰²ã€‚å›¾ä¸­çš„Eè¡¨ç¤ºè¯¥regionå±äºEdenå†…å­˜åŒºåŸŸï¼Œsè¡¨ç¤ºå±äºSurvivorå†…å­˜åŒºåŸŸï¼ŒOè¡¨ç¤ºå±äºOldå†…å­˜åŒºåŸŸã€‚å›¾ä¸­ç©ºç™½çš„è¡¨ç¤ºæœªä½¿ç”¨çš„å†…å­˜ç©ºé—´ã€‚</li>
<li>G1åƒåœ¾æ”¶é›†å™¨è¿˜å¢åŠ äº†ä¸€ç§æ–°çš„å†…å­˜åŒºåŸŸï¼Œå«åšHumongouså†…å­˜åŒºåŸŸï¼Œå¦‚å›¾ä¸­çš„Hå—ã€‚ä¸»è¦ç”¨äºå­˜å‚¨å¤§å¯¹è±¡ï¼Œå¦‚æœè¶…è¿‡1. 5ä¸ªregionï¼Œå°±æ”¾åˆ°Hã€‚</li>
<li>è®¾ç½®Hçš„åŸå› ï¼šå¯¹äºå †ä¸­çš„å¤§å¯¹è±¡ï¼Œé»˜è®¤ç›´æ¥ä¼šè¢«åˆ†é…åˆ°è€å¹´ä»£ï¼Œä½†æ˜¯å¦‚æœå®ƒæ˜¯ä¸€ä¸ªçŸ­æœŸå­˜åœ¨çš„å¤§å¯¹è±¡ï¼Œå°±ä¼šå¯¹åƒåœ¾æ”¶é›†å™¨é€ æˆè´Ÿé¢å½±å“ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒG1åˆ’åˆ†äº†ä¸€ä¸ªHumongousåŒºï¼Œå®ƒç”¨æ¥ä¸“é—¨å­˜æ”¾å¤§å¯¹è±¡ã€‚å¦‚æœä¸€ä¸ªHåŒºè£…ä¸ä¸‹ä¸€ä¸ªå¤§å¯¹è±¡ï¼Œé‚£ä¹ˆG1ä¼šå¯»æ‰¾è¿ç»­çš„HåŒºæ¥å­˜å‚¨ã€‚ä¸ºäº†èƒ½æ‰¾åˆ°è¿ç»­çš„HåŒºï¼Œæœ‰æ—¶å€™ä¸å¾—ä¸å¯åŠ¨Full GCã€‚G1çš„å¤§å¤šæ•°è¡Œä¸ºéƒ½æŠŠHåŒºä½œä¸ºè€å¹´ä»£çš„ä¸€éƒ¨åˆ†æ¥çœ‹å¾…ã€‚</li>
</ul>
<h1 id="G1å›æ”¶å™¨åƒåœ¾å›æ”¶è¿‡ç¨‹"><a href="#G1å›æ”¶å™¨åƒåœ¾å›æ”¶è¿‡ç¨‹" class="headerlink" title="G1å›æ”¶å™¨åƒåœ¾å›æ”¶è¿‡ç¨‹"></a>G1å›æ”¶å™¨åƒåœ¾å›æ”¶è¿‡ç¨‹</h1><p>G1 GCçš„åƒåœ¾å›æ”¶è¿‡ç¨‹ä¸»è¦åŒ…æ‹¬å¦‚ä¸‹ä¸‰ä¸ªç¯èŠ‚ï¼š</p>
<ul>
<li>å¹´è½»ä»£GC ï¼ˆYoung GC ï¼‰</li>
<li>è€å¹´ä»£å¹¶å‘æ ‡è®°è¿‡ç¨‹ï¼ˆ Concurrent Markingï¼‰</li>
<li>æ··åˆå›æ”¶ï¼ˆMixed GC ï¼‰</li>
<li>ï¼ˆå¦‚æœéœ€è¦ï¼Œå•çº¿ç¨‹ã€ç‹¬å å¼ã€é«˜å¼ºåº¦çš„Full GCè¿˜æ˜¯ç»§ç»­å­˜åœ¨çš„ã€‚å®ƒé’ˆå¯¹GCçš„è¯„ä¼°å¤±è´¥æä¾›äº†ä¸€ç§å¤±è´¥ä¿æŠ¤æœºåˆ¶ï¼Œå³å¼ºåŠ›å›æ”¶ã€‚ï¼‰</li>
</ul>
<p><a href="https://img2020.cnblogs.com/blog/1846149/202007/1846149-20200723151103477-1084742760.png" title="img" class="gallery-item" style="box-shadow: none;"> <img src="https://img2020.cnblogs.com/blog/1846149/202007/1846149-20200723151103477-1084742760.png" alt="img"></a></p>
<p> é¡ºæ—¶é’ˆï¼Œ young gc ä¸€&gt; young gc + concurrent mark ä¸€&gt; Mixed GCé¡ºåºï¼Œè¿›è¡Œåƒåœ¾å›æ”¶ã€‚</p>
<p>1.åº”ç”¨ç¨‹åºåˆ†é…å†…å­˜ï¼Œå½“å¹´è½»ä»£çš„EdenåŒºç”¨å°½æ—¶å¼€å§‹å¹´è½»ä»£å›æ”¶è¿‡ç¨‹ï¼› G1çš„å¹´è½»ä»£æ”¶é›†é˜¶æ®µæ˜¯ä¸€ä¸ªå¹¶è¡Œçš„ï¼ˆå¤šä¸ªå›æ”¶çº¿ç¨‹ï¼‰ç‹¬å å¼(STW)æ”¶é›†å™¨ã€‚åœ¨å¹´è½»ä»£å›æ”¶æœŸï¼ŒG1 GCæš‚åœæ‰€æœ‰åº”ç”¨ç¨‹åºçº¿ç¨‹ï¼Œå¯åŠ¨å¤šçº¿ç¨‹æ‰§è¡Œå¹´è½»ä»£å›æ”¶ã€‚ç„¶åä»å¹´è½»ä»£åŒºé—´ç§»åŠ¨å­˜æ´»å¯¹è±¡åˆ°SurvivoråŒºé—´æˆ–è€…è€å¹´åŒºé—´ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ä¸¤ä¸ªåŒºé—´éƒ½ä¼šæ¶‰åŠã€‚</p>
<p>2.å½“å †å†…å­˜ä½¿ç”¨è¾¾åˆ°ä¸€å®šå€¼ï¼ˆé»˜è®¤45%ï¼‰æ—¶ï¼Œå¼€å§‹è€å¹´ä»£å¹¶å‘æ ‡è®°è¿‡ç¨‹ã€‚</p>
<p>3.æ ‡è®°å®Œæˆé©¬.ä¸Šå¼€å§‹æ··åˆå›æ”¶è¿‡ç¨‹ã€‚å¯¹äºä¸€ä¸ªæ··åˆå›æ”¶æœŸï¼ŒG1 GCä»è€å¹´åŒºé—´ç§»åŠ¨å­˜æ´»å¯¹è±¡åˆ°ç©ºé—²åŒºé—´ï¼Œè¿™äº›ç©ºé—²åŒºé—´ä¹Ÿå°±æˆä¸ºäº†è€å¹´ä»£çš„ä¸€éƒ¨åˆ†ã€‚å’Œå¹´è½»ä»£ä¸åŒï¼Œè€å¹´ä»£çš„G1å›æ”¶å™¨å’Œå…¶ä»–GCä¸åŒï¼ŒG1çš„è€å¹´ä»£å›æ”¶å™¨ä¸éœ€è¦æ•´ä¸ªè€å¹´ä»£è¢«å›æ”¶ï¼Œä¸€æ¬¡åªéœ€è¦æ‰«æ/å›æ”¶ä¸€å°éƒ¨åˆ†è€å¹´ä»£çš„Regionå°±å¯ä»¥äº†ã€‚åŒæ—¶ï¼Œè¿™ä¸ªè€å¹´ä»£Regionæ˜¯å’Œå¹´è½»ä»£ä¸€èµ· è¢«å›æ”¶çš„ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼šä¸€ä¸ªwebæœåŠ¡å™¨ï¼ŒJavaè¿›ç¨‹æœ€å¤§å †å†…å­˜ä¸º4Gï¼Œæ¯åˆ†é’Ÿå“åº”1500ä¸ªè¯·æ±‚ï¼Œæ¯45ç§’é’Ÿä¼šæ–°åˆ†é…å¤§çº¦2Gçš„å†…å­˜ã€‚G1ä¼šæ¯45ç§’é’Ÿè¿›è¡Œä¸€æ¬¡å¹´è½»ä»£å›æ”¶ï¼Œæ¯31 ä¸ªå°æ—¶æ•´ä¸ªå †çš„ä½¿ç”¨ç‡ä¼šè¾¾åˆ°45%ï¼Œä¼šå¼€å§‹è€å¹´ä»£å¹¶å‘æ ‡è®°è¿‡ç¨‹ï¼Œæ ‡è®°å®Œæˆåå¼€å§‹å››åˆ°äº”æ¬¡çš„æ··åˆå›æ”¶ã€‚</p>
<h2 id="è®°å¿†é›†ä¸å†™å±éšœ"><a href="#è®°å¿†é›†ä¸å†™å±éšœ" class="headerlink" title="è®°å¿†é›†ä¸å†™å±éšœ"></a>è®°å¿†é›†ä¸å†™å±éšœ</h2><ul>
<li>ä¸€ä¸ªå¯¹è±¡è¢«ä¸åŒåŒºåŸŸå¼•ç”¨çš„é—®é¢˜(åˆ†ä»£å¼•ç”¨é—®é¢˜)</li>
<li>ä¸€ä¸ªRegionä¸å¯èƒ½æ˜¯å­¤ç«‹çš„ï¼Œä¸€ä¸ªRegionä¸­çš„å¯¹è±¡å¯èƒ½è¢«å…¶ä»–ä»»æ„Regionä¸­å¯¹è±¡å¼•ç”¨ï¼Œåˆ¤æ–­å¯¹è±¡å­˜æ´»æ—¶ï¼Œæ˜¯å¦éœ€è¦æ‰«ææ•´ä¸ªJavaå †æ‰èƒ½ä¿è¯å‡†ç¡®ï¼Ÿ</li>
<li>åœ¨å…¶ä»–çš„åˆ†ä»£æ”¶é›†å™¨ï¼Œä¹Ÿå­˜åœ¨è¿™æ ·çš„é—®é¢˜ï¼ˆ è€ŒG1æ›´çªå‡ºï¼‰</li>
<li>å›æ”¶æ–°ç”Ÿä»£ä¹Ÿä¸å¾—ä¸åŒæ—¶æ‰«æè€å¹´ä»£ï¼Ÿ</li>
<li>è¿™æ ·çš„è¯ä¼šé™ä½MinorGCçš„æ•ˆç‡ï¼›</li>
</ul>
<p><strong>Â·è§£å†³æ–¹æ³•ï¼š</strong></p>
<ul>
<li>â¢æ— è®ºG1è¿˜æ˜¯å…¶ä»–åˆ†ä»£æ”¶é›†å™¨ï¼ŒJVMéƒ½æ˜¯ä½¿ç”¨RememberedSetæ¥é¿å…å…¨å±€æ‰«æï¼š</li>
<li>â¢æ¯ä¸ªRegionéƒ½æœ‰ ä¸€ä¸ªå¯¹åº”çš„Remembered Setï¼›</li>
<li>â¢æ¯æ¬¡Referenceç±»å‹æ•°æ®å†™æ“ä½œæ—¶ï¼Œéƒ½ä¼šäº§ç”Ÿä¸€ä¸ªWrite Barrieræš‚æ—¶ä¸­æ–­æ“ä½œï¼› .</li>
<li>â¢ç„¶åæ£€æŸ¥å°†è¦å†™å…¥çš„å¼•ç”¨æŒ‡å‘çš„å¯¹è±¡æ˜¯å¦å’Œè¯¥Referenceç±»å‹æ•°æ®åœ¨ä¸åŒçš„Region ï¼ˆå…¶ä»–æ”¶é›†å™¨ï¼šæ£€æŸ¥è€å¹´ä»£å¯¹è±¡æ˜¯å¦å¼•ç”¨äº†æ–°ç”Ÿä»£å¯¹è±¡ï¼‰ ï¼›</li>
<li>â¢å¦‚æœä¸åŒï¼Œé€šè¿‡CardTableæŠŠç›¸å…³å¼•ç”¨ä¿¡æ¯è®°å½•åˆ°å¼•ç”¨æŒ‡å‘å¯¹è±¡çš„æ‰€åœ¨Regionå¯¹åº”çš„Remembered Setä¸­ï¼›</li>
<li>â¢å½“è¿›è¡Œåƒåœ¾æ”¶é›†æ—¶ï¼Œåœ¨GCæ ¹èŠ‚ç‚¹çš„æšä¸¾èŒƒå›´åŠ å…¥Remembered Setï¼›å°±å¯ä»¥ä¿è¯ä¸è¿›è¡Œå…¨å±€æ‰«æï¼Œä¹Ÿä¸ä¼šæœ‰é—æ¼ã€‚</li>
</ul>
<p><a href="https://img2020.cnblogs.com/blog/1846149/202007/1846149-20200723152028598-2055678824.png" title="img" class="gallery-item" style="box-shadow: none;"> <img src="https://img2020.cnblogs.com/blog/1846149/202007/1846149-20200723152028598-2055678824.png" alt="img"></a></p>
<h1 id="G1å›æ”¶è¿‡ç¨‹è¯¦è§£"><a href="#G1å›æ”¶è¿‡ç¨‹è¯¦è§£" class="headerlink" title="G1å›æ”¶è¿‡ç¨‹è¯¦è§£"></a>G1å›æ”¶è¿‡ç¨‹è¯¦è§£</h1><h2 id="è¿‡ç¨‹1å¹´è½»ä»£GC"><a href="#è¿‡ç¨‹1å¹´è½»ä»£GC" class="headerlink" title="è¿‡ç¨‹1å¹´è½»ä»£GC"></a>è¿‡ç¨‹1å¹´è½»ä»£GC</h2><ul>
<li>JVMå¯åŠ¨æ—¶ï¼ŒG1 å…ˆå‡†å¤‡å¥½EdenåŒºï¼Œç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¸æ–­åˆ›å»ºå¯¹è±¡åˆ°EdenåŒºï¼Œå½“Edenç©ºé—´è€—å°½æ—¶ï¼ŒG1ä¼šå¯åŠ¨ä¸€æ¬¡å¹´è½»ä»£åƒåœ¾å›æ”¶è¿‡ç¨‹ã€‚</li>
<li>å¹´è½»ä»£åƒåœ¾å›æ”¶åªä¼šå›æ”¶EdenåŒºï¼ˆä¸»åŠ¨ï¼‰å’ŒSurvivoråŒºï¼ˆè¢«åŠ¨ï¼‰ã€‚</li>
<li>YGCæ—¶ï¼Œé¦–å…ˆG1åœæ­¢åº”ç”¨ç¨‹åºçš„æ‰§è¡Œï¼ˆStopä¸€Theä¸€Worldï¼‰ï¼ŒG1åˆ›å»ºå›æ”¶é›†ï¼ˆCollection Setï¼‰ï¼Œå›æ”¶é›†æ˜¯æŒ‡éœ€è¦è¢«å›æ”¶çš„å†…å­˜åˆ†æ®µçš„é›†åˆï¼Œå¹´è½»ä»£å›æ”¶è¿‡ç¨‹çš„å›æ”¶é›†åŒ…å«å¹´è½»ä»£EdenåŒºå’ŒSurvivoråŒºæ‰€æœ‰çš„å†…å­˜åˆ†æ®µã€‚</li>
<li>å¤åˆ¶ç®—æ³•ï¼ˆSã€Eâ€“&gt;ç©ºé—²åŒºç›¸å½“äºToåŒºï¼‰ï¼ˆSâ€“&gt;å¯»æ‰¾æ–°çš„ç©ºé—²åŒºä½œä¸ºè€å¹´ä»£ï¼‰</li>
</ul>
<p><a href="https://img2020.cnblogs.com/blog/1846149/202007/1846149-20200723153515525-318612700.png" title="img" class="gallery-item" style="box-shadow: none;"> <img src="https://img2020.cnblogs.com/blog/1846149/202007/1846149-20200723153515525-318612700.png" alt="img"></a></p>
<p>ç„¶åå¼€å§‹å¦‚ä¸‹å›æ”¶è¿‡ç¨‹ï¼š</p>
<ul>
<li>ç¬¬ä¸€é˜¶æ®µï¼Œæ‰«ææ ¹<ul>
<li>æ ¹æ˜¯ï¼šæŒ‡staticå˜é‡æŒ‡å‘çš„å¯¹è±¡ï¼ˆç±»ç”Ÿå‘½å‘¨æœŸï¼Œæ–¹æ³•åŒºå¼•ç”¨çš„å¯¹è±¡ï¼‰ï¼Œæ­£åœ¨æ‰§è¡Œçš„æ–¹æ³•è°ƒç”¨é“¾æ¡ä¸Šçš„å±€éƒ¨å˜é‡ç­‰ï¼ˆæ–¹æ³•ç”Ÿå‘½å‘¨æœŸï¼Œè™šæ‹Ÿæœºæ ˆå¼•ç”¨çš„å¯¹è±¡ï¼‰ã€‚æ ¹å¼•ç”¨è¿åŒRSetè®°å½•çš„å¤–éƒ¨å¼•ç”¨ä½œä¸ºæ‰«æå­˜æ´»å¯¹è±¡çš„å…¥å£ã€‚</li>
</ul>
</li>
<li><strong>ç¬¬äºŒé˜¶æ®µï¼Œæ›´æ–°RSet</strong></li>
</ul>
<p>â€‹     å¤„ç†dirty card queueï¼ˆ è§å¤‡æ³¨ï¼‰ä¸­çš„cardï¼Œæ›´æ–°RSetã€‚ æ­¤é˜¶æ®µå®Œæˆåï¼ŒRSetå¯ ä»¥å‡†ç¡®çš„åæ˜ è€å¹´ä»£å¯¹æ‰€åœ¨çš„å†…å­˜åˆ†æ®µä¸­å¯¹è±¡çš„å¼•ç”¨ï¼ˆæŒ‡çš„æ–°ç”Ÿä»£ï¼‰ã€‚</p>
<ul>
<li><ul>
<li>dirty card queue: å¯¹äºåº”ç”¨ç¨‹åºçš„å¼•ç”¨èµ‹å€¼è¯­å¥object.field=objectï¼ŒJVMä¼šåœ¨ä¹‹å‰å’Œä¹‹åæ‰§è¡Œç‰¹æ®Šçš„æ“ä½œä»¥åœ¨dirty card queueä¸­å…¥é˜Ÿä¸€ä¸ªä¿å­˜äº†å¯¹è±¡å¼•ç”¨ä¿¡æ¯çš„cardã€‚</li>
<li>åœ¨å¹´è½»ä»£å›æ”¶çš„æ—¶å€™ï¼Œ G1ä¼šå¯¹Dirty Card Queueä¸­æ‰€æœ‰çš„cardè¿›è¡Œå¤„ç†ï¼Œä»¥æ›´æ–°RSetï¼Œä¿è¯RSetå®æ—¶å‡†ç¡®çš„åæ˜ å¼•ç”¨å…³ç³»ã€‚</li>
<li>é‚£ä¸ºä»€ä¹ˆä¸åœ¨å¼•ç”¨èµ‹å€¼è¯­å¥å¤„ç›´æ¥æ›´æ–°RSetå‘¢ï¼Ÿè¿™æ˜¯ä¸ºäº†æ€§èƒ½çš„éœ€è¦ï¼ŒRSetçš„å¤„ç†éœ€è¦çº¿ç¨‹åŒæ­¥ï¼Œå¼€é”€ä¼šå¾ˆå¤§ï¼Œä½¿ç”¨é˜Ÿåˆ—æ€§èƒ½ä¼šå¥½å¾ˆå¤šã€‚</li>
</ul>
</li>
<li><p><strong>ç¬¬ä¸‰é˜¶æ®µï¼Œå¤„ç†RSet</strong>ã€‚<br>è¯†åˆ«è¢«è€å¹´ä»£å¯¹è±¡æŒ‡å‘çš„Edenä¸­çš„å¯¹è±¡ï¼Œè¿™äº›è¢«æŒ‡å‘çš„Edenä¸­çš„å¯¹è±¡è¢«è®¤ä¸ºæ˜¯å­˜æ´»çš„å¯¹è±¡ã€‚</p>
</li>
<li><p><strong>ç¬¬å››é˜¶æ®µï¼Œå¤åˆ¶å¯¹è±¡</strong>ã€‚<br>æ­¤é˜¶æ®µï¼Œå¯¹è±¡æ ‘è¢«éå†ï¼ŒEdenåŒº å†…å­˜æ®µä¸­å­˜æ´»çš„å¯¹è±¡ä¼šè¢«å¤åˆ¶åˆ°SurvivoråŒºä¸­ç©ºçš„å†…å­˜åˆ†æ®µï¼ŒSurvivoråŒºå†…å­˜æ®µä¸­å­˜æ´»çš„å¯¹è±¡å¦‚æœå¹´é¾„æœªè¾¾é˜ˆå€¼ï¼Œå¹´é¾„ä¼šåŠ 1ï¼Œè¾¾åˆ°é˜€å€¼ä¼šè¢«ä¼šè¢«å¤åˆ¶åˆ°01dåŒºä¸­ç©ºçš„å†…å­˜åˆ†æ®µã€‚å¦‚æœSurvivorç©ºé—´ä¸å¤Ÿï¼ŒEdenç©ºé—´çš„ éƒ¨åˆ†æ•°æ®ä¼šç›´æ¥æ™‹å‡åˆ°è€å¹´ä»£ç©ºé—´ã€‚</p>
</li>
<li><p><strong>ç¬¬äº”é˜¶æ®µï¼Œå¤„ç†å¼•ç”¨</strong>ã€‚<br>å¤„ç†Softï¼ŒWeakï¼Œ Phantomï¼Œ Finalï¼Œ JNI Weakç­‰å¼•ç”¨ã€‚æœ€ç»ˆEdenç©ºé—´çš„æ•°æ®ä¸ºç©ºï¼ŒGCåœæ­¢å·¥ä½œï¼Œè€Œç›®æ ‡å†…å­˜ä¸­çš„å¯¹è±¡éƒ½æ˜¯è¿ç»­å­˜å‚¨çš„ï¼Œæ²¡æœ‰ç¢ç‰‡ï¼Œæ‰€ä»¥å¤åˆ¶è¿‡ç¨‹å¯ä»¥è¾¾åˆ°å†…å­˜æ•´ç†çš„æ•ˆæœï¼Œå‡å°‘ç¢ç‰‡ã€‚</p>
</li>
</ul>
<h2 id="è¿‡ç¨‹2å¹´è½»ä»£GC-å¹¶å‘æ ‡è®°è¿‡ç¨‹"><a href="#è¿‡ç¨‹2å¹´è½»ä»£GC-å¹¶å‘æ ‡è®°è¿‡ç¨‹" class="headerlink" title="è¿‡ç¨‹2å¹´è½»ä»£GC+å¹¶å‘æ ‡è®°è¿‡ç¨‹"></a>è¿‡ç¨‹2å¹´è½»ä»£GC+å¹¶å‘æ ‡è®°è¿‡ç¨‹</h2><ul>
<li>åˆå§‹æ ‡è®°é˜¶æ®µï¼šæ ‡è®°ä»æ ¹èŠ‚ç‚¹ç›´æ¥å¯è¾¾çš„å¯¹è±¡ã€‚è¿™ä¸ªé˜¶æ®µæ˜¯STWçš„ï¼Œå¹¶ä¸”ä¼šè§¦å‘ä¸€.æ¬¡å¹´è½»ä»£GCã€‚</li>
<li>æ ¹åŒºåŸŸæ‰«æï¼ˆRoot Region Scanningï¼‰ ï¼š G1 GCæ‰«æSurvivoråŒºç›´æ¥å¯è¾¾çš„è€å¹´ä»£åŒºåŸŸå¯¹è±¡ï¼Œå¹¶æ ‡è®°è¢«å¼•ç”¨çš„å¯¹è±¡ã€‚è¿™ä¸€è¿‡ç¨‹å¿…é¡»åœ¨young GCä¹‹å‰å®Œæˆã€‚</li>
<li>å¹¶å‘æ ‡è®°ï¼ˆConcurrent Markingï¼‰ï¼š åœ¨æ•´ä¸ªå †ä¸­è¿›è¡Œå¹¶å‘æ ‡è®°ï¼ˆå’Œåº”ç”¨ç¨‹åºå¹¶å‘æ‰§è¡Œï¼‰ï¼Œæ­¤è¿‡ç¨‹å¯èƒ½è¢«young GCä¸­æ–­ã€‚åœ¨å¹¶å‘æ ‡è®°é˜¶æ®µï¼Œè‹¥å‘ç°åŒºåŸŸå¯¹è±¡ä¸­çš„æ‰€æœ‰å¯¹è±¡éƒ½æ˜¯åƒåœ¾ï¼Œé‚£è¿™ä¸ªåŒºåŸŸä¼šè¢«ç«‹å³å›æ”¶ã€‚åŒæ—¶ï¼Œå¹¶å‘æ ‡è®°è¿‡ç¨‹ä¸­ï¼Œä¼šè®¡ç®—æ¯ä¸ªåŒºåŸŸçš„å¯¹è±¡æ´»æ€§ï¼ˆåŒºåŸŸä¸­å­˜æ´»å¯¹è±¡çš„æ¯”ä¾‹ï¼‰ã€‚</li>
<li>å†æ¬¡æ ‡è®°ï¼ˆRemarkï¼‰ï¼š ç”±äºåº”ç”¨ç¨‹åºæŒç»­è¿›è¡Œï¼Œéœ€è¦ä¿®æ­£ä¸Šä¸€æ¬¡çš„æ ‡è®°ç»“æœã€‚æ˜¯STWçš„ã€‚G1ä¸­é‡‡ç”¨äº†æ¯”CMSæ›´å¿«çš„åˆå§‹å¿«ç…§ç®—æ³•ï¼šsnapshotä¸€atä¸€theä¸€beginning ï¼ˆSATBï¼‰ã€‚</li>
<li>ç‹¬å æ¸…ç†ï¼ˆcleanupï¼ŒSTWï¼‰ï¼šè®¡ç®—å„ä¸ªåŒºåŸŸçš„å­˜æ´»å¯¹è±¡å’ŒGCå›æ”¶æ¯”ä¾‹ï¼Œå¹¶è¿›è¡Œæ’åºï¼Œè¯†åˆ«å¯ä»¥æ··åˆå›æ”¶çš„åŒºåŸŸã€‚ä¸ºä¸‹é˜¶æ®µåšé“ºå«ã€‚æ˜¯STWçš„ã€‚<ul>
<li>â¢è¿™ä¸ªé˜¶æ®µå¹¶ä¸ä¼šå®é™…ä¸Šå»åšåƒåœ¾çš„æ”¶é›†</li>
</ul>
</li>
<li>å¹¶å‘æ¸…ç†é˜¶æ®µï¼šè¯†åˆ«å¹¶æ¸…ç†å®Œå…¨ç©ºé—²çš„åŒºåŸŸã€‚</li>
</ul>
<h2 id="è¿‡ç¨‹3æ··åˆå›æ”¶"><a href="#è¿‡ç¨‹3æ··åˆå›æ”¶" class="headerlink" title="è¿‡ç¨‹3æ··åˆå›æ”¶"></a>è¿‡ç¨‹3æ··åˆå›æ”¶</h2><p>å½“è¶Šæ¥è¶Šå¤šçš„å¯¹è±¡æ™‹å‡åˆ°è€å¹´ä»£Oldregionæ—¶ï¼Œä¸ºäº†é¿å…å †å†…å­˜è¢«è€—å°½ï¼Œè™šæ‹Ÿæœºä¼šè§¦å‘ä¸€ä¸ªæ··åˆçš„åƒåœ¾æ”¶é›†å™¨ï¼Œå³Mixed GCï¼Œ è¯¥ç®—æ³•å¹¶ä¸æ˜¯ä¸€ä¸ªOldGCï¼Œé™¤äº†å›æ”¶æ•´ä¸ªYoung Regionï¼Œè¿˜ä¼šå›æ”¶ä¸€éƒ¨åˆ†çš„0ldRegionã€‚è¿™é‡Œéœ€è¦æ³¨æ„ï¼šæ˜¯ä¸€éƒ¨åˆ†è€å¹´ä»£ï¼Œ è€Œä¸æ˜¯å…¨éƒ¨è€å¹´ä»£ã€‚å¯ä»¥é€‰æ‹©å“ªäº›OldRegionè¿›è¡Œæ”¶é›†ï¼Œä»è€Œå¯ä»¥å¯¹åƒåœ¾å›æ”¶çš„è€—æ—¶æ—¶é—´è¿›è¡Œæ§åˆ¶ã€‚ä¹Ÿè¦æ³¨æ„çš„æ˜¯Mixed GCå¹¶ä¸æ˜¯Full GCã€‚</p>
<ul>
<li>å¹¶å‘æ ‡è®°ç»“æŸä»¥åï¼Œè€å¹´ä»£ä¸­ç™¾åˆ†ç™¾ä¸ºåƒåœ¾çš„å†…å­˜åˆ†æ®µè¢«å›æ”¶äº†ï¼Œéƒ¨åˆ†ä¸ºåƒåœ¾çš„å†…å­˜åˆ†æ®µè¢«è®¡ç®—äº†å‡ºæ¥ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™äº›è€å¹´ä»£çš„å†…å­˜åˆ†æ®µä¼šåˆ†8æ¬¡ï¼ˆå¯ä»¥é€šè¿‡ä¸€XXï¼š G1MixedGCCountTargetè®¾ç½®ï¼‰è¢«å›æ”¶ã€‚</li>
<li>æ··åˆå›æ”¶çš„å›æ”¶é›†ï¼ˆCollection Setï¼‰ åŒ…æ‹¬å…«åˆ†ä¹‹ä¸€çš„è€å¹´ä»£å†…å­˜åˆ†æ®µï¼ŒEdenåŒºå†…å­˜åˆ†æ®µï¼ŒSurvivoråŒºå†…å­˜åˆ†æ®µã€‚æ··åˆå›æ”¶çš„ç®—æ³•å’Œå¹´è½»ä»£å›æ”¶çš„ç®—æ³•å®Œå…¨ä¸€æ ·ï¼Œåªæ˜¯å›æ”¶é›†å¤šäº†è€å¹´ä»£çš„å†…å­˜åˆ†æ®µã€‚å…·ä½“è¿‡ç¨‹è¯·å‚è€ƒä¸Šé¢çš„å¹´è½»ä»£å›æ”¶è¿‡ç¨‹ã€‚</li>
<li>ç”±äºè€å¹´ä»£ä¸­çš„å†…å­˜åˆ†æ®µé»˜è®¤åˆ†8æ¬¡å›æ”¶ï¼ŒG1ä¼šä¼˜å…ˆå›æ”¶åƒåœ¾å¤šçš„å†…å­˜åˆ†æ®µã€‚åƒåœ¾å å†…å­˜åˆ†æ®µæ¯”ä¾‹è¶Šé«˜çš„ï¼Œè¶Šä¼šè¢«å…ˆå›æ”¶ã€‚å¹¶ä¸”æœ‰ä¸€ä¸ªé˜ˆå€¼ä¼šå†³å®šå†…å­˜åˆ†æ®µæ˜¯å¦è¢«å›æ”¶ï¼Œä¸€xXï¼š G1MixedGCLiveThresholdPercentï¼Œé»˜è®¤ä¸º65%ï¼Œæ„æ€æ˜¯åƒåœ¾å å†…å­˜åˆ†æ®µæ¯”ä¾‹è¦è¾¾åˆ°65%æ‰ä¼šè¢«å›æ”¶ã€‚å¦‚æœåƒåœ¾å æ¯”å¤ªä½ï¼Œæ„å‘³ç€å­˜æ´»çš„å¯¹è±¡å æ¯”é«˜ï¼Œåœ¨å¤åˆ¶çš„æ—¶å€™ä¼šèŠ±è´¹æ›´å¤šçš„æ—¶é—´ã€‚</li>
<li>æ··åˆå›æ”¶å¹¶ä¸ä¸€å®šè¦è¿›è¡Œ8æ¬¡ã€‚æœ‰ä¸€ä¸ªé˜ˆå€¼ä¸€Xxï¼š G1HeapWastePercentï¼Œé»˜è®¤å€¼ä¸º10%ï¼Œæ„æ€æ˜¯å…è®¸æ•´ä¸ªå †å†…å­˜ä¸­æœ‰10%çš„ç©ºé—´è¢«æµªè´¹ï¼Œæ„å‘³ç€å¦‚æœå‘ç°å¯ä»¥å›æ”¶çš„åƒåœ¾å å †å†…å­˜çš„æ¯”ä¾‹ä½äº10%ï¼Œåˆ™ä¸å†è¿›è¡Œæ··åˆå›æ”¶ã€‚å› ä¸ºGCä¼šèŠ±è´¹å¾ˆå¤šçš„æ—¶é—´ä½†æ˜¯å›æ”¶åˆ°çš„å†…å­˜å´å¾ˆå°‘ã€‚</li>
</ul>
<h2 id="è¿‡ç¨‹4Full-GC"><a href="#è¿‡ç¨‹4Full-GC" class="headerlink" title="è¿‡ç¨‹4Full GC"></a>è¿‡ç¨‹4Full GC</h2><p>G1çš„åˆè¡·å°±æ˜¯è¦é¿å…Full GCçš„å‡ºç°ã€‚ä½†æ˜¯å¦‚æœä¸Šè¿°æ–¹å¼ä¸èƒ½æ­£å¸¸å·¥ä½œï¼ŒG1ä¼šåœæ­¢åº”ç”¨ç¨‹åºçš„æ‰§è¡Œï¼ˆStopä¸€ Theä¸€Worldï¼‰ï¼Œä½¿ç”¨å•çº¿ç¨‹çš„å†…å­˜å›æ”¶ç®—æ³•è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œæ€§èƒ½ä¼šéå¸¸å·®ï¼Œåº”ç”¨ç¨‹åºåœé¡¿æ—¶é—´ä¼šå¾ˆé•¿ã€‚<br>è¦é¿å…Full GCçš„å‘ç”Ÿï¼Œä¸€æ—¦å‘ç”Ÿéœ€è¦è¿›è¡Œè°ƒæ•´ã€‚ä»€ä¹ˆæ—¶å€™ä¼šå‘ç”ŸFull GCå‘¢ï¼Ÿæ¯”å¦‚å †å†…å­˜å¤ªå°ï¼Œå½“G1åœ¨å¤åˆ¶å­˜æ´»å¯¹è±¡çš„æ—¶å€™æ²¡æœ‰ç©ºçš„å†…å­˜åˆ†æ®µå¯ç”¨ï¼Œåˆ™ä¼šå›é€€åˆ°full gcï¼Œ è¿™ç§æƒ…å†µå¯ä»¥é€šè¿‡å¢å¤§å†…å­˜è§£å†³ã€‚<br>å¯¼è‡´G1Full GCçš„åŸå› å¯èƒ½æœ‰ä¸¤ä¸ªï¼š</p>
<ul>
<li>1.Evacuationçš„æ—¶å€™æ²¡æœ‰è¶³å¤Ÿçš„toä¸€ spaceæ¥å­˜æ”¾æ™‹å‡çš„å¯¹è±¡ï¼›</li>
<li>2.å¹¶å‘å¤„ç†è¿‡ç¨‹å®Œæˆä¹‹å‰ç©ºé—´è€—å°½ã€‚</li>
</ul>
<p><strong>è¡¥å……ï¼š</strong></p>
<p>ä»Oracleå®˜æ–¹é€éœ²å‡ºæ¥çš„ä¿¡æ¯å¯è·çŸ¥ï¼Œå›æ”¶é˜¶æ®µï¼ˆEvacuationï¼‰å…¶å®.æœ¬ä¹Ÿæœ‰æƒ³è¿‡è®¾è®¡æˆä¸ç”¨æˆ·ç¨‹åºä¸€èµ·å¹¶å‘æ‰§è¡Œï¼Œä½†è¿™ä»¶äº‹æƒ…åšèµ·æ¥æ¯”è¾ƒå¤æ‚ï¼Œè€ƒè™‘åˆ°G1åªæ˜¯å›æ”¶ä¸€éƒ¨åˆ†Regionï¼Œ åœé¡¿æ—¶é—´æ˜¯ç”¨æˆ·å¯æ§åˆ¶çš„ï¼Œæ‰€ä»¥å¹¶ä¸è¿«åˆ‡å»å®ç°ï¼Œè€Œé€‰æ‹©æŠŠè¿™ä¸ªç‰¹æ€§æ”¾åˆ°äº†G1ä¹‹åå‡ºç°çš„ä½å»¶è¿Ÿåƒåœ¾æ”¶é›†å™¨ï¼ˆå³ZGCï¼‰ä¸­ã€‚å¦å¤–ï¼Œè¿˜è€ƒè™‘åˆ°G1ä¸æ˜¯ä»…ä»…é¢å‘ä½å»¶è¿Ÿï¼Œåœé¡¿ç”¨æˆ·çº¿ç¨‹èƒ½å¤Ÿæœ€å¤§å¹…åº¦æé«˜åƒåœ¾æ”¶é›†æ•ˆç‡ï¼Œä¸ºäº†ä¿è¯ååé‡æ‰€ä»¥æ‰é€‰æ‹©äº†å®Œå…¨æš‚åœç”¨æˆ·çº¿ç¨‹çš„å®ç°æ–¹æ¡ˆã€‚</p>
<h1 id="G1å›æ”¶å™¨ä¼˜åŒ–å»ºè®®"><a href="#G1å›æ”¶å™¨ä¼˜åŒ–å»ºè®®" class="headerlink" title="G1å›æ”¶å™¨ä¼˜åŒ–å»ºè®®"></a>G1å›æ”¶å™¨ä¼˜åŒ–å»ºè®®</h1><ul>
<li>å¹´è½»ä»£å¤§å°<ul>
<li>â¢é¿å…ä½¿ç”¨ä¸€Xmnæˆ–ä¸€XXï¼šNewRatioç­‰ç›¸å…³é€‰é¡¹æ˜¾å¼è®¾ç½®å¹´è½»ä»£å¤§å°â¢å›ºå®šå¹´è½»ä»£çš„å¤§å°ä¼šè¦†ç›–æš‚åœæ—¶é—´ç›®æ ‡</li>
</ul>
</li>
<li>æš‚åœæ—¶é—´ç›®æ ‡ä¸è¦å¤ªè¿‡ä¸¥è‹›<ul>
<li>G1 GCçš„ååé‡ç›®æ ‡æ˜¯90%çš„åº”ç”¨ç¨‹åºæ—¶é—´å’Œ10%çš„åƒåœ¾å›æ”¶æ—¶é—´</li>
<li>è¯„ä¼°G1 GCçš„ååé‡æ—¶ï¼Œæš‚åœæ—¶é—´ç›®æ ‡ä¸è¦å¤ªä¸¥è‹›ã€‚ç›®æ ‡å¤ªè¿‡ä¸¥è‹›è¡¨ ç¤ºä½ æ„¿æ„æ‰¿å—æ›´å¤šçš„åƒåœ¾å›æ”¶å¼€é”€ï¼Œè€Œè¿™äº›ä¼šç›´æ¥å½±å“åˆ°ååé‡ã€‚</li>
</ul>
</li>
</ul>
<h1 id="7ç§ç»å…¸çš„åƒåœ¾å›æ”¶å™¨æ€»ç»“"><a href="#7ç§ç»å…¸çš„åƒåœ¾å›æ”¶å™¨æ€»ç»“" class="headerlink" title="7ç§ç»å…¸çš„åƒåœ¾å›æ”¶å™¨æ€»ç»“"></a>7ç§ç»å…¸çš„åƒåœ¾å›æ”¶å™¨æ€»ç»“</h1><p>æˆªæ­¢JDK 1.8ï¼Œä¸€å…±æœ‰7æ¬¾ä¸åŒçš„åƒåœ¾æ”¶é›†å™¨ã€‚æ¯ä¸€æ¬¾ä¸åŒçš„åƒåœ¾æ”¶é›†å™¨éƒ½æœ‰ä¸åŒçš„ç‰¹ç‚¹ï¼Œåœ¨å…·ä½“ä½¿ç”¨çš„æ—¶å€™ï¼Œéœ€è¦æ ¹æ®å…·ä½“çš„æƒ…å†µé€‰ç”¨ä¸åŒçš„åƒåœ¾æ”¶é›†å™¨ã€‚</p>
<p><a href="https://img2020.cnblogs.com/blog/1846149/202007/1846149-20200723155737552-624347732.png" title="img" class="gallery-item" style="box-shadow: none;"> <img src="https://img2020.cnblogs.com/blog/1846149/202007/1846149-20200723155737552-624347732.png" alt="img"></a></p>
<p> ä¸åŒå‚å•†ã€ä¸åŒç‰ˆæœ¬çš„è™šæ‹Ÿæœºå®ç°å·®åˆ«å¾ˆå¤§ã€‚HotSpot è™šæ‹Ÿæœºåœ¨JDK7/8åæ‰€æœ‰æ”¶é›†å™¨åŠç»„åˆï¼ˆè¿çº¿ï¼‰ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><a href="https://img2020.cnblogs.com/blog/1846149/202007/1846149-20200723160245863-1482952705.png" title="img" class="gallery-item" style="box-shadow: none;"> <img src="https://img2020.cnblogs.com/blog/1846149/202007/1846149-20200723160245863-1482952705.png" alt="img"></a></p>
<ul>
<li>1.ä¸¤ä¸ªæ”¶é›†å™¨é—´æœ‰è¿çº¿ï¼Œè¡¨æ˜å®ƒä»¬å¯ä»¥æ­é…ä½¿ç”¨ï¼š Serial/Serial 0ldã€Serial /CMSã€ParNew/Serial 0ldã€ParNew/CMSã€ Parallel Scavenge/Serial 01dã€Parallel Scavenge/Parallel 0ldã€G1ï¼›</li>
<li>2.å…¶ä¸­Serial 0ldä½œ ä¸ºCMSå‡ºç°â€Concurrent Mode Failureâ€å¤±è´¥ çš„åå¤‡é¢„æ¡ˆã€‚</li>
<li>3.ï¼ˆçº¢è‰²è™šçº¿ï¼‰ç”±äºç»´æŠ¤å’Œå…¼å®¹æ€§æµ‹è¯•çš„æˆæœ¬ï¼Œåœ¨JDK 8æ—¶å°†Serial+CMSã€ ParNew+Serial 0ldè¿™ä¸¤ä¸ªç»„åˆå£°æ˜ä¸ºDeprecated ï¼ˆJEP 173ï¼‰ï¼Œå¹¶åœ¨JDK 9ä¸­å®Œå…¨å–æ¶ˆäº†è¿™äº›ç»„åˆçš„æ”¯æŒï¼ˆJEP214ï¼‰ï¼Œå³ï¼šç§»é™¤ã€‚</li>
<li>4.ï¼ˆç»¿è‰²è™šçº¿ï¼‰JDK 14ä¸­ï¼šå¼ƒç”¨ParallelScavenge å’ŒSerial0ld GCç»„åˆ ï¼ˆJEP 366ï¼‰</li>
<li>5.ï¼ˆé’è‰²è™šçº¿ï¼‰JDK 14ä¸­ï¼šåˆ é™¤CMSåƒåœ¾å›æ”¶å™¨ ï¼ˆJEP 363 ï¼‰ GCå‘å±•é˜¶æ®µï¼š Serial =&gt; Parallel ï¼ˆå¹¶è¡Œï¼‰ =&gt; CMS ï¼ˆå¹¶å‘ï¼‰ =&gt; G1 =&gt; ZGC</li>
</ul>
<h2 id="æ€ä¹ˆé€‰æ‹©åƒåœ¾å›æ”¶å™¨"><a href="#æ€ä¹ˆé€‰æ‹©åƒåœ¾å›æ”¶å™¨" class="headerlink" title="æ€ä¹ˆé€‰æ‹©åƒåœ¾å›æ”¶å™¨"></a><strong>æ€ä¹ˆé€‰æ‹©åƒåœ¾å›æ”¶å™¨</strong></h2><ul>
<li>Javaåƒåœ¾æ”¶é›†å™¨çš„é…ç½®å¯¹äºJVMä¼˜åŒ–æ¥è¯´æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„é€‰æ‹©ï¼Œé€‰æ‹©åˆé€‚çš„åƒåœ¾æ”¶é›†å™¨å¯ä»¥è®©JVMçš„æ€§èƒ½æœ‰ä¸€ä¸ªå¾ˆå¤§çš„æå‡ã€‚</li>
<li>æ€ä¹ˆé€‰æ‹©åƒåœ¾æ”¶é›†å™¨ï¼Ÿ<ul>
<li>1.ä¼˜å…ˆè°ƒæ•´å †çš„å¤§å°è®©JVMè‡ªé€‚åº”å®Œæˆã€‚</li>
<li>2.å¦‚æœå†…å­˜å°äº100Mï¼Œä½¿ç”¨ä¸²è¡Œæ”¶é›†å™¨</li>
<li>3.å¦‚æœæ˜¯å•æ ¸ã€å•æœºç¨‹åºï¼Œå¹¶ä¸”æ²¡æœ‰åœé¡¿æ—¶é—´çš„è¦æ±‚ï¼Œä¸²è¡Œæ”¶é›†å™¨</li>
<li>4.å¦‚æœæ˜¯å¤šCPUã€éœ€è¦é«˜ååé‡ã€å…è®¸åœé¡¿æ—¶é—´è¶…è¿‡1ç§’ï¼Œé€‰æ‹©å¹¶è¡Œæˆ–è€…JVMè‡ªå·±é€‰æ‹©</li>
<li>5.å¦‚æœæ˜¯å¤šCPUã€è¿½æ±‚ä½åœé¡¿æ—¶é—´ï¼Œéœ€å¿«é€Ÿå“åº”ï¼ˆæ¯”å¦‚å»¶è¿Ÿä¸èƒ½è¶…è¿‡1ç§’ï¼Œå¦‚äº’è”ç½‘åº”ç”¨ï¼‰ï¼Œä½¿ç”¨å¹¶å‘æ”¶é›†å™¨</li>
<li>å®˜æ–¹æ¨èG1ï¼Œæ€§èƒ½é«˜ã€‚ç°åœ¨äº’è”ç½‘çš„é¡¹ç›®ï¼ŒåŸºæœ¬éƒ½æ˜¯ä½¿ç”¨G1ã€‚</li>
</ul>
</li>
<li>æœ€åéœ€è¦æ˜ç¡®ä¸€ä¸€ä¸ªè§‚ç‚¹ï¼š<ul>
<li>1.æ²¡æœ‰æœ€å¥½çš„æ”¶é›†å™¨ï¼Œæ›´æ²¡æœ‰ä¸‡èƒ½çš„æ”¶é›†ï¼›</li>
<li>2.è°ƒä¼˜æ°¸è¿œæ˜¯é’ˆå¯¹ç‰¹å®šåœºæ™¯ã€ç‰¹å®šéœ€æ±‚ï¼Œä¸å­˜åœ¨ä¸€åŠ³æ°¸é€¸çš„æ”¶é›†å™¨</li>
</ul>
</li>
</ul>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>é¢è¯•</tag>
        <tag>JAVA</tag>
      </tags>
  </entry>
  <entry>
    <title>å¸¸è§åƒåœ¾æ”¶é›†å™¨çš„ç‰¹ç‚¹</title>
    <url>/gc-charator/</url>
    <content><![CDATA[<div class=".article-gallery"><h4 id="CMSï¼ˆConcurrent-Mark-Sweepï¼‰æ”¶é›†å™¨"><a href="#CMSï¼ˆConcurrent-Mark-Sweepï¼‰æ”¶é›†å™¨" class="headerlink" title="CMSï¼ˆConcurrent Mark Sweepï¼‰æ”¶é›†å™¨"></a>CMSï¼ˆConcurrent Mark Sweepï¼‰æ”¶é›†å™¨</h4><p><a href="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/11.png?resize=640,175" title="å¸¸è§åƒåœ¾æ”¶é›†å™¨çš„ç‰¹ç‚¹ - ç¬¬1å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/11.png?resize=640,175" alt="å¸¸è§åƒåœ¾æ”¶é›†å™¨çš„ç‰¹ç‚¹ - ç¬¬1å¼   | å¼ å˜"></a></p>
<p><strong>ç¼ºç‚¹ï¼š</strong>1.CMSæ”¶é›†å™¨å¯¹CPUèµ„æºéå¸¸æ•æ„Ÿã€‚å¹¶å‘æ‰§è¡Œçš„ç‰¹æ€§ï¼Œä¼šå¯¹ç”¨æˆ·çº¿ç¨‹äº§ç”Ÿå½±å“ã€‚<br>2.CMSæ”¶é›†å™¨æ— æ³•å¤„ç†æµ®åŠ¨åƒåœ¾ã€‚å¹¶å‘æ¸…ç†é˜¶æ®µç”¨æˆ·çº¿ç¨‹è¿˜åœ¨è¿è¡Œç€ï¼Œä¼´éšç¨‹åºè¿è¡Œè‡ªç„¶è¿˜ä¼šæœ‰æ–°çš„åƒåœ¾ä¸æ–­äº§ç”Ÿï¼ŒCMSæ— æ³•å¤„ç†ä»–ä»¬ã€‚<br>3.é‡‡ç”¨æ ‡è®°-æ¸…æ¥šç®—æ³•å®ç°ï¼Œäº§ç”Ÿå†…å­˜ç¢ç‰‡ã€‚</p>
<h4 id="G1ï¼ˆGarbage-Firstï¼‰æ”¶é›†å™¨"><a href="#G1ï¼ˆGarbage-Firstï¼‰æ”¶é›†å™¨" class="headerlink" title="G1ï¼ˆGarbage-Firstï¼‰æ”¶é›†å™¨"></a>G1ï¼ˆGarbage-Firstï¼‰æ”¶é›†å™¨</h4><p><a href="https://i0.wp.com/192.144.167.243/blog/wp-content/uploads/12.png?resize=640,173" title="å¸¸è§åƒåœ¾æ”¶é›†å™¨çš„ç‰¹ç‚¹ - ç¬¬2å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/192.144.167.243/blog/wp-content/uploads/12.png?resize=640,173" alt="å¸¸è§åƒåœ¾æ”¶é›†å™¨çš„ç‰¹ç‚¹ - ç¬¬2å¼   | å¼ å˜"></a></p>
<p><strong>ç‰¹ç‚¹ï¼š</strong>1.å¹¶å‘ä¸å¹¶è¡Œã€‚<br>2.åˆ†ä»£æ”¶é›†ã€‚<br>3.ç©ºé—´æ•´åˆã€‚æ ‡è®°-æ•´ç†ç®—æ³•ã€‚<br>4.å¯é¢„æµ‹çš„åœé¡¿ã€‚é™ä½åœé¡¿æ—¶é—´æ˜¯G1å’ŒCMSå…±åŒçš„å…³æ³¨ç‚¹ã€‚<br>5.G1å¯ä»¥è¿›è¡Œåƒåœ¾æ”¶é›†çš„èŒƒå›´åŒ…æ‹¬æ–°ç”Ÿä»£å’Œè€å¹´ä»£ã€‚å°†æ•´ä¸ªJavaå †åˆ’åˆ†ä¸ºå¤šä¸ªå¤§å°ç›¸ç­‰çš„ç‹¬ç«‹åŒºåŸŸï¼Œè™½ç„¶è¿˜ä¿ç•™æ–°ç”Ÿä»£å’Œè€å¹´ä»£çš„æ¦‚å¿µï¼Œä½†æ–°ç”Ÿä»£å’Œè€å¹´ä»£ä¸å†æ˜¯ç‰©ç†éš”ç¦»çš„äº†ï¼Œå®ƒä»¬éƒ½æ˜¯ä¸€éƒ¨åˆ†Regionçš„é›†åˆã€‚<strong>åŒ–æ•´ä¸ºé›¶çš„æ€è·¯ï¼Œå¹¶ç»´æŠ¤ä¼˜å…ˆé˜Ÿåˆ—ï¼Œä½¿å¾—G1æ”¶é›†å™¨å®ç°å¯é¢„æµ‹çš„åœé¡¿ã€‚</strong><br>6.å¯è¾¾æ€§åˆ†ææ—¶è·¨Regionå¯¹è±¡å¼•ç”¨çš„é—®é¢˜ï¼Œè™šæ‹Ÿæœºç»´æŠ¤Remembered Setæ¥é¿å…å…¨å †æ‰«æã€‚</p>
<h4 id="ZGCï¼ˆï¼‰æ”¶é›†å™¨"><a href="#ZGCï¼ˆï¼‰æ”¶é›†å™¨" class="headerlink" title="ZGCï¼ˆï¼‰æ”¶é›†å™¨"></a>ZGCï¼ˆï¼‰æ”¶é›†å™¨</h4><h4 id="å †å¤–å†…å­˜å¯¼è‡´æº¢å‡ºé”™è¯¯"><a href="#å †å¤–å†…å­˜å¯¼è‡´æº¢å‡ºé”™è¯¯" class="headerlink" title="å †å¤–å†…å­˜å¯¼è‡´æº¢å‡ºé”™è¯¯"></a>å †å¤–å†…å­˜å¯¼è‡´æº¢å‡ºé”™è¯¯</h4><p>å †å¤–å†…å­˜ä¸åœ¨åƒåœ¾å›æ”¶çš„èŒƒå›´å†…ï¼Œå¦‚æœå‘ç”Ÿå†…å­˜æº¢å‡ºçš„æƒ…å†µï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯å †å¤–å†…å­˜å¼•èµ·çš„ï¼Œå¸¸è§çš„å †å¤–å†…å­˜åŒ…æ‹¬ï¼š<br>1.Direct Memoryã€‚å¯é€šè¿‡-XX:MaxDirectMemorySizeè°ƒæ•´å¤§å°ï¼Œå†…å­˜ä¸è¶³æ—¶æŠ›å‡ºOutOfMemoryErroræˆ–è€…OutOfMemoryError: Direct buffer memoryã€‚<br>2.çº¿ç¨‹å †æ ˆã€‚å¯é€šè¿‡-Xssè°ƒæ•´å¤§å°ï¼Œå†…å­˜ä¸è¶³æ—¶æŠ›å‡ºStackOverflowErroræˆ–è€…OutOfMemoryError: unable to create new native threadã€‚<br>3.Socketç¼“å­˜åŒºã€‚IOException: Too many open filesã€‚<br>4.JNIä»£ç ã€‚è°ƒç”¨æœ¬åœ°åº“ï¼Œæœ¬åœ°åº“ä½¿ç”¨çš„å†…å­˜ä¹Ÿä¸åœ¨å †ä¸­ã€‚<br>5.è™šæ‹Ÿæœºå’ŒGCã€‚è™šæ‹Ÿæœºå’ŒGCçš„ä»£ç æ‰§è¡Œä¹Ÿè¦æ¶ˆè€—ä¸€å®šçš„å†…å­˜ã€‚</p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>é¢è¯•</tag>
        <tag>JAVA</tag>
      </tags>
  </entry>
  <entry>
    <title>åœ°ç†ä½ç½®ä¿¡æ¯GeoHashç®—æ³•åŠGoogle S2ç®—æ³•</title>
    <url>/geohash/</url>
    <content><![CDATA[<div class=".article-gallery"><p>æœ€è¿‘åœ¨æŒç»­ä¼˜åŒ–æœåŠ¡å™¨3Dåœºæ™¯å»ºæ¨¡çš„æ–¹æ¡ˆï¼Œå—Redisçš„GEOå¯å‘ï¼Œç°åœ¨æœ‰ä¸€ä¸ªç©ºé—´å’Œæ—¶é—´ä¸Šéƒ½æ¯”è¾ƒç†æƒ³çš„æ–¹æ¡ˆï¼Œç­‰å®é™…æµ‹è¯•å’Œå®ç°ä¹‹åå†æ•´ç†å®Œæ•´æ–‡æ¡£ã€‚</p>
<p><a href="https://imgtu.com/i/hMnZuR"><a href="https://z3.ax1x.com/2021/08/27/hMnZuR.md.png" title="hMnZuR.md.png" class="gallery-item" style="box-shadow: none;"> <img src="https://z3.ax1x.com/2021/08/27/hMnZuR.md.png" alt="hMnZuR.md.png"></a></a></p>
<p>å…ˆç»™å‡ºä¸¤ç¯‡ä¸é”™çš„ç®—æ³•æ–‡ç« ã€‚</p>
<p>éå¸¸è¯¦ç»†çš„ç®—æ³•åˆ†æï¼š</p>
<p><a href="https://halfrost.com/go_spatial_search/">https://halfrost.com/go_spatial_search/</a></p>
<p><a href="https://www.cnblogs.com/LBSer/p/3310455.html">https://www.cnblogs.com/LBSer/p/3310455.html</a></p>
<p>Redis GEOä½¿ç”¨ï¼š</p>
<p><a href="https://www.jianshu.com/p/c9801c4f9f6a">https://www.jianshu.com/p/c9801c4f9f6a</a></p>
<p>å¯»è·¯ç®—æ³•ï¼š</p>
<p><a href="http://gad.qq.com/article/detail/33637">http://gad.qq.com/article/detail/33637</a></p>
<p><a href="https://zerowidth.com/2013/05/05/jump-point-search-explained.html">https://zerowidth.com/2013/05/05/jump-point-search-explained.html</a></p>
<p><a href="http://qiao.github.io/PathFinding.js/visual/">http://qiao.github.io/PathFinding.js/visual/</a></p>
<p><a href="http://blog.sina.com.cn/s/blog_4a5c75d40102wo5l.html">http://blog.sina.com.cn/s/blog_4a5c75d40102wo5l.html</a></p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>æœåŠ¡å™¨</tag>
      </tags>
  </entry>
  <entry>
    <title>golangç¬”è®°</title>
    <url>/golang-summary/</url>
    <content><![CDATA[<div class=".article-gallery"><h2 id="go-gc"><a href="#go-gc" class="headerlink" title="go gc"></a>go gc</h2><ul>
<li>å¼€å§‹æ ‡è®°ï¼šSTWï¼Œå¼€å¯å†™å±éšœï¼Œç»Ÿè®¡rootå¯¹è±¡ã€‚</li>
<li>ä¸‰è‰²æ ‡è®°ï¼šæ‰«ærootå¯¹è±¡ï¼ŒåŒ…æ‹¬å…¨å±€æŒ‡é’ˆå’ŒGæ ˆä¸Šçš„ï¼Œæ‰«æGæ ˆæ—¶Gæ ˆéœ€è¦æš‚åœã€‚rootæ ‡è®°ç°è‰²ï¼Œæ²¡å¼•ç”¨æ ‡è®°é»‘è‰²ï¼Œæœ‰å¼•ç”¨æ ‡è®°é»‘è‰²å¹¶æŠŠå¼•ç”¨æ ‡è®°ç°è‰²ï¼Œç›´åˆ°ç°è‰²é˜Ÿåˆ—ä¸ºç©ºã€‚ä¸ç”¨æˆ·ç¨‹åºå¹¶è¡Œã€‚</li>
<li>é‡æ–°æ‰«æï¼šSTWï¼Œå› ä¸ºä¸Šä¸€æ­¥å¹¶è¡Œï¼Œå¯èƒ½é‡æ–°åˆ†é…å¯¹è±¡å’Œèµ‹å€¼ï¼Œé€šè¿‡å†™å±éšœè®°å½•ä¸‹æ¥ã€‚</li>
<li>å›æ”¶ç™½è‰²å¯¹è±¡</li>
<li>å†™å±éšœï¼šè®°å½•ç¬¬ä¸€æ¬¡æ‰«ææ—¶å¯¹è±¡çš„çŠ¶æ€ï¼Œå’Œç¬¬äºŒæ¬¡æ¯”å¯¹ï¼Œå¼•ç”¨çŠ¶æ€å˜åŒ–çš„å¯¹è±¡æ ‡è®°ç°è‰²ï¼Œç»§ç»­å¤„ç†ã€‚</li>
</ul>
<span id="more"></span>

<h2 id="mutex"><a href="#mutex" class="headerlink" title="mutex"></a>mutex</h2><ul>
<li>CASè·å–é”ï¼ŒæˆåŠŸåˆ™è¿”å›</li>
<li>åˆ¤æ–­æ˜¯å¦å¯è¿›å…¥è‡ªæ—‹ï¼Œ1å½“å‰é”éé¥¥é¥¿ä¸”å·²é”å®šï¼Œ2æ¬¡æ•°å°äº4ï¼Œ3cpu&gt;1ï¼Œ4æ­£åœ¨æ‰§è¡Œä¸­ï¼Œä¸”é˜Ÿåˆ—ç©ºé—²çš„På¤§äº0ã€‚è¿›å…¥è‡ªæ—‹ä¼šæ‰§è¡Œ30æ¬¡PAUSEæŒ‡ä»¤ã€‚</li>
<li>è‡ªæ—‹ç»“æŸååˆ¤æ–­å½“å‰é”çš„çŠ¶æ€ï¼Œé¥¥é¥¿æ¨¡å¼ä¸‹ä¸ä¼šå»è¯·æ±‚é”ï¼Œè€Œä¼šå°†goroutineåŠ å…¥é˜Ÿåˆ—æœ«ç«¯ã€‚</li>
<li>è‡ªæ—‹åCASè·å–é”ï¼ŒæˆåŠŸåˆ™è¿”å›ã€‚å¤±è´¥åˆ™ä¼‘çœ å½“å‰goroutineï¼Œç­‰å¾…ä¿¡å·é‡å”¤é†’ã€‚</li>
<li>goroutineè¢«å”¤é†’åä¼šåˆ¤æ–­æ˜¯å¦é¥¥é¥¿æ¨¡å¼ï¼ˆé”ç­‰å¾…è¶…è¿‡1mså°±ä¼šè¿›å…¥é¥¥é¥¿çŠ¶æ€ï¼‰ï¼Œé¥¥é¥¿çŠ¶æ€ä¸‹è·å¾—äº’æ–¥é”ï¼Œå¦‚æœé”ç­‰å¾…é˜Ÿåˆ—ä¸­åªæœ‰å½“å‰goroutineåˆ™å–æ¶ˆé¥¥é¥¿çŠ¶æ€ï¼Œå¦‚æœåˆ¤æ–­æ˜¯æ­£å¸¸æ¨¡å¼ï¼Œè®¾ç½®å”¤é†’ï¼Œé‡ç½®è¿­ä»£æ¬¡æ•°å¹¶é‡æ–°è·å–é”ã€‚</li>
<li>è§£é”æ²¡æœ‰ç»‘å®šå…³ç³»ï¼Œå¯ä»¥ä¸€ä¸ªgoroutineé”å®šï¼Œå¦ä¸€ä¸ªgoroutineè§£é”ã€‚</li>
<li>è§£é”ï¼Œatomicä¿®æ”¹é”çŠ¶æ€ï¼Œå¦‚æœè®¾ç½®åç­‰å¾…é”çš„goroutineä¸º0åˆ™è¿”å›ï¼Œä¸ä¸º0è¯´æ˜è¿˜æœ‰å…¶ä»–goroutineåœ¨ç­‰å¾…é”ã€‚</li>
<li>é¥¥é¥¿æ¨¡å¼ä¸‹ï¼Œç›´æ¥å°†é”äº¤ç»™ä¸‹ä¸€ä¸ªç­‰å¾…çš„goroutineï¼Œä¸ä¼šé€€å‡ºé¥¥é¥¿æ¨¡å¼ã€‚</li>
<li>æ­£å¸¸æ¨¡å¼ä¸‹ï¼Œåˆ¤æ–­æœ‰æ²¡æœ‰ç­‰å¾…è€…ï¼Œæˆ–è€…goroutineå·²è¢«å”¤é†’æˆ–å¤„äºé”å®šã€‚å”¤é†’ç­‰å¾…è€…å¹¶ç§»äº¤é”ã€‚</li>
<li>è¯»é”ï¼š<ul>
<li>åŠ é”ï¼šåŸå­æ–¹æ³•å°†æ­£åœ¨è¯»çš„åŠ 1ï¼Œè¿”å›è´Ÿæ•°ï¼Œè¯´æ˜æœ‰å…¶ä»–å†™é”ï¼Œç­‰å¾…ã€‚</li>
<li>è§£é”ï¼šæ­£åœ¨è¯»çš„å‡1ï¼Œè¿”å›è´Ÿæ•°ï¼Œè¯´æ˜æœ‰åœ¨ç­‰å¾…çš„å†™æ“ä½œï¼Œå”¤é†’å†™æ“ä½œ</li>
</ul>
</li>
<li>å†™é”ï¼š<ul>
<li>åŠ é”ï¼šè°ƒç”¨äº’æ–¥é”lockï¼Œè·å¾—äº’æ–¥é”ï¼Œå°†åœ¨è¯»goroutineæ•°è®¾ç½®ä¸ºè´Ÿå€¼ï¼Œé˜»å¡åç»­è¯»æ“ä½œï¼Œå¦‚æœä»ç„¶æœ‰åœ¨è¯»çš„é”æŒæœ‰ï¼Œç­‰å¾…è¯»é”å®Œæˆåå”¤é†’ã€‚</li>
<li>è§£é”ï¼šæ¢å¤ä¹‹å‰å†™å…¥çš„è´Ÿæ•°ï¼Œå¾ªç¯å”¤é†’å½“å‰ç­‰å¾…çš„è¯»æ“ä½œã€‚</li>
</ul>
</li>
<li>sync.Onceå®ç°åŸç†ï¼Œç”¨ä¸€ä¸ªatomicå˜é‡åˆ¤æ–­å‡½æ•°æ˜¯å¦å·²æ‰§è¡Œï¼Œå¦‚æœæ‰§è¡Œè¿‡åˆ™ä¸æ‰§è¡Œï¼Œå¦‚æœæœªæ‰§è¡Œåˆ™å°è¯•æ‰§è¡Œï¼Œå¯èƒ½å¤šä¸ªgoroutineåŒæ—¶å°è¯•ï¼ŒåŠ é”æ“ä½œï¼Œè·å–é”åå†æ£€æµ‹ä¸Šé¢çš„å˜é‡æ˜¯å¦å·²æ‰§è¡Œï¼Œè¿™é‡Œé‡‡ç”¨åŒé‡æ£€æµ‹æœºåˆ¶ï¼Œæ‰§è¡Œå®Œæ–¹æ³•åï¼Œè®¾ç½®atomicå˜é‡ã€‚åŸºæœ¬å°±æ˜¯å•ä¾‹çš„åŸç†ã€‚</li>
</ul>
<h2 id="kitex"><a href="#kitex" class="headerlink" title="kitex"></a>kitex</h2><ul>
<li>å…¬å¸å¼€æºçš„RPCæ¡†æ¶ï¼Œ<a href="https://github.com/cloudwego/kitex">github</a></li>
<li>åº•å±‚ç½‘ç»œåŸºäºNetpollå®ç°ï¼ŒkiteåŸºäºgolangçš„netå®ç°ï¼ŒBIOï¼Œæ¯ä¸ªè¿æ¥éƒ½éœ€è¦ä¸€ä¸ªgoroutineï¼Œå¤§é‡è¿æ¥æ—¶ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ã€‚</li>
<li>NetpollåŸºäºepollå®ç°ï¼Œepollæ˜¯linuxæä¾›çš„å¤šè·¯å¤ç”¨ç½‘ç»œIOæ¨¡å‹ï¼ŒTCPè¯»å†™éƒ½æ˜¯é€šè¿‡ç¼“å†²åŒºæ¥å®ç°çš„ï¼Œæ“ä½œç³»ç»Ÿä¸ºæ¯ä¸ªtcpè¿æ¥ç»´æŠ¤è¯»ã€å†™ç¼“å†²åŒºã€‚epollåŸºäºç›‘å¬è¯»å†™ç¼“å†²åŒºäº‹ä»¶æ¥å®ç°å¯¹ç½‘ç»œè¿æ¥çš„è¯»å†™å’Œç®¡ç†ã€‚epollé€šè¿‡çº¢é»‘æ ‘å®ç°å¯¹fd(æ–‡ä»¶æè¿°ç¬¦)çš„é«˜æ•ˆæŸ¥æ‰¾ï¼Œä¸ºæ¯ä¸ªç›‘å¬çš„ç½‘ç»œioå‘æ“ä½œç³»ç»Ÿæ³¨å†Œå›è°ƒå‡½æ•°ï¼Œæœ‰ç½‘ç»œioå‘é€çš„æ—¶å€™å›è°ƒå‡½æ•°å°†å¯¹åº”çš„äº‹ä»¶åŠ å…¥rdlistä¸­ï¼Œepollåªéœ€è¦åˆ¤æ–­rdlistæ˜¯ä¸æ˜¯ç©ºå³å¯ã€‚<ul>
<li>è‡ªå»ºepollç®¡ç†è¿æ¥çŠ¶æ€</li>
<li>è‡ªå»ºå†…å­˜æ± ï¼Œæé«˜bufferæ€§èƒ½</li>
<li>æ”¯æŒæ‰¹é‡ç³»ç»Ÿå‘½ä»¤è°ƒç”¨</li>
<li>åç¨‹æ± </li>
<li>å¤šç§äº¤äº’æ¨¡å¼ï¼ˆåŒå‘streamingï¼ŒOnewayï¼‰</li>
<li>åè®®æ‰©å±•</li>
</ul>
</li>
<li>é€šè¿‡netpollæ¨¡å‹ï¼Œå®ç°G1åœ¨Mä¸Šè¿›è¡ŒIOæ“ä½œæ—¶ï¼Œå°†G1ç§»åˆ°epollç›‘å¬ä¸­ï¼ŒMç»§ç»­æ‰§è¡ŒPä¸Šå…¶ä»–å¯æ‰§è¡Œçš„G2ï¼Œåˆšæ‰é‚£ä¸ªé˜»å¡G1IOè°ƒç”¨ç»“æŸåï¼Œå†åŠ å›åˆ°Pçš„é˜Ÿåˆ—ä¸­æˆ–Globalé˜Ÿåˆ—ä¸­ã€‚å®ç°ä»¥åŒæ­¥çš„æ¨¡å¼å†™å¼‚æ­¥é€»è¾‘ã€‚</li>
</ul>
<h2 id="java-gc"><a href="#java-gc" class="headerlink" title="java gc"></a>java gc</h2><ul>
<li>å°†å†…å­˜åˆ’åˆ†æˆregionï¼Œæ¯ä¸ªregionè¡¨ç¤ºedenï¼Œsurvivorï¼Œoldï¼Œhugeã€‚è·Ÿè¸ªå„ä¸ªregionåƒåœ¾å›æ”¶ä»·å€¼ï¼Œç»´æŠ¤ä¼˜å…ˆçº§åˆ—è¡¨ï¼Œé¿å…åœ¨æ•´ä¸ªå †ä¸­è¿›è¡Œåƒåœ¾å›æ”¶ã€‚</li>
<li>regioné—´æ˜¯å¤åˆ¶ç®—æ³•</li>
<li>å¯é¢„æµ‹åœé¡¿æ—¶é—´çš„æ¨¡å‹</li>
<li>Eden younggc stw, 45%, å¹¶å‘æ ‡è®°ï¼Œæ··åˆå›æ”¶ï¼Œfullgcã€‚</li>
</ul>
<h2 id="è°ƒä¼˜"><a href="#è°ƒä¼˜" class="headerlink" title="è°ƒä¼˜"></a>è°ƒä¼˜</h2><ul>
<li>å‡å°‘stringä¸byte[]è½¬æ¢ã€‚</li>
<li>æ–‡æœ¬è¿æ¥ç”¨strings.Builderï¼Œå’Œbytes.Bufferæ¯”èµ·æ¥åº•å±‚æ²¡æœ‰å†…å­˜åˆ†é…å’Œæ‹·è´ï¼Œæ˜¯byte sliceç»“æ„åˆ°stringç»“æ„çš„è½¬æ¢ã€‚</li>
<li>åŒjavaä¸€æ ·ï¼Œsliceå’Œmapé¢„åˆ†é…ç©ºé—´ï¼Œå‡å°‘å†…å­˜æ‹·è´ï¼Œmapè¿˜å¯å‡å°‘rehashã€‚</li>
<li>å‡½æ•°ä¸­å°½å¯èƒ½ä½¿ç”¨å€¼è€Œä¸æ˜¯æŒ‡é’ˆï¼Œè¿™å¯èƒ½ä¼šå’Œå¤§å®¶å¸¸å¬åˆ°çš„ç”¨æŒ‡é’ˆé¿å…å¯¹è±¡çš„æ‹·è´çŸ›ç›¾ï¼Œä¸»è¦æ˜¯å› ä¸ºæŒ‡é’ˆä¼šä½¿é€ƒé€¸åˆ†æå°†å˜é‡åˆ†é…åœ¨å †ä¸Šã€‚è¿™ä¸ªè§„åˆ™åŒæ ·é€‚ç”¨äºå‡½æ•°çš„recvï¼ŒæŒ‡é’ˆä»…ä»…åº”è¯¥è¡¨ç¤ºå¯ä¿®æ”¹æƒã€‚sliceç±»å‹å¦‚éå¿…è¦ä¸è¦åŒ…å«æŒ‡é’ˆã€‚ä½†æ˜¯channelä¼ é€’çš„å¯¹è±¡ï¼Œæ— è®ºæŒ‡é’ˆè¿˜æ˜¯å€¼éƒ½ä¼šæŠŠå¯¹è±¡åˆ†é…åˆ°å †ä¸Šï¼Œç›´æ¥ä¼ æŒ‡é’ˆå°±è¡Œã€‚</li>
<li>mapå°½é‡å­˜å€¼è€Œä¸æ˜¯æŒ‡é’ˆã€‚</li>
<li>ä½¿ç”¨sync.Poolä¼˜åŒ–å†…å­˜ï¼Œé€‚ç”¨çŸ­å‘¨æœŸå°å†…å­˜å¯¹è±¡ï¼Œå¿…é¡»æ¸…æ¥šå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚æ”¾å…¥poolå‰å…ˆç½®0ã€‚</li>
<li>ä¸å¸¦ç¼“å†²åŒºçš„channelä¸å‘ç”Ÿå†…å­˜æ‹·è´ã€‚</li>
<li>atomicä¼˜åŒ–ã€‚</li>
</ul>
<h2 id="pprof"><a href="#pprof" class="headerlink" title="pprof"></a>pprof</h2><ul>
<li>Cpu/heap/goroutine/mutex/block/thread</li>
<li>top/source/flame graph</li>
<li>traceï¼Œmmuå¯ä»¥æŸ¥çœ‹ç”¨æˆ·ç¨‹åºcpuæ—¶é—´å æ¯”ï¼Œç¡®å®šgcæ˜¯å¦è€—æ—¶è¿‡é•¿ã€‚</li>
<li>Cpu topè§†å›¾å’Œwebè§†å›¾<ul>
<li>flatå‡½æ•°è‡ªèº«è€—æ—¶å’Œå æ¯”</li>
<li>cumå‡½æ•°è‡ªèº«åŠå…¶è°ƒç”¨å…¶ä»–æ€»è€—æ—¶åŠå æ¯”</li>
<li>listæ ¹æ®åˆ¶å®šçš„æ­£åˆ™æŸ¥æ‰¾ä»£ç ï¼Œæ˜¾ç¤ºæ¯è¡Œæ—¶é—´å æ¯”</li>
</ul>
</li>
<li>heap<ul>
<li>åŒä¸Šç±»ä¼¼ sourceè§†å›¾æŸ¥çœ‹æ¯è¡Œä»£ç å†…å­˜æƒ…å†µ</li>
<li>ç´¯è®¡å’Œå½“å‰æŒæœ‰çš„å¯¹è±¡æ•°å’Œå¤§å°</li>
</ul>
</li>
<li>goroutine<ul>
<li>ç«ç„°å›¾æŸ¥çœ‹</li>
</ul>
</li>
<li>mutex<ul>
<li>å¯æŸ¥çœ‹é”è€—æ—¶çš„å…·ä½“æƒ…å†µï¼Œä»¥åŠä»£ç </li>
</ul>
</li>
<li>block<ul>
<li>pprofä¸­ä¸€äº›è¿‡å°çš„è°ƒç”¨èŠ‚ç‚¹å¯èƒ½ä¸ä¼šå±•ç¤ºï¼Œblockä¸­å¯èƒ½èƒ½çœ‹åˆ°çš„å…·ä½“ä¿¡æ¯å°äºcountè®¡æ•°</li>
</ul>
</li>
<li>é‡‡æ ·åŸç†<ul>
<li>cpuã€‚è¿›ç¨‹å¼€å§‹é‡‡æ ·ï¼Œå‘æ“ä½œç³»ç»Ÿå¯åŠ¨å®šæ—¶å™¨ï¼Œæ“ä½œç³»ç»Ÿæ¯éš”10mså‘è¿›ç¨‹å‘é€ä¸€æ¬¡ä¿¡å·ï¼Œè¿›ç¨‹æ”¶åˆ°ä¿¡å·ï¼Œè®°å½•è°ƒç”¨å †æ ˆã€‚è¿›ç¨‹ä¼šå¯åŠ¨å†™ç¼“å†²çš„goroutineï¼Œæ¯éš”100mså°†å †æ ˆä¿¡æ¯å†™å…¥è¾“å‡ºæµï¼Œé‡‡æ ·åœæ­¢æ—¶ï¼Œåœæ­¢è®¡æ—¶å™¨ï¼Œå†™ç¼“å†²ç»“æŸè¾“å‡ºã€‚</li>
<li>goroutineå’Œthreadcreateã€‚StopTheWorld-&gt;éå†ç”¨æˆ·å‘èµ·çš„goroutine/måˆ—è¡¨-&gt;è¾“å‡ºåˆ›å»ºg/mçš„å †æ ˆ-&gt;StartTheWorldã€‚</li>
<li>heapã€‚åªèƒ½é‡‡æ ·å †å†…å­˜ï¼Œæ¯åˆ†é…512Kè®°å½•ä¸€æ¬¡ï¼Œè®°å½•åˆ†é…æƒ…å†µå’Œé‡Šæ”¾æƒ…å†µï¼Œå¯ä»¥ç®—å‡ºå½“å‰ä½¿ç”¨æƒ…å†µã€‚</li>
<li>metux/blockã€‚é‡‡æ ·æŠ¢é”/é˜»å¡æ“ä½œæ¬¡æ•°å’Œè€—æ—¶ï¼Œè¶…è¿‡é˜ˆå€¼æ‰ä¼šè®°å½•ã€‚å‘ç”Ÿçš„æ—¶å€™ä¸ŠæŠ¥æ—¶é—´å’Œå †æ ˆä¿¡æ¯ä¸ŠæŠ¥profilerï¼Œprofileræ ¹æ®ç­–ç•¥è¿›è¡Œä¸€äº›ä¸¢å¼ƒå’Œç»Ÿè®¡ã€‚</li>
</ul>
</li>
</ul>
<h2 id="ç¼“å­˜"><a href="#ç¼“å­˜" class="headerlink" title="ç¼“å­˜"></a>ç¼“å­˜</h2><ul>
<li>Fetcher,BatchFetcher,Loader,BatchLoader.</li>
<li>å›æº(Loader)è¦ä¿è¯å®‰å…¨ï¼Œé¿å…ç¼“å­˜å‡»ç©¿æ—¶å¼•å‘é›ªå´©ã€‚<ul>
<li>singleflightï¼šé”åŠ å…±äº«ã€‚</li>
<li>å¤šçº§ç¼“å­˜ã€‚</li>
</ul>
</li>
<li>ç¼“å­˜ç©¿é€ï¼šä¸å­˜åœ¨çš„æ•°æ®è¦ç¼“å­˜ã€‚</li>
<li>ç¼“å­˜å‡»ç©¿ï¼šæŸä¸€ç¬é—´ç¼“å­˜å¤±æ•ˆï¼Œå¤§é‡è¯·æ±‚è½åˆ°dbä¸Šã€‚</li>
<li>ç¼“å­˜ç­–ç•¥ï¼š<ul>
<li>ç¼“å­˜ä¼˜å…ˆï¼šç¼“å­˜å‘½ä¸­è¿”å›ã€‚miss-&gt;å›æº-&gt;æ›´æ–°ç¼“å­˜-&gt;è¿”å›ã€‚</li>
<li>å›æºä¼˜å…ˆï¼ˆå…œåº•ï¼‰ï¼šå›æºæˆåŠŸ-&gt;æ›´æ–°ç¼“å­˜-&gt;è¿”å›ç»“æœã€‚å›æºå¤±è´¥-&gt;ç¼“å­˜-&gt;å‘½ä¸­è¿”å›ï¼Œæœªå‘½ä¸­è¿”å›å¤±è´¥ã€‚</li>
<li>ç¼“å­˜ä¼˜å…ˆï¼ŒåŒæ­¥å›æºï¼Œå›æºå¤±è´¥é€»è¾‘è¿‡æœŸæ•°æ®å…œåº•ï¼šç¼“å­˜å‘½ä¸­è¿”å›ã€‚ç¼“å­˜miss-&gt;å›æºæˆåŠŸ-&gt;æ›´æ–°ç¼“å­˜-&gt;è¿”å›ï¼Œå›æºå¤±è´¥-&gt;é€»è¾‘è¿‡æœŸæ•°æ®è¿”å›ï¼Œé€»è¾‘æ•°æ®å¤±è´¥-&gt;è¿”å›å¤±è´¥ã€‚</li>
<li>ç¼“å­˜ä¼˜å…ˆï¼Œè¿‡æœŸæ•°æ®å…œåº•ï¼Œå¼‚æ­¥å›æºï¼šç¼“å­˜å‘½ä¸­è¿”å›ã€‚ç¼“å­˜miss-&gt;é€»è¾‘è¿‡æœŸæ•°æ®-&gt;è¿”å›-&gt;å¼‚æ­¥å›æº-&gt;æ›´æ–°ç¼“å­˜ã€‚ç¼“å­˜miss-&gt;é€»è¾‘è¿‡æœŸæ•°æ®å¤±è´¥-&gt;åŒæ­¥å›æº-&gt;æ›´æ–°ç¼“å­˜-&gt;è¿”å›ç»“æœã€‚</li>
<li>åªè¯»ç¼“å­˜ï¼šåªä»ç¼“å­˜ä¸­è¯»æ•°æ®ï¼Œæœ‰å…¶ä»–æ–¹å¼æ›´æ–°ç¼“å­˜ï¼Œä¸€èˆ¬æ˜¯å…¨é‡ç¼“å­˜ã€‚</li>
<li>åªå›æºï¼šç¼“å­˜é™çº§ã€‚</li>
</ul>
</li>
<li>å­—èŠ‚ç¼“å­˜ï¼šmap&lt;int64, []byte&gt; ä¸åŒ…å«æŒ‡é’ˆï¼ŒåŠ é€ŸGCã€‚å¯¹è±¡ç¼“å­˜ï¼šmap&lt;string, interface{}&gt;åŒ…å«æŒ‡é’ˆã€‚</li>
<li>å¤§keyï¼Œ10Kæˆ–5000ä¸ªå…ƒç´ ã€‚</li>
</ul>
<h2 id="javaæ€§èƒ½"><a href="#javaæ€§èƒ½" class="headerlink" title="javaæ€§èƒ½"></a>javaæ€§èƒ½</h2><ul>
<li><p>å †å¤–å†…å­˜</p>
</li>
<li><p>kwaibookæ˜¥èŠ‚ç¬”è®°</p>
</li>
<li><p>ç¼“å­˜å‡»ç©¿ï¼šjsonååºåˆ—åŒ–å’Œåºåˆ—åŒ–æ€§èƒ½ï¼Œç¼“å­˜å¤±æ•ˆåï¼Œè¯»dbå‰å…ˆåŠ é”ï¼Œæœ¬åœ°ç¼“å­˜ï¼Œæ‹†é™¤å¤§key</p>
</li>
<li><p>sandboxç¬”è®°</p>
</li>
</ul>
<h2 id="åŒ¹é…"><a href="#åŒ¹é…" class="headerlink" title="åŒ¹é…"></a>åŒ¹é…</h2><ul>
<li>open matchæœ‰ä¸‰ä¸ªå¾®æœåŠ¡ï¼Œfrontendï¼Œdirectorï¼ŒMMFã€‚</li>
<li>ç®€åŒ–äº†å¾®æœåŠ¡çš„æ•°é‡ï¼Œå¯ä»¥åœ¨å•ä¸ªæœåŠ¡å™¨è¿è¡Œï¼Œä¹Ÿå¯ä»¥åœ¨é›†ç¾¤è¿è¡Œã€‚</li>
<li>é€šè¿‡åŠ¨æ€é…ç½®ï¼Œæ–¹ä¾¿ä¸åŒé¡¹ç›®ç»„åŠ¨æ€æ¥å…¥åŒ¹é…æ¨¡å¼ã€‚</li>
<li>æ”¯æŒä¸€ä¸ªæ¸¸æˆè¿è¡Œå¤šä¸ªåŒ¹é…æ¨¡å¼ï¼ŒåŒä¸€ç©å®¶å¯ä»¥åŒæ—¶åŒ¹é…å¤šä¸ªæ¨¡å¼ã€‚</li>
<li>æ¯ä¸ªåŒ¹é…æ¨¡å¼å¯¹åº”ä¸€ä¸ªåŒ¹é…ç®—æ³•ï¼Œå¦‚å…ˆæ¥å…ˆåŒ¹é…-æ–—åœ°ä¸»ï¼ŒåŒåŸåŒ¹é…ã€‚</li>
<li>æ”¯æŒäº†RPCå’ŒRMQè¿”å›åŒ¹é…ç»“æœã€‚</li>
<li>åŒ¹é…æµç¨‹ï¼Œgameserveråˆ›å»ºticketï¼Œå‘é€ç»™åŒ¹é…æœæ”¾å…¥ticketpoolä¸­ã€‚åŒ¹é…æœåŠ¡ä¼šå®šæ—¶ä»æ± ä¸­å–å‡ºticketï¼Œmmfç®—æ³•ä¼šé€‰å–åˆé€‚çš„ticketåŒ¹é…ï¼Œåˆ›å»ºmatchã€‚matchåˆ›å»ºè¿›ä¸€æ­¥è¿›è¡Œè¿‡æ»¤ï¼Œå»é™¤é‡å¤åŒ¹é…çš„ç¥¨ï¼Œåˆ é™¤å¼‚å¸¸çš„matchï¼Œæœ€åå°†ç»“æœé€šçŸ¥gameserverï¼Œåˆ é™¤ticketã€‚</li>
<li>æŒ‰eloåˆ†æ•°ç»„é˜Ÿï¼Œ</li>
</ul>
<h2 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h2><ul>
<li><a href="https://www.jianshu.com/p/125bba448cdd">https://www.jianshu.com/p/125bba448cdd</a></li>
<li><a href="https://cbsheng.github.io/posts/redis%E9%87%8C%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E8%AF%B7%E6%B1%82%E5%A6%82%E4%BD%95%E8%A2%AB%E5%A4%84%E7%90%86/">ä¸€ä¸ªç®€å•è¯·æ±‚å¦‚ä½•è¢«å¤„ç†</a></li>
<li>IOå¤šè·¯å¤ç”¨ï¼Œç›‘å¬ç«¯å£6379ï¼Œsocketå°è£…æˆäº‹ä»¶ï¼Œæ³¨å†Œåˆ°äº‹ä»¶å¾ªç¯å™¨é‡Œï¼Œè¿˜æœ‰å›è°ƒå‡½æ•°ã€‚clientæ–°è¿æ¥å»ºç«‹æ—¶ï¼Œå›è°ƒå‡½æ•°acceptï¼Œè¿”å›ä¸€ä¸ªFDï¼Œä¹Ÿæ³¨å†Œè¿›äº‹ä»¶å¾ªç¯å™¨é‡Œã€‚è¿™æ ·ä¹‹åclientå‘é€è¯·æ±‚æ—¶ï¼ŒFDå¯è¯»ï¼Œäº‹ä»¶å¾ªç¯å™¨æ•è·åˆ°äº‹ä»¶å¹¶è°ƒç”¨å¯¹åº”çš„å‡½æ•°ã€‚</li>
<li>æ¯ä¸ªè¿æ¥éƒ½æ˜¯clientå¯¹è±¡ï¼Œå­˜å‚¨å‘½ä»¤ï¼Œè¾“å…¥/å‡ºç¼“å†²åŒºã€‚</li>
<li>äº‹ä»¶å¾ªç¯å™¨æ‹¿åˆ°å°±ç»ªäº‹ä»¶çš„æ–‡ä»¶æè¿°ç¬¦åï¼Œåˆ¤æ–­å¯è¯»è¿˜æ˜¯å¯å†™ï¼Œè°ƒç”¨å¯¹åº”çš„å›è°ƒå‡½æ•°ã€‚</li>
<li>æ•°æ®ç»“æ„<ul>
<li>stirngï¼š intã€embstrã€rawã€‚ä¸èƒ½ç”¨c++stringæ¥ä»£æ›¿ï¼Œc++stringä¸æ”¯æŒé¢„åˆ†é…</li>
<li>Listï¼šziplistã€linkedlist</li>
<li>hashï¼šziplistã€hashtable</li>
<li>setï¼šintsetã€hashtable</li>
<li>zsetï¼šziplistã€skiplist+table</li>
<li>hashå®ç°ï¼šsizemask=size-1ï¼Œé“¾åœ°å€å¤´æ’æ³•ï¼Œrehash</li>
</ul>
</li>
</ul>
<h2 id="Limiter"><a href="#Limiter" class="headerlink" title="Limiter"></a>Limiter</h2><ul>
<li>æ»‘åŠ¨çª—å£ï¼šredisæŒ‡ä»¤ï¼ŒZREMRANGEBYSCOREä¸Šä¸ªçª—å£å‰çš„å€¼ï¼ŒZCARDæŸ¥çœ‹å½“å‰å€¼ï¼Œåˆ¤æ–­å’Œwantæ˜¯å¦é™æµï¼Œä¸é™æµçš„è¯ï¼ŒZADD(timestamp, timestamp+i)ï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œè¿”å›å½“å‰ZCARDæ•°ã€‚</li>
<li>å›ºå®šçª—å£ï¼šæ ¹æ®æ—¶é—´å°è£…keyï¼Œå¯ä»¥æ˜¯ä¸€äº›å¤šç»´çš„å‚æ•°keyï¼Œincræ–¹æ³•è¿”å›åˆ¤æ–­æ˜¯å¦é™æµï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´ã€‚</li>
</ul>
<p><del>æ€§èƒ½åˆ†æ golangè¯¾ç¨‹</del></p>
<p><del>åŒ¹é… p5 elo</del></p>
<p><del>ç½‘å…³</del></p>
<p>tcpã€kcp</p>
<p><a href="https://zhuanlan.zhihu.com/p/388704023">https://zhuanlan.zhihu.com/p/388704023</a></p>
<h5 id="redisï¼š"><a href="#redisï¼š" class="headerlink" title="redisï¼š"></a>redisï¼š</h5><p><a href="https://segmentfault.com/a/1190000040206818">https://segmentfault.com/a/1190000040206818</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/148562122">https://zhuanlan.zhihu.com/p/148562122</a></p>
<p><a href="https://www.jianshu.com/p/125bba448cdd">https://www.jianshu.com/p/125bba448cdd</a></p>
<p><a href="https://cbsheng.github.io/posts/redis%E9%87%8C%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E8%AF%B7%E6%B1%82%E5%A6%82%E4%BD%95%E8%A2%AB%E5%A4%84%E7%90%86/">https://cbsheng.github.io/posts/redis%e9%87%8c%e4%b8%80%e4%b8%aa%e7%ae%80%e5%8d%95%e8%af%b7%e6%b1%82%e5%a6%82%e4%bd%95%e8%a2%ab%e5%a4%84%e7%90%86/</a></p>
<p>javaé”æµç¨‹ï¼Œè¯»å†™é”ï¼Œå»¶è¿Ÿé˜Ÿåˆ—ã€‚</p>
<p><a href="https://segmentfault.com/a/1190000022904663">https://segmentfault.com/a/1190000022904663</a></p>
<p>javaè‡ªå¸¦æ’åºï¼Œblog</p>
<p>mysqlï¼Œblog</p>
<p><a href="https://zhuanlan.zhihu.com/p/48327345">https://zhuanlan.zhihu.com/p/48327345</a></p>
<p><a href="https://www.w3school.com.cn/sql/sql_datatypes.asp">https://www.w3school.com.cn/sql/sql_datatypes.asp</a></p>
<p><a href="https://juejin.cn/post/6844903668571963406">https://juejin.cn/post/6844903668571963406</a></p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUxNTQyOTIxNA==&amp;mid=2247484041&amp;idx=1&amp;sn=76d3bf1772f9e3c796ad3d8a089220fa&amp;chksm=f9b784b8cec00dae3d52318f6cb2bdee39ad975bf79469b72a499ceca1c5d57db5cbbef914ea&amp;token=2025456560&amp;lang=zh_CN#rd">https://mp.weixin.qq.com/s?__biz=MzUxNTQyOTIxNA==&amp;mid=2247484041&amp;idx=1&amp;sn=76d3bf1772f9e3c796ad3d8a089220fa&amp;chksm=f9b784b8cec00dae3d52318f6cb2bdee39ad975bf79469b72a499ceca1c5d57db5cbbef914ea&amp;token=2025456560&amp;lang=zh_CN#rd</a></p>
<p><a href="https://blog.csdn.net/ibigboy/article/details/104571930?depth_1-">https://blog.csdn.net/ibigboy/article/details/104571930?depth_1-</a></p>
<p><a href="http://blog.codinglabs.org/articles/theory-of-mysql-index.html">http://blog.codinglabs.org/articles/theory-of-mysql-index.html</a></p>
<p>mongo</p>
<p><a href="https://www.infoq.cn/article/tencent-ranking-system-practice-and-challenges">https://www.infoq.cn/article/tencent-ranking-system-practice-and-challenges</a></p>
<p><a href="https://www.atzlinux.com/atzlinux/doc/os2atc2019/SPDK-bytedance-miaoyu.pdf">https://www.atzlinux.com/atzlinux/doc/os2atc2019/SPDK-bytedance-miaoyu.pdf</a></p>
<p><a href="http://point-blank-games.com/theses/Sara_Budde_Thesis.pdf">http://point-blank-games.com/theses/Sara_Budde_Thesis.pdf</a></p>
<p>byted openï¼š</p>
<p><a href="https://www.jianshu.com/p/d7284007f883">https://www.jianshu.com/p/d7284007f883</a></p>
<p><a href="https://www.jianshu.com/p/dd5fb725331b">https://www.jianshu.com/p/dd5fb725331b</a></p>
<p><a href="https://docs.google.com/presentation/d/1k7ZlumJKxykn6CXWqdqsx1XcKMxt7HvWgYz1oxgN66E/edit#slide=id.g56a70cb717_0_263">https://docs.google.com/presentation/d/1k7ZlumJKxykn6CXWqdqsx1XcKMxt7HvWgYz1oxgN66E/edit#slide=id.g56a70cb717_0_263</a></p>
<p><a href="https://app.diandian.com/rank/ios/1-2-172-75-4?time=1620835200000&amp;device=1&amp;timetype=today">https://app.diandian.com/rank/ios/1-2-172-75-4?time=1620835200000&amp;device=1&amp;timetype=today</a></p>
<p><a href="https://www.appannie.com/en/apps/ios/top/japan/overall/iphone/">https://www.appannie.com/en/apps/ios/top/japan/overall/iphone/</a></p>
<p><a href="https://segmentfault.com/a/1190000022678327">https://segmentfault.com/a/1190000022678327</a></p>
<p><a href="https://segmentfault.com/a/1190000022731367">https://segmentfault.com/a/1190000022731367</a></p>
<p><a href="https://www.infoq.cn/article/goyirzr19vqvtupois92">https://www.infoq.cn/article/goyirzr19vqvtupois92</a></p>
<p><a href="https://mp.weixin.qq.com/s/_LovnIqJYAuDpTm2QmUgrA">https://mp.weixin.qq.com/s/_LovnIqJYAuDpTm2QmUgrA</a></p>
<p><a href="https://pandaychen.github.io/2020/03/03/BIGCACHE-ANALYSIS/">https://pandaychen.github.io/2020/03/03/BIGCACHE-ANALYSIS/</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/91136759">https://zhuanlan.zhihu.com/p/91136759</a></p>
<p><a href="https://lailin.xyz/post/go-training-03.html">https://lailin.xyz/post/go-training-03.html</a></p>
<p><a href="https://blog.wolfogre.com/posts/go-ppof-practice/">https://blog.wolfogre.com/posts/go-ppof-practice/</a></p>
<p><a href="https://juejin.cn/post/6844903887757901831">https://juejin.cn/post/6844903887757901831</a></p>
<p><a href="https://coolshell.cn/articles/17416.html">https://coolshell.cn/articles/17416.html</a></p>
<p><a href="https://blog.csdn.net/abcjennifer/article/details/47110991">https://blog.csdn.net/abcjennifer/article/details/47110991</a></p>
<p><a href="https://github.com/gogap/aop">https://github.com/gogap/aop</a></p>
<p><a href="https://cloud.tencent.com/developer/article/1165876">https://cloud.tencent.com/developer/article/1165876</a></p>
<p>unityï¼š</p>
<p><a href="https://developer.unity.cn/projects/openday-hangzhou-unity-probe">https://developer.unity.cn/projects/openday-hangzhou-unity-probe</a></p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title>å‘ä¼˜ç§€å›¢é˜Ÿå­¦ä¹ ï¼ˆè½¬è½½ï¼‰</title>
    <url>/good-team/</url>
    <content><![CDATA[<div class=".article-gallery"><p>ä»·å€¼å¯¼å‘ï¼Œæ•°æ®é©±åŠ¨</p>
<ul>
<li>ç”¨äº§å‡ºå’Œä»·å€¼è¯´è¯ï¼Œæ¨åŠ¨åŠ›å’Œæ‰§è¡ŒåŠ›ç¬¬ä¸€</li>
<li>æ•°æ®é©±åŠ¨ï¼Œä¸»åŠ¨åšæ•°æ®åˆ†æï¼Œè€Œä¸æ˜¯ç­‰ç€åˆ«äººç»™æ•°æ®</li>
<li>ç”¨æ•°æ®å’Œæ·±å…¥åˆ†æç»“æœæ¥è®¨è®ºï¼Œä¸æ‹è„‘è¢‹ï¼Œé€šè¿‡æ•°æ®åˆ†æè·Ÿäº§å“ä¸€èµ·æ‰¾ä¼˜åŒ–æ–¹å‘ï¼Œä¸åšçº¯æ‰§è¡Œè€…</li>
<li>æ‰¿è¯ºå¿…è¾¾ï¼Œå…³æ³¨äº¤ä»˜ï¼Œä¸å»¶æœŸ - æˆ‘ä»¬è¦è¿½æ±‚æè‡´ï¼Œä½†ä¸è¦è¿½æ±‚å®Œç¾ï¼Œå¿…è¦æ—¶éœ€è¦åœ¨æŒ‰æ—¶äº¤ä»˜å’Œè¿½æ±‚æè‡´é—´ä½œå‡ºæƒè¡¡ï¼Œå¯ä»¥åœ¨å°½æœ€å¤§åŠªåŠ›çš„æƒ…å†µä¸‹ï¼Œå…ˆæŒ‰æ—¶äº¤ä»˜ï¼ŒåŒæ—¶è¯´æ˜å“ªäº›åœ°æ–¹è¿˜ä¸å¤Ÿæè‡´ï¼Œäº¤ä»˜åä¼šæŒç»­ã€é©¬ä¸Šå»ä¼˜åŒ– - æŒ‰æ—¶äº¤ä»˜ å’Œ è¿½æ±‚æè‡´ä¹‹é—´ä¸æ˜¯å¦¥åï¼Œæ˜¯æƒè¡¡ï¼Œåˆ¤æ–­ä¼˜å…ˆçº§<br>æå€¡</li>
<li>ã€Œç ”å‘ï¼šè¿™ä¸ªéœ€æ±‚è§£å†³äº†ç”¨æˆ·ä»€ä¹ˆç—›ç‚¹ï¼Ÿç›®æ ‡ç”¨æˆ·æ˜¯è°ï¼Ÿä¼˜å…ˆçº§é«˜å—ï¼Ÿæœ‰è¿è¥è®¡åˆ’å—ï¼Ÿæˆ‘è¿˜å¯ä»¥åšç‚¹ä»€ä¹ˆï¼Œè¿˜èƒ½å†ä¸€èµ·æ¨åŠ¨ä¸€ä¸‹åˆä½œæ–¹å—ï¼Ÿã€ã€Œäº§å“ï¼šğŸ˜±ã€</li>
<li>é¡¹ç›®å¾ˆé‡è¦ï¼Œæ’æœŸå®åœ¨å¤ªç´§ï¼Œä¸è¿½æ±‚å®Œç¾ï¼Œä»¥å¯è¡Œçš„æœ€å°æ–¹æ¡ˆä¿éšœé¡¹ç›®ä¸Šçº¿ï¼Œå¹¶æŠŠæƒè¡¡è€ƒè™‘å› ç´ ã€å½±å“åŒæ­¥åˆ°ç›¸å…³åŒå­¦</li>
<li>éœ€æ±‚ä¸Šçº¿åï¼Œç§¯æä¸»åŠ¨å…³æ³¨ä¸Šçº¿æ•ˆæœï¼›æ ¸å¿ƒé¡¹ç›®ï¼Œé•¿æœŸå…³æ³¨æ•°æ®æ³¢åŠ¨ã€ä¸€çº¿åé¦ˆ<br>åå¯¹</li>
<li>ã€ŒAï¼šæˆ‘çœŸå‰å®³å‘€ï¼Œè¿™ä¸ªåŒæœˆä¸Šçº¿äº† 30 ä¸ªæ¥å£ã€ã€Œç”¨æˆ·ï¼šè¿™äº›æ¥å£æœ‰å•¥ç”¨ï¼Ÿä¸€ç‚¹ä»·å€¼æ²¡æœ‰ï½ã€</li>
<li>ã€ŒAï¼šè¿™ä¸ªé¡¹ç›®å„æ–¹èµ„æºæŠ•å…¥ OK å—ï¼Ÿæ¨è¿›æœ‰ä»€ä¹ˆå›°éš¾å—ï¼Ÿã€ã€ŒBï¼šæˆ‘è¿™é‡Œæ²¡é—®é¢˜ï¼Œè¿è¥ã€æµ‹è¯•å°±è¦é—® xxx äº†ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ã€‚è¿™ä¸ªæˆ‘è§‰å¾—åº”è¯¥æ˜¯äº§å“çš„é—®é¢˜å§ã€</li>
<li>å»¶æœŸäº†ä¹Ÿæ²¡äº‹ï¼Œå°±è¯´æœ‰ä¸´æ—¶æœ‰äº‹å ç”¨äº†æ—¶é—´ï½</li>
<li>æˆ‘å°±è¦è¿½æ±‚å®Œç¾ï¼Œå°±ç®—é¡¹ç›®å»¶æœŸæˆ‘ä¹Ÿè¦æŠ æ¯ä¸€ä¸ªç»†èŠ‚ç‚¹ï¼Œå»¶æœŸä¸€ä¸ªæœˆåï¼Œé¡¹ç›®ç»ˆäºä¸Šçº¿äº†ï¼šå¤§å®¶å¿«æ¥çœ‹ï¼Œæˆ‘çš„é¡¹ç›®éƒ½æ˜¯ç²¾å“</li>
<li>æˆ‘æ‰€æœ‰çš„å·¥ä½œåœ¨ä»£ç ä¸Šçº¿çš„é‚£ä¸€åˆ»å°±ç»“æŸäº†ï¼Œåé¢å°±ä¸å…³æˆ‘çš„äº‹äº†</li>
</ul>
<p>æˆä¸ºè§£å†³é—®é¢˜çš„é«˜æ‰‹</p>
<ul>
<li>å»è§£å†³é—®é¢˜ï¼Œä¸»åŠ¨å»è§£å†³ï¼Œè€Œä¸æ˜¯ç­‰ç€å›¢é˜Ÿåˆ†é…ï¼Œä¸æŒ‘å®¹æ˜“çš„ã€å–œæ¬¢çš„äº‹</li>
<li>æŠ€æœ¯æ˜¯ä¸ºäº†è§£å†³é—®é¢˜ï¼Œä¸ä¸ºäº†æŠ€æœ¯è€ŒæŠ€æœ¯ï¼Œä¸ä¸ºäº†æŠ€æœ¯è€Œé€ è½®å­ï¼Œé¿å…è‡ªå—¨</li>
<li>å»æˆä¸º ownerï¼Œä¸ä»…ä»…æ˜¯ coder - æ¯ä¸ªè§’è‰²è¦ã€Œè¾¹ç•Œæ¸…æ™°ã€ï¼ˆPM å‡ºåˆç†éœ€æ±‚ï¼ŒRDã€FE é«˜è´¨é‡ä»£ç ï¼ŒQA è´¨é‡ä¿éšœï¼‰ï¼Œæ›´è¦ã€Œä¸è®¾è¾¹ç•Œã€ï¼Œä¸è¦è¯´ã€Œæˆ‘è§‰å¾—è¿™æ˜¯ xx è¯¥åšçš„ã€ï¼Œå¯èƒ½ç¡®å®æ˜¯ä»–è¯¥åšçš„ï¼ŒButï¼Œæˆ‘ä»¬æ˜¯ one teamï¼Œä»–æ²¡æœ‰ actionï¼Œå¯ä»¥æé†’ä»–ï¼Œå¯ä»¥è·Ÿä»–ä¸€èµ·æ¨è¿›ï¼Œæˆ‘ä»¬çš„ä»·å€¼åº”è¯¥ä¸ä»…ä»…æ˜¯ä¸€ä¸ªæ‰§è¡Œè€… - Owner æ„Ÿä¸æ˜¯è¯´æˆ‘å°±æ˜¯æŠŠä»£ç å†™å¥½äº†ï¼ˆæˆ‘çš„æç«¯çœ‹æ³•ï¼šæŠŠä»£ç å†™å¥½æ˜¯æœ¬è´¨å·¥ä½œï¼Œå¹¶ä¸æ˜¯ owner æ„Ÿçš„ä½“ç°ï¼Œowner æ„Ÿä½“ç°åœ¨ä»£ç ä¹‹å¤–çš„äº‹ä¸Šï¼‰<br>æå€¡</li>
<li>ã€ŒAï¼šç³»ç»Ÿä¸­æœ‰è¿™ä¹ˆä¸€ä¸ª bugï¼Œæˆ‘ä»¬ä¸€èµ·æ¥é…åˆä¼˜åŒ–ä¸‹ã€ã€ŒBï¼šæˆ‘æ¥ä¸€èµ·ï¼Œå¯¹è¿™ä¸ªæ¯”è¾ƒæœ‰å…´è¶£ã€</li>
<li>ä¸»åŠ¨æ‰¿æ‹…èµ·é¡¹ç›®çš„ owner è§’è‰²ï¼Œæå‰åè°ƒå„æ–¹èµ„æºï¼ŒåŒæ­¥é£é™©ï¼Œæ›´å¤§èŒƒå›´å»å¯»æ‰¾ä¿è¯é¡¹ç›®å¯ä»¥å¦‚æœŸäº¤ä»˜çš„åŠæ³•</li>
<li>åœ¨åšä¸€ä¸ªé¡¹ç›®å‰ï¼Œå……åˆ†è°ƒç ”å…¬å¸å†…éƒ¨ã€å¼€æºæ–¹æ¡ˆï¼Œæƒ³æ¸…æ¥šè¦è§£å†³çš„ä¸šåŠ¡é—®é¢˜</li>
<li>ä½ çš„æ–¹å‘æœ‰è¿™ä¸ªé—®é¢˜ï¼Œæ˜¯ä¸æ˜¯éš”å£æ–¹å‘ä¹Ÿå¯èƒ½ä¼šæœ‰ ï¼Ÿå‘èµ·æ¨ªå‘é¡¹ç›®ä¸“é¡¹ï¼Œä¸€èµ·ç³»ç»ŸåŒ–è§£å†³<br>åå¯¹</li>
<li>ã€ŒBï¼šæˆ‘ä¸æƒ³ç¢° A å†™çš„ä»£ç ï¼Œä¸€å¨å±ã€‚ã€ï¼Œä¸€å¹´åï¼Œã€ŒCï¼šæˆ‘ä¸æƒ³ç¢° B å†™çš„ä»£ç ï¼Œä¸€å¨å±ã€‚ã€</li>
<li>ã€ŒAï¼šç³»ç»Ÿä¸­æœ‰è¿™ä¹ˆä¸€ä¸ª bugï¼Œæˆ‘ä»¬ä¸€èµ·æ¥é…åˆä¼˜åŒ–ä¸‹ã€ã€ŒBï¼šå—¨ï¼ŒCï¼Œä¸è¦è·Ÿ A ä¸€èµ·å»åˆä½œï¼Œè¿™ä¸ª bug å…³æˆ‘ä»¬ä»€ä¹ˆäº‹ã€</li>
<li>é¡¹ç›®å»¶æœŸåˆä¸æ˜¯æˆ‘çš„é—®é¢˜ï¼Œæ˜¯ B delay äº†ï¼Œæ˜¯ C æ²¡æœ‰äººåŠ›å‘€</li>
<li>ã€ŒAï¼šåšè¿™ä¸ªé¡¹ç›®æ˜¯è¦è§£å†³ä»€ä¹ˆä¸šåŠ¡é—®é¢˜å•Šï¼Ÿã€ã€ŒB: ä¸çŸ¥é“å•Šï¼Œæˆ‘ç®¡å®ƒå‘¢ï¼Œæˆ‘å°±è§‰å¾—è¿™ä¸ªæŠ€æœ¯ç‰›é€¼ï¼Œå°±è¦åšã€</li>
<li>æ¨åŠ¨æ¨ªå‘é¡¹ç›®å¤ªéº»çƒ¦äº†ï¼Œç´¯æ­»ä¸ªäººï¼Œæˆ‘å°±ç®¡æˆ‘è‡ªå·±å°±å¥½äº†<br>å°æ•…äº‹åˆ†äº«</li>
<li>2 ä¸ªå°ä¼™å­è¢«æ´¾å»å®Œæˆä¸€ä¸ªä»»åŠ¡ï¼šå»é›†å¸‚é‡‡è´­åœŸè±†</li>
<li>è€æ¿é—®å°ä¼™å­ Aï¼šé›†å¸‚ä¸Šæœ‰åœŸè±†å—ï¼Ÿå°ä¼™å­è·‘å»é›†å¸‚çœ‹äº†ä»¥åå›æ¥è¯´ï¼šæœ‰</li>
<li>è€æ¿åˆé—®ï¼šæœ‰å¤šå°‘å®¶åœ¨å–ï¼Ÿ å°ä¼™å­èµ¶ç´§åˆè·‘å›å»çœ‹ï¼Œå›æ¥è¯´ï¼šæœ‰ 10 å®¶</li>
<li>è€æ¿åˆé—®ï¼šå¤šå°‘é’±ä¸€æ–¤ï¼Ÿå°ä¼™å­å¾ˆå§”å±ˆï¼Œä½ æ²¡æœ‰è¦æˆ‘é—®ä»·æ ¼å‘€ï¼Œåªå¥½å†è·‘å»é—®</li>
<li>å°ä¼™å­ Bï¼šçœ‹äº†å¸‚åœºä¸Šæœ‰å¤šå°‘åœŸè±†è´§æºã€ä»·æ ¼ã€å“è´¨ï¼Œå¸‚åœºéœ€æ±‚ï¼Œæ ¹æ®è¿™äº›æƒ…å†µæƒ³å¥½äº†å¦‚æœæ‰¹é‡é‡‡è´­ï¼Œå¦‚ä½•è·Ÿä¾›åº”å•†è°ˆä»·æ ¼ï¼Œå½¢æˆä¸€ä¸ªæ–¹æ¡ˆ</li>
<li>é¢„å®šé…’åº—ï¼ˆçº¯å±è™šæ„ï¼‰</li>
<li>å…¬å¸éœ€è¦é¢„å®šå½“å¤©æŸåœ°é…’åº—çš„ä¸€ä»¶æœå—æµ·æ™¯æˆ¿ï¼Œè¿™ä¸ªä»»åŠ¡æ´¾ç»™äº†åŒäº‹ A</li>
<li>åŒäº‹ A é©¬ä¸Šæ‰“ç”µè¯å»é…’åº—é¢„å®šï¼Œä½†æ˜¯å‘ç°è¿™ä¸ªé…’åº—å½“å¤©çš„æµ·æ™¯æˆ¿å·²ç»æ²¡æœ‰äº†ï¼ŒåŒäº‹ A å‘å…¬å¸æ±‡æŠ¥äº†è¯¥æƒ…å†µï¼Œå¹¶è¯¢é—®æ˜¯å¦å¯ä»¥æ¢ä¸€ä¸ªé…’åº—æˆ–è€…ä¸æ˜¯æµ·æ™¯æˆ¿æ˜¯å¦å¯ä»¥ï¼Œåœ¨å¾—åˆ°å¦å®šç­”æ¡ˆåï¼Œç»§ç»­è·Ÿè¿›</li>
<li>åŒäº‹ A å‘é…’åº—æ‰“å¬äº†æµ·æ™¯æˆ¿è¢«é¢„å®šçš„æƒ…å†µï¼Œå‘ç°æœ‰ä¸€é—´æµ·æ™¯æˆ¿æ˜¯è¢«ä¸€å¯¹å¹´è½»æƒ…ä¾£é¢„å®šäº†ï¼Œé©¬ä¸Šè·Ÿè¿™å¯¹æƒ…ä¾£è”ç³»ï¼Œæå‡ºä¸€ä¸ªæ–¹æ¡ˆï¼šè¿™é—´æµ·æ™¯æˆ¿çš„é’±ç”±åŒäº‹ A è¡¥è´´ç»™ä»–ä»¬ï¼ŒåŒæ—¶ç»™ä»–ä»¬å®šå¥½å¦å¤–ä¸€é—´éæµ·æ™¯æˆ¿ã€‚åœ¨æˆåŠŸé¢„å®šåˆ°æµ·æ™¯æˆ¿åï¼Œè·Ÿå…¬å¸æ±‡æŠ¥ï¼šæµ·æ™¯æˆ¿é¢„å®šå®Œæˆ</li>
</ul>
<p>æ·±æŒ–æœ¬è´¨ï¼Œç§¯æä¸»åŠ¨</p>
<ul>
<li>å¤šé—®å‡ ä¸ªã€Œä¸ºä»€ä¹ˆã€ï¼Œæ‰¾åˆ°æœ€æ ¹æœ¬çš„åŸå› </li>
<li>å¤šé—®å‡ ä¸ªã€Œç„¶åå‘¢ã€ï¼Œæ¨æ¼”æœ€æ·±è¿œçš„ä»·å€¼</li>
<li>ä¸»åŠ¨å‘ç°é—®é¢˜ï¼Œå½¢æˆè‡ªå·±çš„ç†è§£å’Œæ€è€ƒï¼Œæå‡ºæƒ³æ³•ï¼Œå¹¶æ¨åŠ¨è½åœ°<br>æå€¡<ul>
<li>ã€ŒA: æœåŠ¡æœ‰å‘¨æœŸæ€§æŠ¥è­¦ï¼Œå€¼ç­åŒå­¦çœ‹ä¸‹ã€ã€ŒBï¼šä¸éœ€è¦ç®¡ï¼Œæ¡†æ¶çš„æŠ¥é”™ï¼Œå®ƒè‡ªå·±ä¼šå¥½çš„ã€ã€ŒAï¼šä¸ºä»€ä¹ˆæ¡†æ¶ä¼šæŠ¥é”™å‘¢ï¼Ÿã€ã€ŒB: æœåŠ¡ç«¯å…³é—­é“¾æ¥äº†ã€ã€ŒAï¼šä¸ºä»€ä¹ˆæœåŠ¡ç«¯ä¼šå¶å‘å…³é—­é“¾æ¥ï¼Ÿã€</li>
<li>ã€Œäº§å“ï¼šè¿™ä¸ªéœ€æ±‚è¦åšä¸€ä¸‹ã€ã€Œç ”å‘ï¼šè¿™ä¸ªéœ€æ±‚è¦è§£å†³ç”¨æˆ·çš„ä»€ä¹ˆé—®é¢˜å•Šï¼Ÿç”¨æˆ·è¯‰æ±‚å¼ºå—ï¼Ÿéœ€æ±‚å¾ˆç´§æ€¥å—ï¼Ÿã€</li>
<li>é—®é¢˜å¢™ä¸Šçš„é—®é¢˜è¿˜æ²¡æœ‰äººå»è§£å†³ï¼Œä¸»åŠ¨è®¤é¢†ï¼Œé’»ç ”è§£å†³</li>
<li>å›¢é˜Ÿå®‰æ’çš„å·¥ä½œåšå®Œäº†ï¼Œä¸»åŠ¨å¯»æ‰¾æœ‰å“ªäº›ä¼˜åŒ–å·¥ä½œå¯ä»¥åšï¼Œè·Ÿå›¢é˜Ÿæ²Ÿé€šæœ‰å“ªäº›é—®é¢˜å¯ä»¥è‡ªå·±å»è§£å†³<br>åå¯¹</li>
<li>ã€ŒA: æœåŠ¡æœ‰å‘¨æœŸæ€§æŠ¥è­¦ï¼Œå€¼ç­åŒå­¦çœ‹ä¸‹ã€ã€ŒBï¼šä¸éœ€è¦ç®¡ï¼Œç¬é—´æ³¢åŠ¨ï¼Œå®ƒè‡ªå·±ä¼šå¥½çš„ï¼Œä¸éœ€è¦ç®¡ã€</li>
<li>æœ‰å•¥éœ€æ±‚å°±åšå•¥éœ€æ±‚ï¼Œç®¡å®ƒé‡è¦ä¸é‡è¦</li>
<li>åˆä¸æ˜¯æˆ‘çš„ bugï¼Œç®¡æˆ‘å±äº‹ï¼Œæˆ‘éœ€æ±‚åšå®Œäº†è¦ä¸‹ç­çš„å‘€</li>
<li>æ’æœŸå¤šæ’ä¸€ç‚¹çœŸæ˜¯å¥½ï½</li>
</ul>
</li>
</ul>
<p>å¼€æ”¾åˆä½œï¼ŒæŒç»­ç²¾è¿›</p>
<ul>
<li>å¤šä¸€äº›å–„æ„å‡è®¾ï¼Œå°‘ä¸€äº›æ¶æ„æ£æµ‹</li>
<li>ä¹è§‚çš®å®ï¼Œå­¦ä¹ æ€»ç»“<ul>
<li>ä¹è§‚ï¼šå¯ä»¥æ‹“å±•ä¸º åšéŸ§çš„ä¹è§‚ï¼Œä¸ä¼šå› ä¸ºé‡åˆ°ä¸€ç‚¹å›°éš¾ã€ä¸€ç‚¹æŒ«æŠ˜å°±ä¸€è¹¶ä¸æŒ¯äº†ã€‚<ul>
<li>ä¸ºä»€ä¹ˆæˆ‘ä¼šé‡åˆ°è¿™ç§äº‹ ï¼Ÿ â¡ï¸ è¿™ä»¶äº‹æ•™ä¼šäº†æˆ‘ä»€ä¹ˆ ï¼Ÿ</li>
</ul>
</li>
<li>çš®å®ï¼šä¸è¦ç»ç’ƒå¿ƒï¼Œè¯´ä¸å¾—ï¼Œä¸èƒ½æ¥å—ä»»ä½•å»ºè®®ï¼Œåªå¸Œæœ›å¬å¤¸èµã€‚ - æˆ‘ä»¬çš„å·¥ä½œä¸å¯èƒ½æ¯ä»¶äº‹éƒ½åšçš„å¾ˆæˆåŠŸå¾ˆåˆ°ä½ï¼Œä¸è¦æƒ³ç€æˆ‘ä¹‹å‰çš„äº‹éƒ½åšå¥½äº†ï¼Œå°±è¿™ä»¶æ²¡åšå¥½ï¼Œä¸ºä»€ä¹ˆè¦è¯´æˆ‘ï¼Ÿ - å¦‚æœéƒ½ä¸å€¼å¾—è¢«è¯´äº†ï¼Œé‚£æ˜¯ä¸æ˜¯æœŸæœ›ä¹Ÿä¸å¤§äº†ï½ æœ€æ·±çš„ä¸çˆ±ï¼Œä¸æ˜¯äº‰åµï¼Œè€Œæ˜¯æ‡’å¾—åµ<br>å­¦ä¹ ï¼šå­¦ä¹ æ˜¯è‡ªå·±çš„äº‹ï¼Œå›¢é˜Ÿåªèƒ½ç»™å¼•å¯¼<br>æ€»ç»“ï¼šå¯¹æŸä¸ªéœ€æ±‚è´¨é‡çš„æ€»ç»“ã€å¯¹æŸæ¬¡å†³ç­–çš„æ€»ç»“ã€å¯¹è¿‡å»ä¸€æ®µæ—¶é—´è‡ªå·±è¡¨ç°çš„æ€»ç»“ã€‚å¹¶è®°å½•ä¸‹æ¥ï½<br>æå€¡</li>
<li>æœ‰è¯¯ä¼šï¼Œå¦è¯šæ¸…æ™°çš„æ²Ÿé€šï¼Œå¯»æ±‚åˆä½œå’Œå…±åŒåˆ©ç›Š</li>
<li>æ–°åŒäº‹æ¥äº†ä¸»åŠ¨æ‰“æ‹›å‘¼ï¼Œä¸€èµ·åƒé¥­ï¼Œæœ‰å›°éš¾ä¸»åŠ¨å¸®åŠ©</li>
<li>å–„äºæ€è€ƒã€æ€»ç»“ã€æ²‰æ·€ï¼Œç§¯æè‡ªçœï¼Œå¹¶è½¬åŒ–ä¸ºä¸‹ä¸€æ­¥çš„æå‡è®¡åˆ’</li>
<li>ä¼šå¯¹å¤–è¾“å‡ºæœ€ä½³å®è·µå’ŒæŠ€æœ¯ç§¯ç´¯ï¼Œèµ‹èƒ½å›¢é˜Ÿçš„åŒæ—¶ï¼Œä¹Ÿæå‡å½±å“åŠ›<br>åå¯¹</li>
<li>ã€ŒA è¿™ä¸ªäººä¸è¡Œï¼ŒB å•¥ä¹Ÿä¸æ‡‚ï¼Œæˆ‘ä¸æƒ³è·Ÿä»–ä»¬åˆä½œã€</li>
<li>ã€Œä»–åœ¨ç¾¤é‡Œè¿™ä¹ˆè¯´ï¼Œä¸å°±æ˜¯åœ¨é’ˆå¯¹æˆ‘å˜›ã€</li>
<li>ä»–æ˜¯ A çš„å®ä¹ ç”Ÿï¼Œå…³æˆ‘ä»€ä¹ˆäº‹</li>
<li>ç»ç’ƒå¿ƒï¼Œæ¥å—ä¸äº†å›¢é˜Ÿ/åŒäº‹çš„å»ºè®®</li>
<li>åªåŸ‹å¤´åšéœ€æ±‚ï¼Œä¸æ€»ç»“ã€ä¸æ²‰æ·€ã€ä¸è¾“å‡ºã€ä¸æå‡</li>
<li>ã€Œæˆ‘åšçš„æ¢ç´¢ï¼Œä¸ºä»€ä¹ˆè¦å‘Šè¯‰åˆ«äººï¼Œä»–è¦ç”¨ï¼Œè‡ªå·±ç ”ç©¶å»ã€</li>
</ul>
</li>
</ul>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>æ‚ä¹±</tag>
      </tags>
  </entry>
  <entry>
    <title>é¦–å±Šhackathonçš„ä¸€äº›æ„Ÿæƒ³</title>
    <url>/hackathon/</url>
    <content><![CDATA[<div class=".article-gallery"><p>å¾ˆå¼€å¿ƒæˆ‘ä»¬å›¢é˜Ÿèƒ½è·å¾—ã€Šæœ€ä½³ç”¨æˆ·ä½“éªŒå¥–ã€‹ã€‚ä»é›¶å¼€å§‹ï¼Œå…¨æ–°çš„å›¢é˜Ÿï¼Œ30ä¸ªå°æ—¶å‡ºdemoã€‚</p>
<p><a href="https://imgtu.com/i/hBrcBd"><a href="https://z3.ax1x.com/2021/09/01/hBrcBd.jpg" title="hBrcBd.jpg" class="gallery-item" style="box-shadow: none;"> <img src="https://z3.ax1x.com/2021/09/01/hBrcBd.jpg" alt="hBrcBd.jpg"></a></a></p>
<p>åç»­çš„ä¸€äº›æƒ³æ³•ï¼Œæœ¬èº«å¦‚æœå±€é™äºæ—…è¡Œæ–¹é¢å¯èƒ½ç”¨æˆ·ç¾¤é‡Œå’Œå†…å®¹ç”Ÿæˆæœ‰å¾ˆå¤§çš„å±€é™æ€§ã€‚</p>
<p>ä½†æ˜¯ä¸€äº›é«˜åº¦å®šåˆ¶çš„è¡Œä¸šï¼Œå¦‚æ•™è‚²ï¼ŒåŒ…æ‹¬ä¸€äº›ç‰¹æ®Šäº§ä¸šï¼Œè¿˜æ˜¯å¾ˆæœ‰å¸‚åœºçš„ï¼Œæ™šä¸Šå›¢é˜Ÿèšé¤çš„æ—¶å€™ä¸€èµ·è®¨è®ºä¸‹ã€‚</p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>æ‚ä¹±</tag>
      </tags>
  </entry>
  <entry>
    <title>JAVA HTTPSæœåŠ¡</title>
    <url>/https/</url>
    <content><![CDATA[<div class=".article-gallery"><h2 id="åˆ†è‡ªç­¾è¯ä¹¦å’ŒCAè¯ä¹¦ä¸¤ç§æ–¹å¼ã€‚"><a href="#åˆ†è‡ªç­¾è¯ä¹¦å’ŒCAè¯ä¹¦ä¸¤ç§æ–¹å¼ã€‚" class="headerlink" title="åˆ†è‡ªç­¾è¯ä¹¦å’ŒCAè¯ä¹¦ä¸¤ç§æ–¹å¼ã€‚"></a>åˆ†è‡ªç­¾è¯ä¹¦å’ŒCAè¯ä¹¦ä¸¤ç§æ–¹å¼ã€‚</h2><h1 id="ä¸€ã€åˆ¶ä½œä¸€å¼ è‡ªç­¾è¯ä¹¦ï¼ˆjksæ ¼å¼ï¼‰"><a href="#ä¸€ã€åˆ¶ä½œä¸€å¼ è‡ªç­¾è¯ä¹¦ï¼ˆjksæ ¼å¼ï¼‰" class="headerlink" title="ä¸€ã€åˆ¶ä½œä¸€å¼ è‡ªç­¾è¯ä¹¦ï¼ˆjksæ ¼å¼ï¼‰"></a>ä¸€ã€åˆ¶ä½œä¸€å¼ è‡ªç­¾è¯ä¹¦ï¼ˆjksæ ¼å¼ï¼‰</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#keytool -genkey -keysize 2048 -validity 3650 -keyalg RSA -dname &quot;CN=myyiba.com&quot; -keypass 123456 -storepass 123456 -keystore myyiba.jks</span><br></pre></td></tr></table></figure>

<p>keytoolä¸ºJDKæä¾›çš„ç”Ÿæˆè¯ä¹¦å·¥å…·</p>
<ul>
<li>-keysize 2048 å¯†é’¥é•¿åº¦2048ä½ï¼ˆè¿™ä¸ªé•¿åº¦çš„å¯†é’¥ç›®å‰å¯è®¤ä¸ºæ— æ³•è¢«æš´åŠ›ç ´è§£ï¼‰</li>
<li>-validity 3650 è¯ä¹¦æœ‰æ•ˆæœŸ3650å¤©</li>
<li>-keyalg RSA ä½¿ç”¨RSAéå¯¹ç§°åŠ å¯†ç®—æ³•</li>
<li>-dname â€œCN=myyiba.comâ€ è®¾ç½®Common Nameä¸ºmyyiba.comï¼Œè¿™æ˜¯æˆ‘çš„åŸŸå</li>
<li>-keypass 123456 å¯†é’¥çš„è®¿é—®å¯†ç ä¸º123456</li>
<li>-storepass 123456 å¯†é’¥åº“çš„è®¿é—®å¯†ç ä¸º123456ï¼ˆå…¶å®è¿™ä¸¤ä¸ªå¯†ç ä¹Ÿå¯ä»¥è®¾ç½®ä¸€æ ·ï¼Œé€šå¸¸éƒ½è®¾ç½®ä¸€æ ·ï¼Œæ–¹ä¾¿è®°ï¼‰</li>
<li>-keystore myyiba.jks æŒ‡å®šç”Ÿæˆçš„å¯†é’¥åº“æ–‡ä»¶ä¸º myyiba .jks</li>
</ul>
<p>å®Œäº†ä¹‹åå°±æ‹¿åˆ°äº†myyiba.jksè¿™ä¸ªå¯†é’¥åº“æ–‡ä»¶äº†ï¼ŒæŠŠå®ƒæ”¾åˆ°è‡ªå·±çš„é¡¹ç›®ç›®å½•ä¸‹ï¼Œæ¯”å¦‚ï¼š/usr/local/server/project/resource/myyiba.jks</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">é¡¹ç›®ç¤ºä¾‹ï¼šgithubä¸‹HttpServerInitializer</span><br></pre></td></tr></table></figure>

<span id="more"></span>

<h1 id="åœ¨ç¨‹åºåˆå§‹åŒ–çš„æ—¶å€™ç”ŸæˆSSLContext"><a href="#åœ¨ç¨‹åºåˆå§‹åŒ–çš„æ—¶å€™ç”ŸæˆSSLContext" class="headerlink" title="åœ¨ç¨‹åºåˆå§‹åŒ–çš„æ—¶å€™ç”ŸæˆSSLContext"></a>åœ¨ç¨‹åºåˆå§‹åŒ–çš„æ—¶å€™ç”ŸæˆSSLContext</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">keyStore ks = KeyStore.getInstance(&quot;JKS&quot;);</span><br><span class="line">InputStream ksInputStream = new FileInputStream(&quot;/usr/local/server/project/resource/myyiba.jks&quot;);</span><br><span class="line">ks.load(ksInputStream, &quot;123456&quot;.toCharArray());</span><br><span class="line">keyManagerFactory kmf = KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());</span><br><span class="line">kmf.init(ks, &quot;123456&quot;.toCharArray());</span><br><span class="line">SSLContext sslContext = SSLContext.getInstance(&quot;TLS&quot;);</span><br><span class="line">sslContext.init(kmf.getKeyManagers(), null, null);</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªè¿‡ç¨‹åœ¨æ•´ä¸ªç¨‹åºå‘¨æœŸåªéœ€è¦åšä¸€æ¬¡ï¼Œæœ€å¥½try-catchä¸€ä¸‹ï¼Œä»¥ä¾¿æ£€æŸ¥å¼‚å¸¸ï¼Œå¥½äº†ä¹‹åä¿å­˜å¥½sslContextï¼Œåé¢ç”¨åˆ°ã€‚</p>
<h1 id="åœ¨ChannelInitializerçš„initChannelä¸­"><a href="#åœ¨ChannelInitializerçš„initChannelä¸­" class="headerlink" title="åœ¨ChannelInitializerçš„initChannelä¸­"></a>åœ¨ChannelInitializerçš„initChannelä¸­</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@Override</span><br><span class="line">protected void initChannel(SocketChannel socketChannel) throws Exception &#123;</span><br><span class="line">SSLEngine sslEngine = sslContext.createSSLEngine();</span><br><span class="line">sslEngine.setUseClientMode(false); //æœåŠ¡å™¨ç«¯æ¨¡å¼</span><br><span class="line">sslEngine.setNeedClientAuth(false); //ä¸éœ€è¦éªŒè¯å®¢æˆ·ç«¯</span><br><span class="line">socketChannel.pipeline().addLast(&quot;ssl&quot;, new SslHandler(sslEngine)); //æå®š</span><br><span class="line">//...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="äºŒã€CAè¯ä¹¦"><a href="#äºŒã€CAè¯ä¹¦" class="headerlink" title="äºŒã€CAè¯ä¹¦"></a>äºŒã€CAè¯ä¹¦</h1><p>ä¾‹å¦‚å¾®ä¿¡å°ç¨‹åºçš„æœåŠ¡å™¨ï¼Œéœ€è¦CAè¯ä¹¦çš„HTTPSæœåŠ¡ï¼Œé˜¿é‡Œäº‘æä¾›å…è´¹çš„SSLè¯ä¹¦ï¼Œç”³è¯·è¯ä¹¦åï¼Œä¸‹è½½tomcatç‰ˆã€‚è§£å‹æœ‰åä¸¤ä¸ªæ–‡ä»¶ï¼šxxx.pfxå’Œpfx-password.txtã€‚</p>
<p><a href="https://imgtu.com/i/hBsD5q"><a href="https://z3.ax1x.com/2021/09/01/hBsD5q.md.png" title="hBsD5q.md.png" class="gallery-item" style="box-shadow: none;"> <img src="https://z3.ax1x.com/2021/09/01/hBsD5q.md.png" alt="hBsD5q.md.png"></a></a></p>
<p>pfxæ–‡ä»¶ç±»ä¼¼ä¸Šé¢çš„è‡ªç­¾è¯ä¹¦xxx.jksæ–‡ä»¶ã€‚åŠ è½½è¯ä¹¦çš„å¯†ç åœ¨<br>pfx-password.txtæ–‡ä»¶ä¸­ã€‚</p>
<p>åŒä¸Šé¢è‡ªç­¾è¯ä¹¦ä¸€æ ·çš„æ–¹å¼åŠ è½½CAè¯ä¹¦SSLã€‚é¡¹ç›®åœ°å€è§åŒä¸€ä¸ªGitHubé¡¹ç›®ã€‚</p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>JAVA</tag>
      </tags>
  </entry>
  <entry>
    <title>WordPressè¿ç§»Hexo</title>
    <url>/hello/</url>
    <content><![CDATA[<div class=".article-gallery"><h1 id="æ¬æ–°å®¶äº†ï¼"><a href="#æ¬æ–°å®¶äº†ï¼" class="headerlink" title="æ¬æ–°å®¶äº†ï¼"></a>æ¬<a href="http://kwaibook.com/">æ–°å®¶</a>äº†ï¼</h1><p>åœ¨ç”¨äº†ä¸‰å¹´å¤š WordPress åè¿˜æ˜¯å†³å®šå°è¯•ä¸‹ä½¿ç”¨ä¸€äº›è½»é‡çš„æ¡†æ¶æ¥æ­å»ºç«™ç‚¹ï¼Œæ¯”å¦‚ Hexoã€‚<br>æ”¾å¼ƒ WordPress ä¸»è¦å‡ºäºä»¥ä¸‹å‡ ä¸ªæ–¹é¢çš„è€ƒè™‘å§ï¼š</p>
<ol>
<li>æˆæœ¬ï¼šéœ€è¦å•ç‹¬çš„æœåŠ¡å™¨éƒ¨ç½²ã€‚</li>
<li>æ•ˆç‡ï¼šåŠŸèƒ½å¤§è€Œå…¨ï¼Œä¾¿åˆ©æ€§æ–¹é¢è¿˜æ˜¯å¾ˆå¥½çš„ï¼Œä½†æ˜¯æ•æ·æ€§æ–¹é¢å°±ç¨æ˜¾æ¬ ç¼ºäº†ï¼Œè€Œ Hexo æ”¯æŒ MD è¯­æ³•ï¼Œå¤§å¤§æ¿€æ´»åˆ›ä½œæ•ˆç‡ã€‚</li>
<li>æ€§èƒ½ï¼šç½‘é¡µåŠ è½½å›¾ç‰‡çš„é€Ÿåº¦è¾ƒæ…¢ã€‚</li>
<li>ç¾è§‚ï¼šç®€æ´æ‰æ˜¯ç‹é“</li>
<li>æ€é¸¡ç”¨ç‰›åˆ€ï¼šåœ¨ä¸ªäººç«™ç‚¹æ–¹é¢ï¼Œé™æ€çš„ Hexo å®Œå…¨å¤Ÿäº†ã€‚</li>
</ol>
<span id="more"></span>

<p>ç«™ç‚¹æ­å»ºå®Œäº†ï¼Œç°åœ¨çš„æ–¹æ¡ˆæ˜¯ï¼Œæœ¬åœ°ç¼–å†™ MD æ–‡ä»¶ï¼Œæäº¤ Githubï¼ŒTravis è‡ªåŠ¨å‘å¸ƒã€‚<br>çš®è‚¤ï¼š<a href="http://theme-next.iissnan.com/getting-started.html">next</a></p>
<p>çš®è‚¤: <a href="https://github.com/HiNinoJay/hexo-theme-A4">hexo-theme-A4</a></p>
<p>çš®è‚¤ï¼š<a href="https://butterfly.js.org/posts/ceeb73f/">butterfly</a></p>
<p>åŸŸåï¼š</p>
<ul>
<li>github.io åœ¨ DNS ä¸­æ·»åŠ è§£æï¼Œè§<a href="https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site/managing-a-custom-domain-for-your-github-pages-site">https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site/managing-a-custom-domain-for-your-github-pages-site</a></li>
</ul>
<p>åç»­éœ€è¦çš„æ’ä»¶é™†ç»­æ·»åŠ å§ã€‚<br>ä¸»è¦å‚è€ƒçš„æ–‡ç« ï¼š</p>
<ul>
<li><a href="https://segmentfault.com/a/1190000021987832">Travis CI</a></li>
<li><del><a href="https://kchen.cc/2016/11/12/hexo-instructions/">Hexo éƒ¨ç½²</a></del> (å·²ç»ä¸å…è´¹)</li>
<li><a href="https://hexo.io/docs/github-pages">GithubActions CI</a></li>
</ul>
<h1 id="å¸¸ç”¨ç¬”è®°"><a href="#å¸¸ç”¨ç¬”è®°" class="headerlink" title="å¸¸ç”¨ç¬”è®°"></a>å¸¸ç”¨ç¬”è®°</h1><ol>
<li>æ–°å»ºåšæ–‡ï¼šhexo new post $title</li>
<li>æ–°å»ºè‰ç¨¿ï¼šhexo new draft $title</li>
<li>æ–‡ç« ç›®å½•ï¼šsource_posts</li>
<li>å›¾ç‰‡ç›®å½•ï¼šsource\images</li>
<li><a href="https://typora.io/">https://typora.io/</a> markdown å·¥å…·</li>
<li><a href="https://markdown.com.cn/basic-syntax/links.html">Markdown è¯­æ³•</a></li>
<li><a href="http://blog.smallerpig.com/set-hexo-show-more-button-on-indexpage.html">å‚è€ƒé“¾æ¥</a></li>
<li><a href="https://tohugo.com/2021/01/26/%E5%B7%A5%E5%85%B7%E9%85%8D%E7%BD%AE/Hexo%E6%B7%BB%E5%8A%A0%E5%88%86%E7%B1%BB%E5%8F%8A%E6%A0%87%E7%AD%BE%EF%BC%88%E5%9C%A8Next%E4%B8%BB%E9%A2%98%E4%B8%8B%EF%BC%89/">å‚è€ƒé“¾æ¥</a></li>
<li><a href="https://huyongfei.com/posts/2324b80c.html">met çš®è‚¤</a></li>
</ol>
<h1 id="hexo-åšå®¢æ’å…¥å›¾ç‰‡ä¸è§†é¢‘æ–¹æ³•"><a href="#hexo-åšå®¢æ’å…¥å›¾ç‰‡ä¸è§†é¢‘æ–¹æ³•" class="headerlink" title="hexo åšå®¢æ’å…¥å›¾ç‰‡ä¸è§†é¢‘æ–¹æ³•"></a>hexo åšå®¢æ’å…¥å›¾ç‰‡ä¸è§†é¢‘æ–¹æ³•</h1><h3 id="å›¾ç‰‡æ’å…¥"><a href="#å›¾ç‰‡æ’å…¥" class="headerlink" title="å›¾ç‰‡æ’å…¥"></a>å›¾ç‰‡æ’å…¥</h3><p>Hexo æœ‰å¤šç§å›¾ç‰‡æ’å…¥æ–¹å¼ï¼Œå¯ä»¥å°†å›¾ç‰‡å­˜æ”¾åœ¨æœ¬åœ°å¼•ç”¨æˆ–è€…å°†å›¾ç‰‡æ”¾åœ¨ CDN ä¸Šå¼•ç”¨ã€‚</p>
<h3 id="æœ¬åœ°å¼•ç”¨â€“ç»å¯¹è·¯å¾„"><a href="#æœ¬åœ°å¼•ç”¨â€“ç»å¯¹è·¯å¾„" class="headerlink" title="æœ¬åœ°å¼•ç”¨â€“ç»å¯¹è·¯å¾„"></a>æœ¬åœ°å¼•ç”¨â€“ç»å¯¹è·¯å¾„</h3><p>å½“ Hexo é¡¹ç›®ä¸­åªç”¨åˆ°å°‘é‡å›¾ç‰‡æ—¶ï¼Œå¯ä»¥å°†å›¾ç‰‡ç»Ÿä¸€æ”¾åœ¨ source/images æ–‡ä»¶å¤¹ä¸­ï¼Œé€šè¿‡ markdown è¯­æ³•è®¿é—®å®ƒä»¬ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">source/images/image.jpg</span><br><span class="line"></span><br><span class="line">![(å¯ä»¥å†™å…³äºå›¾ç‰‡çš„æè¿°)](/images/image.jpg)</span><br></pre></td></tr></table></figure>

<p>å›¾ç‰‡æ—¢å¯ä»¥åœ¨é¦–é¡µå†…å®¹ä¸­è®¿é—®åˆ°ï¼Œä¹Ÿå¯ä»¥åœ¨æ–‡ç« æ­£æ–‡ä¸­è®¿é—®åˆ°ã€‚</p>
<h3 id="æœ¬åœ°å¼•ç”¨â€“ç›¸å¯¹è·¯å¾„"><a href="#æœ¬åœ°å¼•ç”¨â€“ç›¸å¯¹è·¯å¾„" class="headerlink" title="æœ¬åœ°å¼•ç”¨â€“ç›¸å¯¹è·¯å¾„"></a>æœ¬åœ°å¼•ç”¨â€“ç›¸å¯¹è·¯å¾„</h3><p>å›¾ç‰‡é™¤äº†å¯ä»¥æ”¾åœ¨ç»Ÿä¸€çš„ images æ–‡ä»¶å¤¹ä¸­ï¼Œè¿˜å¯ä»¥æ”¾åœ¨æ–‡ç« è‡ªå·±çš„ç›®å½•ä¸­ã€‚æ–‡ç« çš„ç›®å½•å¯ä»¥é€šè¿‡é…ç½®_config.yml æ¥ç”Ÿæˆã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">_config.yml</span><br><span class="line"></span><br><span class="line">post_asset_folder: true</span><br></pre></td></tr></table></figure>

<p>å°†_config.yml æ–‡ä»¶ä¸­çš„é…ç½®é¡¹ post_asset_folder è®¾ä¸º true åï¼Œæ‰§è¡Œå‘½ä»¤$ hexo new post_nameï¼Œåœ¨ source/_posts ä¸­ä¼šç”Ÿæˆ<br>æ–‡ç«  post_name.md å’ŒåŒåæ–‡ä»¶å¤¹ post_nameã€‚å°†å›¾ç‰‡èµ„æºæ”¾åœ¨ post_name ä¸­ï¼Œæ–‡ç« å°±å¯ä»¥ä½¿ç”¨ç›¸å¯¹è·¯å¾„å¼•ç”¨å›¾ç‰‡èµ„æºäº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">_posts/post_name/image.jpg</span><br><span class="line"></span><br><span class="line">![](image.jpg)</span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°æ˜¯ markdown çš„å¼•ç”¨æ–¹å¼ï¼Œå›¾ç‰‡åªèƒ½åœ¨æ–‡ç« ä¸­æ˜¾ç¤ºï¼Œä½†æ— æ³•åœ¨é¦–é¡µä¸­æ­£å¸¸æ˜¾ç¤ºã€‚<br>å¦‚æœå¸Œæœ›å›¾ç‰‡åœ¨æ–‡ç« å’Œé¦–é¡µä¸­åŒæ—¶æ˜¾ç¤ºï¼Œå¯ä»¥ä½¿ç”¨æ ‡ç­¾æ’ä»¶è¯­æ³•ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">_posts/post_name/image.jpg</span><br><span class="line"></span><br><span class="line">&#123;% asset_img image.jpg This is an image %&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å›¾åºŠ"><a href="#å›¾åºŠ" class="headerlink" title="å›¾åºŠ"></a>å›¾åºŠ</h3><p><a href="https://picx.xpoet.cn/#/?jump=0">PicXåœ¨çº¿</a><br>Upic(Mac)<br>PicGo(Windows)</p>
<h3 id="è§†é¢‘æ’å…¥"><a href="#è§†é¢‘æ’å…¥" class="headerlink" title="è§†é¢‘æ’å…¥"></a>è§†é¢‘æ’å…¥</h3><p>æ’å…¥è§†é¢‘ä¸å›¾ç‰‡ä¸åŒï¼Œè¿™é‡Œä»¥ b ç«™çš„è§†é¢‘ä¸ºä¾‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;iframe src=&quot;ï¼ˆè§†é¢‘ç½‘å€ï¼‰&quot; scrolling=&quot;no&quot; border=&quot;0&quot; frameborder=&quot;no&quot; framespacing=&quot;0&quot; allowfullscreen=&quot;true&quot; width=&quot;100%&quot;  height=&quot;580&quot; quality=&quot;high&quot; &gt; &lt;/iframe&gt;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·ç›´æ¥æ’å…¥çš„ä»£ç æ‰‹æœºç«¯ä¸èƒ½è‡ªé€‚åº”ï¼Œæ•ˆæœä¸å®Œç¾ã€‚<br><strong>æœ€å¥½è¿™æ ·</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div style=&quot;position: relative; width: 100%; height: 0; padding-bottom: 75%;&quot;&gt;&lt;iframe</span><br><span class="line">src=&quot;//player.bilibili.com/player.html?aid=39807850&amp;cid=69927212&amp;page=1&quot; scrolling=&quot;no&quot; border=&quot;0&quot;</span><br><span class="line">frameborder=&quot;no&quot; framespacing=&quot;0&quot; allowfullscreen=&quot;true&quot; style=&quot;position: absolute; width: 100%;</span><br><span class="line">height: 100%; left: 0; top: 0;&quot;&gt; &lt;/iframe&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h1 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a>å¸¸è§é—®é¢˜</h1><ol>
<li><p>Travis CI å‘å¸ƒå¤±è´¥</p>
<p>2022 å¹´ 07 æœˆå‘ç° github æäº¤åï¼Œç½‘ç«™æ²¡æœ‰è‡ªåŠ¨æ›´æ–°æˆåŠŸã€‚ç™»å½• Travis CI åå‘ç° CI å¤±è´¥ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><a href="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2022-07/20220727124915-rDXndx.jpg" title="20220727124915-rDXndx" class="gallery-item" style="box-shadow: none;"> <img src="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2022-07/20220727124915-rDXndx.jpg" alt="20220727124915-rDXndx"></a></p>
</li>
</ol>
<p>â€‹ åŸå› æ˜¯ node ç‰ˆæœ¬é—®é¢˜ï¼Œä¿®æ”¹é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„<code>.travis.yml</code>æ–‡ä»¶ä¸­çš„ node_js ç‰ˆæœ¬ï¼ŒåŸæ¥æ˜¯<code>stable</code>æ”¹ä¸º<code>lts</code></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">os:</span> <span class="string">linux</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">node_js</span></span><br><span class="line"><span class="attr">node_js:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">lts/*</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>è‡ªåŠ¨å‘ç‰ˆä¸ç”Ÿæ•ˆ<br>ä½¿ç”¨æ‰‹åŠ¨å‘ç‰ˆï¼š</li>
</ol>
<ul>
<li>å‘½ä»¤æ‰§è¡Œå…ˆ <code>hexo g</code> ç”Ÿæˆ</li>
<li>å†æ‰§è¡Œ <code>hexo d</code> å‘å¸ƒ</li>
</ul>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ç½‘ç«™</tag>
      </tags>
  </entry>
  <entry>
    <title>InfluxDBå’ŒGrafanaæ­å»ºç›‘æ§æœåŠ¡</title>
    <url>/influxdb-grafana/</url>
    <content><![CDATA[<div class=".article-gallery"><p>æœ¬ç¯‡ä¸ºç›‘æ§æœåŠ¡çš„ç¯å¢ƒæ­å»ºæ•™ç¨‹ã€‚</p>
<h2 id="Dockerå®‰è£…"><a href="#Dockerå®‰è£…" class="headerlink" title="Dockerå®‰è£…"></a>Dockerå®‰è£…</h2><p><a href="https://cloud.tencent.com/developer/article/1701451">å®‰è£…æ•™ç¨‹</a></p>
<h4 id="é—®é¢˜ä¸€ï¼š"><a href="#é—®é¢˜ä¸€ï¼š" class="headerlink" title="é—®é¢˜ä¸€ï¼š"></a>é—®é¢˜ä¸€ï¼š</h4><p><a href="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2021-12/WX20211217-005210@2x-AlSghZ.png" title="WX20211217-005210@2x-AlSghZ" class="gallery-item" style="box-shadow: none;"> <img src="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2021-12/WX20211217-005210@2x-AlSghZ.png" alt="WX20211217-005210@2x-AlSghZ"></a></p>
<p>å½“å‰pythonç¯å¢ƒä¸ºpython3ï¼Œä¿®æ”¹/usr/bin/yum-config-managerä½¿ç”¨çš„pythonç‰ˆæœ¬ä¸º2å³å¯ã€‚å¦‚ä¸‹å›¾</p>
<p><a href="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2021-12/WX20211217-005513@2x-8lyFc6.png" title="WX20211217-005513@2x-8lyFc6" class="gallery-item" style="box-shadow: none;"> <img src="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2021-12/WX20211217-005513@2x-8lyFc6.png" alt="WX20211217-005513@2x-8lyFc6"></a></p>
<h2 id="InfluxDB"><a href="#InfluxDB" class="headerlink" title="InfluxDB"></a>InfluxDB</h2><p>ä¸‹é¢ä¸€æ˜¯serviceæ–¹å¼å®‰è£…ï¼ŒäºŒæ˜¯dockeræ–¹å¼å®‰è£…ï¼ŒæŒ‰éœ€é€‰æ‹©ä¸€ç§æ–¹å¼å®‰è£…å³å¯ï¼Œ<strong>æ¨èæ–¹å¼1</strong>ã€‚</p>
<ol>
<li><p><a href="https://docs.influxdata.com/influxdb/v2.1/install/?t=Linux#install-influxdb-as-a-service-with-systemd">Install InfluxDB as a service with systemd</a></p>
<p>æˆ‘çš„æ˜¯CentOSçš„ç³»ç»Ÿï¼Œä½¿ç”¨yumæ–¹å¼å®‰è£…å¦‚ä¸‹ï¼š</p>
<p><a href="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2021-12/20211220115000-i3NQOj.jpg" title="20211220115000-i3NQOj" class="gallery-item" style="box-shadow: none;"> <img src="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2021-12/20211220115000-i3NQOj.jpg" alt="20211220115000-i3NQOj"></a></p>
<p><a href="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2021-12/20211220115209-ElUVDl.jpg" title="20211220115209-ElUVDl" class="gallery-item" style="box-shadow: none;"> <img src="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2021-12/20211220115209-ElUVDl.jpg" alt="20211220115209-ElUVDl"></a></p>
<p>å¯åŠ¨influxdï¼š</p>
<p><a href="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2021-12/20211220115329-zLOFBX.jpg" title="20211220115329-zLOFBX" class="gallery-item" style="box-shadow: none;"> <img src="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2021-12/20211220115329-zLOFBX.jpg" alt="20211220115329-zLOFBX"></a></p>
</li>
<li><p>ä¹Ÿå¯ä»¥é€‰æ‹©<a href="https://docs.influxdata.com/influxdb/v2.1/install/?t=Docker">Dockeræ–¹å¼å®‰è£…</a></p>
</li>
</ol>
<h4 id="é—®é¢˜ä¸€ï¼š-1"><a href="#é—®é¢˜ä¸€ï¼š-1" class="headerlink" title="é—®é¢˜ä¸€ï¼š"></a>é—®é¢˜ä¸€ï¼š</h4><p>å¦‚æœæœåŠ¡å™¨ä¸Šå·²ç»ä½¿ç”¨yumå®‰è£…äº†å…¶ä»–ç‰ˆæœ¬çš„influxDBï¼Œå¯ä»¥é€‰æ‹©å°†æ—§ç‰ˆæœ¬å¸è½½ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">rpm -q influxdb</span><br><span class="line">rpm -e influxdb</span><br><span class="line">rpm -q influxdb</span><br></pre></td></tr></table></figure>



<h2 id="Grafana"><a href="#Grafana" class="headerlink" title="Grafana"></a>Grafana</h2><ul>
<li><p>ä½¿ç”¨Grafanaå®˜ç½‘æœåŠ¡</p>
<ol>
<li><p><a href="https://grafana.com/grafana/">https://grafana.com/grafana/</a></p>
</li>
<li><p>åˆ›å»ºè‡ªå·±çš„grafana cloudï¼Œå¦‚ï¼š<a href="https://zhangga.grafana.net/">https://zhangga.grafana.net/</a></p>
</li>
<li><p>é…ç½®æ•°æ®æº<a href="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2021-12/ds1-qTTC9g.jpg" title="ds1-qTTC9g" class="gallery-item" style="box-shadow: none;"> <img src="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2021-12/ds1-qTTC9g.jpg" alt="ds1-qTTC9g"></a></p>
<p><a href="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2021-12/ds2-3lfW1i.jpg" title="ds2-3lfW1i" class="gallery-item" style="box-shadow: none;"> <img src="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2021-12/ds2-3lfW1i.jpg" alt="ds2-3lfW1i"></a></p>
<p><a href="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2021-12/ds3-Ve1we7.jpg" title="ds3-Ve1we7" class="gallery-item" style="box-shadow: none;"> <img src="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2021-12/ds3-Ve1we7.jpg" alt="ds3-Ve1we7"></a></p>
</li>
<li><p>é…ç½®ç›‘æ§é¢æ¿</p>
<p><a href="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2021-12/ds4-LUiCLt.jpg" title="ds4-LUiCLt" class="gallery-item" style="box-shadow: none;"> <img src="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2021-12/ds4-LUiCLt.jpg" alt="ds4-LUiCLt"></a></p>
</li>
</ol>
</li>
<li><p>äº‘æœåŠ¡å™¨å®‰è£…Grafana</p>
<ol>
<li><a href="https://cloud.tencent.com/developer/article/1411555">å®‰è£…æŒ‡å—</a>ã€‚</li>
<li>åœ¨è…¾è®¯äº‘æœåŠ¡å™¨(CentOS)ä¸Šå®‰è£…æˆåŠŸã€‚</li>
<li>é…ç½®æ•°æ®æºåŒä¸Šã€‚</li>
</ol>
</li>
</ul>
<p><a href="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2021-12/WX20211217-002036@2x-x6aO5K.png" title="WX20211217-002036@2x-x6aO5K" class="gallery-item" style="box-shadow: none;"> <img src="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2021-12/WX20211217-002036@2x-x6aO5K.png" alt="WX20211217-002036@2x-x6aO5K"></a></p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€è½¬è½½ã€‘ IO å¤šè·¯å¤ç”¨</title>
    <url>/ionet/</url>
    <content><![CDATA[<div class=".article-gallery"><h1 id="ä½ ç®¡è¿™ç ´ç©æ„å«-IO-å¤šè·¯å¤ç”¨ï¼Ÿ"><a href="#ä½ ç®¡è¿™ç ´ç©æ„å«-IO-å¤šè·¯å¤ç”¨ï¼Ÿ" class="headerlink" title="ä½ ç®¡è¿™ç ´ç©æ„å« IO å¤šè·¯å¤ç”¨ï¼Ÿ"></a>ä½ ç®¡è¿™ç ´ç©æ„å« IO å¤šè·¯å¤ç”¨ï¼Ÿ</h1><p>åŸåˆ› é—ªå®¢ <a href="javascript:void(0);">ä½å¹¶å‘ç¼–ç¨‹</a> <em>2021-03-25 09:00</em></p>
<p><a href="https://mp.weixin.qq.com/s/YdIdoZ_yusVWza1PU7lWaw">https://mp.weixin.qq.com/s/YdIdoZ_yusVWza1PU7lWaw</a></p>
<p>æ”¶å½•äºåˆé›†</p>
<p>#ç ´ç©æ„å„¿25ä¸ª</p>
<p>#ç½‘ç»œ4ä¸ª</p>
<p>ä½å¹¶å‘ç¼–ç¨‹</p>
<p>æˆ˜ç•¥ä¸Šè—è§†æŠ€æœ¯ï¼Œæˆ˜æœ¯ä¸Šé‡è§†æŠ€æœ¯</p>
<p>ä¸ºäº†è®²å¤šè·¯å¤ç”¨ï¼Œå½“ç„¶è¿˜æ˜¯è¦è·Ÿé£ï¼Œé‡‡ç”¨é­å°¸çš„æ€è·¯ï¼Œå…ˆè®²è®²ä¼ ç»Ÿçš„ç½‘ç»œ IO çš„å¼Šç«¯ï¼Œç”¨æ‹‰è¸©çš„æ–¹å¼æ§èµ·å¤šè·¯å¤ç”¨ IO çš„ä¼˜åŠ¿ã€‚</p>
<p>ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œä»¥ä¸‹æ‰€æœ‰ä»£ç éƒ½æ˜¯ä¼ªä»£ç ï¼ŒçŸ¥é“å…¶è¡¨è¾¾çš„æ„æ€å³å¯ã€‚</p>
<p><strong>Letâ€™s go</strong></p>
<h1 id="é˜»å¡-IO"><a href="#é˜»å¡-IO" class="headerlink" title="é˜»å¡ IO"></a><strong>é˜»å¡ IO</strong></h1><p>æœåŠ¡ç«¯ä¸ºäº†å¤„ç†å®¢æˆ·ç«¯çš„è¿æ¥å’Œè¯·æ±‚çš„æ•°æ®ï¼Œå†™äº†å¦‚ä¸‹ä»£ç ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">listenfd = socket();   // æ‰“å¼€ä¸€ä¸ªç½‘ç»œé€šä¿¡ç«¯å£</span><br><span class="line">bind(listenfd);        // ç»‘å®š</span><br><span class="line">listen(listenfd);      // ç›‘å¬</span><br><span class="line">while(1) &#123;</span><br><span class="line">  connfd = accept(listenfd);  // é˜»å¡å»ºç«‹è¿æ¥</span><br><span class="line">  int n = read(connfd, buf);  // é˜»å¡è¯»æ•°æ®</span><br><span class="line">  doSomeThing(buf);  // åˆ©ç”¨è¯»åˆ°çš„æ•°æ®åšäº›ä»€ä¹ˆ</span><br><span class="line">  close(connfd);     // å…³é—­è¿æ¥ï¼Œå¾ªç¯ç­‰å¾…ä¸‹ä¸€ä¸ªè¿æ¥</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ®µä»£ç ä¼šæ‰§è¡Œå¾—ç£•ç£•ç»Šç»Šï¼Œå°±åƒè¿™æ ·ã€‚</p>
<p><a href="https://mmbiz.qpic.cn/mmbiz_gif/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zArJDictJLnnRWwXriaXkgJFXnUsibFTlxjqSaBicqpeH4NhXBCqWuFgc7VQ/640?wx_fmt=gif&wxfrom=5&wx_lazy=1" title="å›¾ç‰‡" class="gallery-item" style="box-shadow: none;"> <img src="https://mmbiz.qpic.cn/mmbiz_gif/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zArJDictJLnnRWwXriaXkgJFXnUsibFTlxjqSaBicqpeH4NhXBCqWuFgc7VQ/640?wx_fmt=gif&wxfrom=5&wx_lazy=1" alt="å›¾ç‰‡"></a></p>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒæœåŠ¡ç«¯çš„çº¿ç¨‹é˜»å¡åœ¨äº†ä¸¤ä¸ªåœ°æ–¹ï¼Œä¸€ä¸ªæ˜¯ accept å‡½æ•°ï¼Œä¸€ä¸ªæ˜¯ read å‡½æ•°ã€‚</p>
<p>å¦‚æœå†æŠŠ read å‡½æ•°çš„ç»†èŠ‚å±•å¼€ï¼Œæˆ‘ä»¬ä¼šå‘ç°å…¶é˜»å¡åœ¨äº†ä¸¤ä¸ªé˜¶æ®µã€‚</p>
<p><a href="https://mmbiz.qpic.cn/mmbiz_gif/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zADM8nrhNkEtFpSpLjGicOemZ5mt7orYF8vFC7g83lPVDeSbnlgKl7XaA/640?wx_fmt=gif&wxfrom=5&wx_lazy=1" title="å›¾ç‰‡" class="gallery-item" style="box-shadow: none;"> <img src="https://mmbiz.qpic.cn/mmbiz_gif/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zADM8nrhNkEtFpSpLjGicOemZ5mt7orYF8vFC7g83lPVDeSbnlgKl7XaA/640?wx_fmt=gif&wxfrom=5&wx_lazy=1" alt="å›¾ç‰‡"></a></p>
<p>è¿™å°±æ˜¯ä¼ ç»Ÿçš„é˜»å¡ IOã€‚</p>
<p>æ•´ä½“æµç¨‹å¦‚ä¸‹å›¾ã€‚</p>
<p><a href="https://mmbiz.qpic.cn/mmbiz_png/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zAadgqoGRuEcAClAdesz7WTGhq6ugGbCKNiaghwqyAJJBC1GtVuYpkkmA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" title="å›¾ç‰‡" class="gallery-item" style="box-shadow: none;"> <img src="https://mmbiz.qpic.cn/mmbiz_png/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zAadgqoGRuEcAClAdesz7WTGhq6ugGbCKNiaghwqyAJJBC1GtVuYpkkmA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡"></a></p>
<p>æ‰€ä»¥ï¼Œå¦‚æœè¿™ä¸ªè¿æ¥çš„å®¢æˆ·ç«¯ä¸€ç›´ä¸å‘æ•°æ®ï¼Œé‚£ä¹ˆæœåŠ¡ç«¯çº¿ç¨‹å°†ä¼šä¸€ç›´é˜»å¡åœ¨ read å‡½æ•°ä¸Šä¸è¿”å›ï¼Œä¹Ÿæ— æ³•æ¥å—å…¶ä»–å®¢æˆ·ç«¯è¿æ¥ã€‚</p>
<p>è¿™è‚¯å®šæ˜¯ä¸è¡Œçš„ã€‚</p>
<h1 id="éé˜»å¡-IO"><a href="#éé˜»å¡-IO" class="headerlink" title="éé˜»å¡ IO"></a><strong>éé˜»å¡ IO</strong></h1><p>ä¸ºäº†è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œå…¶å…³é”®åœ¨äºæ”¹é€ è¿™ä¸ª read å‡½æ•°ã€‚</p>
<p>æœ‰ä¸€ç§èªæ˜çš„åŠæ³•æ˜¯ï¼Œæ¯æ¬¡éƒ½åˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹æˆ–çº¿ç¨‹ï¼Œå»è°ƒç”¨ read å‡½æ•°ï¼Œå¹¶åšä¸šåŠ¡å¤„ç†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">while(1) &#123;</span><br><span class="line">  connfd = accept(listenfd);  // é˜»å¡å»ºç«‹è¿æ¥</span><br><span class="line">  pthread_createï¼ˆdoWork);  // åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹</span><br><span class="line">&#125;</span><br><span class="line">void doWork() &#123;</span><br><span class="line">  int n = read(connfd, buf);  // é˜»å¡è¯»æ•°æ®</span><br><span class="line">  doSomeThing(buf);  // åˆ©ç”¨è¯»åˆ°çš„æ•°æ®åšäº›ä»€ä¹ˆ</span><br><span class="line">  close(connfd);     // å…³é—­è¿æ¥ï¼Œå¾ªç¯ç­‰å¾…ä¸‹ä¸€ä¸ªè¿æ¥</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·ï¼Œå½“ç»™ä¸€ä¸ªå®¢æˆ·ç«¯å»ºç«‹å¥½è¿æ¥åï¼Œå°±å¯ä»¥ç«‹åˆ»ç­‰å¾…æ–°çš„å®¢æˆ·ç«¯è¿æ¥ï¼Œè€Œä¸ç”¨é˜»å¡åœ¨åŸå®¢æˆ·ç«¯çš„ read è¯·æ±‚ä¸Šã€‚</p>
<p><a href="https://mmbiz.qpic.cn/mmbiz_gif/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zA55fIbicSuYiad7vYdyLD0usibPibYiaAjBDR0gQPzArnzYlWXOZRyQzub3Q/640?wx_fmt=gif&wxfrom=5&wx_lazy=1" title="å›¾ç‰‡" class="gallery-item" style="box-shadow: none;"> <img src="https://mmbiz.qpic.cn/mmbiz_gif/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zA55fIbicSuYiad7vYdyLD0usibPibYiaAjBDR0gQPzArnzYlWXOZRyQzub3Q/640?wx_fmt=gif&wxfrom=5&wx_lazy=1" alt="å›¾ç‰‡"></a></p>
<p>ä¸è¿‡ï¼Œè¿™ä¸å«éé˜»å¡ IOï¼Œåªä¸è¿‡ç”¨äº†å¤šçº¿ç¨‹çš„æ‰‹æ®µä½¿å¾—ä¸»çº¿ç¨‹æ²¡æœ‰å¡åœ¨ read å‡½æ•°ä¸Šä¸å¾€ä¸‹èµ°ç½¢äº†ã€‚æ“ä½œç³»ç»Ÿä¸ºæˆ‘ä»¬æä¾›çš„ read å‡½æ•°ä»ç„¶æ˜¯é˜»å¡çš„ã€‚</p>
<p>æ‰€ä»¥çœŸæ­£çš„éé˜»å¡ IOï¼Œä¸èƒ½æ˜¯é€šè¿‡æˆ‘ä»¬ç”¨æˆ·å±‚çš„å°æŠŠæˆï¼Œ<strong>è€Œæ˜¯è¦æ³è¯·æ“ä½œç³»ç»Ÿä¸ºæˆ‘ä»¬æä¾›ä¸€ä¸ªéé˜»å¡çš„ read å‡½æ•°</strong>ã€‚</p>
<p>è¿™ä¸ª read å‡½æ•°çš„æ•ˆæœæ˜¯ï¼Œå¦‚æœæ²¡æœ‰æ•°æ®åˆ°è¾¾æ—¶ï¼ˆåˆ°è¾¾ç½‘å¡å¹¶æ‹·è´åˆ°äº†å†…æ ¸ç¼“å†²åŒºï¼‰ï¼Œç«‹åˆ»è¿”å›ä¸€ä¸ªé”™è¯¯å€¼ï¼ˆ-1ï¼‰ï¼Œè€Œä¸æ˜¯é˜»å¡åœ°ç­‰å¾…ã€‚</p>
<p>æ“ä½œç³»ç»Ÿæä¾›äº†è¿™æ ·çš„åŠŸèƒ½ï¼Œåªéœ€è¦åœ¨è°ƒç”¨ read å‰ï¼Œå°†æ–‡ä»¶æè¿°ç¬¦è®¾ç½®ä¸ºéé˜»å¡å³å¯ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">fcntl(connfd, F_SETFL, O_NONBLOCK);</span><br><span class="line">int n = read(connfd, buffer) != SUCCESS);</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·ï¼Œå°±éœ€è¦ç”¨æˆ·çº¿ç¨‹å¾ªç¯è°ƒç”¨ readï¼Œç›´åˆ°è¿”å›å€¼ä¸ä¸º -1ï¼Œå†å¼€å§‹å¤„ç†ä¸šåŠ¡ã€‚</p>
<p><a href="https://mmbiz.qpic.cn/mmbiz_gif/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zAT6rHhibbzK5rXiarLuJU0P4MGrHNl35vVCV4JdS4FeejOkl8bBGz9nVQ/640?wx_fmt=gif&wxfrom=5&wx_lazy=1" title="å›¾ç‰‡" class="gallery-item" style="box-shadow: none;"> <img src="https://mmbiz.qpic.cn/mmbiz_gif/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zAT6rHhibbzK5rXiarLuJU0P4MGrHNl35vVCV4JdS4FeejOkl8bBGz9nVQ/640?wx_fmt=gif&wxfrom=5&wx_lazy=1" alt="å›¾ç‰‡"></a></p>
<p>è¿™é‡Œæˆ‘ä»¬æ³¨æ„åˆ°ä¸€ä¸ªç»†èŠ‚ã€‚</p>
<p>éé˜»å¡çš„ readï¼ŒæŒ‡çš„æ˜¯åœ¨æ•°æ®åˆ°è¾¾å‰ï¼Œå³æ•°æ®è¿˜æœªåˆ°è¾¾ç½‘å¡ï¼Œæˆ–è€…åˆ°è¾¾ç½‘å¡ä½†è¿˜æ²¡æœ‰æ‹·è´åˆ°å†…æ ¸ç¼“å†²åŒºä¹‹å‰ï¼Œè¿™ä¸ªé˜¶æ®µæ˜¯éé˜»å¡çš„ã€‚</p>
<p>å½“æ•°æ®å·²åˆ°è¾¾å†…æ ¸ç¼“å†²åŒºï¼Œæ­¤æ—¶è°ƒç”¨ read å‡½æ•°ä»ç„¶æ˜¯é˜»å¡çš„ï¼Œéœ€è¦ç­‰å¾…æ•°æ®ä»å†…æ ¸ç¼“å†²åŒºæ‹·è´åˆ°ç”¨æˆ·ç¼“å†²åŒºï¼Œæ‰èƒ½è¿”å›ã€‚</p>
<p>æ•´ä½“æµç¨‹å¦‚ä¸‹å›¾</p>
<p><a href="https://mmbiz.qpic.cn/mmbiz_png/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zA4NCGPZZo9ydSiczrguMdwqFNvibGlzbaopiauFxTqrIa5po5faEAoY7HA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" title="å›¾ç‰‡" class="gallery-item" style="box-shadow: none;"> <img src="https://mmbiz.qpic.cn/mmbiz_png/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zA4NCGPZZo9ydSiczrguMdwqFNvibGlzbaopiauFxTqrIa5po5faEAoY7HA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡"></a></p>
<h1 id="IO-å¤šè·¯å¤ç”¨"><a href="#IO-å¤šè·¯å¤ç”¨" class="headerlink" title="IO å¤šè·¯å¤ç”¨"></a><strong>IO å¤šè·¯å¤ç”¨</strong></h1><p>ä¸ºæ¯ä¸ªå®¢æˆ·ç«¯åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼ŒæœåŠ¡å™¨ç«¯çš„çº¿ç¨‹èµ„æºå¾ˆå®¹æ˜“è¢«è€—å…‰ã€‚</p>
<p><a href="https://mmbiz.qpic.cn/mmbiz_png/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zAibNxnhFichNdFVYbbTYQ45AhMnzQm7MYRwg3gWUYNib9MKUDpuibHRINlA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" title="å›¾ç‰‡" class="gallery-item" style="box-shadow: none;"> <img src="https://mmbiz.qpic.cn/mmbiz_png/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zAibNxnhFichNdFVYbbTYQ45AhMnzQm7MYRwg3gWUYNib9MKUDpuibHRINlA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡"></a></p>
<p>å½“ç„¶è¿˜æœ‰ä¸ªèªæ˜çš„åŠæ³•ï¼Œæˆ‘ä»¬å¯ä»¥æ¯ accept ä¸€ä¸ªå®¢æˆ·ç«¯è¿æ¥åï¼Œå°†è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼ˆconnfdï¼‰æ”¾åˆ°ä¸€ä¸ªæ•°ç»„é‡Œã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">fdlist.add(connfd);</span><br></pre></td></tr></table></figure>

<p>ç„¶åå¼„ä¸€ä¸ªæ–°çš„çº¿ç¨‹å»ä¸æ–­éå†è¿™ä¸ªæ•°ç»„ï¼Œè°ƒç”¨æ¯ä¸€ä¸ªå…ƒç´ çš„éé˜»å¡ read æ–¹æ³•ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">while(1) &#123;</span><br><span class="line">  for(fd &lt;-- fdlist) &#123;</span><br><span class="line">    if(read(fd) != -1) &#123;</span><br><span class="line">      doSomeThing();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±æˆåŠŸç”¨ä¸€ä¸ªçº¿ç¨‹å¤„ç†äº†å¤šä¸ªå®¢æˆ·ç«¯è¿æ¥ã€‚</p>
<p><a href="https://mmbiz.qpic.cn/mmbiz_gif/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zABlkKBoB04kDCApjketfzN9PWTwjwTng4ibWJTibCDmE3FsiaOTibAdaO3A/640?wx_fmt=gif&wxfrom=5&wx_lazy=1" title="å›¾ç‰‡" class="gallery-item" style="box-shadow: none;"> <img src="https://mmbiz.qpic.cn/mmbiz_gif/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zABlkKBoB04kDCApjketfzN9PWTwjwTng4ibWJTibCDmE3FsiaOTibAdaO3A/640?wx_fmt=gif&wxfrom=5&wx_lazy=1" alt="å›¾ç‰‡"></a></p>
<p>ä½ æ˜¯ä¸æ˜¯è§‰å¾—è¿™æœ‰äº›å¤šè·¯å¤ç”¨çš„æ„æ€ï¼Ÿ</p>
<p>ä½†è¿™å’Œæˆ‘ä»¬ç”¨å¤šçº¿ç¨‹å»å°†é˜»å¡ IO æ”¹é€ æˆçœ‹èµ·æ¥æ˜¯éé˜»å¡ IO ä¸€æ ·ï¼Œè¿™ç§éå†æ–¹å¼ä¹Ÿåªæ˜¯æˆ‘ä»¬ç”¨æˆ·è‡ªå·±æƒ³å‡ºçš„å°æŠŠæˆï¼Œæ¯æ¬¡éå†é‡åˆ° read è¿”å› -1 æ—¶ä»ç„¶æ˜¯ä¸€æ¬¡æµªè´¹èµ„æºçš„ç³»ç»Ÿè°ƒç”¨ã€‚</p>
<p>åœ¨ while å¾ªç¯é‡Œåšç³»ç»Ÿè°ƒç”¨ï¼Œå°±å¥½æ¯”ä½ åšåˆ†å¸ƒå¼é¡¹ç›®æ—¶åœ¨ while é‡Œåš rpc è¯·æ±‚ä¸€æ ·ï¼Œæ˜¯ä¸åˆ’ç®—çš„ã€‚</p>
<p>æ‰€ä»¥ï¼Œè¿˜æ˜¯å¾—æ³è¯·æ“ä½œç³»ç»Ÿè€å¤§ï¼Œæä¾›ç»™æˆ‘ä»¬ä¸€ä¸ªæœ‰è¿™æ ·æ•ˆæœçš„å‡½æ•°ï¼Œæˆ‘ä»¬å°†ä¸€æ‰¹æ–‡ä»¶æè¿°ç¬¦é€šè¿‡ä¸€æ¬¡ç³»ç»Ÿè°ƒç”¨ä¼ ç»™å†…æ ¸ï¼Œç”±å†…æ ¸å±‚å»éå†ï¼Œæ‰èƒ½çœŸæ­£è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<h2 id="select"><a href="#select" class="headerlink" title="select"></a><strong>select</strong></h2><p>select æ˜¯æ“ä½œç³»ç»Ÿæä¾›çš„ç³»ç»Ÿè°ƒç”¨å‡½æ•°ï¼Œé€šè¿‡å®ƒï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦çš„æ•°ç»„å‘ç»™æ“ä½œç³»ç»Ÿï¼Œ è®©æ“ä½œç³»ç»Ÿå»éå†ï¼Œç¡®å®šå“ªä¸ªæ–‡ä»¶æè¿°ç¬¦å¯ä»¥è¯»å†™ï¼Œ ç„¶åå‘Šè¯‰æˆ‘ä»¬å»å¤„ç†ï¼š</p>
<p><a href="https://mmbiz.qpic.cn/mmbiz_gif/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zAicgy5qFYcyoWPAV31k82icRe6I4Lya2F9qWcBlhHv3kzpgt9yjD7Hnpw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1" title="å›¾ç‰‡" class="gallery-item" style="box-shadow: none;"> <img src="https://mmbiz.qpic.cn/mmbiz_gif/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zAicgy5qFYcyoWPAV31k82icRe6I4Lya2F9qWcBlhHv3kzpgt9yjD7Hnpw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1" alt="å›¾ç‰‡"></a></p>
<p>selectç³»ç»Ÿè°ƒç”¨çš„å‡½æ•°å®šä¹‰å¦‚ä¸‹ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">int select(</span><br><span class="line">    int nfds,</span><br><span class="line">    fd_set *readfds,</span><br><span class="line">    fd_set *writefds,</span><br><span class="line">    fd_set *exceptfds,</span><br><span class="line">    struct timeval *timeout);</span><br><span class="line">// nfds:ç›‘æ§çš„æ–‡ä»¶æè¿°ç¬¦é›†é‡Œæœ€å¤§æ–‡ä»¶æè¿°ç¬¦åŠ 1</span><br><span class="line">// readfdsï¼šç›‘æ§æœ‰è¯»æ•°æ®åˆ°è¾¾æ–‡ä»¶æè¿°ç¬¦é›†åˆï¼Œä¼ å…¥ä¼ å‡ºå‚æ•°</span><br><span class="line">// writefdsï¼šç›‘æ§å†™æ•°æ®åˆ°è¾¾æ–‡ä»¶æè¿°ç¬¦é›†åˆï¼Œä¼ å…¥ä¼ å‡ºå‚æ•°</span><br><span class="line">// exceptfdsï¼šç›‘æ§å¼‚å¸¸å‘ç”Ÿè¾¾æ–‡ä»¶æè¿°ç¬¦é›†åˆ, ä¼ å…¥ä¼ å‡ºå‚æ•°</span><br><span class="line">// timeoutï¼šå®šæ—¶é˜»å¡ç›‘æ§æ—¶é—´ï¼Œ3ç§æƒ…å†µ</span><br><span class="line">//  1.NULLï¼Œæ°¸è¿œç­‰ä¸‹å»</span><br><span class="line">//  2.è®¾ç½®timevalï¼Œç­‰å¾…å›ºå®šæ—¶é—´</span><br><span class="line">//  3.è®¾ç½®timevalé‡Œæ—¶é—´å‡ä¸º0ï¼Œæ£€æŸ¥æè¿°å­—åç«‹å³è¿”å›ï¼Œè½®è¯¢</span><br></pre></td></tr></table></figure>

<p>æœåŠ¡ç«¯ä»£ç ï¼Œè¿™æ ·æ¥å†™ã€‚</p>
<p>é¦–å…ˆä¸€ä¸ªçº¿ç¨‹ä¸æ–­æ¥å—å®¢æˆ·ç«¯è¿æ¥ï¼Œå¹¶æŠŠ socket æ–‡ä»¶æè¿°ç¬¦æ”¾åˆ°ä¸€ä¸ª list é‡Œã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">while(1) &#123;</span><br><span class="line">  connfd = accept(listenfd);</span><br><span class="line">  fcntl(connfd, F_SETFL, O_NONBLOCK);</span><br><span class="line">  fdlist.add(connfd);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸å†è‡ªå·±éå†ï¼Œè€Œæ˜¯è°ƒç”¨ selectï¼Œå°†è¿™æ‰¹æ–‡ä»¶æè¿°ç¬¦ list äº¤ç»™æ“ä½œç³»ç»Ÿå»éå†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">while(1) &#123;</span><br><span class="line">  // æŠŠä¸€å †æ–‡ä»¶æè¿°ç¬¦ list ä¼ ç»™ select å‡½æ•°</span><br><span class="line">  // æœ‰å·²å°±ç»ªçš„æ–‡ä»¶æè¿°ç¬¦å°±è¿”å›ï¼Œnready è¡¨ç¤ºæœ‰å¤šå°‘ä¸ªå°±ç»ªçš„</span><br><span class="line">  nready = select(list);</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸è¿‡ï¼Œå½“ select å‡½æ•°è¿”å›åï¼Œç”¨æˆ·ä¾ç„¶éœ€è¦éå†åˆšåˆšæäº¤ç»™æ“ä½œç³»ç»Ÿçš„ listã€‚</p>
<p>åªä¸è¿‡ï¼Œæ“ä½œç³»ç»Ÿä¼šå°†å‡†å¤‡å°±ç»ªçš„æ–‡ä»¶æè¿°ç¬¦åšä¸Šæ ‡è¯†ï¼Œç”¨æˆ·å±‚å°†ä¸ä¼šå†æœ‰æ— æ„ä¹‰çš„ç³»ç»Ÿè°ƒç”¨å¼€é”€ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">while(1) &#123;</span><br><span class="line">  nready = select(list);</span><br><span class="line">  // ç”¨æˆ·å±‚ä¾ç„¶è¦éå†ï¼Œåªä¸è¿‡å°‘äº†å¾ˆå¤šæ— æ•ˆçš„ç³»ç»Ÿè°ƒç”¨</span><br><span class="line">  for(fd &lt;-- fdlist) &#123;</span><br><span class="line">    if(fd != -1) &#123;</span><br><span class="line">      // åªè¯»å·²å°±ç»ªçš„æ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">      read(fd, buf);</span><br><span class="line">      // æ€»å…±åªæœ‰ nready ä¸ªå·²å°±ç»ªæè¿°ç¬¦ï¼Œä¸ç”¨è¿‡å¤šéå†</span><br><span class="line">      if(--nready == 0) break;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ­£å¦‚åˆšåˆšçš„åŠ¨å›¾ä¸­æ‰€æè¿°çš„ï¼Œå…¶ç›´è§‚æ•ˆæœå¦‚ä¸‹ã€‚ï¼ˆåŒä¸€ä¸ªåŠ¨å›¾æ¶ˆè€—äº†ä½ ä¸¤æ¬¡æµé‡ï¼Œæ°”ä¸æ°”ï¼Ÿï¼‰</p>
<p><a href="https://mmbiz.qpic.cn/mmbiz_gif/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zAicgy5qFYcyoWPAV31k82icRe6I4Lya2F9qWcBlhHv3kzpgt9yjD7Hnpw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1" title="å›¾ç‰‡" class="gallery-item" style="box-shadow: none;"> <img src="https://mmbiz.qpic.cn/mmbiz_gif/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zAicgy5qFYcyoWPAV31k82icRe6I4Lya2F9qWcBlhHv3kzpgt9yjD7Hnpw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1" alt="å›¾ç‰‡"></a></p>
<p>å¯ä»¥çœ‹å‡ºå‡ ä¸ªç»†èŠ‚ï¼š</p>
<p>\1. select è°ƒç”¨éœ€è¦ä¼ å…¥ fd æ•°ç»„ï¼Œéœ€è¦æ‹·è´ä¸€ä»½åˆ°å†…æ ¸ï¼Œé«˜å¹¶å‘åœºæ™¯ä¸‹è¿™æ ·çš„æ‹·è´æ¶ˆè€—çš„èµ„æºæ˜¯æƒŠäººçš„ã€‚ï¼ˆå¯ä¼˜åŒ–ä¸ºä¸å¤åˆ¶ï¼‰</p>
<p>\2. select åœ¨å†…æ ¸å±‚ä»ç„¶æ˜¯é€šè¿‡éå†çš„æ–¹å¼æ£€æŸ¥æ–‡ä»¶æè¿°ç¬¦çš„å°±ç»ªçŠ¶æ€ï¼Œæ˜¯ä¸ªåŒæ­¥è¿‡ç¨‹ï¼Œåªä¸è¿‡æ— ç³»ç»Ÿè°ƒç”¨åˆ‡æ¢ä¸Šä¸‹æ–‡çš„å¼€é”€ã€‚ï¼ˆå†…æ ¸å±‚å¯ä¼˜åŒ–ä¸ºå¼‚æ­¥äº‹ä»¶é€šçŸ¥ï¼‰</p>
<p>\3. select ä»…ä»…è¿”å›å¯è¯»æ–‡ä»¶æè¿°ç¬¦çš„ä¸ªæ•°ï¼Œå…·ä½“å“ªä¸ªå¯è¯»è¿˜æ˜¯è¦ç”¨æˆ·è‡ªå·±éå†ã€‚ï¼ˆå¯ä¼˜åŒ–ä¸ºåªè¿”å›ç»™ç”¨æˆ·å°±ç»ªçš„æ–‡ä»¶æè¿°ç¬¦ï¼Œæ— éœ€ç”¨æˆ·åšæ— æ•ˆçš„éå†ï¼‰</p>
<p>æ•´ä¸ª select çš„æµç¨‹å›¾å¦‚ä¸‹ã€‚</p>
<p><a href="https://mmbiz.qpic.cn/mmbiz_png/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zAr5qibfgLBad0zoCEWXxdqC9I4v4mAYLR2SiafwtG4qOmdicHxa1Sx8MKQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" title="å›¾ç‰‡" class="gallery-item" style="box-shadow: none;"> <img src="https://mmbiz.qpic.cn/mmbiz_png/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zAr5qibfgLBad0zoCEWXxdqC9I4v4mAYLR2SiafwtG4qOmdicHxa1Sx8MKQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="å›¾ç‰‡"></a></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ç§æ–¹å¼ï¼Œæ—¢åšåˆ°äº†ä¸€ä¸ªçº¿ç¨‹å¤„ç†å¤šä¸ªå®¢æˆ·ç«¯è¿æ¥ï¼ˆæ–‡ä»¶æè¿°ç¬¦ï¼‰ï¼Œåˆå‡å°‘äº†ç³»ç»Ÿè°ƒç”¨çš„å¼€é”€ï¼ˆå¤šä¸ªæ–‡ä»¶æè¿°ç¬¦åªæœ‰ä¸€æ¬¡ select çš„ç³»ç»Ÿè°ƒç”¨ + n æ¬¡å°±ç»ªçŠ¶æ€çš„æ–‡ä»¶æè¿°ç¬¦çš„ read ç³»ç»Ÿè°ƒç”¨ï¼‰ã€‚</p>
<h2 id="poll"><a href="#poll" class="headerlink" title="poll"></a><strong>poll</strong></h2><p>poll ä¹Ÿæ˜¯æ“ä½œç³»ç»Ÿæä¾›çš„ç³»ç»Ÿè°ƒç”¨å‡½æ•°ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">int poll(struct pollfd *fds, nfds_tnfds, int timeout);</span><br><span class="line"></span><br><span class="line">struct pollfd &#123;</span><br><span class="line">  intfd; /*æ–‡ä»¶æè¿°ç¬¦*/</span><br><span class="line">  shortevents; /*ç›‘æ§çš„äº‹ä»¶*/</span><br><span class="line">  shortrevents; /*ç›‘æ§äº‹ä»¶ä¸­æ»¡è¶³æ¡ä»¶è¿”å›çš„äº‹ä»¶*/</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>å®ƒå’Œ select çš„ä¸»è¦åŒºåˆ«å°±æ˜¯ï¼Œå»æ‰äº† select åªèƒ½ç›‘å¬ 1024 ä¸ªæ–‡ä»¶æè¿°ç¬¦çš„é™åˆ¶ã€‚</p>
<h2 id="epoll"><a href="#epoll" class="headerlink" title="epoll"></a><strong>epoll</strong></h2><p>epoll æ˜¯æœ€ç»ˆçš„å¤§ bossï¼Œå®ƒè§£å†³äº† select å’Œ poll çš„ä¸€äº›é—®é¢˜ã€‚</p>
<p>è¿˜è®°å¾—ä¸Šé¢è¯´çš„ select çš„ä¸‰ä¸ªç»†èŠ‚ä¹ˆï¼Ÿ</p>
<p>\1. select è°ƒç”¨éœ€è¦ä¼ å…¥ fd æ•°ç»„ï¼Œéœ€è¦æ‹·è´ä¸€ä»½åˆ°å†…æ ¸ï¼Œé«˜å¹¶å‘åœºæ™¯ä¸‹è¿™æ ·çš„æ‹·è´æ¶ˆè€—çš„èµ„æºæ˜¯æƒŠäººçš„ã€‚ï¼ˆå¯ä¼˜åŒ–ä¸ºä¸å¤åˆ¶ï¼‰</p>
<p>\2. select åœ¨å†…æ ¸å±‚ä»ç„¶æ˜¯é€šè¿‡éå†çš„æ–¹å¼æ£€æŸ¥æ–‡ä»¶æè¿°ç¬¦çš„å°±ç»ªçŠ¶æ€ï¼Œæ˜¯ä¸ªåŒæ­¥è¿‡ç¨‹ï¼Œåªä¸è¿‡æ— ç³»ç»Ÿè°ƒç”¨åˆ‡æ¢ä¸Šä¸‹æ–‡çš„å¼€é”€ã€‚ï¼ˆå†…æ ¸å±‚å¯ä¼˜åŒ–ä¸ºå¼‚æ­¥äº‹ä»¶é€šçŸ¥ï¼‰</p>
<p>\3. select ä»…ä»…è¿”å›å¯è¯»æ–‡ä»¶æè¿°ç¬¦çš„ä¸ªæ•°ï¼Œå…·ä½“å“ªä¸ªå¯è¯»è¿˜æ˜¯è¦ç”¨æˆ·è‡ªå·±éå†ã€‚ï¼ˆå¯ä¼˜åŒ–ä¸ºåªè¿”å›ç»™ç”¨æˆ·å°±ç»ªçš„æ–‡ä»¶æè¿°ç¬¦ï¼Œæ— éœ€ç”¨æˆ·åšæ— æ•ˆçš„éå†ï¼‰</p>
<p>æ‰€ä»¥ epoll ä¸»è¦å°±æ˜¯é’ˆå¯¹è¿™ä¸‰ç‚¹è¿›è¡Œäº†æ”¹è¿›ã€‚</p>
<p>\1. å†…æ ¸ä¸­ä¿å­˜ä¸€ä»½æ–‡ä»¶æè¿°ç¬¦é›†åˆï¼Œæ— éœ€ç”¨æˆ·æ¯æ¬¡éƒ½é‡æ–°ä¼ å…¥ï¼Œåªéœ€å‘Šè¯‰å†…æ ¸ä¿®æ”¹çš„éƒ¨åˆ†å³å¯ã€‚</p>
<p>\2. å†…æ ¸ä¸å†é€šè¿‡è½®è¯¢çš„æ–¹å¼æ‰¾åˆ°å°±ç»ªçš„æ–‡ä»¶æè¿°ç¬¦ï¼Œè€Œæ˜¯é€šè¿‡å¼‚æ­¥ IO äº‹ä»¶å”¤é†’ã€‚</p>
<p>\3. å†…æ ¸ä»…ä¼šå°†æœ‰ IO äº‹ä»¶çš„æ–‡ä»¶æè¿°ç¬¦è¿”å›ç»™ç”¨æˆ·ï¼Œç”¨æˆ·ä¹Ÿæ— éœ€éå†æ•´ä¸ªæ–‡ä»¶æè¿°ç¬¦é›†åˆã€‚</p>
<p>å…·ä½“ï¼Œæ“ä½œç³»ç»Ÿæä¾›äº†è¿™ä¸‰ä¸ªå‡½æ•°ã€‚</p>
<p>ç¬¬ä¸€æ­¥ï¼Œåˆ›å»ºä¸€ä¸ª epoll å¥æŸ„</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">int epoll_create(int size);</span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒæ­¥ï¼Œå‘å†…æ ¸æ·»åŠ ã€ä¿®æ”¹æˆ–åˆ é™¤è¦ç›‘æ§çš„æ–‡ä»¶æè¿°ç¬¦ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">int epoll_ctl(</span><br><span class="line">  int epfd, int op, int fd, struct epoll_event *event);</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸‰æ­¥ï¼Œç±»ä¼¼å‘èµ·äº† select() è°ƒç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">int epoll_wait(</span><br><span class="line">  int epfd, struct epoll_event *events, int max events, int timeout);</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨èµ·æ¥ï¼Œå…¶å†…éƒ¨åŸç†å°±åƒå¦‚ä¸‹ä¸€èˆ¬ä¸æ»‘ã€‚</p>
<p><a href="https://mmbiz.qpic.cn/mmbiz_gif/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zAjXNXJTV82eOqkbJdOrDpQpAaWiceBqvAXyFEOTdV5fC2dNsL29yBW7w/640?wx_fmt=gif&wxfrom=5&wx_lazy=1" title="å›¾ç‰‡" class="gallery-item" style="box-shadow: none;"> <img src="https://mmbiz.qpic.cn/mmbiz_gif/GLeh42uInXTyY80RSpUTLjIMiaGGicv9zAjXNXJTV82eOqkbJdOrDpQpAaWiceBqvAXyFEOTdV5fC2dNsL29yBW7w/640?wx_fmt=gif&wxfrom=5&wx_lazy=1" alt="å›¾ç‰‡"></a></p>
<p>å¦‚æœä½ æƒ³ç»§ç»­æ·±å…¥äº†è§£ epoll çš„åº•å±‚åŸç†ï¼Œæ¨èé˜…è¯»é£å“¥çš„ã€Š<a href="http://mp.weixin.qq.com/s?__biz=MjM5Njg5NDgwNA==&mid=2247484905&idx=1&sn=a74ed5d7551c4fb80a8abe057405ea5e&chksm=a6e304d291948dc4fd7fe32498daaae715adb5f84ec761c31faf7a6310f4b595f95186647f12&scene=21#wechat_redirect">å›¾è§£ | æ·±å…¥æ­ç§˜ epoll æ˜¯å¦‚ä½•å®ç° IO å¤šè·¯å¤ç”¨çš„ï¼</a>ã€‹ï¼Œä» linux æºç çº§åˆ«ï¼Œä¸€è¡Œä¸€è¡Œéå¸¸ç¡¬æ ¸åœ°è§£è¯» epoll çš„å®ç°åŸç†ï¼Œä¸”é…æœ‰å¤§é‡æ–¹ä¾¿ç†è§£çš„å›¾ç‰‡ï¼Œéå¸¸é€‚åˆæºç æ§çš„å°ä¼™ä¼´é˜…è¯»ã€‚</p>
<blockquote>
<blockquote>
<p><strong>åè®°</strong></p>
</blockquote>
</blockquote>
<p>å¤§ç™½è¯æ€»ç»“ä¸€ä¸‹ã€‚</p>
<p>ä¸€åˆ‡çš„å¼€å§‹ï¼Œéƒ½èµ·æºäºè¿™ä¸ª read å‡½æ•°æ˜¯æ“ä½œç³»ç»Ÿæä¾›çš„ï¼Œè€Œä¸”æ˜¯é˜»å¡çš„ï¼Œæˆ‘ä»¬å«å®ƒ <strong>é˜»å¡ IO</strong>ã€‚</p>
<p>ä¸ºäº†ç ´è¿™ä¸ªå±€ï¼Œç¨‹åºå‘˜åœ¨ç”¨æˆ·æ€é€šè¿‡å¤šçº¿ç¨‹æ¥é˜²æ­¢ä¸»çº¿ç¨‹å¡æ­»ã€‚</p>
<p>åæ¥æ“ä½œç³»ç»Ÿå‘ç°è¿™ä¸ªéœ€æ±‚æ¯”è¾ƒå¤§ï¼Œäºæ˜¯åœ¨æ“ä½œç³»ç»Ÿå±‚é¢æä¾›äº†éé˜»å¡çš„ read å‡½æ•°ï¼Œè¿™æ ·ç¨‹åºå‘˜å°±å¯ä»¥åœ¨ä¸€ä¸ªçº¿ç¨‹å†…å®Œæˆå¤šä¸ªæ–‡ä»¶æè¿°ç¬¦çš„è¯»å–ï¼Œè¿™å°±æ˜¯ <strong>éé˜»å¡ IO</strong>ã€‚</p>
<p>ä½†å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦çš„è¯»å–å°±éœ€è¦éå†ï¼Œå½“é«˜å¹¶å‘åœºæ™¯è¶Šæ¥è¶Šå¤šæ—¶ï¼Œç”¨æˆ·æ€éå†çš„æ–‡ä»¶æè¿°ç¬¦ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œç›¸å½“äºåœ¨ while å¾ªç¯é‡Œè¿›è¡Œäº†è¶Šæ¥è¶Šå¤šçš„ç³»ç»Ÿè°ƒç”¨ã€‚</p>
<p>åæ¥æ“ä½œç³»ç»Ÿåˆå‘ç°è¿™ä¸ªåœºæ™¯éœ€æ±‚é‡è¾ƒå¤§ï¼Œäºæ˜¯åˆåœ¨æ“ä½œç³»ç»Ÿå±‚é¢æä¾›äº†è¿™æ ·çš„éå†æ–‡ä»¶æè¿°ç¬¦çš„æœºåˆ¶ï¼Œè¿™å°±æ˜¯ <strong>IO å¤šè·¯å¤ç”¨</strong>ã€‚</p>
<p>å¤šè·¯å¤ç”¨æœ‰ä¸‰ä¸ªå‡½æ•°ï¼Œæœ€å¼€å§‹æ˜¯ selectï¼Œç„¶ååˆå‘æ˜äº† poll è§£å†³äº† select æ–‡ä»¶æè¿°ç¬¦çš„é™åˆ¶ï¼Œç„¶ååˆå‘æ˜äº† epoll è§£å†³ select çš„ä¸‰ä¸ªä¸è¶³ã€‚</p>
<hr>
<p>æ‰€ä»¥ï¼ŒIO æ¨¡å‹çš„æ¼”è¿›ï¼Œå…¶å®å°±æ˜¯æ—¶ä»£çš„å˜åŒ–ï¼Œå€’é€¼ç€æ“ä½œç³»ç»Ÿå°†æ›´å¤šçš„åŠŸèƒ½åŠ åˆ°è‡ªå·±çš„å†…æ ¸è€Œå·²ã€‚</p>
<p>å¦‚æœä½ å»ºç«‹äº†è¿™æ ·çš„æ€ç»´ï¼Œå¾ˆå®¹æ˜“å‘ç°ç½‘ä¸Šçš„ä¸€äº›é”™è¯¯ã€‚</p>
<p>æ¯”å¦‚å¥½å¤šæ–‡ç« è¯´ï¼Œå¤šè·¯å¤ç”¨ä¹‹æ‰€ä»¥æ•ˆç‡é«˜ï¼Œæ˜¯å› ä¸ºç”¨ä¸€ä¸ªçº¿ç¨‹å°±å¯ä»¥ç›‘æ§å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚</p>
<p>è¿™æ˜¾ç„¶æ˜¯çŸ¥å…¶ç„¶è€Œä¸çŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œå¤šè·¯å¤ç”¨äº§ç”Ÿçš„æ•ˆæœï¼Œå®Œå…¨å¯ä»¥ç”±ç”¨æˆ·æ€å»éå†æ–‡ä»¶æè¿°ç¬¦å¹¶è°ƒç”¨å…¶éé˜»å¡çš„ read å‡½æ•°å®ç°ã€‚è€Œå¤šè·¯å¤ç”¨å¿«çš„åŸå› åœ¨äºï¼Œæ“ä½œç³»ç»Ÿæä¾›äº†è¿™æ ·çš„ç³»ç»Ÿè°ƒç”¨ï¼Œä½¿å¾—åŸæ¥çš„ while å¾ªç¯é‡Œå¤šæ¬¡ç³»ç»Ÿè°ƒç”¨ï¼Œå˜æˆäº†ä¸€æ¬¡ç³»ç»Ÿè°ƒç”¨ + å†…æ ¸å±‚éå†è¿™äº›æ–‡ä»¶æè¿°ç¬¦ã€‚</p>
<p>å°±å¥½æ¯”æˆ‘ä»¬å¹³æ—¶å†™ä¸šåŠ¡ä»£ç ï¼ŒæŠŠåŸæ¥ while å¾ªç¯é‡Œè°ƒ http æ¥å£è¿›è¡Œæ‰¹é‡ï¼Œæ”¹æˆäº†è®©å¯¹æ–¹æä¾›ä¸€ä¸ªæ‰¹é‡æ·»åŠ çš„ http æ¥å£ï¼Œç„¶åæˆ‘ä»¬ä¸€æ¬¡ rpc è¯·æ±‚å°±å®Œæˆäº†æ‰¹é‡æ·»åŠ ã€‚</p>
<p>ä¸€ä¸ªé“ç†ã€‚</p>
<p>æ‰¾æ—¶é—´æˆ‘å†ä¸“é—¨å†™ä¸€ç¯‡ï¼Œè®²è®²è¿™å—ç½‘ç»œä¸Šé±¼é¾™æ··æ‚çš„èŠ±å¼é”™è¯¯ç†è§£ã€‚</p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>JAVAæ¸¸æˆæœåŠ¡å™¨çƒ­æ›´</title>
    <url>/java-hot/</url>
    <content><![CDATA[<div class=".article-gallery"><p>å…·ä½“å·¥ç¨‹è¯¦è§github:</p>
<p><a href="https://github.com/zhangga/HotswapJAVA.git">https://github.com/zhangga/HotswapJAVA.git</a></p>
<p>agentmainå’Œpremainæ–¹æ³•éƒ½åªèƒ½ä¿®æ”¹æ–¹æ³•ä½“ã€‚</p>
<p><a href="https://imgtu.com/i/hKvk5V"><a href="https://z3.ax1x.com/2021/08/27/hKvk5V.md.png" title="hKvk5V.md.png" class="gallery-item" style="box-shadow: none;"> <img src="https://z3.ax1x.com/2021/08/27/hKvk5V.md.png" alt="hKvk5V.md.png"></a></a></p>
<p>jrebelå¯ä»¥çƒ­æ›´ç±»ï¼Œæ–°å¢ã€åˆ é™¤ã€ä¿®æ”¹ç­‰ã€‚</p>
<p>jrebelæœ‰eclipseå’Œideaçš„æ’ä»¶ï¼Œæ–¹ä¾¿å¹³æ—¶å¼€å‘æ—¶ï¼Œä¸ç”¨é‡å¯æœåŠ¡å™¨ã€‚</p>
<p>ç ´è§£ç‰ˆçš„æ’ä»¶åœ¨æˆ‘çš„ç™¾åº¦äº‘ç›˜é‡Œã€‚</p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>JAVA</tag>
      </tags>
  </entry>
  <entry>
    <title>å¼€å‘æœºéƒ¨ç½²Jenkinsè®°å½•</title>
    <url>/jenkins/</url>
    <content><![CDATA[<div class=".article-gallery"><p>åœ¨å¹³æ—¶å¼€å‘DS(Dedicated Server)æ—¶ï¼Œæœ‰æ—¶å€™éœ€è¦Linuxç¯å¢ƒï¼Œæ¯”å¦‚è¿›è¡Œå…±äº«å†…å­˜(Fork)æµ‹è¯•çš„æ—¶å€™ã€‚</p>
<p>æˆ‘ä¸€èˆ¬åœ¨è‡ªå·±çš„å¼€å‘æœºä¸Šè¿›è¡Œç¼–è¯‘å’Œæµ‹è¯•ï¼Œç¼–è¯‘è„šæœ¬æ˜¯æ ¹æ®é¡¹ç›®çš„æ‰“åŒ…è„šæœ¬(Jenkins/groovy)è¿›è¡Œç¼–å†™çš„ï¼Œéšç€å¼€å‘ç¯å¢ƒçš„å¢å¤šï¼Œæ¯”å¦‚æˆ˜åœºã€è¥åœ°ï¼Œä»¥åŠæœ€è¿‘å¼€å§‹æ”¯æŒXBoxå’ŒPS5ï¼Œé¡¹ç›®çš„æ‰“åŒ…è„šæœ¬ä¼šå¢åŠ è¶Šæ¥è¶Šå¤šçš„å‚æ•°æ§åˆ¶ï¼ŒåŒæ—¶è„šæœ¬æœ¬èº«çš„é€»è¾‘å¯èƒ½ä¹Ÿä¼šè¿›è¡Œè¿­ä»£ï¼Œè¿™æ ·å°±é¢ä¸´å¾—åŒæ­¥ç»´æŠ¤å¼€å‘æœºçš„ç¼–è¯‘è„šæœ¬ã€‚æ­£å¥½æœ€è¿‘å¼€å‘æœºä¸Šç¢°åˆ°ç¼–è¯‘è„šæœ¬æ‰“åŒ…æ—¶Stageé˜¶æ®µæ€»æ˜¯å‡ºé”™çš„é—®é¢˜ï¼Œç»ˆäºå†³å®šåœ¨å¼€å‘æœºä¸Šä¹Ÿéƒ¨ç½²ä¸‹Jenkinsï¼Œé€šè¿‡Jenkinsè¿›è¡Œç¼–è¯‘å·¥ä½œï¼Œç»Ÿä¸€ä¸‹å¼€å‘æœºå’Œé¡¹ç›®æ‰“åŒ…çš„æµç¨‹ï¼Œçœå»äº†å¤šä½™çš„ç»´æŠ¤æˆæœ¬ã€‚</p>
<p><a href="https://github.com/zhangga/picx-images-hosting/raw/master/jenkins-1.8z6xsf1j66.webp" title="pic" class="gallery-item" style="box-shadow: none;"> <img src="https://github.com/zhangga/picx-images-hosting/raw/master/jenkins-1.8z6xsf1j66.webp" alt="pic"></a></p>
<h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><h2 id="Dockeréƒ¨ç½²"><a href="#Dockeréƒ¨ç½²" class="headerlink" title="Dockeréƒ¨ç½²"></a>Dockeréƒ¨ç½²</h2><h4 id="æ‹‰å–-Jenkins-é•œåƒ"><a href="#æ‹‰å–-Jenkins-é•œåƒ" class="headerlink" title="æ‹‰å– Jenkins é•œåƒ"></a>æ‹‰å– Jenkins é•œåƒ</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker pull jenkinsci/blueocean</span><br></pre></td></tr></table></figure>

<h4 id="åˆ›å»ºæ•°æ®å·"><a href="#åˆ›å»ºæ•°æ®å·" class="headerlink" title="åˆ›å»ºæ•°æ®å·"></a>åˆ›å»ºæ•°æ®å·</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># åˆ›å»ºæŒ‚è½½ç›®å½•</span><br><span class="line">sudo mkdir -p /data/jenkins_home</span><br><span class="line">sudo chown -R 1000:1000 /data/jenkins_home</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run \          </span><br><span class="line">  -u root \</span><br><span class="line">  -d \</span><br><span class="line">  -p 8080:8080 \</span><br><span class="line">  -p 50000:50000 \</span><br><span class="line">  -v jenkins-data:/data/jenkins_home \</span><br><span class="line">  -v /var/run/docker.sock:/var/run/docker.sock \</span><br><span class="line">  jenkinsci/blueocean</span><br></pre></td></tr></table></figure>

<h2 id="è™šæ‹Ÿæœºå®‰è£…ï¼ˆæ¨èï¼‰"><a href="#è™šæ‹Ÿæœºå®‰è£…ï¼ˆæ¨èï¼‰" class="headerlink" title="è™šæ‹Ÿæœºå®‰è£…ï¼ˆæ¨èï¼‰"></a>è™šæ‹Ÿæœºå®‰è£…ï¼ˆæ¨èï¼‰</h2><h4 id="æ·»åŠ Jenkinså®˜æ–¹ä»“åº“"><a href="#æ·»åŠ Jenkinså®˜æ–¹ä»“åº“" class="headerlink" title="æ·»åŠ Jenkinså®˜æ–¹ä»“åº“"></a>æ·»åŠ Jenkinså®˜æ–¹ä»“åº“</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">wget -q -O - <span class="attr">https</span>:<span class="comment">//pkg.jenkins.io/debian-stable/jenkins.io.key | sudo tee \</span></span><br><span class="line">  <span class="regexp">/usr/</span>share/keyrings/jenkins-keyring.<span class="property">asc</span> &gt; <span class="regexp">/dev/</span><span class="literal">null</span></span><br><span class="line"></span><br><span class="line">echo <span class="string">&quot;deb [signed-by=/usr/share/keyrings/jenkins-keyring.asc] \</span></span><br><span class="line"><span class="string">  https://pkg.jenkins.io/debian-stable binary/&quot;</span> | sudo tee \</span><br><span class="line">  /etc/apt/sources.<span class="property">list</span>.<span class="property">d</span>/jenkins.<span class="property">list</span> &gt; <span class="regexp">/dev/</span><span class="literal">null</span></span><br><span class="line"></span><br><span class="line">sudo apt update</span><br></pre></td></tr></table></figure>

<h4 id="å®‰è£…-1"><a href="#å®‰è£…-1" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt install jenkins -y</span><br></pre></td></tr></table></figure>

<h4 id="ä¿®æ”¹-Jenkins-systemd-é…ç½®"><a href="#ä¿®æ”¹-Jenkins-systemd-é…ç½®" class="headerlink" title="ä¿®æ”¹ Jenkins systemd é…ç½®"></a>ä¿®æ”¹ Jenkins systemd é…ç½®</h4><p>ç¼–è¾‘ Jenkins çš„ systemd æ–‡ä»¶ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl edit jenkins</span><br></pre></td></tr></table></figure>

<p>æ·»åŠ å†…å®¹ï¼ˆè¦†ç›–ç¯å¢ƒï¼‰ï¼š</p>
<p>è¿™é‡Œä¸»è¦æ˜¯</p>
<ul>
<li>å•ç‹¬è®¾ç½®ä¸‹jdkçš„ç‰ˆæœ¬ï¼Œå› ä¸ºæˆ‘æœ¬æœºç”¨çš„æ˜¯jdk25ï¼Œä½†æ˜¯Jenkinsç›®å‰åªæ”¯æŒ17-21ã€‚</li>
<li>ä¿®æ”¹ JENKINS_HOME</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo mkdir -p /data00/jenkins</span><br><span class="line">sudo chown -R jenkins:jenkins /data00/jenkins</span><br><span class="line">sudo chmod -R 750 /data00/jenkins</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[Service]</span><br><span class="line">Environment=&quot;JENKINS_HOME=/data00/jenkins&quot;</span><br><span class="line">Environment=&quot;JAVA_HOME=/home/java/jdk-17.0.17+10&quot;</span><br><span class="line">Environment=&quot;PATH=/home/java/jdk-17.0.17+10/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin&quot;</span><br></pre></td></tr></table></figure>

<h4 id="å¯åŠ¨å¹¶è®¾ç½®å¼€æœºè‡ªå¯"><a href="#å¯åŠ¨å¹¶è®¾ç½®å¼€æœºè‡ªå¯" class="headerlink" title="å¯åŠ¨å¹¶è®¾ç½®å¼€æœºè‡ªå¯"></a>å¯åŠ¨å¹¶è®¾ç½®å¼€æœºè‡ªå¯</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl daemon-reexec</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl enable jenkins</span><br><span class="line">sudo systemctl start jenkins</span><br><span class="line">sudo systemctl status jenkins</span><br></pre></td></tr></table></figure>

<h1 id="é…ç½®Jenkins"><a href="#é…ç½®Jenkins" class="headerlink" title="é…ç½®Jenkins"></a>é…ç½®Jenkins</h1><p>è®¿é—®Jenkinsç•Œé¢ï¼š<code>http://&lt;ä½ çš„æœåŠ¡å™¨IP&gt;:8080</code></p>
<h3 id="å®‰è£…æ’ä»¶"><a href="#å®‰è£…æ’ä»¶" class="headerlink" title="å®‰è£…æ’ä»¶"></a>å®‰è£…æ’ä»¶</h3><ol>
<li>Pipeline</li>
<li><a href="https://plugins.jenkins.io/subversion">Subversion</a></li>
<li>Git</li>
<li>Build Triggers</li>
</ol>
<h3 id="é…ç½®Label"><a href="#é…ç½®Label" class="headerlink" title="é…ç½®Label"></a>é…ç½®Label</h3><p>å¦‚æœä½ çš„pipelineé‡ŒæŒ‡å®šäº†agent labelçš„è¯ã€‚</p>
<ol>
<li>ç™»å½• Jenkins Web UIã€‚</li>
<li>ç‚¹å‡» â€‹<strong>â€œManage Jenkinsâ€ â†’ â€œNodesâ€ â†’ â€œConfigureâ€ â†’ â€œLabelsâ€</strong>â€‹ã€‚</li>
</ol>
<h1 id="JENKINS-HOME"><a href="#JENKINS-HOME" class="headerlink" title="JENKINS_HOME"></a>JENKINS_HOME</h1><p>å¦‚æœä¸­é—´æƒ³æ¢Jenkinsç›®å½•çš„è¯ï¼Œå»ºè®®æŠŠåŸç›®å½•æ•´ç†æ‹·ä¸‹ã€‚</p>
<ol>
<li><h4 id="Jenkins-åœæ­¢æœåŠ¡"><a href="#Jenkins-åœæ­¢æœåŠ¡" class="headerlink" title="Jenkins åœæ­¢æœåŠ¡"></a>Jenkins åœæ­¢æœåŠ¡</h4></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl stop jenkins</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><h4 id="åˆ›å»ºæ–°çš„-JENKINS-HOME-ç›®å½•"><a href="#åˆ›å»ºæ–°çš„-JENKINS-HOME-ç›®å½•" class="headerlink" title="åˆ›å»ºæ–°çš„ JENKINS_HOME ç›®å½•"></a>åˆ›å»ºæ–°çš„ <code>JENKINS_HOME</code> ç›®å½•</h4></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo mkdir -p /data/jenkins</span><br><span class="line">sudo chown -R jenkins:jenkins /data/jenkins</span><br><span class="line">sudo chmod -R 750 /data/jenkins</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><h4 id="æ‹·è´åŸæœ‰æ•°æ®ï¼ˆå¯é€‰ï¼Œä½†æ¨èï¼‰"><a href="#æ‹·è´åŸæœ‰æ•°æ®ï¼ˆå¯é€‰ï¼Œä½†æ¨èï¼‰" class="headerlink" title="æ‹·è´åŸæœ‰æ•°æ®ï¼ˆå¯é€‰ï¼Œä½†æ¨èï¼‰"></a>æ‹·è´åŸæœ‰æ•°æ®ï¼ˆå¯é€‰ï¼Œä½†æ¨èï¼‰</h4></li>
</ol>
<p>å¦‚æœå¸Œæœ›ä¿ç•™åŸæ¥çš„ Jenkins é…ç½®å’Œ jobï¼Œéœ€è¦æŠŠæ—§ <code>JENKINS_HOME</code> å†…å®¹æ‹·è´è¿‡å»ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo rsync -av /var/lib/jenkins/ /data/jenkins/</span><br><span class="line">sudo chown -R jenkins:jenkins /data/jenkins</span><br></pre></td></tr></table></figure>

<ol start="4">
<li><h4 id="ä¿®æ”¹-systemd-é…ç½®"><a href="#ä¿®æ”¹-systemd-é…ç½®" class="headerlink" title="ä¿®æ”¹ systemd é…ç½®"></a>ä¿®æ”¹ systemd é…ç½®</h4></li>
</ol>
<p>é€šè¿‡ systemd è¦†ç›–é…ç½®ä¿®æ”¹ <code>JENKINS_HOME</code>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl edit jenkins</span><br></pre></td></tr></table></figure>

<p>å¡«å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[Service]</span><br><span class="line">Environment=&quot;JENKINS_HOME=/data/jenkins&quot;</span><br></pre></td></tr></table></figure>

<p>ä¿å­˜é€€å‡ºåï¼Œé‡æ–°åŠ è½½ systemdï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl start jenkins</span><br></pre></td></tr></table></figure>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>UE</tag>
      </tags>
  </entry>
  <entry>
    <title>JVisualVMè¿œç¨‹è°ƒè¯•</title>
    <url>/jvm-remote/</url>
    <content><![CDATA[<div class=".article-gallery"><h1 id="ä¸€ã€ä½¿ç”¨jstatd"><a href="#ä¸€ã€ä½¿ç”¨jstatd" class="headerlink" title="ä¸€ã€ä½¿ç”¨jstatd"></a>ä¸€ã€ä½¿ç”¨jstatd</h1><p>linuxä¸‹ä½¿ç”¨ hostname -i  æŸ¥çœ‹hostnameå¯¹åº”çš„IP</p>
<p>ç¡®ä¿è¿œç¨‹è¿æ¥ä½¿ç”¨çš„ipåœ¨åˆ—è¡¨é‡Œï¼Œä¸åœ¨çš„è¯jvisualvmæ— æ³•ä½¿ç”¨ipè¿œç¨‹è¿æ¥ã€‚</p>
<p>ä¸åœ¨çš„è¯vi /etc/hosts  åœ¨é‡Œé¢åŠ å…¥ã€‚</p>
<span id="more"></span>

<p>è¿›å…¥jdkçš„binç›®å½•ä¸‹ï¼š/usr/java/jdk1.8/bin/</p>
<p>æ–°å»ºæ–‡ä»¶jstatd.all.policy</p>
<p>å†™å…¥å†…å®¹ï¼š</p>
<p>grant codebase â€œfile:${java.home}/../lib/tools.jarâ€ {<br>permission java.security.AllPermission;<br>};</p>
<p>ç¼–å†™å¯åŠ¨è„šæœ¬ï¼šstartJstatd.sh</p>
<p>#!/bin/bash<br>nohup $JAVA_HOME/bin/jstatd -J-Djava.rmi.server.hostname=172.16.200.82 -p 1099 -J-Djava.security.policy=jstatd.all.policy -J-Dcom.sun.management.jmxremote.authenticate=false -J-Dcom.sun.management.jmxremote.ssl=false -J-Dcom.sun.management.jmxremote.port=1199 &amp;</p>
<p>ï¼ˆ-J-Djava.rmi.server.logCalls=true  å‚æ•°èƒ½çœ‹åˆ°æ—¥å¿—è¾“å‡ºï¼‰</p>
<p>è„šæœ¬é‡Œæœ‰jstatd å’Œ jmxçš„é…ç½®ã€‚åªè¦jstatdçš„é…ç½®ä¹ŸOJBKã€‚</p>
<p>ç¡®ä¿linuxçš„jstatdç«¯å£ï¼ˆé»˜è®¤1099ï¼‰å¯¹å¤–å¼€æ”¾ï¼Œç„¶åä½¿ç”¨jvisualvmè¿œç¨‹è¿æ¥å³å¯ã€‚</p>
<h1 id="äºŒã€ä½¿ç”¨jmx"><a href="#äºŒã€ä½¿ç”¨jmx" class="headerlink" title="äºŒã€ä½¿ç”¨jmx"></a>äºŒã€ä½¿ç”¨jmx</h1><p>æ‰¾åˆ°é…ç½®æ–‡ä»¶$JAVA_HOME/jre/lib/management/jmxremote.password.template,å¤åˆ¶ä¸€ä»½å¹¶æ”¹åä¸ºjmxremote.password,</p>
<p>ä½¿ç”¨chmod +w jmxremote.password  å°†æ–‡ä»¶åŠ å…¥å†™æƒé™</p>
<p>ç„¶åæ‰“å¼€jmxremote.passwrodï¼Œå–æ¶ˆä»¥ä¸‹ä¸¤è¡Œæ³¨é‡Šï¼š</p>
<p>#monitorRole QED#controlRole R&amp;D monitorRoleä¸ºç”¨æˆ·å QEDä¸ºå¯†ç  æ‰§è¡Œï¼šchmod 400 jmxremote.passwordæŒ‡ä»¤ã€‚ JVMå¯åŠ¨è„šæœ¬åŠ å…¥å¯åŠ¨å‚æ•°ï¼šJAVA_PARAMS=â€$JAVA_PARAMS -Djava.rmi.server.hostname=47.95.10.167 -Dcom.sun.management.jmxremote.port=1199 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=trueâ€ï¼ˆå¯ä»¥å…³é—­éªŒè¯ä¹ŸOJBKï¼‰</p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>JAVA</tag>
      </tags>
  </entry>
  <entry>
    <title>è‡ªå·±åŠ¨æ‰‹å†™JVM</title>
    <url>/jvm-self/</url>
    <content><![CDATA[<div class=".article-gallery"><p>æ ¹æ®ã€Šè‡ªå·±åŠ¨æ‰‹å†™Javaè™šæ‹Ÿæœºã€‹ä¸€ä¹¦</p>
<p><a href="https://i0.wp.com/192.144.167.243/blog/wp-content/uploads/cover-300x179.png?resize=300,179" title="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬1å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/192.144.167.243/blog/wp-content/uploads/cover-300x179.png?resize=300,179" alt="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬1å¼   | å¼ å˜"></a></p>
<h2 id="å®ç°çš„goä»£ç åœ¨GitHubä¸­ï¼šQJvm"><a href="#å®ç°çš„goä»£ç åœ¨GitHubä¸­ï¼šQJvm" class="headerlink" title="å®ç°çš„goä»£ç åœ¨GitHubä¸­ï¼šQJvm"></a>å®ç°çš„goä»£ç åœ¨GitHubä¸­ï¼š<a href="https://github.com/zhangga/QJvm">QJvm</a></h2><h2 id="å¯è§†åŒ–æŸ¥çœ‹classæ–‡ä»¶çš„å·¥å…·ï¼šæŸ¥çœ‹classå·¥å…·ï¼Œå¯åŠ¨ç±»ï¼šClasspyAppã€‚ä¹¦ç±è‡ªèº«ä»£ç ï¼šä»£ç "><a href="#å¯è§†åŒ–æŸ¥çœ‹classæ–‡ä»¶çš„å·¥å…·ï¼šæŸ¥çœ‹classå·¥å…·ï¼Œå¯åŠ¨ç±»ï¼šClasspyAppã€‚ä¹¦ç±è‡ªèº«ä»£ç ï¼šä»£ç " class="headerlink" title="å¯è§†åŒ–æŸ¥çœ‹classæ–‡ä»¶çš„å·¥å…·ï¼šæŸ¥çœ‹classå·¥å…·ï¼Œå¯åŠ¨ç±»ï¼šClasspyAppã€‚ä¹¦ç±è‡ªèº«ä»£ç ï¼šä»£ç "></a>å¯è§†åŒ–æŸ¥çœ‹classæ–‡ä»¶çš„å·¥å…·ï¼š<a href="https://github.com/zxh0/classpy">æŸ¥çœ‹classå·¥å…·</a>ï¼Œå¯åŠ¨ç±»ï¼šClasspyAppã€‚ä¹¦ç±è‡ªèº«ä»£ç ï¼š<a href="https://github.com/zxh0/jvmgo-book">ä»£ç </a></h2> <span id="more"></span>

<h1 id="Classæ–‡ä»¶è§£æï¼š"><a href="#Classæ–‡ä»¶è§£æï¼š" class="headerlink" title="Classæ–‡ä»¶è§£æï¼š"></a>Classæ–‡ä»¶è§£æï¼š</h1><p><a href="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/22.png?resize=640,484" title="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬2å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/22.png?resize=640,484" alt="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬2å¼   | å¼ å˜"></a></p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼š</p>
<p>å¸¸é‡æ± è§£æï¼š</p>
<p>1.è¯»å–16ä½çš„å¸¸é‡æ± å¤§å°cp_countã€‚</p>
<p>2.ç´¢å¼•ä»1åˆ°cp_count-1ï¼Œä¾æ¬¡è¯»å–å¸¸é‡ä¿¡æ¯ã€‚</p>
<p>3.å¸¸é‡ä¿¡æ¯æœ‰tag(8bit)è¡¨ç¤ºå¸¸é‡ç±»å‹ã€‚ä¸åŒçš„ç±»å‹è¯»å–æ•°æ®æ–¹å¼ä¸åŒã€‚</p>
<p>// å¸¸é‡æ± ç±»å‹</p>
<p>const (</p>
<p>  CONSTANT_Class = 7</p>
<p>  CONSTANT_Fieldref = 9</p>
<p>  CONSTANT_Methodref = 10</p>
<p>  CONSTANT_InterfaceMethodref = 11</p>
<p>  CONSTANT_String = 8</p>
<p>  CONSTANT_Integer = 3</p>
<p>  CONSTANT_Float = 4</p>
<p>  CONSTANT_Long = 5</p>
<p>  CONSTANT_Double = 6</p>
<p>  CONSTANT_NameAndType = 12</p>
<p>  CONSTANT_Utf8 = 1</p>
<p>  CONSTANT_MethodHandle = 15</p>
<p>  CONSTANT_MethodType = 16</p>
<p>  CONSTANT_InvokeDynamic = 18</p>
<p>)</p>
<p><a href="https://i1.wp.com/192.144.167.243/blog/wp-content/uploads/23.png?resize=640,490" title="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬3å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i1.wp.com/192.144.167.243/blog/wp-content/uploads/23.png?resize=640,490" alt="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬3å¼   | å¼ å˜"></a></p>
<p>å¸¸é‡æ± ç±»å‹å¯åˆ†ä¸ºä¸‹é¢å‡ å¤§ç±»ï¼š</p>
<table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>è¯´æ˜</th>
<th>å…·ä½“ä»£è¡¨ç±»å‹</th>
<th>classå­˜å‚¨æ ¼å¼</th>
</tr>
</thead>
<tbody><tr>
<td>numeric</td>
<td>æ•°å€¼å‹</td>
<td>int/float/doubleç­‰</td>
<td>tag(8bit)+æ•°å€¼(å…·ä½“ç±»å‹å†³å®š)</td>
</tr>
<tr>
<td>string</td>
<td>æŒ‡å‘å­—ç¬¦ä¸²</td>
<td>string</td>
<td>tag(8bit)+æŒ‡å‘utf8å­—ç¬¦ä¸²çš„ç´¢å¼•(16bit)</td>
</tr>
<tr>
<td>utf8</td>
<td>å­—ç¬¦ä¸²</td>
<td>string</td>
<td>tag(8bit)+length(16b)+bytes(length)</td>
</tr>
<tr>
<td>class</td>
<td>ç±»ä¿¡æ¯</td>
<td>class</td>
<td>tag(8bit)+æŒ‡å‘utf8å­—ç¬¦ä¸²çš„ç´¢å¼•(16bit)</td>
</tr>
<tr>
<td>name&amp;type</td>
<td>åå­—å’Œæè¿°(å‚æ•°)</td>
<td>å­—æ®µã€æ–¹æ³•çš„åç§°å’Œæè¿°</td>
<td>tag(8bit)+æŒ‡å‘nameå­—ç¬¦ä¸²ç´¢å¼•(16bit)+æŒ‡å‘æè¿°å­—ç¬¦ä¸²çš„ç´¢å¼•(16bit)</td>
</tr>
<tr>
<td>member</td>
<td>æˆå‘˜ä¿¡æ¯</td>
<td>å­—æ®µã€æ–¹æ³•ã€æ¥å£ä¿¡æ¯ç­‰</td>
<td>tag(8bit)+æŒ‡å‘classç´¢å¼•(16bit)+æŒ‡å‘name&amp;typeçš„ç´¢å¼•(16bit)</td>
</tr>
<tr>
<td>methodType</td>
<td>æ–¹æ³•æè¿°</td>
<td>æ–¹æ³•</td>
<td>tag(8bit)+æŒ‡å‘æè¿°å­—ç¬¦ä¸²çš„ç´¢å¼•(16bit)</td>
</tr>
<tr>
<td>methodHandle</td>
<td>æ–¹æ³•å¥æŸ„</td>
<td>æ–¹æ³•å¥æŸ„</td>
<td>tag(8bit)+refKind(8b)+æŒ‡å‘å¼•ç”¨refçš„ç´¢å¼•(16b)</td>
</tr>
<tr>
<td>dynamic</td>
<td>åŠ¨æ€è°ƒç”¨</td>
<td>Lambdaè¡¨è¾¾å¼</td>
<td>tag(8bit)+æŒ‡å®šå¯åŠ¨æ–¹æ³•çš„ç´¢å¼•(16bæŒ‡å‘å±æ€§è¡¨)+æŒ‡å‘name&amp;typeçš„ç´¢å¼•(16b)</td>
</tr>
</tbody></table>
<h1 id="åŠ¨æ€è°ƒç”¨ï¼šCONSTANT-InvokeDynamic-info"><a href="#åŠ¨æ€è°ƒç”¨ï¼šCONSTANT-InvokeDynamic-info" class="headerlink" title="åŠ¨æ€è°ƒç”¨ï¼šCONSTANT_InvokeDynamic_info"></a>åŠ¨æ€è°ƒç”¨ï¼šCONSTANT_InvokeDynamic_info</h1><p>ä¸ºäº†æ›´å¥½çš„æ”¯æŒ<a href="http://en.wikipedia.org/wiki/Dynamic_typing#DYNAMIC">åŠ¨æ€ç±»å‹è¯­è¨€</a>ï¼Œ<a href="https://www.baidu.com/s?wd=Java7&tn=24004469_oem_dg&rsv_dl=gh_pl_sl_csd">Java7</a>é€šè¿‡<a href="https://jcp.org/en/jsr/detail?id=292">JSR292</a>ç»™JVMå¢åŠ äº†ä¸€æ¡æ–°çš„å­—èŠ‚ç æŒ‡ä»¤ï¼šinvokedynamicã€‚Java8çš„Lambdaè¡¨è¾¾å¼ã€‚</p>
<p>ä»¥ä¸‹é¢ä»£ç ä¸ºä¾‹ï¼š</p>
<p><a href="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/24.png?resize=640,239" title="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬4å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/24.png?resize=640,239" alt="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬4å¼   | å¼ å˜"></a></p>
<p>ä½¿ç”¨javap -v -pæŒ‡ä»¤åç¼–è¯‘ç”Ÿæˆçš„classæ–‡ä»¶ï¼Œæ‰¾åˆ°mainæ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°ç”Ÿæˆäº†ä¸€æ¡indyæŒ‡ä»¤</p>
<p><a href="https://i1.wp.com/192.144.167.243/blog/wp-content/uploads/25.png?resize=640,223" title="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬5å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i1.wp.com/192.144.167.243/blog/wp-content/uploads/25.png?resize=640,223" alt="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬5å¼   | å¼ å˜"></a></p>
<p>æŒ‡å‘å¸¸é‡æ± ç´¢å¼•ä¸º#2ï¼ŒæŸ¥çœ‹å¸¸é‡æ± å¯çŸ¥ï¼Œç¡®å®æ˜¯ä¸€ä¸ªCONSTANT_InvokeDynamic_info</p>
<p>CONSTANT_InvokeDynamic_info {</p>
<p>  u1 tag;</p>
<p>  u2 bootstrap_method_attr_index;</p>
<p>  u2 name_and_type_index;</p>
<p>}</p>
<p><a href="https://i0.wp.com/192.144.167.243/blog/wp-content/uploads/26.png?resize=640,89" title="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬6å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/192.144.167.243/blog/wp-content/uploads/26.png?resize=640,89" alt="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬6å¼   | å¼ å˜"></a></p>
<p>å¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ªå‚æ•°å³æˆ‘ä»¬ä¸Šé¢è¡¨ä¸­æ€»ç»“çš„å‚æ•°åˆ†åˆ«ä¸ºï¼š</p>
<p>æŒ‡å®šå¯åŠ¨æ–¹æ³•çš„ç´¢å¼•(16bæŒ‡å‘å±æ€§è¡¨)+æŒ‡å‘name&amp;typeçš„ç´¢å¼•(16b)</p>
<p>å…ˆçœ‹name&amp;type</p>
<p><a href="https://i1.wp.com/192.144.167.243/blog/wp-content/uploads/35.png?resize=640,125" title="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬7å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i1.wp.com/192.144.167.243/blog/wp-content/uploads/35.png?resize=640,125" alt="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬7å¼   | å¼ å˜"></a></p>
<p>å®ƒæè¿°çš„æ˜¯è¿™æ ·çš„ä¸€ä¸ªæ–¹æ³•ï¼š</p>
<p>Runnable run() {â€¦}</p>
<p>å†çœ‹bootstrap_method_attr_index</p>
<p><a href="http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html#jvms-4.7.21">JVMè§„èŒƒ</a>è§„å®šï¼Œå¦‚æœç±»çš„å¸¸é‡æ± ä¸­å­˜åœ¨CONSTANT_InvokeDynamic_infoçš„è¯ï¼Œé‚£ä¹ˆattributesè¡¨ä¸­å°±å¿…å®š<strong>æœ‰ä¸”ä»…æœ‰ä¸€ä¸ª</strong>BootstrapMethodså±æ€§ã€‚BootstrapMethodså±æ€§æ˜¯ä¸ªå˜é•¿çš„è¡¨ï¼Œç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p>BootstrapMethods_attribute {<br>u2 attribute_name_index;<br>u4 attribute_length;<br>u2 num_bootstrap_methods;<br>{   u2 bootstrap_method_ref;<br>u2 num_bootstrap_arguments;<br>u2 bootstrap_arguments[num_bootstrap_arguments];<br>} bootstrap_methods[num_bootstrap_methods];<br>}<br>æ¯ä¸€ä¸ªBootstrapMethodéƒ½åŒ…å«ä¸€ä¸ªbootstrap_method_refå’Œnä¸ªbootstrap_argumentsã€‚bootstrap_method_refæ˜¯ä¸ªå¸¸é‡æ± ç´¢å¼•ï¼ŒæŒ‡å‘ä¸€ä¸ªCONSTANT_MethodHandle_infoã€‚è€Œæ¯ä¸€ä¸ªbootstrap_argumentä¹Ÿéƒ½æ˜¯å¸¸é‡æ± ç´¢å¼•ï¼Œå¯ä»¥æŒ‡å‘ä¸‹é¢è¿™äº›ç»“æ„ï¼š</p>
<ul>
<li>CONSTANT_String_info</li>
<li>CONSTANT_Class_info</li>
<li>CONSTANT_Integer_info</li>
<li>CONSTANT_Long_info</li>
<li>CONSTANT_Float_info</li>
<li>CONSTANT_Double_info</li>
<li>CONSTANT_MethodHandle_info</li>
<li>CONSTANT_MethodType_info</li>
</ul>
<p>æœ¬ä¾‹ä¸­çš„å¯åŠ¨æ–¹æ³•åç¼–è¯‘å›¾ï¼š</p>
<p><a href="https://i1.wp.com/192.144.167.243/blog/wp-content/uploads/28.png?resize=640,132" title="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬8å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i1.wp.com/192.144.167.243/blog/wp-content/uploads/28.png?resize=640,132" alt="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬8å¼   | å¼ å˜"></a></p>
<p>ç¡®å®å­˜åœ¨ä¸€ä¸ªBootstrapMethodsè¡¨ï¼Œè¿™ä¸ªè¡¨ä¸­åªæœ‰ä¸€ä¸ªBootstrapMethodï¼Œå®ƒçš„bootstrap_method_refæ˜¯å¸¸é‡æ± #23ï¼Œæœ‰ä¸‰ä¸ªbootstrap_argumentsï¼Œåˆ†åˆ«æŒ‡å‘å¸¸é‡æ± #24ï¼Œ#25ï¼Œ#24ï¼š</p>
<p><a href="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/30.png?resize=640,76" title="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬9å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/30.png?resize=640,76" alt="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬9å¼   | å¼ å˜"></a></p>
<h2 id="CONSTANT-MethodHandle-info"><a href="#CONSTANT-MethodHandle-info" class="headerlink" title="CONSTANT_MethodHandle_info"></a>CONSTANT_MethodHandle_info</h2><p><a href="http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html#jvms-4.4.8">CONSTANT_MethodHandle_info</a>ç»“æ„åŒ…å«ä¸¤é¡¹ä¿¡æ¯ï¼Œå…¶ç»“æ„å‚è€ƒä¸Šé¢è¡¨æ ¼ã€‚</p>
<p>reference_kindæ˜¯ä¸€ä¸ª1åˆ°9ä¹‹é—´çš„æ•´æ•°ï¼Œå…·ä½“å«ä¹‰å¯ä»¥å‚è€ƒ<a href="http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-5.html#jvms-5.4.3.5">JVMè§„èŒƒ</a>ã€‚reference_indexæ˜¯å¸¸é‡æ± ç´¢å¼•ï¼Œä½†å…·ä½“ç´¢å¼•çš„æ˜¯ä»€ä¹ˆç±»å‹çš„å¸¸é‡ï¼Œéœ€è¦çœ‹reference_kindï¼š</p>
<table>
<thead>
<tr>
<th>constant_pool entry</th>
<th>reference_kind</th>
</tr>
</thead>
<tbody><tr>
<td>CONSTANT_Fieldref_info</td>
<td>1 (REF_getField), 2 (REF_getStatic), 3 (REF_putField), or 4 (REF_putStatic)</td>
</tr>
<tr>
<td>CONSTANT_Methodref_info</td>
<td>5 (REF_invokeVirtual), 6 (REF_invokeStatic), 7 (REF_invokeSpecial), or 8 (REF_newInvokeSpecial)</td>
</tr>
<tr>
<td>CONSTANT_InterfaceMethodref_info</td>
<td>9 (REF_invokeInterface)</td>
</tr>
</tbody></table>
<p>é€šè¿‡è§‚å¯Ÿå¸¸é‡æ± #23ï¼ˆä¸Šå›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼‰å¯ä»¥çœ‹åˆ°ï¼Œå®ƒçš„reference_kindæ˜¯6ï¼ˆREF_invokeStaticï¼‰ï¼Œreference_indexæ˜¯#29ï¼Œæ­£å¥½æ˜¯ä¸ªCONSTANT_Methodref_infoï¼š</p>
<p><a href="https://i1.wp.com/192.144.167.243/blog/wp-content/uploads/32.png?resize=640,130" title="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬10å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i1.wp.com/192.144.167.243/blog/wp-content/uploads/32.png?resize=640,130" alt="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬10å¼   | å¼ å˜"></a></p>
<p>å¼•ç”¨çš„æ˜¯java.lang.invoke.LambdaMetafactoryç±»çš„é™æ€æ–¹æ³•metafactory()ã€‚</p>
<p>å¼•ç”¨å…³ç³»å›¾ï¼š</p>
<p><a href="https://i0.wp.com/192.144.167.243/blog/wp-content/uploads/33.png?resize=640,545" title="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬11å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/192.144.167.243/blog/wp-content/uploads/33.png?resize=640,545" alt="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬11å¼   | å¼ å˜"></a></p>
<p>JVMå¦‚ä½•æ‰§è¡ŒindyæŒ‡ä»¤<br>å‰é¢ä»classæ–‡ä»¶çš„è§’åº¦ï¼Œåˆ†æäº†indyæŒ‡ä»¤ã€‚ä¸‹é¢è®©æˆ‘ä»¬çœ‹çœ‹JVMæ˜¯å¦‚ä½•æ‰§è¡ŒindyæŒ‡ä»¤çš„ã€‚</p>
<ul>
<li>æ¯ä¸€ä¸ªindyæŒ‡ä»¤å‡ºç°çš„åœ°æ–¹ï¼Œéƒ½å«åšä¸€ä¸ªdynamic call siteï¼ˆåŠ¨æ€è°ƒç”¨ç‚¹ï¼‰</li>
<li>æ ¹æ®indyæŒ‡ä»¤çš„æ“ä½œæ•°ï¼Œå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªcall site specifierï¼ˆè°ƒç”¨ç‚¹è¯´æ˜ç¬¦ï¼‰ï¼Œæ ¹æ®å‰é¢çš„åˆ†æï¼Œè¿™ä¸ªè¯´æ˜ç¬¦å…¶å®å°±å¸¸é‡æ± é‡Œçš„CONSTANT_InvokeDynamic_info</li>
<li>JVMè§£æï¼ˆresolveï¼‰è°ƒç”¨ç‚¹è¯´æ˜ç¬¦ï¼Œå¾—åˆ°ä¸‹é¢ä¸‰ç§ä¿¡æ¯ï¼š</li>
</ul>
<p>1.ä¸€ä¸ªMethodHandleï¼ŒæŒ‡å‘<strong>bootstrap method</strong>ï¼ˆå¯åŠ¨æ–¹æ³•ï¼‰</p>
<p>2.æ–¹æ³•åå’Œæ–¹æ³•æè¿°ï¼Œè¡¨ç¤ºåŠ¨æ€è°ƒç”¨çš„æ–¹æ³•</p>
<p>3.å…¶ä»–æä¾›ç»™å¯åŠ¨æ–¹æ³•çš„å‚æ•°</p>
<ul>
<li>æ¥ç€JVMè°ƒç”¨å¯åŠ¨æ–¹æ³•ï¼Œå¹¶æŠŠä¸Šä¸€æ­¥æåˆ°çš„ä¿¡æ¯é€šè¿‡å‚æ•°ä¼ ç»™å¯åŠ¨æ–¹æ³•</li>
<li>å¯åŠ¨æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ª<strong>CallSite</strong>å¯¹è±¡ï¼Œå¹¶ä¸”ï¼Œè¿™ä¸ªCallSiteå¯¹è±¡å°†æ°¸ä¹…å’Œè¿™ä¸ªåŠ¨æ€è°ƒç”¨ç‚¹å…³è”</li>
<li>è°ƒç”¨è·ŸCallSiteå…³è”çš„MethodHandleæŒ‡å‘çš„æ–¹æ³•</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€å¼ ç¤ºæ„å›¾ï¼Œç”»å‡ºäº†å…³é”®ç‚¹ï¼š</p>
<p><a href="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/31-1.png?resize=640,227" title="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬12å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/31-1.png?resize=640,227" alt="è‡ªå·±åŠ¨æ‰‹å†™JVM - ç¬¬12å¼   | å¼ å˜"></a></p>
<p>æ¥ç€å›åˆ°æˆ‘ä»¬ä¸Šé¢çš„å¸¸é‡æ± è§£æï¼Œæ³¨æ„ConstantLongInfoå’ŒConstantDoubleInfoåœ¨å¸¸é‡æ± å ä¸¤ä¸ªä½ç½®ã€‚è‡³æ­¤å¸¸é‡æ± è§£æå®Œæˆã€‚</p>
<p>æ¥ç€classæ–‡ä»¶ä¸­å­˜æ”¾çš„æ˜¯ç±»è®¿é—®æ ‡è¯†ã€‚</p>
<p>ç„¶åæ˜¯ç±»ï¼Œè¶…ç±»ï¼Œæ¥å£ä¿¡æ¯ã€‚éƒ½æ˜¯å¸¸é‡æ± ç´¢å¼•ã€‚</p>
<p>ç„¶åå­—æ®µè¡¨å’Œæ–¹æ³•è¡¨ï¼Œè¿™ä¿©è¯»å–æ–¹å¼ä¸€æ ·ï¼Œä»¥æ–¹æ³•è¡¨ä¸ºä¾‹ï¼š</p>
<p>1.è¯»å–16ä½çš„æ–¹æ³•ä¸ªæ•°ï¼Œmember_count</p>
<p>2.ä¾æ¬¡è¯»å–member_countä¸ªæ–¹æ³•ä¿¡æ¯ï¼š</p>
<p>è®¿é—®æ ‡è¯†(16bit)ã€åç§°ç´¢å¼•(16bitæŒ‡å‘å¸¸é‡æ± )ã€æè¿°ç¬¦ç´¢å¼•(16bitæŒ‡å‘å¸¸é‡æ± )ã€è¯»å–æ–¹æ³•å…³è”çš„å±æ€§è¡¨ã€‚</p>
<p>æœ€åè¯»å–classæ–‡ä»¶çš„å±æ€§è¡¨Attributesã€‚</p>
<p>1.è¯»å–16ä½çš„å±æ€§ä¸ªæ•°ï¼Œattributes_count</p>
<p>2.ä¾æ¬¡è¯»å–attributes_countä¸ªå±æ€§ä¿¡æ¯ï¼š</p>
<p>å±æ€§åç´¢å¼•(æŒ‡å‘å¸¸é‡æ± çš„UTF8)ã€å±æ€§é•¿åº¦(32bit)ï¼Œ</p>
<p>æ ¹æ®å±æ€§åå’Œé•¿åº¦æ–°å»ºJVMå®ç°çš„å±æ€§å®ä¾‹ã€‚</p>
<p>Javaè™šæ‹Ÿæœºè§„èŒƒé¢„å®šä¹‰äº†23ç§å±æ€§ï¼Œå¯åˆ†ä¸ºä¸‰ç»„ã€‚</p>
<p>ä¸€ã€Javaè™šæ‹Ÿæœºå¿…é¡»çš„ï¼Œ5ç§ã€‚</p>
<p>äºŒã€Javaç±»åº“å¿…é¡»çš„ï¼Œ12ç§ã€‚</p>
<p>ä¸‰ã€æä¾›ç»™å·¥å…·ä½¿ç”¨çš„ï¼Œ6ç§ã€‚å¯é€‰çš„ã€‚</p>
<p>ä¾‹ï¼šCodeã€ConstantValueã€Exceptionsã€LineNumberTableã€LocalVariableTableã€SourceFileã€Syntheticç­‰</p>
<p>è‡³æ­¤classæ–‡ä»¶è§£æå®Œæˆã€‚</p>
<h1 id="çº¿ç¨‹å¯åŠ¨ï¼š"><a href="#çº¿ç¨‹å¯åŠ¨ï¼š" class="headerlink" title="çº¿ç¨‹å¯åŠ¨ï¼š"></a>çº¿ç¨‹å¯åŠ¨ï¼š</h1><p>ä»å¯åŠ¨ç±»ä¸­æŸ¥æ‰¾mainæ–¹æ³•ã€‚æ–¹æ³•åï¼šmainã€æ–¹æ³•æè¿°ç¬¦ï¼š([Ljava/lang/String;)V</p>
<p>å³ï¼šVoid main(String[] xxx) {â€¦}</p>
<p>è§£é‡Šå¹¶æ‰§è¡Œmainæ–¹æ³•ã€‚</p>
<p>çº¿ç¨‹Threadï¼š</p>
<p>// çº¿ç¨‹</p>
<p>type Thread struct {</p>
<p>  pc int</p>
<p>  stack *Stack  // çº¿ç¨‹çš„å¸§æ ˆ</p>
<p>}</p>
<p>// jvmæ ˆ</p>
<p>type Stack struct {</p>
<p>  maxSize uint  // æœ€å¤§å¤§å°</p>
<p>  size uint      // å½“å‰å¤§å°</p>
<p>  _top *Frame  // æ ˆç»“æ„</p>
<p>}</p>
<p>// å¸§</p>
<p>type Frame struct {</p>
<p>  lower *Frame  // ä¸‹ä¸€ä¸ªå¸§ï¼Œæ ˆç»“æ„ã€‚</p>
<p>  localVars LocalVars // å±€éƒ¨å˜é‡è¡¨</p>
<p>  operandStack *OperandStack  // æ“ä½œæ•°æ ˆ</p>
<p>  thread *Thread // æ‰€å±çº¿ç¨‹</p>
<p>  nextPC int // the next instruction after the call</p>
<p>}</p>
<p>æ ¹æ®main()æ–¹æ³•çš„CodeAttribute(å±æ€§è¡¨ï¼Œåç§°Codeï¼Œå­˜å‚¨æ–¹æ³•æ‰§è¡Œçš„å­—èŠ‚ç ä¿¡æ¯)ï¼Œè·å–å…¶ä¸­çš„æœ€å¤§å±€éƒ¨å˜é‡å¤§å°ã€æœ€å¤§æ“ä½œæ•°æ ˆå¤§å°ï¼Œæ–°å»ºFrameå®ä¾‹ï¼Œå°†Frameå®ä¾‹å‹å…¥å½“å‰çº¿ç¨‹çš„æ‰§è¡Œå¸§æ ˆã€‚</p>
<p>JVMä¼šå¾ªç¯ä¸åœçš„ä»çº¿ç¨‹çš„å¸§æ ˆä¸­å¼¹å‡ºå¸§Frameï¼Œæ‰§è¡ŒFrameï¼š</p>
<p>1.1è·å–frameè¦æ‰§è¡Œçš„æŒ‡ä»¤ç¼–å·NextPC</p>
<p>1.2å°†NextPCè®¾ç½®åˆ°threadçš„pc</p>
<p>2.1è§£ç codeï¼Œæ ¹æ®pcä»CodeAttributeä¸­çš„code(byte[]ç»“æ„)è§£ç </p>
<p>2.2å…ˆè·å–8bitæ“ä½œæŒ‡ä»¤ï¼Œæ ¹æ®æŒ‡ä»¤æ–°å»ºæŒ‡ä»¤å®ä¾‹ã€‚</p>
<p>å…±åˆ†ä¸º11ç±»ï¼šå¸¸é‡ï¼ˆconstantsï¼‰æŒ‡ä»¤ã€åŠ è½½ï¼ˆloadsï¼‰æŒ‡ä»¤ã€å­˜å‚¨ï¼ˆstoresï¼‰æŒ‡ä»¤ã€<br>æ“ä½œæ•°æ ˆï¼ˆstackï¼‰æŒ‡ä»¤ã€æ•°å­¦ï¼ˆmathï¼‰æŒ‡ä»¤ã€è½¬æ¢ï¼ˆconversionsï¼‰æŒ‡ä»¤ã€æ¯”<br>è¾ƒï¼ˆcomparisonsï¼‰æŒ‡ä»¤ã€æ§åˆ¶ï¼ˆcontrolï¼‰æŒ‡ä»¤ã€å¼•ç”¨ï¼ˆreferencesï¼‰æŒ‡ä»¤ã€<br>æ‰©å±•ï¼ˆextendedï¼‰æŒ‡ä»¤å’Œä¿ç•™ï¼ˆreservedï¼‰æŒ‡ä»¤ã€‚</p>
<p>å¦‚ï¼šiconst_0ï¼Œistore_1ï¼Œiload_1ï¼Œiinc{}ï¼Œif_icmpleï¼Œ_gotoï¼Œswapï¼Œi2bç­‰ã€‚</p>
<p>2.3ä»å±æ€§è¡¨çš„codeè·å–æ“ä½œæ•°ï¼Œä¸åŒçš„æŒ‡ä»¤å…·ä½“å®ç°ã€‚</p>
<p>å¦‚if_icmpeqæŒ‡ä»¤ï¼Œå¦‚æœæ¯”è¾ƒå€¼ç›¸ç­‰åˆ™è·³è½¬ï¼Œå…¶ä¸­çš„è·³è½¬åœ°å€éœ€è¦åœ¨æ–¹æ³•å±æ€§è¡¨codeä¸­è·å–ï¼Œè¯»å–code(byte[]ç»“æ„)çš„ä¸‹16ä½ä¸ºè·³è½¬çš„åç§»åœ°å€ã€‚</p>
<p>2.4è®¾ç½®frameçš„NextPCä¸ºcodeçš„pcï¼Œå³è®°å½•codeè¯»å–åˆ°å“ªä¸ªä½ç½®ã€‚</p>
<p>2.5æ‰§è¡ŒæŒ‡ä»¤å®ä¾‹ï¼Œä¸åŒçš„æŒ‡ä»¤å…·ä½“å®ç°ã€‚</p>
<p>å¦‚if_icmpeqæŒ‡ä»¤ï¼Œä»å¸§çš„æ“ä½œæ•°æ ˆä¸­ï¼Œå¼¹å‡ºä¸¤ä¸ªintå€¼ï¼Œæ¯”è¾ƒä¸¤ä¸ªå€¼ï¼Œå¦‚æœç›¸ç­‰ï¼Œåˆ™è®¾ç½®å¸§frameçš„NextPCä¸º å½“å‰çº¿ç¨‹çš„pc + åç§»é‡ï¼ˆæ­¥éª¤2.3ä»codeå±æ€§è¡¨ä¸­è¯»å–ï¼‰ã€‚</p>
<p>é‡å¤1.1æ‰§è¡Œ</p>
<p>ä¸Šé¢æ˜¯ä¸€ä¸ªå¸§Frameå®Œæ•´çš„æ‰§è¡Œæµç¨‹ã€‚</p>
<h3 id="ä¸Šé¢æè¿°äº†ä¸€ä¸ªç®€æ˜“çš„JVMæ‰§è¡Œæµç¨‹ï¼Œç”±çº¿ç¨‹é©±åŠ¨ï¼Œä¸åœçš„ä»çº¿ç¨‹çš„å¸§æ ˆä¸­å¼¹å‡ºå¸§ï¼Œæ‰§è¡Œå¸§ï¼šå¾ªç¯ä¸åœçš„ä»æ–¹æ³•çš„å±æ€§è¡¨ä¸­è·å–codeï¼Œè§£ææˆæŒ‡ä»¤ï¼Œæ‰§è¡ŒæŒ‡ä»¤ï¼ŒæŒ‡ä»¤çš„æ‰§è¡Œéœ€è¦æ“ä½œå¸§frameçš„å±€éƒ¨å˜é‡ï¼Œæ“ä½œæ•°æ ˆä»¥åŠå±æ€§è¡¨ã€‚"><a href="#ä¸Šé¢æè¿°äº†ä¸€ä¸ªç®€æ˜“çš„JVMæ‰§è¡Œæµç¨‹ï¼Œç”±çº¿ç¨‹é©±åŠ¨ï¼Œä¸åœçš„ä»çº¿ç¨‹çš„å¸§æ ˆä¸­å¼¹å‡ºå¸§ï¼Œæ‰§è¡Œå¸§ï¼šå¾ªç¯ä¸åœçš„ä»æ–¹æ³•çš„å±æ€§è¡¨ä¸­è·å–codeï¼Œè§£ææˆæŒ‡ä»¤ï¼Œæ‰§è¡ŒæŒ‡ä»¤ï¼ŒæŒ‡ä»¤çš„æ‰§è¡Œéœ€è¦æ“ä½œå¸§frameçš„å±€éƒ¨å˜é‡ï¼Œæ“ä½œæ•°æ ˆä»¥åŠå±æ€§è¡¨ã€‚" class="headerlink" title="ä¸Šé¢æè¿°äº†ä¸€ä¸ªç®€æ˜“çš„JVMæ‰§è¡Œæµç¨‹ï¼Œç”±çº¿ç¨‹é©±åŠ¨ï¼Œä¸åœçš„ä»çº¿ç¨‹çš„å¸§æ ˆä¸­å¼¹å‡ºå¸§ï¼Œæ‰§è¡Œå¸§ï¼šå¾ªç¯ä¸åœçš„ä»æ–¹æ³•çš„å±æ€§è¡¨ä¸­è·å–codeï¼Œè§£ææˆæŒ‡ä»¤ï¼Œæ‰§è¡ŒæŒ‡ä»¤ï¼ŒæŒ‡ä»¤çš„æ‰§è¡Œéœ€è¦æ“ä½œå¸§frameçš„å±€éƒ¨å˜é‡ï¼Œæ“ä½œæ•°æ ˆä»¥åŠå±æ€§è¡¨ã€‚"></a><strong>ä¸Šé¢æè¿°äº†ä¸€ä¸ªç®€æ˜“çš„JVMæ‰§è¡Œæµç¨‹ï¼Œç”±çº¿ç¨‹é©±åŠ¨ï¼Œä¸åœçš„ä»çº¿ç¨‹çš„å¸§æ ˆä¸­å¼¹å‡ºå¸§ï¼Œæ‰§è¡Œå¸§ï¼šå¾ªç¯ä¸åœçš„ä»æ–¹æ³•çš„å±æ€§è¡¨ä¸­è·å–codeï¼Œè§£ææˆæŒ‡ä»¤ï¼Œæ‰§è¡ŒæŒ‡ä»¤ï¼ŒæŒ‡ä»¤çš„æ‰§è¡Œéœ€è¦æ“ä½œå¸§frameçš„å±€éƒ¨å˜é‡ï¼Œæ“ä½œæ•°æ ˆä»¥åŠå±æ€§è¡¨ã€‚</strong></h3><h2 id="å®Œæ•´æµç¨‹ï¼š"><a href="#å®Œæ•´æµç¨‹ï¼š" class="headerlink" title="å®Œæ•´æµç¨‹ï¼š"></a>å®Œæ•´æµç¨‹ï¼š</h2><p>1.è§£æç¯å¢ƒå˜é‡<br>2.ç±»åŠ è½½å™¨<br>3.è§£æä¸»ç±»å<br>4.åŠ è½½ä¸»ç±»<br>åŠ è½½ç±»æµç¨‹ï¼šå†…å­˜ä¸­æ˜¯å¦å·²åŠ è½½è¯¥ç±»ï¼Œæ²¡æœ‰çš„è¯åŠ è½½ç±»<br>ä¸€ã€è§£æï¼š<br>è¯»å–classæ–‡ä»¶å­—èŠ‚ç ï¼Œè§£æ<br>ç”Ÿæˆè™šæ‹Ÿæœºå¯ç”¨çš„ç±»æ•°æ®ï¼Œæ”¾å…¥æ–¹æ³•åŒºã€‚ç±»æ•°æ®ï¼šç±»åŸºæœ¬ä¿¡æ¯ã€å¸¸é‡æ± ã€å­—æ®µã€æ–¹æ³•ã€çˆ¶ç±»ã€æ¥å£ã€é™æ€å˜é‡ç­‰ä¿¡æ¯ã€‚<br>åŠ è½½ç±»çš„æ—¶å€™ä¼šé€’å½’åŠ è½½ç±»çš„çˆ¶ç±»å’Œæ¥å£ã€‚<br>äºŒã€é“¾æ¥ï¼š<br>1éªŒè¯<br>2å‡†å¤‡<br>è®¡ç®—å®ä¾‹å­—æ®µçš„ä¸ªæ•°<br>è®¡ç®—é™æ€å­—æ®µçš„ä¸ªæ•°<br>åˆ†é…å¹¶åˆå§‹åŒ–é™æ€å˜é‡ï¼Œè®¾ç½®å¸¸é‡çš„å€¼ï¼ˆå­—æ®µä¿¡æ¯é‡Œæœ‰å¸¸é‡æŒ‡å‘çš„å¸¸é‡æ± çš„ç´¢å¼•ï¼‰</p>
<p>5.ä¸»ç±»åŠ è½½å®Œæˆåï¼Œæ‰¾åˆ°ä¸»å…¥å£æ–¹æ³•main<br>6.è§£é‡Šæ‰§è¡Œmainæ–¹æ³•</p>
<h2 id="æ–¹æ³•çš„è°ƒç”¨è¿‡ç¨‹ï¼š"><a href="#æ–¹æ³•çš„è°ƒç”¨è¿‡ç¨‹ï¼š" class="headerlink" title="æ–¹æ³•çš„è°ƒç”¨è¿‡ç¨‹ï¼š"></a>æ–¹æ³•çš„è°ƒç”¨è¿‡ç¨‹ï¼š</h2><h2 id="invokeinterface-invokespecial-invokestatic-invokevirtual-1-åˆ›å»ºå¸§ï¼ˆå¸§çš„ä¸»è¦ç»„æˆæ˜¯Methodï¼‰ï¼Œå°†å¸§æ¨å…¥æ ˆé¡¶ï¼Œ-2-å°†è¦ä¼ é€’çš„å‚æ•°ï¼ˆå®ä¾‹æ–¹æ³•ä¼šå¤šä¼ thisï¼‰ï¼Œä»è°ƒç”¨è€…çš„æ“ä½œæ•°æ ˆä¸­å¼¹å‡ºï¼Œæ”¾è¿›è¢«è°ƒç”¨æ–¹æ³•å¸§çš„å±€éƒ¨å˜é‡è¡¨ä¸­ã€‚-3-ä¸»looperä¸­ï¼Œä¼šä¸åœçš„æ‰§è¡Œå½“å‰å¸§ï¼Œè¿™æ ·è°ƒç”¨çš„æ–¹æ³•å¸§å³ä¼šè¢«æ‰§è¡Œã€‚-4-returnç³»åˆ—æŒ‡ä»¤ä¼šæŠŠå½“å‰å¸§ä»æ ˆä¸­å¼¹å‡ºï¼Œä½¿å¾—ä¸‹ä¸€å¸§å¾—ä»¥æ‰§è¡Œï¼Œä»è€Œå®ç°æ–¹æ³•çš„è¿”å›ã€‚"><a href="#invokeinterface-invokespecial-invokestatic-invokevirtual-1-åˆ›å»ºå¸§ï¼ˆå¸§çš„ä¸»è¦ç»„æˆæ˜¯Methodï¼‰ï¼Œå°†å¸§æ¨å…¥æ ˆé¡¶ï¼Œ-2-å°†è¦ä¼ é€’çš„å‚æ•°ï¼ˆå®ä¾‹æ–¹æ³•ä¼šå¤šä¼ thisï¼‰ï¼Œä»è°ƒç”¨è€…çš„æ“ä½œæ•°æ ˆä¸­å¼¹å‡ºï¼Œæ”¾è¿›è¢«è°ƒç”¨æ–¹æ³•å¸§çš„å±€éƒ¨å˜é‡è¡¨ä¸­ã€‚-3-ä¸»looperä¸­ï¼Œä¼šä¸åœçš„æ‰§è¡Œå½“å‰å¸§ï¼Œè¿™æ ·è°ƒç”¨çš„æ–¹æ³•å¸§å³ä¼šè¢«æ‰§è¡Œã€‚-4-returnç³»åˆ—æŒ‡ä»¤ä¼šæŠŠå½“å‰å¸§ä»æ ˆä¸­å¼¹å‡ºï¼Œä½¿å¾—ä¸‹ä¸€å¸§å¾—ä»¥æ‰§è¡Œï¼Œä»è€Œå®ç°æ–¹æ³•çš„è¿”å›ã€‚" class="headerlink" title="invokeinterface invokespecial invokestatic invokevirtual 1.åˆ›å»ºå¸§ï¼ˆå¸§çš„ä¸»è¦ç»„æˆæ˜¯Methodï¼‰ï¼Œå°†å¸§æ¨å…¥æ ˆé¡¶ï¼Œ 2.å°†è¦ä¼ é€’çš„å‚æ•°ï¼ˆå®ä¾‹æ–¹æ³•ä¼šå¤šä¼ thisï¼‰ï¼Œä»è°ƒç”¨è€…çš„æ“ä½œæ•°æ ˆä¸­å¼¹å‡ºï¼Œæ”¾è¿›è¢«è°ƒç”¨æ–¹æ³•å¸§çš„å±€éƒ¨å˜é‡è¡¨ä¸­ã€‚ 3.ä¸»looperä¸­ï¼Œä¼šä¸åœçš„æ‰§è¡Œå½“å‰å¸§ï¼Œè¿™æ ·è°ƒç”¨çš„æ–¹æ³•å¸§å³ä¼šè¢«æ‰§è¡Œã€‚ 4.returnç³»åˆ—æŒ‡ä»¤ä¼šæŠŠå½“å‰å¸§ä»æ ˆä¸­å¼¹å‡ºï¼Œä½¿å¾—ä¸‹ä¸€å¸§å¾—ä»¥æ‰§è¡Œï¼Œä»è€Œå®ç°æ–¹æ³•çš„è¿”å›ã€‚"></a>invokeinterface invokespecial invokestatic invokevirtual 1.åˆ›å»ºå¸§ï¼ˆå¸§çš„ä¸»è¦ç»„æˆæ˜¯Methodï¼‰ï¼Œå°†å¸§æ¨å…¥æ ˆé¡¶ï¼Œ 2.å°†è¦ä¼ é€’çš„å‚æ•°ï¼ˆå®ä¾‹æ–¹æ³•ä¼šå¤šä¼ thisï¼‰ï¼Œä»è°ƒç”¨è€…çš„æ“ä½œæ•°æ ˆä¸­å¼¹å‡ºï¼Œæ”¾è¿›è¢«è°ƒç”¨æ–¹æ³•å¸§çš„å±€éƒ¨å˜é‡è¡¨ä¸­ã€‚ 3.ä¸»looperä¸­ï¼Œä¼šä¸åœçš„æ‰§è¡Œå½“å‰å¸§ï¼Œè¿™æ ·è°ƒç”¨çš„æ–¹æ³•å¸§å³ä¼šè¢«æ‰§è¡Œã€‚ 4.returnç³»åˆ—æŒ‡ä»¤ä¼šæŠŠå½“å‰å¸§ä»æ ˆä¸­å¼¹å‡ºï¼Œä½¿å¾—ä¸‹ä¸€å¸§å¾—ä»¥æ‰§è¡Œï¼Œä»è€Œå®ç°æ–¹æ³•çš„è¿”å›ã€‚</h2><p> ç±»åˆå§‹åŒ–</p>
<h1 id="ç¬”è®°ï¼š"><a href="#ç¬”è®°ï¼š" class="headerlink" title="ç¬”è®°ï¼š"></a>ç¬”è®°ï¼š</h1><p>1.æœç´¢classæ–‡ä»¶</p>
<p>1.hello worldä¸ºä¾‹ï¼ŒåŠ è½½å‰éœ€è¦åŠ è½½è¶…ç±»<strong>java.lang.Object</strong>ï¼Œåœ¨è°ƒç”¨main()æ–¹æ³•å‰ï¼Œè™šæ‹Ÿæœºéœ€è¦å‡†å¤‡å¥½å‚æ•°æ•°ç»„ï¼ŒåŠ è½½<strong>java.lang.String</strong>å’Œ<strong>java.lang.String[]<strong>ï¼Œæ‰“å°éœ€è¦åŠ è½½</strong>java.lang.System</strong>ç±»ã€‚</p>
<p>2.ç±»è·¯å¾„ï¼šå¯åŠ¨ç±»è·¯å¾„ï¼ˆbootstrap classpathï¼‰jre\libã€</p>
<p>æ‰©å±•ç±»è·¯å¾„ï¼ˆextension classpathï¼‰ jre\lib\extã€</p>
<p>ç”¨æˆ·ç±»è·¯å¾„ï¼ˆuser classpathï¼‰-classpathæˆ–-cpæŒ‡å®šï¼Œä½¿ç”¨ç³»ç»Ÿåˆ†éš”ç¬¦æŒ‡å®šå¤šä¸ªè·¯å¾„ã€‚</p>
<p>2.è§£æclassæ–‡ä»¶</p>
<p>1.classæ–‡ä»¶çš„åŸºæœ¬æ•°æ®å•ä½æ˜¯å­—èŠ‚ï¼Œæ•°æ®åœ¨classæ–‡ä»¶ä¸­ä»¥å¤§ç«¯(big-endian)æ–¹å¼å­˜å‚¨ã€‚</p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>JAVA</tag>
      </tags>
  </entry>
  <entry>
    <title>TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£</title>
    <url>/kcp/</url>
    <content><![CDATA[<div class=".article-gallery"><h1 id="KCP-Nettyçš„ä¸­æ–‡æ³¨è§£ç‰ˆï¼š"><a href="#KCP-Nettyçš„ä¸­æ–‡æ³¨è§£ç‰ˆï¼š" class="headerlink" title="KCP-Nettyçš„ä¸­æ–‡æ³¨è§£ç‰ˆï¼š"></a>KCP-Nettyçš„ä¸­æ–‡æ³¨è§£ç‰ˆï¼š</h1><p><a href="https://github.com/zhangga/kcp-netty">kcp-nettyä¸­æ–‡æ³¨é‡Š</a></p>
<h1 id="KCP-UDTæ¯”è¾ƒï¼š"><a href="#KCP-UDTæ¯”è¾ƒï¼š" class="headerlink" title="KCP/UDTæ¯”è¾ƒï¼š"></a>KCP/UDTæ¯”è¾ƒï¼š</h1><p><a href="https://github.com/libinzhangyuan/asio_kcp">kcp/udt</a></p>
<h1 id="KCP"><a href="#KCP" class="headerlink" title="KCP"></a>KCP</h1><p>ä¼ è¾“å±‚ï¼Œå¯é æ€§ï¼ŒARQåè®®ã€‚</p>
<p>ç›®çš„ï¼šè§£å†³åœ¨ç½‘ç»œæ‹¥å µæƒ…å†µä¸‹tcpåè®®çš„ç½‘ç»œé€Ÿåº¦æ…¢çš„é—®é¢˜ã€‚å¯é æ€§ï¼Œä¼ è¾“é€Ÿåº¦ã€‚</p>
<p>ä¸€èˆ¬ç”¨udpä½œä¸ºä¸‹å±‚ä¼ è¾“åè®®ï¼ŒudpæŠ¥æ–‡+æ§åˆ¶å¤´ã€‚</p>
<p>ä¼ è¾“æ•°æ®å¤§äºmss(æœ€å¤§æŠ¥æ–‡æ®µ)æ—¶ï¼Œkcpå°†æ•°æ®åˆ†ç‰‡å­˜å‚¨åœ¨å¤šä¸ªkcpåŒ…(Segment)ä¸­ã€‚</p>
<span id="more"></span>

<ol>
<li><ol>
<li><strong>æ»‘åŠ¨çª—å£æœºåˆ¶ï¼š</strong>kcpé‡‡ç”¨æ»‘åŠ¨çª—å£æœºåˆ¶æ¥æé«˜å‘é€é€Ÿåº¦ã€‚ç”±äºUDPåœ¨ç½‘ç»œä¸­çš„ä¼ è¾“æ˜¯ä¸å¯é çš„ï¼Œå› æ­¤ä¼šå‡ºç°ä¸¢åŒ…å’ŒåŒ…çš„ä¹±åºã€‚kcpæ˜¯å¯é çš„ä¿è¯æ•°æ®æœ‰åºçš„åè®®ï¼Œæ‰€ä»¥ä¸ºäº†çº æ­£åŒ…çš„ä¹±åºã€‚æ¥æ”¶æ–¹ç»´æŠ¤ä¸€ä¸ªæ¥æ”¶çª—å£ã€‚æ¥æ”¶çª—å£æœ‰ä¸€ä¸ªèµ·å§‹åºå·rcv_nxtä»¥åŠå°¾åºå·rcv_nxt+rcv_wndã€‚å¦‚æœæ¥æ”¶çª—å£æ”¶åˆ°åºå·ä¸ºrcv_nxtçš„åˆ†ç‰‡é‚£ä¹ˆrcv_nxtå°±åŠ ä¸€ï¼Œå½¢è±¡ä¸€ç‚¹çš„è¯´æ³•æ˜¯æ»‘åŠ¨çª—å£å³ç§»,å¹¶æŠŠè¯¥æ•°æ®æ”¾å…¥æ¥æ”¶é˜Ÿåˆ—ä¾›åº”ç”¨å±‚å–ç”¨ã€‚å¦‚æœæ”¶åˆ°çš„æ•°æ®åœ¨çª—å£èŒƒå›´å†…ä½†ä¸æ˜¯rcv_nxté‚£ä¹ˆå°±æŠŠæ•°æ®ä¿å­˜èµ·æ¥,ç­‰æ”¶åˆ°rcv_nxtåºå·çš„åˆ†ç‰‡æ—¶å†ä¸€å¹¶æ”¾å…¥æ¥æ”¶é˜Ÿåˆ—ä¾›åº”ç”¨å±‚å–ç”¨ã€‚</li>
</ol>
</li>
<li><p><strong>å¿«é€Ÿé‡ä¼ æœºåˆ¶ï¼š</strong>æ•°æ®åœ¨ç½‘ç»œä¸­çš„ä¼ è¾“æ—¶é—´æ˜¯ä¸å›ºå®šçš„ï¼Œå› æ­¤è¶…æ—¶é‡ä¼ æ—¶é—´æ¯”è¾ƒé•¿ã€‚è€Œä¸ºäº†å°½æ—©åœ°åˆ¤æ–­å‡ºæ•°æ®åŒ…çš„ä¸¢å¤±ï¼Œkcpå¼•å…¥äº†å¿«é€Ÿé‡ä¼ æœºåˆ¶ã€‚å¿«é€Ÿé‡ä¼ æœºåˆ¶å·¥ä½œåŸç†æ˜¯ï¼Œå½“å‘é€æ–¹å‘é€äº†n,n+1,n+2â€¦ç­‰ç­‰åŒ…å‡ºå»åï¼Œæ¥æ”¶æ–¹æ²¡æœ‰æ¥æ”¶åˆ°n,è€Œæ¥æ”¶åˆ°n+1,n+2..ç­‰ç­‰nå·åŒ…ä¹‹åçš„åŒ…ï¼Œè¿™æ—¶å› ä¸ºnå·åŒ…ä¹‹åçš„åŒ…éƒ½å·²ç»æ¥æ”¶åˆ°äº†ï¼Œè€Œnå·åŒ…è¿˜æ²¡æœ‰æ¥æ”¶åˆ°ï¼Œæ‰€ä»¥å¯ä»¥è®¤ä¸ºnå·åŒ…å·²ç»ä¸¢å¤±äº†ï¼Œå‘ŠçŸ¥å‘é€æ–¹å¯ä»¥è¿›è¡Œå¿«é€Ÿé‡ä¼ ã€‚kcpä¸ºäº†æ”¯æŒå¿«é€Ÿé‡ä¼ ï¼Œæ¥æ”¶æ–¹éœ€è¦å‘Šè¯‰å‘é€æ–¹ï¼Œå“ªäº›åŒ…å·²ç»æˆåŠŸæ”¶åˆ°äº†ï¼Œå“ªäº›åŒ…æ²¡æœ‰æ”¶åˆ°ã€‚å› æ­¤æ¥æ”¶æ–¹è¿”å›å‘é€æ–¹çš„ç¡®è®¤æ•°æ®ï¼ˆackï¼‰ä¸­åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼šæ¥æ”¶çª—å£å·¦ç«¯çš„åºå·rcv_nxt,æ¥æ”¶åˆ°çš„å¤§äºrcv_nxtçš„åŒ…åºå·snã€‚rcv_nxtçš„å«ä¹‰æ˜¯æ¥æ”¶æ–¹å·²ç»æˆåŠŸæŒ‰é¡ºåºæ¥æ”¶äº†rcv_nxtåºå·ä¹‹å‰çš„æ‰€æœ‰åŒ…,å¤§äºrcv_nxtçš„åºå·snè¡¨ç¤ºçš„æ˜¯åœ¨æ¥æ”¶çª—å£å†…çš„ä¸è¿ç»­çš„åŒ…ã€‚å‘é€æ–¹æ¥æ”¶åˆ°æ¥æ”¶æ–¹å‘è¿‡æ¥çš„æ•°æ®æ—¶ï¼Œé¦–å…ˆè§£ærcv_nxtï¼ŒæŠŠå‘é€ç¼“å­˜ä¸­æ‰€æœ‰å°äºrcv_nxtåºå·çš„åŒ…å…¨éƒ¨ç§»é™¤æ‰ï¼ˆå› ä¸ºè¿™äº›åŒ…å…¨éƒ½éƒ½å·²ç»æ­£ç¡®æ¥æ”¶äº†ï¼‰ã€‚ç„¶åå†è§£æsn,éå†å‘é€ç¼“å­˜ï¼Œæ‰¾åˆ°æ‰€æœ‰åºå·å°äºsnçš„åŒ…ï¼Œè¿™äº›åŒ…å°±æ˜¯å¯èƒ½åœ¨ç½‘ç»œä¸­å·²ç»ä¸¢æ‰äº†çš„åŒ…,åªæ˜¯å¯èƒ½ï¼Œå› ä¸ºæœ‰å¯èƒ½è¿™äº›åŒ…åªæ˜¯æ‹¥å µåœ¨äº†ç½‘ç»œä¸­ï¼Œéœ€è¦æ›´é•¿çš„æ—¶é—´åˆ°è¾¾ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬è®¾ç½®ä¸€ä¸ªå¿«é€Ÿé‡ä¼ çš„é—¨é™ï¼Œå¯¹æ¯ä¸ªåˆ†ç‰‡ç»´æŠ¤ä¸€ä¸ªå¿«é€Ÿé‡ä¼ çš„è®¡æ•°ï¼Œæ¯æ”¶åˆ°ä¸€ä¸ªackè§£æsnåæ‰¾åˆ°äº†ä¸€ä¸ªåˆ†ç‰‡ï¼Œå°±æŠŠè¯¥åˆ†ç‰‡çš„å¿«é€Ÿé‡ä¼ çš„è®¡æ•°åŠ ä¸€ï¼Œå¦‚æœè¯¥è®¡æ•°è¾¾åˆ°äº†å¿«é€Ÿé‡ä¼ é—¨é™ï¼Œé‚£ä¹ˆå°±è®¤ä¸ºè¯¥åˆ†ç‰‡å·²ç»ä¸¢å¤±ï¼Œå¯ä»¥è§¦å‘å¿«é€Ÿé‡ä¼ ï¼Œè¯¥é—¨é™å€¼åœ¨kcpä¸­å¯ä»¥è®¾ç½®ï¼Œtcpä¸­æ˜¯3ã€‚</p>
</li>
<li><p><strong>é€‰æ‹©é‡ä¼ æœºåˆ¶ï¼š</strong>é€‰æ‹©é‡ä¼ çš„å…³é”®åœ¨äºæ¥æ”¶æ–¹è¦å‘ŠçŸ¥å‘é€æ–¹å“ªäº›åŒ…å·²ç»æ”¶åˆ°äº†ï¼Œå“ªäº›åŒ…æ²¡æœ‰æ”¶åˆ°ï¼Œä¸ºäº†æœ€å°åŒ–æ•°æ®é‡ï¼Œæ¥æ”¶æ–¹å¯ä»¥å‘Šè¯‰å‘é€æ–¹å“ªäº›åŒ…å·²ç»æŒ‰åºæ”¶åˆ°äº†ï¼Œå“ªäº›åŒ…æ˜¯æ”¶åˆ°çš„ä½†æ˜¯ä¸è¿ç»­ã€‚æ‰€ä»¥è¿”å›çš„ackä¸­åŒ…å«rcv_nxtå’Œsnã€‚rcv_nxtä»£è¡¨æ”¶åˆ°çš„æ‰€æœ‰è¿ç»­çš„åŒ…ï¼Œsnä»£è¡¨å“ªäº›ä¸è¿ç»­çš„åŒ…æ”¶åˆ°äº†ï¼Œé‚£ä¹ˆæ ¹æ®è¿™ä¸¤ä¸ªå‚æ•°å¯ä»¥è®¡ç®—å‡ºæ¥æ²¡æœ‰æ”¶åˆ°çš„åŒ…çš„åºå·ã€‚</p>
</li>
<li><p><strong>æ‹¥å¡æ§åˆ¶ï¼š</strong>æ‹¥å¡æ§åˆ¶å°±æ˜¯å‘Šè¯‰å‘é€æ–¹ï¼Œç½‘ç»œå¤ªå µäº†ï¼Œåº”è¯¥å°‘å‘ä¸€äº›æ•°æ®ï¼Œå› æ­¤åœ¨æ»‘åŠ¨çª—å£çš„æœºåˆ¶ä¸Šå¼•å…¥äº†æ‹¥å¡çª—å£ï¼Œä¹Ÿå°±æ˜¯è¯´å‘é€å‘å‘é€çš„æ•°æ®ä¸å¾—è¶…è¿‡æ‹¥å¡çª—å£ï¼Œæ‹¥å¡çª—å£çš„å¤§å°ä¼šéšç½‘ç»œæƒ…å†µè€Œå˜å¿«ï¼Œç½‘ç»œå¿«æ‹¥å¡çª—å£å°±å¤§ï¼Œåä¹‹åŒç†ã€‚æ‹¥å¡çª—å£çš„å¤§å°æ§åˆ¶ä½¿ç”¨æ…¢å¯åŠ¨æœºåˆ¶ï¼Œå…·ä½“å‚è€ƒTCPã€‚</p>
</li>
</ol>
<p>åº”ç”¨ï¼škcpé‡‡å–ä¸€ç³»åˆ—æªæ–½å°½é‡æé«˜ç½‘ç»œä¼ è¾“é€Ÿç‡ï¼Œåœ¨ç½‘ç»œå®æ—¶æ€§å’Œå¯é æ€§è¦æ±‚æ¯”è¾ƒé«˜çš„åœºæ™¯ä¸‹å¯ä»¥è€ƒè™‘kcpåè®®ä»£æ›¿tcpåè®®ã€‚</p>
<p>åè¯è¯´æ˜ï¼ˆæºç å­—æ®µï¼‰ï¼š<br>ç”¨æˆ·æ•°æ®ï¼šåº”ç”¨å±‚å‘é€çš„æ•°æ®ï¼Œå¦‚ä¸€å¼ å›¾ç‰‡2Kbçš„æ•°æ®<br>MTUï¼šæœ€å¤§ä¼ è¾“å•å…ƒã€‚å³æ¯æ¬¡å‘é€çš„æœ€å¤§æ•°æ®<br>RTOï¼šRetransmission TimeOutï¼Œé‡ä¼ è¶…æ—¶æ—¶é—´ã€‚<br>cwnd:congestion windowï¼Œæ‹¥å¡çª—å£ï¼Œè¡¨ç¤ºå‘é€æ–¹å¯å‘é€å¤šå°‘ä¸ªKCPæ•°æ®åŒ…ã€‚ä¸æ¥æ”¶æ–¹çª—å£æœ‰å…³ï¼Œä¸ç½‘ç»œçŠ¶å†µï¼ˆæ‹¥å¡æ§åˆ¶ï¼‰æœ‰å…³ï¼Œä¸å‘é€çª—å£å¤§å°æœ‰å…³ã€‚<br>rwnd:receiver window,æ¥æ”¶æ–¹çª—å£å¤§å°ï¼Œè¡¨ç¤ºæ¥æ”¶æ–¹è¿˜å¯æ¥æ”¶å¤šå°‘ä¸ªKCPæ•°æ®åŒ…<br>snd_queue:å¾…å‘é€KCPæ•°æ®åŒ…é˜Ÿåˆ—<br>snd_nxt:ä¸‹ä¸€ä¸ªå³å°†å‘é€çš„kcpæ•°æ®åŒ…åºåˆ—å·<br>snd_una:ä¸‹ä¸€ä¸ªå¾…ç¡®è®¤çš„åºåˆ—å·</p>
<p><a href="https://i1.wp.com/192.144.167.243/blog/wp-content/uploads/1.png?resize=640,467" title="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬1å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i1.wp.com/192.144.167.243/blog/wp-content/uploads/1.png?resize=640,467" alt="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬1å¼   | å¼ å˜"></a></p>
<p><a href="https://i1.wp.com/192.144.167.243/blog/wp-content/uploads/2.png?resize=640,351" title="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬2å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i1.wp.com/192.144.167.243/blog/wp-content/uploads/2.png?resize=640,351" alt="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬2å¼   | å¼ å˜"></a></p>
<p>[ KCP å‘é€è¿‡ç¨‹ ]</p>
<p><a href="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/3.jpg?resize=485,296" title="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬3å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/3.jpg?resize=485,296" alt="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬3å¼   | å¼ å˜"></a></p>
<p>[ RTOç®—æ³•å¯¹æ¯”å›¾ ]</p>
<p>KCPçš„æ¥æ”¶è¿‡ç¨‹æ˜¯å°†UDPæ”¶åˆ°çš„æ•°æ®è¿›è¡Œè§£åŒ…ï¼Œé‡æ–°ç»„è£…é¡ºåºçš„ã€å¯é çš„æ•°æ®åäº¤ä»˜ç»™ç”¨æˆ·ã€‚</p>
<p><a href="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/4.png?resize=365,353" title="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬4å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/4.png?resize=365,353" alt="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬4å¼   | å¼ å˜"></a></p>
<p><strong>rcv_queueçš„æ•°æ®æ˜¯è¿ç»­çš„ï¼Œrcv_bufå¯èƒ½æ˜¯é—´éš”çš„</strong></p>
<p><a href="https://i0.wp.com/192.144.167.243/blog/wp-content/uploads/5.png?resize=355,448" title="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬5å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/192.144.167.243/blog/wp-content/uploads/5.png?resize=355,448" alt="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬5å¼   | å¼ å˜"></a></p>
<p><a href="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/6.png?resize=466,424" title="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬6å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/6.png?resize=466,424" alt="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬6å¼   | å¼ å˜"></a></p>
<p>[ æ•°æ®ç¡®è®¤åŒ…å¤„ç†æµç¨‹ ]</p>
<p><a href="https://i1.wp.com/192.144.167.243/blog/wp-content/uploads/7.png?resize=574,403" title="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬7å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i1.wp.com/192.144.167.243/blog/wp-content/uploads/7.png?resize=574,403" alt="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬7å¼   | å¼ å˜"></a></p>
<p>[ KCPå¿«é€Ÿç¡®è®¤ ]</p>
<p><strong>æ€»ç»“ï¼šTCPå¯é ç®€å•ï¼Œä½†æ˜¯å¤æ‚æ— ç§ï¼Œæ‰€ä»¥é€Ÿåº¦æ…¢ã€‚KCPå°½å¯èƒ½ä¿ç•™UDPå¿«çš„ç‰¹ç‚¹ä¸‹ï¼Œä¿è¯å¯é ã€‚</strong></p>
<p><a href="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/992994-20180616162318524-660296383.jpg?resize=640,323" title="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬8å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/992994-20180616162318524-660296383.jpg?resize=640,323" alt="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬8å¼   | å¼ å˜"></a></p>
<p>æ€»ç»“ï¼šUDPæ”¶åˆ°çš„åŒ…ï¼Œä¸æ–­é€šè¿‡kcp_inputå–‚ç»™KCPï¼ŒKCPä¼šå¯¹è¿™éƒ¨åˆ†æ•°æ®ï¼ˆKCPåè®®æ•°æ®ï¼‰è¿›è¡Œè§£åŒ…ï¼Œé‡æ–°å°è£…æˆåº”ç”¨å±‚ç”¨æˆ·æ•°æ®ï¼Œåº”ç”¨å±‚é€šè¿‡kcp_recvè·å–ã€‚åº”ç”¨å±‚é€šè¿‡kcp_sendå‘é€æ•°æ®ï¼ŒKCPä¼šæŠŠç”¨æˆ·æ•°æ®æ‹†åˆ†kcpæ•°æ®åŒ…ï¼Œé€šè¿‡kcp_outputï¼Œä»¥UDPï¼ˆsendï¼‰çš„æ–¹å¼å‘é€ã€‚</p>
<p><strong>KCPçš„é…ç½®æ¨¡å¼</strong></p>
<p>\1. å·¥ä½œæ¨¡å¼ï¼š</p>
<blockquote>
<p>int ikcp_nodelay(ikcpcb *kcp, int nodelay, int interval, int resend, int nc)</p>
</blockquote>
<ul>
<li>nodelay ï¼šæ˜¯å¦å¯ç”¨ nodelayæ¨¡å¼ï¼Œ0ä¸å¯ç”¨ï¼›1å¯ç”¨ã€‚</li>
<li>interval ï¼šåè®®å†…éƒ¨å·¥ä½œçš„ intervalï¼Œå•ä½æ¯«ç§’ï¼Œæ¯”å¦‚ 10msæˆ–è€… 20ms</li>
<li>resend ï¼šå¿«é€Ÿé‡ä¼ æ¨¡å¼ï¼Œé»˜è®¤0å…³é—­ï¼Œå¯ä»¥è®¾ç½®2ï¼ˆ2æ¬¡ACKè·¨è¶Šå°†ä¼šç›´æ¥é‡ä¼ ï¼‰</li>
<li>nc ï¼šæ˜¯å¦å…³é—­æµæ§ï¼Œé»˜è®¤æ˜¯0ä»£è¡¨ä¸å…³é—­ï¼Œ1ä»£è¡¨å…³é—­ã€‚</li>
</ul>
<p><strong>æ™®é€šæ¨¡å¼ï¼š</strong> ikcp_nodelay(kcp, 0, 40, 0, 0);</p>
<p><strong>æé€Ÿæ¨¡å¼ï¼š</strong> ikcp_nodelay(kcp, 1, 10, 2, 1)</p>
<p>\1. æœ€å¤§çª—å£</p>
<blockquote>
<p>int ikcp_wndsize(ikcpcb *kcp, int sndwnd, int rcvwnd);</p>
</blockquote>
<p>è¯¥è°ƒç”¨å°†ä¼šè®¾ç½®åè®®çš„æœ€å¤§å‘é€çª—å£å’Œæœ€å¤§æ¥æ”¶çª—å£å¤§å°ï¼Œé»˜è®¤ä¸º32. è¿™ä¸ªå¯ä»¥ç†è§£ä¸º TCPçš„ SND_BUF å’Œ RCV_BUFï¼Œåªä¸è¿‡å•ä½ä¸ä¸€æ · SND/RCV_BUF å•ä½æ˜¯å­—èŠ‚ï¼Œè¿™ä¸ªå•ä½æ˜¯åŒ…ã€‚</p>
<p>\2. æœ€å¤§ä¼ è¾“å•å…ƒï¼š</p>
<p>çº¯ç®—æ³•åè®®å¹¶ä¸è´Ÿè´£æ¢æµ‹ MTUï¼Œé»˜è®¤ mtuæ˜¯1400å­—èŠ‚ï¼Œå¯ä»¥ä½¿ç”¨ikcp_setmtuæ¥è®¾ç½®è¯¥å€¼ã€‚è¯¥å€¼å°†ä¼šå½±å“æ•°æ®åŒ…å½’å¹¶åŠåˆ†ç‰‡æ—¶å€™çš„æœ€å¤§ä¼ è¾“å•å…ƒã€‚</p>
<p>\3. æœ€å°RTOï¼š</p>
<p>ä¸ç®¡æ˜¯ TCPè¿˜æ˜¯ KCPè®¡ç®— RTOæ—¶éƒ½æœ‰æœ€å° RTOçš„é™åˆ¶ï¼Œå³ä¾¿è®¡ç®—å‡ºæ¥RTOä¸º40msï¼Œç”±äºé»˜è®¤çš„ RTOæ˜¯100msï¼Œåè®®åªæœ‰åœ¨100msåæ‰èƒ½æ£€æµ‹åˆ°ä¸¢åŒ…ï¼Œå¿«é€Ÿæ¨¡å¼ä¸‹ä¸º30msï¼Œå¯ä»¥æ‰‹åŠ¨æ›´æ”¹è¯¥å€¼ï¼š<br>kcp-&gt;rx_minrto = 10;</p>
<p>KCPåŸç†è§ï¼š<a href="https://www.cnblogs.com/wetest/p/9190786.html">KCPåŸç†</a></p>
<h1 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h1><h3 id="ç‰¹æ€§ï¼š"><a href="#ç‰¹æ€§ï¼š" class="headerlink" title="ç‰¹æ€§ï¼š"></a>ç‰¹æ€§ï¼š</h3><p>1.ä¸ºæµé‡è®¾è®¡ï¼ˆKBæ•°æ®/ç§’ï¼‰ï¼Œå……åˆ†åˆ©ç”¨å®½å¸¦ã€‚</p>
<p>2.å®‰å…¨å¯é ï¼Œä¸¢åŒ…å…¨éƒ¨é‡ä¼ ã€‚</p>
<p>3.è¶…æ—¶ = RTO * 2ã€‚</p>
<p>4.å»¶è¿ŸACKï¼Œå……åˆ†åˆ©ç”¨å®½å¸¦ã€‚</p>
<h4 id="UNA-vs-ACK-UNAï¼š"><a href="#UNA-vs-ACK-UNAï¼š" class="headerlink" title="UNA vs ACK+UNAï¼š"></a>UNA vs ACK+UNAï¼š</h4><p>ARQæ¨¡å‹å“åº”æœ‰ä¸¤ç§ï¼ŒUNAï¼ˆæ­¤ç¼–å·å‰æ‰€æœ‰åŒ…å·²æ”¶åˆ°ï¼Œå¦‚TCPï¼‰å’ŒACKï¼ˆè¯¥ç¼–å·åŒ…å·²æ”¶åˆ°  ï¼‰ï¼Œå…‰ç”¨UNAå°†å¯¼è‡´å…¨éƒ¨é‡ä¼ ï¼Œå…‰ç”¨ACKåˆ™ä¸¢å¤±æˆæœ¬å¤ªé«˜ï¼Œä»¥å¾€åè®®éƒ½æ˜¯äºŒé€‰å…¶ä¸€ï¼Œè€Œ  KCPåè®®ä¸­ï¼Œé™¤å»å•ç‹¬çš„ ACKåŒ…å¤–ï¼Œæ‰€æœ‰åŒ…éƒ½æœ‰UNAä¿¡æ¯ã€‚</p>
<h3 id="æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼šç›®æ ‡ï¼šå…¬å¹³å æœ‰å®½å¸¦çš„å‰æä¸‹ï¼Œæ— é™åº¦æé«˜å®½å¸¦çš„åˆ©ç”¨ç‡ã€‚"><a href="#æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼šç›®æ ‡ï¼šå…¬å¹³å æœ‰å®½å¸¦çš„å‰æä¸‹ï¼Œæ— é™åº¦æé«˜å®½å¸¦çš„åˆ©ç”¨ç‡ã€‚" class="headerlink" title="æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼šç›®æ ‡ï¼šå…¬å¹³å æœ‰å®½å¸¦çš„å‰æä¸‹ï¼Œæ— é™åº¦æé«˜å®½å¸¦çš„åˆ©ç”¨ç‡ã€‚"></a>æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼šç›®æ ‡ï¼šå…¬å¹³å æœ‰å®½å¸¦çš„å‰æä¸‹ï¼Œæ— é™åº¦æé«˜å®½å¸¦çš„åˆ©ç”¨ç‡ã€‚</h3><p><strong>æ…¢å¼€å§‹ç®—æ³•</strong>ï¼šå½“ä¸»æœºå¼€å§‹å‘é€æ•°æ®æ—¶ï¼Œå¦‚æœç«‹å³æ‰€å¤§é‡æ•°æ®å­—èŠ‚æ³¨å…¥åˆ°ç½‘ç»œï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½å¼•èµ·ç½‘ç»œæ‹¥å¡ï¼Œå› ä¸ºç°åœ¨å¹¶ä¸æ¸…æ¥šç½‘ç»œçš„è´Ÿè·æƒ…å†µã€‚å› æ­¤ï¼Œè¾ƒå¥½çš„æ–¹æ³•æ˜¯ å…ˆæ¢æµ‹ä¸€ä¸‹ï¼Œå³ç”±å°åˆ°å¤§é€æ¸å¢å¤§å‘é€çª—å£ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç”±å°åˆ°å¤§é€æ¸å¢å¤§æ‹¥å¡çª—å£æ•°å€¼ã€‚é€šå¸¸åœ¨åˆšåˆšå¼€å§‹å‘é€æŠ¥æ–‡æ®µæ—¶ï¼Œå…ˆæŠŠæ‹¥å¡çª—å£ cwnd è®¾ç½®ä¸ºä¸€ä¸ªæœ€å¤§æŠ¥æ–‡æ®µMSSçš„æ•°å€¼ã€‚è€Œåœ¨æ¯æ”¶åˆ°ä¸€ä¸ªå¯¹æ–°çš„æŠ¥æ–‡æ®µçš„ç¡®è®¤åï¼ŒæŠŠæ‹¥å¡çª—å£å¢åŠ è‡³å¤šä¸€ä¸ªMSSçš„æ•°å€¼ã€‚ç”¨è¿™æ ·çš„æ–¹æ³•é€æ­¥å¢å¤§å‘é€æ–¹çš„æ‹¥å¡çª—å£ cwnd ï¼Œå¯ä»¥ä½¿åˆ†ç»„æ³¨å…¥åˆ°ç½‘ç»œçš„é€Ÿç‡æ›´åŠ åˆç†ã€‚</p>
<p><a href="https://i1.wp.com/192.144.167.243/blog/wp-content/uploads/2010101120451114.jpg?resize=499,305" title="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬9å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i1.wp.com/192.144.167.243/blog/wp-content/uploads/2010101120451114.jpg?resize=499,305" alt="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬9å¼   | å¼ å˜"></a></p>
<p>æ¯ç»è¿‡ä¸€ä¸ªä¼ è¾“è½®æ¬¡ï¼Œæ‹¥å¡çª—å£ cwnd å°±åŠ å€ã€‚ä¸€ä¸ªä¼ è¾“è½®æ¬¡æ‰€ç»å†çš„æ—¶é—´å…¶å®å°±æ˜¯å¾€è¿”æ—¶é—´RTTã€‚ä¸è¿‡â€œä¼ è¾“è½®æ¬¡â€æ›´åŠ å¼ºè°ƒï¼šæŠŠæ‹¥å¡çª—å£cwndæ‰€å…è®¸å‘é€çš„æŠ¥æ–‡æ®µéƒ½è¿ç»­å‘é€å‡ºå»ï¼Œå¹¶æ”¶åˆ°äº†å¯¹å·²å‘é€çš„æœ€åä¸€ä¸ªå­—èŠ‚çš„ç¡®è®¤ã€‚</p>
<p>å¦ï¼Œæ…¢å¼€å§‹çš„â€œæ…¢â€å¹¶ä¸æ˜¯æŒ‡cwndçš„å¢é•¿é€Ÿç‡æ…¢ï¼Œè€Œæ˜¯æŒ‡åœ¨TCPå¼€å§‹å‘é€æŠ¥æ–‡æ®µæ—¶å…ˆè®¾ç½®cwnd=1ï¼Œä½¿å¾—å‘é€æ–¹åœ¨å¼€å§‹æ—¶åªå‘é€ä¸€ä¸ªæŠ¥æ–‡æ®µï¼ˆç›®çš„æ˜¯è¯•æ¢ä¸€ä¸‹ç½‘ç»œçš„æ‹¥å¡æƒ…å†µï¼‰ï¼Œç„¶åå†é€æ¸å¢å¤§cwndã€‚</p>
<p>ä¸ºäº†é˜²æ­¢æ‹¥å¡çª—å£cwndå¢é•¿è¿‡å¤§å¼•èµ·ç½‘ç»œæ‹¥å¡ï¼Œè¿˜éœ€è¦è®¾ç½®ä¸€ä¸ªæ…¢å¼€å§‹é—¨é™ssthreshçŠ¶æ€å˜é‡ï¼ˆå¦‚ä½•è®¾ç½®ssthreshï¼‰ã€‚æ…¢å¼€å§‹é—¨é™ssthreshçš„ç”¨æ³•å¦‚ä¸‹ï¼š</p>
<p>å½“ cwnd &lt; ssthresh æ—¶ï¼Œä½¿ç”¨ä¸Šè¿°çš„æ…¢å¼€å§‹ç®—æ³•ã€‚</p>
<p>å½“ cwnd &gt; ssthresh æ—¶ï¼Œåœæ­¢ä½¿ç”¨æ…¢å¼€å§‹ç®—æ³•è€Œæ”¹ç”¨æ‹¥å¡é¿å…ç®—æ³•ã€‚</p>
<p>å½“ cwnd = ssthresh æ—¶ï¼Œæ—¢å¯ä½¿ç”¨æ…¢å¼€å§‹ç®—æ³•ï¼Œä¹Ÿå¯ä½¿ç”¨æ‹¥å¡æ§åˆ¶é¿å…ç®—æ³•ã€‚</p>
<p>æ‹¥å¡é¿å…ç®—æ³•ï¼šè®©æ‹¥å¡çª—å£cwndç¼“æ…¢åœ°å¢å¤§ï¼Œå³æ¯ç»è¿‡ä¸€ä¸ªå¾€è¿”æ—¶é—´RTTå°±æŠŠå‘é€æ–¹çš„æ‹¥å¡çª—å£cwndåŠ 1ï¼Œè€Œä¸æ˜¯åŠ å€ã€‚è¿™æ ·æ‹¥å¡çª—å£cwndæŒ‰çº¿æ€§è§„å¾‹ç¼“æ…¢å¢é•¿ï¼Œæ¯”æ…¢å¼€å§‹ç®—æ³•çš„æ‹¥å¡çª—å£å¢é•¿é€Ÿç‡ç¼“æ…¢å¾—å¤šã€‚</p>
<p>æ— è®ºåœ¨æ…¢å¼€å§‹é˜¶æ®µè¿˜æ˜¯åœ¨æ‹¥å¡é¿å…é˜¶æ®µï¼Œåªè¦å‘é€æ–¹åˆ¤æ–­ç½‘ç»œå‡ºç°æ‹¥å¡ï¼ˆå…¶æ ¹æ®å°±æ˜¯æ²¡æœ‰æ”¶åˆ°ç¡®è®¤ï¼‰ï¼Œå°±è¦æŠŠæ…¢å¼€å§‹é—¨é™ssthreshè®¾ç½®ä¸ºå‡ºç°æ‹¥å¡æ—¶çš„å‘é€ æ–¹çª—å£å€¼çš„ä¸€åŠï¼ˆä½†ä¸èƒ½å°äº2ï¼‰ã€‚ç„¶åæŠŠæ‹¥å¡çª—å£cwndé‡æ–°è®¾ç½®ä¸º1ï¼Œæ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ã€‚è¿™æ ·åšçš„ç›®çš„å°±æ˜¯è¦è¿…é€Ÿå‡å°‘ä¸»æœºå‘é€åˆ°ç½‘ç»œä¸­çš„åˆ†ç»„æ•°ï¼Œä½¿å¾—å‘ç”Ÿ æ‹¥å¡çš„è·¯ç”±å™¨æœ‰è¶³å¤Ÿæ—¶é—´æŠŠé˜Ÿåˆ—ä¸­ç§¯å‹çš„åˆ†ç»„å¤„ç†å®Œæ¯•ã€‚</p>
<p>å¦‚ä¸‹å›¾ï¼Œç”¨å…·ä½“æ•°å€¼è¯´æ˜äº†ä¸Šè¿°æ‹¥å¡æ§åˆ¶çš„è¿‡ç¨‹ã€‚ç°åœ¨å‘é€çª—å£çš„å¤§å°å’Œæ‹¥å¡çª—å£ä¸€æ ·å¤§ã€‚</p>
<p><a href="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/2010101120591634.jpg?resize=570,306" title="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬10å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/2010101120591634.jpg?resize=570,306" alt="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬10å¼   | å¼ å˜"></a></p>
<p>&lt;1&gt;. å½“TCPè¿æ¥è¿›è¡Œåˆå§‹åŒ–æ—¶ï¼ŒæŠŠæ‹¥å¡çª—å£cwndç½®ä¸º1ã€‚å‰é¢å·²è¯´è¿‡ï¼Œä¸ºäº†ä¾¿äºç†è§£ï¼Œå›¾ä¸­çš„çª—å£å•ä½ä¸ä½¿ç”¨å­—èŠ‚è€Œä½¿ç”¨æŠ¥æ–‡æ®µçš„ä¸ªæ•°ã€‚æ…¢å¼€å§‹é—¨é™çš„åˆå§‹å€¼è®¾ç½®ä¸º16ä¸ªæŠ¥æ–‡æ®µï¼Œå³ cwnd = 16 ã€‚</p>
<p>&lt;2&gt;. åœ¨æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•æ—¶ï¼Œæ‹¥å¡çª—å£ cwnd çš„åˆå§‹å€¼ä¸º1ã€‚ä»¥åå‘é€æ–¹æ¯æ”¶åˆ°ä¸€ä¸ªå¯¹æ–°æŠ¥æ–‡æ®µçš„ç¡®è®¤ACKï¼Œå°±æŠŠæ‹¥å¡çª—å£å€¼å¦1ï¼Œç„¶åå¼€å§‹ä¸‹ä¸€è½®çš„ä¼ è¾“ï¼ˆå›¾ä¸­æ¨ªåæ ‡ä¸ºä¼ è¾“è½®æ¬¡ï¼‰ã€‚å› æ­¤æ‹¥å¡çª—å£cwnd éšç€ä¼ è¾“è½®æ¬¡æŒ‰æŒ‡æ•°è§„å¾‹å¢é•¿ã€‚å½“æ‹¥å¡çª—å£cwndå¢é•¿åˆ°æ…¢å¼€å§‹é—¨é™å€¼ssthreshæ—¶ï¼ˆå³å½“cwnd=16æ—¶ï¼‰ï¼Œå°±æ”¹ä¸ºæ‰§è¡Œæ‹¥å¡æ§åˆ¶ç®—æ³•ï¼Œæ‹¥å¡çª—å£æŒ‰çº¿ æ€§è§„å¾‹å¢é•¿ã€‚</p>
<p>&lt;3&gt;. å‡å®šæ‹¥å¡çª—å£çš„æ•°å€¼å¢é•¿åˆ°24æ—¶ï¼Œç½‘ç»œå‡ºç°è¶…æ—¶ï¼ˆè¿™å¾ˆå¯èƒ½å°±æ˜¯ç½‘ç»œå‘ç”Ÿæ‹¥å¡äº†ï¼‰ã€‚æ›´æ–°åçš„ssthreshå€¼å˜ä¸º12ï¼ˆå³å˜ä¸ºå‡ºç°è¶…æ—¶æ—¶çš„æ‹¥å¡çª—å£æ•°å€¼ 24çš„ä¸€åŠï¼‰ï¼Œæ‹¥å¡çª—å£å†é‡æ–°è®¾ç½®ä¸º1ï¼Œå¹¶æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ã€‚å½“cwnd=ssthresh=12æ—¶æ”¹ä¸ºæ‰§è¡Œæ‹¥å¡é¿å…ç®—æ³•ï¼Œæ‹¥å¡çª—å£æŒ‰çº¿æ€§è§„å¾‹å¢é•¿ï¼Œæ¯ç»è¿‡ ä¸€ä¸ªå¾€è¿”æ—¶é—´å¢åŠ ä¸€ä¸ªMSSçš„å¤§å°ã€‚</p>
<p>å¼ºè°ƒï¼šâ€œæ‹¥å¡é¿å…â€å¹¶éæŒ‡å®Œå…¨èƒ½å¤Ÿé¿å…äº†æ‹¥å¡ã€‚åˆ©ç”¨ä»¥ä¸Šçš„æªæ–½è¦å®Œå…¨é¿å…ç½‘ç»œæ‹¥å¡è¿˜æ˜¯ä¸å¯èƒ½çš„ã€‚â€œæ‹¥å¡é¿å…â€æ˜¯è¯´åœ¨æ‹¥å¡é¿å…é˜¶æ®µå°†æ‹¥å¡çª—å£æ§åˆ¶ä¸ºæŒ‰çº¿æ€§è§„å¾‹å¢é•¿ï¼Œ<strong>ä½¿ç½‘ç»œæ¯”è¾ƒä¸å®¹æ˜“å‡ºç°æ‹¥å¡ã€‚</strong></p>
<h3 id="å¿«é‡ä¼ å’Œå¿«æ¢å¤ç®—æ³•ï¼š"><a href="#å¿«é‡ä¼ å’Œå¿«æ¢å¤ç®—æ³•ï¼š" class="headerlink" title="å¿«é‡ä¼ å’Œå¿«æ¢å¤ç®—æ³•ï¼š"></a>å¿«é‡ä¼ å’Œå¿«æ¢å¤ç®—æ³•ï¼š</h3><p>å¦‚æœå‘é€æ–¹è®¾ç½®çš„è¶…æ—¶è®¡æ—¶å™¨æ—¶é™å·²åˆ°ä½†è¿˜æ²¡æœ‰æ”¶åˆ°ç¡®è®¤ï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½æ˜¯ç½‘ç»œå‡ºç°äº†æ‹¥å¡ï¼Œè‡´ä½¿æŠ¥æ–‡æ®µåœ¨ç½‘ç»œä¸­çš„æŸå¤„è¢«ä¸¢å¼ƒã€‚è¿™æ—¶ï¼ŒTCPé©¬ä¸ŠæŠŠæ‹¥å¡çª—å£ cwnd å‡å°åˆ°1ï¼Œå¹¶æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ï¼ŒåŒæ—¶æŠŠæ…¢å¼€å§‹é—¨é™å€¼ssthreshå‡åŠã€‚è¿™æ˜¯ä¸ä½¿ç”¨å¿«é‡ä¼ çš„æƒ…å†µã€‚</p>
<p>å¿«é‡ä¼ ç®—æ³•é¦–å…ˆè¦æ±‚æ¥æ”¶æ–¹æ¯æ”¶åˆ°ä¸€ä¸ªå¤±åºçš„æŠ¥æ–‡æ®µåå°±ç«‹å³å‘å‡ºé‡å¤ç¡®è®¤ï¼ˆä¸ºçš„æ˜¯ä½¿å‘é€æ–¹åŠæ—©çŸ¥é“æœ‰æŠ¥æ–‡æ®µæ²¡æœ‰åˆ°è¾¾å¯¹æ–¹ï¼‰è€Œä¸è¦ç­‰åˆ°è‡ªå·±å‘é€æ•°æ®æ—¶æ‰è¿›è¡Œæå¸¦ç¡®è®¤ã€‚</p>
<p><a href="https://i0.wp.com/192.144.167.243/blog/wp-content/uploads/2010101122524670.jpg?resize=492,276" title="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬11å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/192.144.167.243/blog/wp-content/uploads/2010101122524670.jpg?resize=492,276" alt="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬11å¼   | å¼ å˜"></a></p>
<p>æ¥æ”¶æ–¹æ”¶åˆ°äº†M1å’ŒM2åéƒ½åˆ†åˆ«å‘å‡ºäº†ç¡®è®¤ã€‚ç°åœ¨å‡å®šæ¥æ”¶æ–¹æ²¡æœ‰æ”¶åˆ°M3ä½†æ¥ç€æ”¶åˆ°äº†M4ã€‚æ˜¾ç„¶ï¼Œæ¥æ”¶æ–¹ä¸èƒ½ç¡®è®¤M4ï¼Œå› ä¸ºM4æ˜¯æ”¶åˆ°çš„å¤±åºæŠ¥æ–‡æ®µã€‚æ ¹æ® å¯é ä¼ è¾“åŸç†ï¼Œæ¥æ”¶æ–¹å¯ä»¥ä»€ä¹ˆéƒ½ä¸åšï¼Œä¹Ÿå¯ä»¥åœ¨é€‚å½“æ—¶æœºå‘é€ä¸€æ¬¡å¯¹M2çš„ç¡®è®¤ã€‚ä½†æŒ‰ç…§å¿«é‡ä¼ ç®—æ³•çš„è§„å®šï¼Œæ¥æ”¶æ–¹åº”åŠæ—¶å‘é€å¯¹M2çš„é‡å¤ç¡®è®¤ï¼Œè¿™æ ·åšå¯ä»¥è®© å‘é€æ–¹åŠæ—©çŸ¥é“æŠ¥æ–‡æ®µM3æ²¡æœ‰åˆ°è¾¾æ¥æ”¶æ–¹ã€‚å‘é€æ–¹æ¥ç€å‘é€äº†M5å’ŒM6ã€‚æ¥æ”¶æ–¹æ”¶åˆ°è¿™ä¸¤ä¸ªæŠ¥æ–‡åï¼Œä¹Ÿè¿˜è¦å†æ¬¡å‘å‡ºå¯¹M2çš„é‡å¤ç¡®è®¤ã€‚è¿™æ ·ï¼Œå‘é€æ–¹å…±æ”¶åˆ°äº† æ¥æ”¶æ–¹çš„å››ä¸ªå¯¹M2çš„ç¡®è®¤ï¼Œå…¶ä¸­åä¸‰ä¸ªéƒ½æ˜¯é‡å¤ç¡®è®¤ã€‚å¿«é‡ä¼ ç®—æ³•è¿˜è§„å®šï¼Œå‘é€æ–¹åªè¦ä¸€è¿æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤å°±åº”å½“ç«‹å³é‡ä¼ å¯¹æ–¹å°šæœªæ”¶åˆ°çš„æŠ¥æ–‡æ®µM3ï¼Œè€Œä¸å¿… ç»§ç»­ç­‰å¾…M3è®¾ç½®çš„é‡ä¼ è®¡æ—¶å™¨åˆ°æœŸã€‚ç”±äºå‘é€æ–¹å°½æ—©é‡ä¼ æœªè¢«ç¡®è®¤çš„æŠ¥æ–‡æ®µï¼Œå› æ­¤é‡‡ç”¨å¿«é‡ä¼ åå¯ä»¥ä½¿æ•´ä¸ªç½‘ç»œååé‡æé«˜çº¦20%ã€‚</p>
<p>ä¸å¿«é‡ä¼ é…åˆä½¿ç”¨çš„è¿˜æœ‰å¿«æ¢å¤ç®—æ³•ï¼Œå…¶è¿‡ç¨‹æœ‰ä»¥ä¸‹ä¸¤ä¸ªè¦ç‚¹ï¼š</p>
<p>&lt;1&gt;. å½“å‘é€æ–¹è¿ç»­æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤ï¼Œå°±æ‰§è¡Œâ€œä¹˜æ³•å‡å°â€ç®—æ³•ï¼ŒæŠŠæ…¢å¼€å§‹é—¨é™ssthreshå‡åŠã€‚è¿™æ˜¯ä¸ºäº†é¢„é˜²ç½‘ç»œå‘ç”Ÿæ‹¥å¡ã€‚è¯·æ³¨æ„ï¼šæ¥ä¸‹å»ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ã€‚</p>
<p>&lt;2&gt;. ç”±äºå‘é€æ–¹ç°åœ¨è®¤ä¸ºç½‘ç»œå¾ˆå¯èƒ½æ²¡æœ‰å‘ç”Ÿæ‹¥å¡ï¼Œå› æ­¤ä¸æ…¢å¼€å§‹ä¸åŒä¹‹å¤„æ˜¯ç°åœ¨ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ï¼ˆå³æ‹¥å¡çª—å£cwndç°åœ¨ä¸è®¾ç½®ä¸º1ï¼‰ï¼Œè€Œæ˜¯æŠŠcwndå€¼è®¾ç½®ä¸º æ…¢å¼€å§‹é—¨é™ssthreshå‡åŠåçš„æ•°å€¼ï¼Œç„¶åå¼€å§‹æ‰§è¡Œæ‹¥å¡é¿å…ç®—æ³•ï¼ˆâ€œåŠ æ³•å¢å¤§â€ï¼‰ï¼Œä½¿æ‹¥å¡çª—å£ç¼“æ…¢åœ°çº¿æ€§å¢å¤§ã€‚</p>
<p>ä¸‹å›¾ç»™å‡ºäº†å¿«é‡ä¼ å’Œå¿«æ¢å¤çš„ç¤ºæ„å›¾ï¼Œå¹¶æ ‡æ˜äº†â€œTCP Renoç‰ˆæœ¬â€ã€‚</p>
<p>åŒºåˆ«ï¼šæ–°çš„ TCP Reno ç‰ˆæœ¬åœ¨å¿«é‡ä¼ ä¹‹åé‡‡ç”¨å¿«æ¢å¤ç®—æ³•è€Œä¸æ˜¯é‡‡ç”¨æ…¢å¼€å§‹ç®—æ³•ã€‚</p>
<p><a href="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/2010101123101842.jpg?resize=621,313" title="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬12å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/2010101123101842.jpg?resize=621,313" alt="TCP/KCPè¯¦è§£ï¼ŒåŠæºç æ³¨è§£ - ç¬¬12å¼   | å¼ å˜"></a></p>
<p>ä¹Ÿæœ‰çš„å¿«é‡ä¼ å®ç°æ˜¯æŠŠå¼€å§‹æ—¶çš„æ‹¥å¡çª—å£cwndå€¼å†å¢å¤§ä¸€ç‚¹ï¼Œå³ç­‰äº ssthresh + 3 X MSS ã€‚è¿™æ ·åšçš„ç†ç”±æ˜¯ï¼šæ—¢ç„¶å‘é€æ–¹æ”¶åˆ°ä¸‰ä¸ªé‡å¤çš„ç¡®è®¤ï¼Œå°±è¡¨æ˜æœ‰ä¸‰ä¸ªåˆ†ç»„å·²ç»ç¦»å¼€äº†ç½‘ç»œã€‚è¿™ä¸‰ä¸ªåˆ†ç»„ä¸å†æ¶ˆè€—ç½‘ç»œ çš„èµ„æºè€Œæ˜¯åœç•™åœ¨æ¥æ”¶æ–¹çš„ç¼“å­˜ä¸­ã€‚å¯è§ç°åœ¨ç½‘ç»œä¸­å¹¶ä¸æ˜¯å †ç§¯äº†åˆ†ç»„è€Œæ˜¯å‡å°‘äº†ä¸‰ä¸ªåˆ†ç»„ã€‚å› æ­¤å¯ä»¥é€‚å½“æŠŠæ‹¥å¡çª—å£æ‰©å¤§äº†äº›ã€‚</p>
<p>åœ¨é‡‡ç”¨å¿«æ¢å¤ç®—æ³•æ—¶ï¼Œæ…¢å¼€å§‹ç®—æ³•åªæ˜¯åœ¨TCPè¿æ¥å»ºç«‹æ—¶å’Œç½‘ç»œå‡ºç°è¶…æ—¶æ—¶æ‰ä½¿ç”¨ã€‚</p>
<p>é‡‡ç”¨è¿™æ ·çš„æ‹¥å¡æ§åˆ¶æ–¹æ³•ä½¿å¾—TCPçš„æ€§èƒ½æœ‰æ˜æ˜¾çš„æ”¹è¿›ã€‚</p>
<p>æ¥æ”¶æ–¹æ ¹æ®è‡ªå·±çš„æ¥æ”¶èƒ½åŠ›è®¾å®šäº†æ¥æ”¶çª—å£rwndï¼Œå¹¶æŠŠè¿™ä¸ªçª—å£å€¼å†™å…¥TCPé¦–éƒ¨ä¸­çš„çª—å£å­—æ®µï¼Œä¼ é€ç»™å‘é€æ–¹ã€‚å› æ­¤ï¼Œæ¥æ”¶çª—å£åˆç§°ä¸ºé€šçŸ¥çª—å£ã€‚å› æ­¤ï¼Œä»æ¥æ”¶æ–¹å¯¹å‘é€æ–¹çš„æµé‡æ§åˆ¶çš„è§’åº¦è€ƒè™‘ï¼Œå‘é€æ–¹çš„å‘é€çª—å£ä¸€å®šä¸èƒ½è¶…è¿‡å¯¹æ–¹ç»™å‡ºçš„æ¥æ”¶çª—å£rwnd ã€‚</p>
<p>å‘é€æ–¹çª—å£çš„ä¸Šé™å€¼ = Min [ rwnd, cwnd ]</p>
<p>å½“rwnd &lt; cwnd æ—¶ï¼Œæ˜¯æ¥æ”¶æ–¹çš„æ¥æ”¶èƒ½åŠ›é™åˆ¶å‘é€æ–¹çª—å£çš„æœ€å¤§å€¼ã€‚</p>
<p>å½“cwnd &lt; rwnd æ—¶ï¼Œåˆ™æ˜¯ç½‘ç»œçš„æ‹¥å¡é™åˆ¶å‘é€æ–¹çª—å£çš„æœ€å¤§å€¼ã€‚</p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œ</tag>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title>æœåŠ¡æµæ§æ–¹æ¡ˆæ€»ç»“</title>
    <url>/limiter/</url>
    <content><![CDATA[<div class=".article-gallery"><p>è½¬è½½è‡ªï¼š<a href="https://developer.aliyun.com/article/765912">https://developer.aliyun.com/article/765912</a></p>
<h3 id="ä¸€-æµæ§çš„åœºæ™¯"><a href="#ä¸€-æµæ§çš„åœºæ™¯" class="headerlink" title="ä¸€ æµæ§çš„åœºæ™¯"></a>ä¸€ æµæ§çš„åœºæ™¯</h3><p>æµæ§çš„æ„ä¹‰å…¶å®æ— éœ€å¤šè¨€äº†ã€‚æœ€å¸¸ç”¨çš„åœºæ™¯ä¸‹ï¼Œæµæ§æ˜¯ä¸ºäº†ä¿æŠ¤ä¸‹æ¸¸æœ‰é™çš„èµ„æºä¸è¢«æµé‡å†²å®ï¼Œä¿è¯æœåŠ¡çš„å¯ç”¨æ€§ï¼Œä¸€èˆ¬å…è®¸æµæ§çš„é˜ˆå€¼æœ‰ä¸€å®šçš„å¼¹æ€§ï¼Œå¶å°”çš„è¶…é‡è®¿é—®æ˜¯å¯ä»¥æ¥å—çš„ã€‚</p>
<p>æœ‰çš„æ—¶å€™ï¼Œæµæ§æœåŠ¡äºæ”¶è´¹æ¨¡å¼ï¼Œæ¯”å¦‚æŸäº›äº‘å‚å•†ä¼šå¯¹è°ƒç”¨ API çš„é¢‘æ¬¡è¿›è¡Œè®¡è´¹ã€‚æ—¢ç„¶æ¶‰åŠåˆ°é’±ï¼Œä¸€èˆ¬å°±ä¸å…è®¸æœ‰è¶…å‡ºé˜ˆå€¼çš„è°ƒç”¨é‡ã€‚</p>
<p>è¿™äº›ä¸åŒçš„åœºæ™¯ä¸‹ï¼Œé€‚ç”¨çš„æµæ§ç®—æ³•ä¸å°½ç›¸åŒã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½¿ç”¨ Sentinel ä¸­é—´ä»¶å·²ç»èƒ½å¾ˆå¥½åœ°åº”å¯¹ï¼Œä½† Sentinel ä¹Ÿå¹¶ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œéœ€è¦æ€è€ƒå…¶ä»–çš„æµæ§æ–¹æ¡ˆã€‚</p>
<span id="more"></span>

<h3 id="äºŒ-æ¥å£å®šä¹‰"><a href="#äºŒ-æ¥å£å®šä¹‰" class="headerlink" title="äºŒ æ¥å£å®šä¹‰"></a>äºŒ æ¥å£å®šä¹‰</h3><p>ä¸ºäº†æ–¹ä¾¿ï¼Œä»¥ä¸‹æ‰€æœ‰çš„ç¤ºä¾‹ä»£ç å®ç°éƒ½æ˜¯åŸºäº Throttler æ¥å£ã€‚</p>
<p>Throttler æ¥å£å®šä¹‰äº†ä¸€ä¸ªé€šç”¨çš„æ–¹æ³•ç”¨äºç”³è¯·å•ä¸ªé…é¢ã€‚</p>
<p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥å®šä¹‰ä¸€ä¸ª tryAcquire(String key, int permits) ç­¾åçš„æ–¹æ³•ç”¨äºä¸€æ¬¡ç”³è¯·å¤šä¸ªé…é¢ï¼Œå®ç°çš„æ€è·¯æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>æœ‰äº›æµæ§ç®—æ³•éœ€è¦ä¸ºæ¯ä¸ª key ç»´æŠ¤ä¸€ä¸ª Throttler å®ä¾‹ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public interface Throttler &#123;</span><br><span class="line">    /**</span><br><span class="line">     * å°è¯•ç”³è¯·ä¸€ä¸ªé…é¢</span><br><span class="line">     *</span><br><span class="line">     * @param key     ç”³è¯·é…é¢çš„key</span><br><span class="line">     * @return ç”³è¯·æˆåŠŸåˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›false</span><br><span class="line">     */</span><br><span class="line">    boolean tryAcquire(String key);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä¸‰-å•æœºæµæ§"><a href="#ä¸‰-å•æœºæµæ§" class="headerlink" title="ä¸‰ å•æœºæµæ§"></a>ä¸‰ å•æœºæµæ§</h3><h4 id="1-ç®€å•çª—å£"><a href="#1-ç®€å•çª—å£" class="headerlink" title="1 ç®€å•çª—å£"></a>1 ç®€å•çª—å£</h4><blockquote>
<p>ç®€å•çª—å£æ˜¯æˆ‘è‡ªå·±çš„å‘½åï¼Œæœ‰äº›åœ°æ–¹ä¹Ÿå«åšå›ºå®šçª—å£ï¼Œä¸»è¦æ˜¯ä¸ºäº†è·Ÿåé¢çš„æ»‘åŠ¨çª—å£åŒºåˆ†ã€‚</p>
</blockquote>
<p>æµæ§æ˜¯ä¸ºäº†é™åˆ¶æŒ‡å®šæ—¶é—´é—´éš”å†…èƒ½å¤Ÿå…è®¸çš„è®¿é—®é‡ï¼Œå› æ­¤ï¼Œæœ€ç›´è§‚çš„æ€è·¯å°±æ˜¯åŸºäºä¸€ä¸ªç»™å®šçš„æ—¶é—´çª—å£ï¼Œç»´æŠ¤ä¸€ä¸ªè®¡æ•°å™¨ç”¨äºç»Ÿè®¡è®¿é—®æ¬¡æ•°ï¼Œç„¶åå®ç°ä»¥ä¸‹è§„åˆ™ï¼š</p>
<ul>
<li>å¦‚æœè®¿é—®æ¬¡æ•°å°äºé˜ˆå€¼ï¼Œåˆ™ä»£è¡¨å…è®¸è®¿é—®ï¼Œè®¿é—®æ¬¡æ•° +1ã€‚</li>
<li>å¦‚æœè®¿é—®æ¬¡æ•°è¶…å‡ºé˜ˆå€¼ï¼Œåˆ™é™åˆ¶è®¿é—®ï¼Œè®¿é—®æ¬¡æ•°ä¸å¢ã€‚</li>
<li>å¦‚æœè¶…è¿‡äº†æ—¶é—´çª—å£ï¼Œè®¡æ•°å™¨æ¸…é›¶ï¼Œå¹¶é‡ç½®æ¸…é›¶åçš„é¦–æ¬¡æˆåŠŸè®¿é—®æ—¶é—´ä¸ºå½“å‰æ—¶é—´ã€‚è¿™æ ·å°±ç¡®ä¿è®¡æ•°å™¨ç»Ÿè®¡çš„æ˜¯æœ€è¿‘ä¸€ä¸ªçª—å£çš„è®¿é—®é‡ã€‚</li>
</ul>
<p><strong>ä»£ç å®ç° SimpleWindowThrottler</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/**</span><br><span class="line"> * æ¯«ç§’ä¸ºå•ä½çš„æ—¶é—´çª—å£</span><br><span class="line"> */</span><br><span class="line">private final long windowInMs;</span><br><span class="line">/**</span><br><span class="line"> * æ—¶é—´çª—å£å†…æœ€å¤§å…è®¸çš„é˜ˆå€¼</span><br><span class="line"> */</span><br><span class="line">private final int threshold;</span><br><span class="line">/**</span><br><span class="line"> * æœ€åä¸€æ¬¡æˆåŠŸè¯·æ±‚æ—¶é—´</span><br><span class="line"> */</span><br><span class="line">private long lastReqTime = System.currentTimeMillis();</span><br><span class="line">/**</span><br><span class="line"> * è®¡æ•°å™¨</span><br><span class="line"> */</span><br><span class="line">private long counter;</span><br><span class="line"></span><br><span class="line">public boolean tryAcquire(String key) &#123;</span><br><span class="line">    long now = System.currentTimeMillis();</span><br><span class="line">    // å¦‚æœå½“å‰æ—¶é—´å·²ç»è¶…è¿‡äº†ä¸Šä¸€æ¬¡è®¿é—®æ—¶é—´å¼€å§‹çš„æ—¶é—´çª—å£ï¼Œé‡ç½®è®¡æ•°å™¨ï¼Œä»¥å½“å‰æ—¶é—´ä½œä¸ºæ–°çª—å£çš„èµ·å§‹å€¼</span><br><span class="line">    if (now - lastReqTime &gt; windowInMs) &#123;       #1</span><br><span class="line">        counter = 0;</span><br><span class="line">        lastReqTime = now;                  #2</span><br><span class="line">    &#125;</span><br><span class="line">    if (counter &lt; threshold) &#123;                  #3</span><br><span class="line">        counter++;                          #4</span><br><span class="line">        return true;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦å¤–ä¸€ç§å¸¸è§çš„åœºæ™¯æ˜¯æ ¹æ®ä¸åŒçš„ key æ¥åšæµæ§ï¼Œæ¯ä¸ª key æœ‰å•ç‹¬çš„æ—¶é—´çª—å£ã€é˜ˆå€¼é…ç½®ï¼Œå› æ­¤éœ€è¦ä¸ºæ¯ä¸ª key ç»´æŠ¤ä¸€ä¸ªå•ç‹¬çš„é™æµå™¨å®ä¾‹ã€‚</p>
<p><strong>åˆ‡æ¢åˆ°å¤šçº¿ç¨‹ç¯å¢ƒ</strong><br>åœ¨ç°å®åº”ç”¨ä¸­ï¼Œå¾€å¾€æ˜¯å¤šä¸ªçº¿ç¨‹æ¥åŒæ—¶ç”³è¯·é…é¢ï¼Œä¸ºäº†æ¯”è¾ƒç®€æ´åœ°è¡¨è¾¾ç®—æ³•æ€è·¯ï¼Œç¤ºä¾‹ä»£ç é‡Œé¢éƒ½æ²¡æœ‰åšå¹¶å‘åŒæ­¥æ§åˆ¶ã€‚</p>
<p>ä»¥ç®€å•çª—å£çš„å®ç°ä¸ºä¾‹ï¼Œè¦è½¬æ¢ä¸ºå¤šçº¿ç¨‹å®‰å…¨çš„æµæ§ç®—æ³•ï¼Œä¸€ç§ç›´æ¥çš„åŠæ³•æ˜¯å°† tryAcquire æ–¹æ³•è®¾ç½®ä¸º synchronizedã€‚</p>
<p>å½“ç„¶ä¸€ç§æ„Ÿè§‰ä¸Šæ›´é«˜æ•ˆçš„åŠæ³•ä¹Ÿå¯ä»¥æ˜¯ä¿®æ”¹è¯»å†™å˜é‡çš„ç±»å‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">private volatile long lastReqTime = System.currentTimeMillis();</span><br><span class="line">private LongAdder counter = new LongAdder();</span><br></pre></td></tr></table></figure>

<p>ä¸è¿‡è¿™æ ·å…¶å®å¹¶ä¸çœŸæ­£â€œå®‰å…¨â€ï¼Œè®¾æƒ³ä»¥ä¸‹çš„åœºæ™¯ï¼Œä¸¤ä¸ªçº¿ç¨‹ Aã€çº¿ç¨‹ B å‰åè„šå°è¯•è·å–é…é¢ï¼Œ#1 ä½ç½®çš„åˆ¤æ–­æ¡ä»¶æ»¡è¶³åï¼Œä¼šåŒæ—¶èµ°åˆ° #2 ä½ç½®ä¿®æ”¹ lastReqTime å€¼ï¼Œçº¿ç¨‹ B çš„èµ‹å€¼ä¼šè¦†ç›–çº¿ç¨‹ Aï¼Œå¯¼è‡´æ—¶é—´çª—å£èµ·å§‹ç‚¹å‘ååç§»ã€‚åŒæ ·çš„ï¼Œä½ç½® #3 å’Œ #4 ä¹Ÿä¼šæ„æˆç«äº‰æ¡ä»¶ã€‚å½“ç„¶å¦‚æœå¯¹æµæ§çš„ç²¾åº¦è¦æ±‚ä¸é«˜ï¼Œè¿™ç§ç«äº‰ä¹Ÿæ˜¯èƒ½æ¥å—çš„ã€‚</p>
<p><strong>ä¸´ç•Œçªå˜é—®é¢˜</strong></p>
<p>ç®€å•çª—å£çš„æµæ§å®ç°éå¸¸ç®€å•ï¼Œä»¥ 1 åˆ†é’Ÿå…è®¸ 100 æ¬¡è®¿é—®ä¸ºä¾‹ï¼Œå¦‚æœæµé‡å‡åŒ€ä¿æŒ 200 æ¬¡/åˆ†é’Ÿçš„è®¿é—®é€Ÿç‡ï¼Œç³»ç»Ÿçš„è®¿é—®é‡æ›²çº¿å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼ˆæŒ‰åˆ†é’Ÿæ¸…é›¶ï¼‰ï¼š</p>
<p><a href="https://ucc.alicdn.com/pic/developer-ecology/55c271e1437d49e2822a5f3114659474.png" title="image.png" class="gallery-item" style="box-shadow: none;"> <img src="https://ucc.alicdn.com/pic/developer-ecology/55c271e1437d49e2822a5f3114659474.png" alt="image.png"></a></p>
<p>ä½†å¦‚æœæµé‡å¹¶ä¸å‡åŒ€ï¼Œå‡è®¾åœ¨æ—¶é—´çª—å£å¼€å§‹æ—¶åˆ» 0:00 æœ‰å‡ æ¬¡é›¶æ˜Ÿçš„è®¿é—®ï¼Œä¸€ç›´åˆ° 0:50 æ—¶åˆ»ï¼Œå¼€å§‹ä»¥ 10 æ¬¡/ç§’çš„é€Ÿåº¦è¯·æ±‚ï¼Œå°±ä¼šå‡ºç°è¿™æ ·çš„è®¿é—®é‡å›¾çº¿ï¼š</p>
<p><a href="https://ucc.alicdn.com/pic/developer-ecology/71496c33553043328fd24f9e6c58a352.png" title="image.png" class="gallery-item" style="box-shadow: none;"> <img src="https://ucc.alicdn.com/pic/developer-ecology/71496c33553043328fd24f9e6c58a352.png" alt="image.png"></a></p>
<p>åœ¨ä¸´ç•Œçš„ 20 ç§’å†…ï¼ˆ0:50~1:10ï¼‰ç³»ç»Ÿæ‰¿å—çš„å®é™…è®¿é—®é‡æ˜¯ 200 æ¬¡ï¼Œæ¢å¥è¯è¯´ï¼Œæœ€åçš„æƒ…å†µä¸‹ï¼Œåœ¨çª—å£ä¸´ç•Œç‚¹é™„è¿‘ç³»ç»Ÿä¼šæ‰¿å— 2 å€çš„æµé‡å†²å‡»ï¼Œè¿™å°±æ˜¯ç®€å•çª—å£ä¸èƒ½è§£å†³çš„ä¸´ç•Œçªå˜é—®é¢˜ã€‚</p>
<h4 id="2-æ»‘åŠ¨çª—å£"><a href="#2-æ»‘åŠ¨çª—å£" class="headerlink" title="2 æ»‘åŠ¨çª—å£"></a>2 æ»‘åŠ¨çª—å£</h4><p>å¦‚ä½•è§£å†³ç®€å•çª—å£ç®—æ³•çš„ä¸´ç•Œçªå˜é—®é¢˜ï¼Ÿæ—¢ç„¶ä¸€ä¸ªçª—å£ç»Ÿè®¡çš„ç²¾åº¦ä½ï¼Œé‚£ä¹ˆå¯ä»¥æŠŠæ•´ä¸ªå¤§çš„æ—¶é—´çª—å£åˆ‡åˆ†æˆæ›´ç»†ç²’åº¦çš„å­çª—å£ï¼Œæ¯ä¸ªå­çª—å£ç‹¬ç«‹ç»Ÿè®¡ã€‚åŒæ—¶ï¼Œæ¯è¿‡ä¸€ä¸ªå­çª—å£å¤§å°çš„æ—¶é—´ï¼Œå°±å‘å³æ»‘åŠ¨ä¸€ä¸ªå­çª—å£ã€‚è¿™å°±æ˜¯æ»‘åŠ¨çª—å£ç®—æ³•çš„æ€è·¯ã€‚</p>
<p><a href="https://ucc.alicdn.com/pic/developer-ecology/64e7d74023a84b75a17fc320b152fa27.png" title="image.png" class="gallery-item" style="box-shadow: none;"> <img src="https://ucc.alicdn.com/pic/developer-ecology/64e7d74023a84b75a17fc320b152fa27.png" alt="image.png"></a></p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå°†ä¸€åˆ†é’Ÿçš„æ—¶é—´çª—å£åˆ‡åˆ†æˆ 6 ä¸ªå­çª—å£ï¼Œæ¯ä¸ªå­çª—å£ç»´æŠ¤ä¸€ä¸ªç‹¬ç«‹çš„è®¡æ•°å™¨ç”¨äºç»Ÿè®¡ 10 ç§’å†…çš„è®¿é—®é‡ï¼Œæ¯ç»è¿‡ 10sï¼Œæ—¶é—´çª—å£å‘å³æ»‘åŠ¨ä¸€æ ¼ã€‚</p>
<p>å›åˆ°ç®€å•çª—å£å‡ºç°ä¸´ç•Œè·³å˜çš„ä¾‹å­ï¼Œç»“åˆä¸Šé¢çš„å›¾å†çœ‹æ»‘åŠ¨çª—å£å¦‚ä½•æ¶ˆé™¤ä¸´ç•Œçªå˜ã€‚å¦‚æœ 0:50 åˆ° 1:00 æ—¶åˆ»ï¼ˆå¯¹åº”ç°è‰²çš„æ ¼å­ï¼‰è¿›æ¥äº† 100 æ¬¡è¯·æ±‚ï¼Œæ¥ä¸‹æ¥ 1:00~1:10 çš„ 100 æ¬¡è¯·æ±‚ä¼šè½åˆ°é»„è‰²çš„æ ¼å­ä¸­ï¼Œç”±äºç®—æ³•ç»Ÿè®¡çš„æ˜¯ 6 ä¸ªå­çª—å£çš„è®¿é—®é‡æ€»å’Œï¼Œè¿™æ—¶å€™æ€»å’Œè¶…è¿‡è®¾å®šçš„é˜ˆå€¼ 100ï¼Œå°±ä¼šæ‹’ç»åé¢çš„è¿™ 100 æ¬¡è¯·æ±‚ã€‚</p>
<p><strong>ä»£ç å®ç°ï¼ˆå‚è€ƒ Sentinelï¼‰</strong></p>
<p>Sentinel æä¾›äº†ä¸€ä¸ªè½»é‡é«˜æ€§èƒ½çš„æ»‘åŠ¨çª—å£æµæ§ç®—æ³•å®ç°ï¼Œçœ‹ä»£ç çš„æ—¶å€™å¯ä»¥é‡ç‚¹å…³æ³¨è¿™å‡ ä¸ªç±»ï¼š</p>
<p>1ï¼‰åŠŸèƒ½æ’æ§½ StatisticSlot è´Ÿè´£è®°å½•ã€ç»Ÿè®¡ä¸åŒçº¬åº¦çš„ runtime æŒ‡æ ‡ç›‘æ§ä¿¡æ¯ï¼Œä¾‹å¦‚ RTã€QPS ç­‰ã€‚</p>
<p>Sentinel å†…éƒ¨ä½¿ç”¨äº† slot chain çš„è´£ä»»é“¾è®¾è®¡æ¨¡å¼ï¼Œæ¯ä¸ªåŠŸèƒ½æ’æ§½ slot æœ‰ä¸åŒçš„åŠŸèƒ½ï¼ˆé™æµã€é™çº§ã€ç³»ç»Ÿä¿æŠ¤ï¼‰ï¼Œé€šè¿‡ ProcessorSlotChain ä¸²è”åœ¨ä¸€èµ·ã€‚</p>
<p>å‚è€ƒå®˜æ–¹ Wikiï¼š<br><a href="https://github.com/alibaba/Sentinel/wiki/Sentinel%E5%B7%A5%E4%BD%9C%E4%B8%BB%E6%B5%81%E7%A8%8B">https://github.com/alibaba/Sentinel/wiki/Sentinelå·¥ä½œä¸»æµç¨‹</a></p>
<p>2ï¼‰StatisticSlot ä½¿ç”¨ StatisticNode#addPassRequest è®°å½•å…è®¸çš„è¯·æ±‚æ•°ï¼ŒåŒ…å«ç§’å’Œåˆ†é’Ÿä¸¤ä¸ªç»´åº¦ã€‚</p>
<p>3ï¼‰å…·ä½“è®°å½•ç”¨åˆ°çš„æ˜¯ Metric æ¥å£ï¼Œå¯¹åº”å®ç°ç±» ArrayMetricï¼ŒèƒŒåçœŸæ­£çš„æ»‘åŠ¨çª—å£æ•°æ®ç»“æ„æ˜¯ LeapArray ã€‚</p>
<p>4ï¼‰LeapArray å†…éƒ¨ç»´æŠ¤äº†æ»‘åŠ¨çª—å£ç”¨åˆ°çš„å…³é”®å±æ€§å’Œç»“æ„ï¼ŒåŒ…æ‹¬ï¼š</p>
<p>aï¼‰æ€»çª—å£å¤§å° intervalInMsï¼Œæ»‘åŠ¨å­çª—å£å¤§å° windowLengthInMsï¼Œé‡‡æ ·æ•°é‡sampleCountï¼š</p>
<p>sampleCount = intervalInMs / windowLengthInMs</p>
<p>å½“å‰å®ç°é»˜è®¤ä¸º 2ï¼Œè€Œæ€»çª—å£å¤§å°é»˜è®¤æ˜¯ 1sï¼Œä¹Ÿå°±æ„å‘³ç€é»˜è®¤çš„æ»‘åŠ¨çª—å£å¤§å°æ˜¯ 500msã€‚å¯ä»¥é€šè¿‡è°ƒæ•´é‡‡æ ·æ•°é‡æ¥è°ƒæ•´ç»Ÿè®¡çš„ç²¾åº¦ã€‚</p>
<p>bï¼‰æ»‘åŠ¨çª—å£çš„æ•°ç»„ arrayï¼Œæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ ä»¥ WindowWrap è¡¨ç¤ºï¼Œå…¶ä¸­åŒ…å«ï¼š</p>
<ul>
<li>windowStartï¼šæ»‘åŠ¨çª—å£çš„å¼€å§‹æ—¶é—´ã€‚</li>
<li>windowLengthï¼šæ»‘åŠ¨çª—å£çš„é•¿åº¦ã€‚</li>
<li>valueï¼šæ»‘åŠ¨çª—å£è®°å½•çš„å†…å®¹ï¼Œæ³›å‹è¡¨ç¤ºï¼Œå…³é”®çš„ä¸€ç±»å°±æ˜¯ MetricBucketï¼Œé‡Œé¢åŒ…å«äº†ä¸€ç»„ LongAdder ç”¨äºè®°å½•ä¸åŒç±»å‹çš„æ•°æ®ï¼Œä¾‹å¦‚è¯·æ±‚é€šè¿‡æ•°ã€è¯·æ±‚é˜»å¡æ•°ã€è¯·æ±‚å¼‚å¸¸æ•°ç­‰ç­‰ã€‚</li>
</ul>
<p>è®°å½•è¯·æ±‚çš„é€»è¾‘è¯´ç™½äº†ï¼Œå°±æ˜¯æ ¹æ®å½“å‰æ—¶é—´è·å–æ‰€å±çš„æ»‘åŠ¨çª—å£ï¼Œç„¶åå°†è¯¥çª—å£çš„ç»Ÿè®¡å€¼ +1 å³å¯ã€‚ä½†å®é™…ä¸Šï¼Œè·å–å½“å‰æ‰€å±çš„æ—¶é—´çª—å£è¿™ä¸€æ­¥éšå«äº†ä¸å°‘ç»†èŠ‚ï¼Œè¯¦ç»†çš„å®ç°å¯ä»¥ä» LeapArray#currentWindow ä¸­æ‰¾åˆ°ï¼Œæºç çš„æ³¨é‡Šå†™å¾—å¾ˆè¯¦ç»†ï¼Œè¿™é‡Œå°±ä¸å¤šæäº†ã€‚</p>
<p>è¿™é‡Œå€ŸåŠ©ä¸€å¼ å…¶ä»–åŒå­¦ç”»çš„å›¾è¡¨è¿°ä»¥ä¸Šçš„æµç¨‹ï¼š</p>
<p><a href="https://ucc.alicdn.com/pic/developer-ecology/94326f15088f4750acd811ec75b43252.png" title="image.png" class="gallery-item" style="box-shadow: none;"> <img src="https://ucc.alicdn.com/pic/developer-ecology/94326f15088f4750acd811ec75b43252.png" alt="image.png"></a></p>
<p>ä»¥ä¸Šçš„æµç¨‹åŸºäº 3.9.21 ç‰ˆæœ¬çš„æºç ï¼Œæ—©å…ˆç‰ˆæœ¬çš„ Sentinel å†…éƒ¨ç‰ˆæœ¬å®ç°ä¸å°½ç›¸åŒï¼Œä½¿ç”¨äº†ä¸€ä¸ªå« SentinelRollingNumber çš„æ•°æ®ç»“æ„ï¼Œä½†åŸç†æ˜¯ç±»ä¼¼çš„ã€‚</p>
<p><strong>ç²¾åº¦é—®é¢˜</strong></p>
<p>ç°åœ¨æ€è€ƒè¿™ä¹ˆä¸€ä¸ªé—®é¢˜ï¼šæ»‘åŠ¨çª—å£ç®—æ³•èƒ½å¦ç²¾å‡†åœ°æ§åˆ¶ä»»æ„ç»™å®šæ—¶é—´çª—å£ T å†…çš„è®¿é—®é‡ä¸å¤§äº Nï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œè¿˜æ˜¯å°† 1 åˆ†é’Ÿåˆ†æˆ 6 ä¸ª 10 ç§’å¤§å°çš„å­çª—å£çš„ä¾‹å­ï¼Œå‡è®¾è¯·æ±‚çš„é€Ÿç‡ç°åœ¨æ˜¯ 20 æ¬¡/ç§’ï¼Œä» 0:05 æ—¶åˆ»å¼€å§‹è¿›å…¥ï¼Œé‚£ä¹ˆåœ¨ 0:05<del>0:10 æ—¶é—´æ®µå†…ä¼šæ”¾è¿› 100 ä¸ªè¯·æ±‚ï¼ŒåŒæ—¶æ¥ä¸‹æ¥çš„è¯·æ±‚éƒ½ä¼šè¢«é™æµï¼Œç›´åˆ° 1:00 æ—¶åˆ»çª—å£æ»‘åŠ¨ï¼Œåœ¨ 1:00</del>1:05 æ—¶åˆ»ç»§ç»­æ”¾è¿› 100 ä¸ªè¯·æ±‚ã€‚å¦‚æœæŠŠ 0:05~1:05 çœ‹ä½œæ˜¯ 1 åˆ†é’Ÿçš„æ—¶é—´çª—å£ï¼Œé‚£ä¹ˆè¿™ä¸ªçª—å£å†…å®é™…çš„è¯·æ±‚é‡æ˜¯ 200ï¼Œè¶…å‡ºäº†ç»™å®šçš„é˜ˆå€¼ 100ã€‚</p>
<p>å¦‚æœè¦è¿½æ±‚æ›´é«˜çš„ç²¾åº¦ï¼Œç†è®ºä¸Šåªéœ€è¦æŠŠæ»‘åŠ¨çª—å£åˆ‡åˆ†å¾—æ›´ç»†ã€‚åƒ Sentinel ä¸­å°±å¯ä»¥é€šè¿‡ä¿®æ”¹å•ä½æ—¶é—´å†…çš„é‡‡æ ·æ•°é‡ sampleCount å€¼æ¥è®¾ç½®ç²¾åº¦ï¼Œè¿™ä¸ªå€¼ä¸€èˆ¬æ ¹æ®ä¸šåŠ¡çš„éœ€æ±‚æ¥å®šï¼Œä»¥è¾¾åˆ°åœ¨ç²¾åº¦å’Œå†…å­˜æ¶ˆè€—ä¹‹é—´çš„å¹³è¡¡ã€‚</p>
<p><strong>å¹³æ»‘åº¦é—®é¢˜</strong></p>
<p>ä½¿ç”¨æ»‘åŠ¨çª—å£ç®—æ³•é™åˆ¶æµé‡æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šçœ‹åˆ°åƒä¸‹é¢ä¸€æ ·çš„æµé‡æ›²çº¿ã€‚</p>
<p><a href="https://ucc.alicdn.com/pic/developer-ecology/d80a395b5cb24ca59f2b97d4fb55893e.png" title="image.png" class="gallery-item" style="box-shadow: none;"> <img src="https://ucc.alicdn.com/pic/developer-ecology/d80a395b5cb24ca59f2b97d4fb55893e.png" alt="image.png"></a></p>
<p>çªå‘çš„å¤§æµé‡åœ¨çª—å£å¼€å§‹ä¸ä¹…å°±ç›´æ¥æŠŠé™æµçš„é˜ˆå€¼æ‰“æ»¡ï¼Œå¯¼è‡´å‰©ä½™çš„çª—å£å†…æ‰€æœ‰è¯·æ±‚éƒ½æ— æ³•é€šè¿‡ã€‚åœ¨æ—¶é—´çª—å£çš„å•ä½æ¯”è¾ƒå¤§æ—¶ï¼ˆä¾‹å¦‚ä»¥åˆ†ä¸ºå•ä½è¿›è¡Œæµæ§ï¼‰ï¼Œè¿™ç§é—®é¢˜çš„å½±å“å°±æ¯”è¾ƒå¤§äº†ã€‚åœ¨å®é™…åº”ç”¨ä¸­æˆ‘ä»¬è¦çš„é™æµæ•ˆæœå¾€å¾€ä¸æ˜¯æŠŠæµé‡ä¸€ä¸‹å­ææ–­ï¼Œè€Œæ˜¯è®©æµé‡å¹³æ»‘åœ°è¿›å…¥ç³»ç»Ÿå½“ä¸­ã€‚</p>
<h4 id="3-æ¼æ¡¶"><a href="#3-æ¼æ¡¶" class="headerlink" title="3 æ¼æ¡¶"></a>3 æ¼æ¡¶</h4><p>æ»‘åŠ¨çª—å£æ— æ³•å¾ˆå¥½åœ°è§£å†³å¹³æ»‘åº¦é—®é¢˜ï¼Œå†å›è¿‡å¤´çœ‹æˆ‘ä»¬å¯¹äºå¹³æ»‘åº¦çš„è¯‰æ±‚ï¼Œå½“æµé‡è¶…è¿‡ä¸€å®šèŒƒå›´åï¼Œæˆ‘ä»¬æƒ³è¦çš„æ•ˆæœä¸æ˜¯ä¸€ä¸‹å­åˆ‡æ–­æµé‡ï¼Œè€Œæ˜¯å°†æµé‡æ§åˆ¶åœ¨ç³»ç»Ÿèƒ½æ‰¿å—çš„ä¸€å®šçš„é€Ÿåº¦å†…ã€‚å‡è®¾å¹³å‡è®¿é—®é€Ÿç‡ä¸º v, é‚£æˆ‘ä»¬è¦åšçš„æµæ§å…¶å®æ˜¯æµé€Ÿæ§åˆ¶ï¼Œå³æ§åˆ¶å¹³å‡è®¿é—®é€Ÿç‡ v â‰¤ N / Tã€‚</p>
<p>åœ¨ç½‘ç»œé€šä¿¡ä¸­å¸¸å¸¸ç”¨åˆ°æ¼æ¡¶ç®—æ³•æ¥å®ç°æµé‡æ•´å½¢ã€‚æ¼æ¡¶ç®—æ³•çš„æ€è·¯å°±æ˜¯åŸºäºæµé€Ÿæ¥åšæ§åˆ¶ã€‚æƒ³è±¡ä¸€ä¸‹ä¸Šå­¦æ—¶ç»å¸¸åšçš„æ°´æ± ä¸€è¾¹æŠ½æ°´ä¸€è¾¹æ³¨æ°´çš„åº”ç”¨é¢˜ï¼ŒæŠŠæ°´æ± æ¢æˆæ°´æ¡¶ï¼ˆè¿˜æ˜¯åº•ä¸‹æœ‰æ´ä¸€æ³¨æ°´å°±å¼€å§‹æ¼çš„é‚£ç§ï¼‰ï¼ŒæŠŠè¯·æ±‚çœ‹ä½œæ˜¯å¾€æ¡¶é‡Œæ³¨æ°´ï¼Œæ¡¶åº•æ¼å‡ºçš„æ°´ä»£è¡¨ç¦»å¼€ç¼“å†²åŒºè¢«æœåŠ¡å™¨å¤„ç†çš„è¯·æ±‚ï¼Œæ¡¶å£æº¢å‡ºçš„æ°´ä»£è¡¨è¢«ä¸¢å¼ƒçš„è¯·æ±‚ã€‚åœ¨æ¦‚å¿µä¸Šç±»æ¯”ï¼š</p>
<ul>
<li>æœ€å¤§å…è®¸è¯·æ±‚æ•° Nï¼šæ¡¶çš„å¤§å°</li>
<li>æ—¶é—´çª—å£å¤§å° Tï¼šä¸€æ•´æ¡¶æ°´æ¼å®Œçš„æ—¶é—´</li>
<li>æœ€å¤§è®¿é—®é€Ÿç‡ Vï¼šä¸€æ•´æ¡¶æ°´æ¼å®Œçš„é€Ÿåº¦ï¼Œå³ N/T</li>
<li>è¯·æ±‚è¢«é™æµï¼šæ¡¶æ³¨æ°´çš„é€Ÿåº¦æ¯”æ¼æ°´çš„é€Ÿåº¦å¿«ï¼Œæœ€ç»ˆå¯¼è‡´æ¡¶å†…æ°´æº¢å‡º</li>
</ul>
<p>å‡è®¾èµ·å§‹æ—¶åˆ»æ¡¶æ˜¯ç©ºçš„ï¼Œæ¯æ¬¡è®¿é—®éƒ½ä¼šå¾€æ¡¶é‡Œæ³¨å…¥ä¸€å•ä½ä½“ç§¯çš„æ°´é‡ï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬ä»¥å°äºç­‰äº N/T çš„é€Ÿåº¦å¾€æ¡¶é‡Œæ³¨æ°´æ—¶ï¼Œæ¡¶å†…çš„æ°´å°±æ°¸è¿œä¸ä¼šæº¢å‡ºã€‚åä¹‹ï¼Œä¸€æ—¦å®é™…æ³¨æ°´é€Ÿåº¦è¶…è¿‡æ¼æ°´é€Ÿåº¦ï¼Œæ¡¶é‡Œå°±ä¼šäº§ç”Ÿè¶Šæ¥è¶Šå¤šçš„ç§¯æ°´ï¼Œç›´åˆ°æº¢å‡ºä¸ºæ­¢ã€‚åŒæ—¶æ¼æ°´çš„é€Ÿåº¦æ°¸è¿œè¢«æ§åˆ¶åœ¨ N/T ä»¥å†…ï¼Œè¿™å°±å®ç°äº†å¹³æ»‘æµé‡çš„ç›®çš„ã€‚</p>
<p>æ¼æ¡¶ç®—æ³•çš„è®¿é—®é€Ÿç‡æ›²çº¿å¦‚ä¸‹ï¼š<br><a href="https://ucc.alicdn.com/pic/developer-ecology/68127312b88a4bb3ac0b4a1caf297f6c.png" title="image.png" class="gallery-item" style="box-shadow: none;"> <img src="https://ucc.alicdn.com/pic/developer-ecology/68127312b88a4bb3ac0b4a1caf297f6c.png" alt="image.png"></a></p>
<p>é™„ä¸Šä¸€å¼ ç½‘ä¸Šå¸¸è§çš„æ¼æ¡¶ç®—æ³•åŸé¢˜å›¾ï¼š</p>
<p><a href="https://ucc.alicdn.com/pic/developer-ecology/1299847fdcb042289fa10067ab074949.png" title="image.png" class="gallery-item" style="box-shadow: none;"> <img src="https://ucc.alicdn.com/pic/developer-ecology/1299847fdcb042289fa10067ab074949.png" alt="image.png"></a></p>
<p><strong>ä»£ç å®ç° LeakyBucketThrottler</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/**</span><br><span class="line"> * å½“å‰æ¡¶å†…å‰©ä½™çš„æ°´</span><br><span class="line"> */</span><br><span class="line">private long left;</span><br><span class="line">/**</span><br><span class="line"> * ä¸Šæ¬¡æˆåŠŸæ³¨æ°´çš„æ—¶é—´æˆ³</span><br><span class="line"> */</span><br><span class="line">private long lastInjectTime = System.currentTimeMillis();</span><br><span class="line">/**</span><br><span class="line"> * æ¡¶çš„å®¹é‡</span><br><span class="line"> */</span><br><span class="line">private long capacity;</span><br><span class="line">/**</span><br><span class="line"> * ä¸€æ¡¶æ°´æ¼å®Œçš„æ—¶é—´</span><br><span class="line"> */</span><br><span class="line">private long duration;</span><br><span class="line">/**</span><br><span class="line"> * æ¡¶æ¼æ°´çš„é€Ÿåº¦ï¼Œå³ capacity / duration</span><br><span class="line"> */</span><br><span class="line">private double velocity;</span><br><span class="line"></span><br><span class="line">public boolean tryAcquire(String key) &#123;</span><br><span class="line">    long now = System.currentTimeMillis();</span><br><span class="line">    // å½“å‰å‰©ä½™çš„æ°´ = ä¹‹å‰çš„å‰©ä½™æ°´é‡ - è¿‡å»è¿™æ®µæ—¶é—´å†…æ¼æ‰çš„æ°´é‡</span><br><span class="line">    // è¿‡å»è¿™æ®µæ—¶é—´å†…æ¼æ‰çš„æ°´é‡ = (å½“å‰æ—¶é—´-ä¸Šæ¬¡æ³¨æ°´æ—¶é—´) * æ¼æ°´é€Ÿåº¦</span><br><span class="line">    // å¦‚æœå½“å‰æ—¶é—´ç›¸æ¯”ä¸Šæ¬¡æ³¨æ°´æ—¶é—´ç›¸éš”å¤ªä¹…ï¼ˆä¸€ç›´æ²¡æœ‰æ³¨æ°´ï¼‰ï¼Œæ¡¶å†…çš„å‰©ä½™æ°´é‡å°±æ˜¯0ï¼ˆæ¼å®Œäº†ï¼‰</span><br><span class="line">    left = Math.max(0, left - (long)((now - lastInjectTime) * velocity));</span><br><span class="line">    // å¾€å½“å‰æ°´é‡åŸºç¡€ä¸Šæ³¨ä¸€å•ä½æ°´ï¼Œåªè¦æ²¡æœ‰æº¢å‡ºå°±ä»£è¡¨å¯ä»¥è®¿é—®</span><br><span class="line">    if (left + 1 &lt;= capacity) &#123;</span><br><span class="line">        lastInjectTime = now;</span><br><span class="line">        left++;</span><br><span class="line">        return true;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ¼æ¡¶çš„é—®é¢˜</strong></p>
<p>æ¼æ¡¶çš„ä¼˜åŠ¿åœ¨äºèƒ½å¤Ÿå¹³æ»‘æµé‡ï¼Œå¦‚æœæµé‡ä¸æ˜¯å‡åŒ€çš„ï¼Œé‚£ä¹ˆæ¼æ¡¶ç®—æ³•ä¸æ»‘åŠ¨çª—å£ç®—æ³•ä¸€æ ·æ— æ³•åšåˆ°çœŸæ­£çš„ç²¾ç¡®æ§åˆ¶ã€‚æç«¯æƒ…å†µä¸‹ï¼Œæ¼æ¡¶åœ¨æ—¶é—´çª—å£ T å†…ä¹Ÿä¼šæ”¾è¿›ç›¸å½“äº 2 å€é˜ˆå€¼ N çš„æµé‡ã€‚</p>
<p>è®¾æƒ³ä¸€ä¸‹ï¼Œå¦‚æœè®¿é—®é‡ç›¸æ¯”çª—å£å¤§å° N å¤§å¾ˆå¤šï¼Œåœ¨çª—å£ï¼ˆ0~Tï¼‰ä¸€å¼€å§‹çš„ 0 æ—¶åˆ»å°±ç›´æ¥æ¶Œè¿›æ¥ï¼Œä½¿å¾—æ¼æ¡¶åœ¨æ—¶é—´ tï¼ˆ 0â‰ˆt</p>
<p>è™½ç„¶å¯ä»¥é€šè¿‡é™åˆ¶æ¡¶å¤§å°çš„æ–¹å¼ä½¿å¾—è®¿é—®é‡æ§åˆ¶åœ¨ N ä»¥å†…ï¼Œä½†è¿™æ ·åšçš„å‰¯ä½œç”¨æ˜¯æµé‡åœ¨è¿˜æœªè¾¾åˆ°é™åˆ¶æ¡ä»¶å°±è¢«ç¦æ­¢ã€‚</p>
<p>è¿˜æœ‰ä¸€ä¸ªéšå«çš„çº¦æŸæ˜¯ï¼Œæ¼æ¡¶æ¼æ°´çš„é€Ÿåº¦æœ€å¥½æ˜¯ä¸€ä¸ªæ•´æ•°å€¼ï¼ˆå³å®¹é‡ N èƒ½å¤Ÿæ•´é™¤æ—¶é—´çª—å£å¤§å° T ï¼‰ï¼Œå¦åˆ™åœ¨è®¡ç®—å‰©ä½™æ°´é‡æ—¶ä¼šæœ‰äº›è®¸è¯¯å·®ã€‚</p>
<h4 id="4-ä»¤ç‰Œæ¡¶"><a href="#4-ä»¤ç‰Œæ¡¶" class="headerlink" title="4 ä»¤ç‰Œæ¡¶"></a>4 ä»¤ç‰Œæ¡¶</h4><p>æ¼æ¡¶æ¨¡å‹ä¸­ï¼Œè¯·æ±‚æ¥äº†æ˜¯å¾€æ¡¶é‡Œæ³¨æ°´ï¼Œå¦‚æœåä¸€ä¸‹ï¼ŒæŠŠè¯·æ±‚æ”¾è¡Œå˜æˆä»æ¡¶é‡ŒæŠ½æ°´ï¼Œå¯¹åº”çš„ï¼ŒæŠŠæ³¨æ°´çœ‹ä½œæ˜¯è¡¥å……ç³»ç»Ÿå¯æ‰¿å—æµé‡çš„è¯ï¼Œæ¼æ¡¶æ¨¡å‹å°±å˜æˆäº†ä»¤ç‰Œæ¡¶æ¨¡å‹ã€‚</p>
<p>ç†è§£æ¼æ¡¶ä¹‹åï¼Œå†çœ‹ä»¤ç‰Œæ¡¶å°±å¾ˆç®€å•äº†ï¼ŒæŠ„ä¸€æ®µä»¤ç‰Œæ¡¶çš„åŸç†ï¼š</p>
<blockquote>
<p>ä»¤ç‰Œæ¡¶ç®—æ³•çš„åŸç†æ˜¯ç³»ç»Ÿä»¥æ’å®šçš„é€Ÿç‡äº§ç”Ÿä»¤ç‰Œï¼Œç„¶åæŠŠä»¤ç‰Œæ”¾åˆ°ä»¤ç‰Œæ¡¶ä¸­ï¼Œä»¤ç‰Œæ¡¶æœ‰ä¸€ä¸ªå®¹é‡ï¼Œå½“ä»¤ç‰Œæ¡¶æ»¡äº†çš„æ—¶å€™ï¼Œå†å‘å…¶ä¸­æ”¾ä»¤ç‰Œï¼Œé‚£ä¹ˆå¤šä½™çš„ä»¤ç‰Œä¼šè¢«ä¸¢å¼ƒï¼›å½“æƒ³è¦å¤„ç†ä¸€ä¸ªè¯·æ±‚çš„æ—¶å€™ï¼Œéœ€è¦ä»ä»¤ç‰Œæ¡¶ä¸­å–å‡ºä¸€ä¸ªä»¤ç‰Œï¼Œå¦‚æœæ­¤æ—¶ä»¤ç‰Œæ¡¶ä¸­æ²¡æœ‰ä»¤ç‰Œï¼Œé‚£ä¹ˆåˆ™æ‹’ç»è¯¥è¯·æ±‚ã€‚</p>
</blockquote>
<p><a href="https://ucc.alicdn.com/pic/developer-ecology/c17f0f04ac0642cd8764e477b0880e26.png" title="image.png" class="gallery-item" style="box-shadow: none;"> <img src="https://ucc.alicdn.com/pic/developer-ecology/c17f0f04ac0642cd8764e477b0880e26.png" alt="image.png"></a></p>
<p><strong>ä»£ç å®ç° TokenBucketThrottler</strong></p>
<p>ä»¤ç‰Œæ¡¶ä¸æ¼æ¡¶æœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œå› æ­¤æ¼æ¡¶çš„ä»£ç ç¨å¾®æ”¹ä¸‹å°±å¯ä»¥å˜æˆä»¤ç‰Œæ¡¶ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">long now = System.currentTimeMillis();</span><br><span class="line">left = Math.min(capacity, left + (long)((now - lastInjectTime) * velocity));</span><br><span class="line">if (left - 1 &gt; 0) &#123;</span><br><span class="line">    lastInjectTime = now;</span><br><span class="line">    left--;</span><br><span class="line">    return true;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ä»¤ç‰Œæ¡¶çš„è¯ï¼Œå¯ä»¥è€ƒè™‘å€ŸåŠ© Guava ä¸­æä¾›çš„ RateLimiterã€‚å®ƒçš„å®ç°æ˜¯å¤šçº¿ç¨‹å®‰å…¨çš„ï¼Œè°ƒç”¨ RateLimiter#acquire æ—¶ï¼Œå¦‚æœå‰©ä½™ä»¤ç‰Œä¸è¶³ï¼Œä¼šé˜»å¡çº¿ç¨‹ä¸€æ®µæ—¶é—´ç›´è‡³æœ‰è¶³å¤Ÿçš„å¯ç”¨ä»¤ç‰Œï¼ˆè€Œä¸æ˜¯ç›´æ¥æ‹’ç»ï¼Œè¿™åœ¨æŸäº›åœºæ™¯ä¸‹å¾ˆæœ‰ç”¨ï¼‰ã€‚é™¤å»é»˜è®¤çš„ SmoothBursty ç­–ç•¥å¤–ï¼ŒRateLimiter è¿˜æä¾›äº†ä¸€ç§å« SmoothWarmingUp çš„ç­–ç•¥ï¼Œæ”¯æŒè®¾ç½®ä¸€ä¸ªçƒ­èº«æœŸï¼Œçƒ­èº«æœŸå†…ï¼ŒRateLimiter ä¼šå¹³æ»‘åœ°å°†æ”¾ä»¤ç‰Œçš„é€Ÿç‡åŠ å¤§ï¼Œç›´è‡´æœ€å¤§é€Ÿç‡ã€‚è®¾è®¡è¿™ä¸ªçš„æ„å›¾æ˜¯ä¸ºäº†æ»¡è¶³é‚£ç§èµ„æºæä¾›æ–¹éœ€è¦çƒ­èº«æ—¶é—´ï¼Œè€Œä¸æ˜¯æ¯æ¬¡è®¿é—®éƒ½èƒ½æä¾›ç¨³å®šé€Ÿç‡çš„æœåŠ¡çš„æƒ…å†µ(æ¯”å¦‚å¸¦ç¼“å­˜æœåŠ¡ï¼Œéœ€è¦å®šæœŸåˆ·æ–°ç¼“å­˜) ã€‚RateLimiter æœ‰ä¸€ä¸ªç¼ºç‚¹æ˜¯åªæ”¯æŒ QPS çº§åˆ«ã€‚</p>
<p><strong>æ¼æ¡¶ã€ä»¤ç‰Œæ¡¶çš„åŒºåˆ«</strong></p>
<p>è™½ç„¶ä¸¤è€…æœ¬è´¨ä¸Šåªæ˜¯åè½¬äº†ä¸€ä¸‹ï¼Œä¸è¿‡åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œé€‚ç”¨çš„åœºæ™¯ç¨æœ‰å·®åˆ«ï¼š</p>
<p>1ï¼‰æ¼æ¡¶ï¼šç”¨äºæ§åˆ¶ç½‘ç»œä¸­çš„é€Ÿç‡ã€‚åœ¨è¯¥ç®—æ³•ä¸­ï¼Œè¾“å…¥é€Ÿç‡å¯ä»¥å˜åŒ–ï¼Œä½†è¾“å‡ºé€Ÿç‡ä¿æŒæ’å®šã€‚å¸¸å¸¸é…åˆä¸€ä¸ª FIFO é˜Ÿåˆ—ä½¿ç”¨ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹ï¼Œæ¼æ¡¶çš„ç ´æ´æ˜¯å›ºå®šå¤§å°çš„ï¼Œå› æ­¤æ¼æ°´çš„é€Ÿç‡æ˜¯å¯ä»¥ä¿æŒæ’å®šçš„ã€‚</p>
<p>2ï¼‰ä»¤ç‰Œæ¡¶ï¼šæŒ‰ç…§å›ºå®šé€Ÿç‡å¾€æ¡¶ä¸­æ·»åŠ ä»¤ç‰Œï¼Œå…è®¸è¾“å‡ºé€Ÿç‡æ ¹æ®çªå‘å¤§å°è€Œå˜åŒ–ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ªç³»ç»Ÿé™åˆ¶ 60 ç§’å†…çš„æœ€å¤§è®¿é—®é‡æ˜¯ 60 æ¬¡ï¼Œæ¢ç®—é€Ÿç‡æ˜¯ 1 æ¬¡/ç§’ï¼Œå¦‚æœåœ¨ä¸€æ®µæ—¶é—´å†…æ²¡æœ‰è®¿é—®é‡ï¼Œé‚£ä¹ˆå¯¹æ¼æ¡¶è€Œè¨€æ­¤åˆ»æ˜¯ç©ºçš„ã€‚ç°åœ¨ï¼Œä¸€ç¬é—´æ¶Œå…¥ 60 ä¸ªè¯·æ±‚ï¼Œé‚£ä¹ˆæµé‡æ•´å½¢åï¼Œæ¼æ¡¶ä¼šä»¥æ¯ç§’ 1 ä¸ªè¯·æ±‚çš„é€Ÿåº¦ï¼ŒèŠ±ä¸Š 1 åˆ†é’Ÿå°† 60 ä¸ªè¯·æ±‚æ¼ç»™ä¸‹æ¸¸ã€‚æ¢æˆä»¤ç‰Œæ¡¶çš„è¯ï¼Œåˆ™æ˜¯ä»ä»¤ç‰Œæ¡¶ä¸­ä¸€æ¬¡æ€§å–èµ° 60 ä¸ªä»¤ç‰Œï¼Œä¸€ä¸‹å­å¡ç»™ä¸‹æ¸¸ã€‚</p>
<h4 id="5-æ»‘åŠ¨æ—¥å¿—"><a href="#5-æ»‘åŠ¨æ—¥å¿—" class="headerlink" title="5 æ»‘åŠ¨æ—¥å¿—"></a>5 æ»‘åŠ¨æ—¥å¿—</h4><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸Šè¿°çš„ç®—æ³•å·²ç»èƒ½å¾ˆå¥½åœ°ç”¨äºå¤§éƒ¨åˆ†å®é™…åº”ç”¨åœºæ™¯äº†ï¼Œå¾ˆå°‘æœ‰åœºæ™¯éœ€è¦çœŸæ­£å®Œå…¨ç²¾ç¡®çš„æ§åˆ¶ï¼ˆå³ä»»æ„ç»™å®šæ—¶é—´çª—å£Tå†…è¯·æ±‚é‡ä¸å¤§äº N ï¼‰ã€‚å¦‚æœè¦ç²¾ç¡®æ§åˆ¶çš„è¯ï¼Œæˆ‘ä»¬éœ€è¦è®°å½•æ¯ä¸€æ¬¡ç”¨æˆ·è¯·æ±‚æ—¥å¿—ï¼Œå½“æ¯æ¬¡æµæ§åˆ¤æ–­æ—¶ï¼Œå–å‡ºæœ€è¿‘æ—¶é—´çª—å£å†…çš„æ—¥å¿—æ•°ï¼Œçœ‹æ˜¯å¦å¤§äºæµæ§é˜ˆå€¼ã€‚è¿™å°±æ˜¯æ»‘åŠ¨æ—¥å¿—çš„ç®—æ³•æ€è·¯ã€‚</p>
<p>è®¾æƒ³æŸä¸€ä¸ªæ—¶åˆ» t æœ‰ä¸€ä¸ªè¯·æ±‚ï¼Œè¦åˆ¤æ–­æ˜¯å¦å…è®¸ï¼Œæˆ‘ä»¬è¦çœ‹çš„å…¶å®æ˜¯è¿‡å» t - N æ—¶é—´æ®µå†…æ˜¯å¦æœ‰å¤§äºç­‰äº N ä¸ªè¯·æ±‚è¢«æ”¾è¡Œï¼Œå› æ­¤åªè¦ç³»ç»Ÿç»´æŠ¤ä¸€ä¸ªé˜Ÿåˆ— qï¼Œé‡Œé¢è®°å½•æ¯ä¸€ä¸ªè¯·æ±‚çš„æ—¶é—´ï¼Œç†è®ºä¸Šå°±å¯ä»¥è®¡ç®—å‡ºä» t - N æ—¶åˆ»å¼€å§‹çš„è¯·æ±‚æ•°ã€‚</p>
<p>è€ƒè™‘åˆ°åªéœ€å…³å¿ƒå½“å‰æ—¶é—´ä¹‹å‰æœ€é•¿ T æ—¶é—´å†…çš„è®°å½•ï¼Œå› æ­¤é˜Ÿåˆ— q çš„é•¿åº¦å¯ä»¥åŠ¨æ€å˜åŒ–ï¼Œå¹¶ä¸”é˜Ÿåˆ—ä¸­æœ€å¤šåªè®°å½• N æ¡è®¿é—®ï¼Œå› æ­¤é˜Ÿåˆ—é•¿åº¦çš„æœ€å¤§å€¼ä¸º Nã€‚</p>
<blockquote>
<p>æ»‘åŠ¨æ—¥å¿—ä¸æ»‘åŠ¨çª—å£éå¸¸åƒï¼ŒåŒºåˆ«åœ¨äºæ»‘åŠ¨æ—¥å¿—çš„æ»‘åŠ¨æ˜¯æ ¹æ®æ—¥å¿—è®°å½•çš„æ—¶é—´åšåŠ¨æ€æ»‘åŠ¨ï¼Œè€Œæ»‘åŠ¨çª—å£æ˜¯æ ¹æ®å­çª—å£çš„å¤§å°ï¼Œä»¥å­çª—å£ç»´åº¦æ»‘åŠ¨ã€‚</p>
</blockquote>
<p><strong>ä¼ªä»£ç å®ç°</strong></p>
<p>ç®—æ³•çš„ä¼ªä»£ç è¡¨ç¤ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># åˆå§‹åŒ–</span><br><span class="line">counter = 0</span><br><span class="line">q = []</span><br><span class="line"></span><br><span class="line"># è¯·æ±‚å¤„ç†æµç¨‹</span><br><span class="line"># 1.æ‰¾åˆ°é˜Ÿåˆ—ä¸­ç¬¬ä¸€ä¸ªæ—¶é—´æˆ³&gt;=t-Tçš„è¯·æ±‚ï¼Œå³ä»¥å½“å‰æ—¶é—´tæˆªæ­¢çš„æ—¶é—´çª—å£Tå†…çš„æœ€æ—©è¯·æ±‚</span><br><span class="line">t = now</span><br><span class="line">start = findWindowStart(q, t)</span><br><span class="line"></span><br><span class="line"># 2.æˆªæ–­é˜Ÿåˆ—ï¼Œåªä¿ç•™æœ€è¿‘Tæ—¶é—´çª—å£å†…çš„è®°å½•å’Œè®¡æ•°å€¼</span><br><span class="line">q = q[start, q.length - 1] </span><br><span class="line">counter -= start</span><br><span class="line"></span><br><span class="line"># 3.åˆ¤æ–­æ˜¯å¦æ”¾è¡Œï¼Œå¦‚æœå…è®¸æ”¾è¡Œåˆ™å°†è¿™æ¬¡è¯·æ±‚åŠ åˆ°é˜Ÿåˆ— q çš„æœ«å°¾</span><br><span class="line">if counter &lt; threshold</span><br><span class="line">    push(q, t)</span><br><span class="line">    counter++</span><br><span class="line">    # æ”¾è¡Œ</span><br><span class="line">else</span><br><span class="line">    # é™æµ</span><br></pre></td></tr></table></figure>

<p>findWindowStart çš„å®ç°ä¾èµ–äºé˜Ÿåˆ— q ä½¿ç”¨çš„æ•°æ®ç»“æ„ï¼Œä»¥ç®€å•çš„æ•°ç»„ä¸ºä¾‹ï¼Œå¯ä»¥ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾ç­‰æ–¹å¼ã€‚åé¢ä¹Ÿä¼šçœ‹åˆ°ä½¿ç”¨å…¶ä»–æ•°æ®ç»“æ„å¦‚ä½•å®ç°ã€‚</p>
<p>å¦‚æœç”¨æ•°ç»„å®ç°ï¼Œä¸€ä¸ªéš¾ç‚¹å¯èƒ½æ˜¯å¦‚ä½•æˆªæ–­ä¸€ä¸ªé˜Ÿåˆ—ï¼Œä¸€ç§å¯è¡Œçš„æ€è·¯æ˜¯ä½¿ç”¨ä¸€ç»„å¤´å°¾æŒ‡é’ˆ head å’Œ tail åˆ†åˆ«æŒ‡å‘æ•°ç»„ä¸­æœ€è¿‘å’Œæœ€æ—©çš„æœ‰æ•ˆè®°å½•ç´¢å¼•æ¥è§£å†³ï¼Œ findWindowStart çš„å®ç°å°±å˜æˆåœ¨ tail å’Œ head ä¹‹é—´æŸ¥æ‰¾å¯¹åº”å…ƒç´ ã€‚</p>
<p><strong>å¤æ‚åº¦é—®é¢˜</strong></p>
<p>è™½ç„¶ç®—æ³•è§£å†³äº†ç²¾ç¡®åº¦é—®é¢˜ï¼Œä½†ä»£ä»·ä¹Ÿæ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦ä¿å­˜ä¸€ä¸ªé•¿åº¦æœ€å¤§ä¸º N çš„é˜Ÿåˆ—ï¼Œè¿™æ„å‘³ç€ç©ºé—´å¤æ‚åº¦è¾¾åˆ° O(N)ï¼Œå¦‚æœè¦é’ˆå¯¹ä¸åŒçš„ key åšæµæ§ï¼Œé‚£ä¹ˆç©ºé—´ä¸Šä¼šå ç”¨æ›´å¤šã€‚å½“ç„¶ï¼Œå¯ä»¥å¯¹ä¸æ´»è·ƒ key çš„é˜Ÿåˆ—è¿›è¡Œå¤ç”¨æ¥é™ä½å†…å­˜æ¶ˆè€—ã€‚</p>
<p>å…¶æ¬¡ï¼Œæˆ‘ä»¬éœ€è¦åœ¨é˜Ÿåˆ—ä¸­ç¡®å®šæ—¶é—´çª—å£ï¼Œå³é€šè¿‡ findWindowStart æ–¹æ³•å¯»æ‰¾ä¸æ—©äºå½“å‰æ—¶é—´æˆ³ t - N çš„è¯·æ±‚è®°å½•ã€‚ä»¥äºŒåˆ†æŸ¥æ‰¾ä¸ºä¾‹ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ O(logN)ã€‚</p>
<h3 id="å››-åˆ†å¸ƒå¼æµæ§"><a href="#å››-åˆ†å¸ƒå¼æµæ§" class="headerlink" title="å›› åˆ†å¸ƒå¼æµæ§"></a>å›› åˆ†å¸ƒå¼æµæ§</h3><p>ç°å®ä¸­çš„åº”ç”¨æœåŠ¡å¾€å¾€æ˜¯åˆ†å¸ƒå¼éƒ¨ç½²çš„ï¼Œå¦‚æœå…±ç”¨çš„èµ„æºï¼ˆä¾‹å¦‚æ•°æ®åº“ï¼‰æˆ–è€…ä¾èµ–çš„ä¸‹æ¸¸æœåŠ¡æœ‰æµé‡é™åˆ¶ï¼Œé‚£ä¹ˆåˆ†å¸ƒå¼æµæ§å°±è¦æ´¾ä¸Šç”¨åœºäº†ã€‚</p>
<p>è™½ç„¶å¯ä»¥ç»™æ¯å°åº”ç”¨æœåŠ¡å™¨å¹³å‡åˆ†é…æµæ§é…é¢ï¼ŒæŠŠé—®é¢˜è½¬æ¢ä¸ºå•æœºæµæ§ï¼Œä½†å¦‚æœç¢°åˆ°æµé‡ä¸å‡åŒ€ã€æœºå™¨å®•æœºã€ä¸´æ—¶æ‰©ç¼©å®¹ç­‰åœºæ™¯ï¼Œè¿™ç§åšæ³•çš„æ•ˆæœä¸ä½³ã€‚</p>
<p>åˆ†å¸ƒå¼ç¯å¢ƒä¸‹åšæµæ§çš„æ ¸å¿ƒç®—æ³•æ€è·¯å…¶å®ä¸å•æœºæµæ§æ˜¯ä¸€è‡´çš„ï¼ŒåŒºåˆ«åœ¨äºéœ€è¦å®ç°ä¸€ç§åŒæ­¥æœºåˆ¶æ¥ä¿è¯å…¨å±€é…é¢ã€‚åŒæ­¥æœºåˆ¶çš„å®ç°å¯ä»¥æœ‰ä¸­å¿ƒåŒ–å’Œå»ä¸­å¿ƒåŒ–ä¸¤ç§æ€è·¯ï¼š</p>
<p>1ï¼‰ä¸­å¿ƒåŒ–ï¼šé…é¢ç”±ä¸€ä¸ªä¸­å¿ƒç³»ç»Ÿç»Ÿä¸€ç®¡æ§ï¼Œåº”ç”¨è¿›ç¨‹é€šè¿‡å‘ä¸­å¿ƒç³»ç»Ÿç”³è¯·çš„æ–¹å¼è·å–æµæ§é…é¢ã€‚</p>
<ul>
<li>çŠ¶æ€çš„ä¸€è‡´æ€§åœ¨ä¸­å¿ƒç³»ç»Ÿç»´æŠ¤ï¼Œå®ç°ç®€å•ã€‚</li>
<li>ä¸­å¿ƒç³»ç»ŸèŠ‚ç‚¹çš„ä¸å¯ç”¨ä¼šå¯¼è‡´æµæ§å‡ºé”™ï¼Œéœ€è¦æœ‰é¢å¤–çš„ä¿æŠ¤ã€‚ä¾‹å¦‚ï¼Œä¸­å¿ƒåŒ–æµæ§åœ¨ä¸­å¿ƒå­˜å‚¨ä¸å¯ç”¨æ—¶ï¼Œå¾€å¾€ä¼šé€€åŒ–ä¸ºå•æœºæµæ§ã€‚</li>
</ul>
<p>2ï¼‰å»ä¸­å¿ƒåŒ–ï¼šåº”ç”¨è¿›ç¨‹ç‹¬ç«‹ä¿å­˜å’Œç»´æŠ¤æµæ§é…é¢çŠ¶æ€ï¼Œé›†ç¾¤å†…å‘¨æœŸæ€§å¼‚æ­¥é€šè®¯ä»¥ä¿æŒçŠ¶æ€ä¸€è‡´ã€‚</p>
<ul>
<li>ç›¸æ¯”ä¸­å¿ƒåŒ–æ–¹æ¡ˆï¼Œå»ä¸­å¿ƒåŒ–æ–¹æ¡ˆèƒ½å¤Ÿé™ä½ä¸­å¿ƒåŒ–å•ç‚¹å¯é æ€§å¸¦æ¥çš„å½±å“ï¼Œä½†å®ç°ä¸Šæ¯”è¾ƒå¤æ‚ï¼ŒçŠ¶æ€çš„ä¸€è‡´æ€§éš¾ä»¥ä¿è¯ã€‚</li>
<li>åœ¨ CAP ä¸­å»ä¸­å¿ƒåŒ–æ›´åŠ å€¾å‘äº A è€Œä¸­å¿ƒåŒ–æ›´å€¾å‘äº Cã€‚</li>
</ul>
<p>å»ä¸­å¿ƒåŒ–æ–¹æ¡ˆåœ¨ç”Ÿäº§ç¯å¢ƒä¸­æ²¡æœ‰è§è¿‡ï¼Œå› æ­¤ä¸‹æ–‡åªè®¨è®ºä¸­å¿ƒåŒ–æµæ§çš„æ€è·¯ã€‚</p>
<h4 id="1-æ¥å…¥å±‚å…¥å£æµæ§"><a href="#1-æ¥å…¥å±‚å…¥å£æµæ§" class="headerlink" title="1 æ¥å…¥å±‚å…¥å£æµæ§"></a>1 æ¥å…¥å±‚å…¥å£æµæ§</h4><p>åº”ç”¨æ¥å…¥çš„ç½‘ç»œæ¶æ„ä¸­ï¼Œåœ¨åº”ç”¨æœåŠ¡å™¨ä¹‹å‰å¾€å¾€æœ‰ä¸€å±‚ LVS æˆ– Nginx åšç»Ÿä¸€å…¥å£ï¼Œå¯ä»¥åœ¨è¿™ä¸€å±‚åšå…¥å£çš„æµæ§ã€‚æœ¬è´¨ä¸Šè¿™å°±æ˜¯å•æœºæµæ§çš„åœºæ™¯ã€‚</p>
<p>ä»¥ Nginx ä¸ºä¾‹ï¼ŒNginx æä¾›äº† ngx_http_limit_req_module æ¨¡å—ç”¨äºæµæ§ï¼Œåº•å±‚ä½¿ç”¨çš„æ˜¯æ¼æ¡¶ç®—æ³•ã€‚</p>
<p>ä¸€ä¸ª Nginx æµæ§é…ç½®çš„ç¤ºä¾‹å¦‚ä¸‹ï¼Œè¡¨ç¤ºæ¯ä¸ª IP åœ°å€æ¯ç§’åªèƒ½è¯·æ±‚ 10 æ¬¡ /login/ æ¥å£ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">limit_req_zone $binary_remote_addr zone=mylimit:10m rate=10r/s;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    location /login/ &#123;</span><br><span class="line">        limit_req zone=mylimit;</span><br><span class="line"></span><br><span class="line">        proxy_pass http://my_upstream;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Nginx çš„æµæ§æŒ‡ä»¤è¿˜æ”¯æŒæ›´å¤šé…ç½®ï¼Œæ¯”å¦‚è¯´é…ç½® limit_req æŒ‡ä»¤æ—¶åŠ ä¸Š burst å’Œ nodelay å‚æ•°æ¥å…è®¸ä¸€å®šç¨‹åº¦çš„çªå‘ï¼Œæˆ–è€…ç»“åˆ geo å’Œ map æŒ‡ä»¤æ¥å®ç°é»‘ç™½åå•æµæ§ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ Nginx å®˜æ–¹æ–‡æ¡£ï¼š<br>Rate Limiting with NGINX and NGINX Plusï¼ˆ<a href="https://www.nginx.com/blog/rate-limiting-nginx/%EF%BC%89%E3%80%82">https://www.nginx.com/blog/rate-limiting-nginx/ï¼‰ã€‚</a></p>
<p>å¦‚æœè‡ªå¸¦çš„æ¨¡å—ä¸èƒ½æ»¡è¶³ï¼Œé‚£å°±ä¸Šè‡ªå®šä¹‰çš„ lua æ¨¡å—å§ï¼Œå‚è€ƒ OpenResty æä¾›çš„ Lua é™æµæ¨¡å— lua-resty-limit-trafficã€‚</p>
<h4 id="2-TokenServer-æµæ§"><a href="#2-TokenServer-æµæ§" class="headerlink" title="2 TokenServer æµæ§"></a>2 TokenServer æµæ§</h4><blockquote>
<p>è¿™é‡Œå€Ÿç”¨äº† Sentinel ä¸­çš„ TokenServer å«æ³•ï¼ŒSentinel é›†ç¾¤æµæ§çš„ä»‹ç»å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼šSentinelé›†ç¾¤æµæ§ï¼ˆ<a href="https://github.com/alibaba/Sentinel/wiki/%E9%9B%86%E7%BE%A4%E6%B5%81%E6%8E%A7%EF%BC%89%E3%80%82">https://github.com/alibaba/Sentinel/wiki/é›†ç¾¤æµæ§ï¼‰ã€‚</a></p>
</blockquote>
<p>è¿™ç±»æµæ§çš„æ€è·¯æ˜¯æ‰¾ä¸€ä¸ª TokenServer æ¥ä¸“é—¨æ¥ç®¡æ§æµæ§é…é¢ï¼ŒåŒ…æ‹¬ç»Ÿè®¡æ€»è°ƒç”¨é‡ï¼Œåˆ¤æ–­å•ä¸ªè¯·æ±‚æ˜¯å¦å…è®¸ç­‰ç­‰ï¼Œåº”ç”¨æœåŠ¡å™¨ä½œä¸ºå®¢æˆ·ç«¯ä¸ TokenServer é€šä¿¡æ¥è·å–é…é¢ã€‚å› ä¸ºæµæ§çš„é€»è¾‘åœ¨ TokenServer å†…éƒ¨ç»Ÿä¸€å¤„ç†ï¼Œå› æ­¤å•æœºæµæ§ä¸­è®¨è®ºçš„ç®—æ³•åŒæ ·é€‚ç”¨ã€‚</p>
<p>å¾ˆè‡ªç„¶åœ°èƒ½æƒ³åˆ°ï¼Œè¿™ç±»æµæ§éå¸¸ä¾èµ–äº TokenServer çš„æ€§èƒ½å’Œå¯ç”¨æ€§ã€‚</p>
<p>æ€§èƒ½æ–¹é¢ï¼Œå•ç‚¹çš„ TokenServer å¾ˆå®¹æ˜“æˆä¸ºç“¶é¢ˆï¼ŒæŸ¥ Sentinel æºç ï¼Œå…¶ä¸­ä½¿ç”¨äº† Netty æ¥åšç½‘ç»œé€šä¿¡ï¼Œæ•°æ®åŒ…é‡‡ç”¨è‡ªå®šä¹‰æ ¼å¼ï¼Œå…¶ä»–æ€§èƒ½ä¼˜åŒ–èƒ½æ‰¾åˆ°çš„ä¸å¤šã€‚</p>
<p>å¯ç”¨æ€§æ–¹é¢ï¼Œå°±åƒ Sentinel å®˜æ–¹æ–‡æ¡£ä¸­è®²çš„ï¼Œè‹¥åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ TokenServer é›†ç¾¤é™æµï¼Œå¿…é¡»è¦è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š</p>
<p>Token Server è‡ªåŠ¨ç®¡ç†ã€è°ƒåº¦ï¼ˆåˆ†é…/é€‰ä¸¾ Token Serverï¼‰</p>
<p>Token Server é«˜å¯ç”¨ï¼Œåœ¨æŸä¸ª Server ä¸å¯ç”¨æ—¶è‡ªåŠ¨ failover åˆ°å…¶å®ƒæœºå™¨</p>
<p>ç›®å‰ Sentinel çš„ TokenServer é»˜è®¤å¹¶æ²¡æœ‰å®ç°è¿™äº›èƒ½åŠ›ï¼Œéœ€è¦å®šåˆ¶æˆ–å¢åŠ å…¶ä»–ç³»ç»Ÿæ¥å®ç°ï¼Œä¾‹å¦‚ï¼Œé‡‡ç”¨ä¸€ç§åˆ†å¸ƒå¼ä¸€è‡´æ€§åè®®æ¥åšé›†ç¾¤é€‰ä¸¾ï¼Œæˆ–è€…å€ŸåŠ©ä¸€ç»„ monitor æ¥ç›‘æ§çŠ¶æ€ï¼Œå®ç°æˆæœ¬è¿˜æ˜¯æŒºé«˜çš„ã€‚</p>
<h4 id="3-å­˜å‚¨å¼æµæ§"><a href="#3-å­˜å‚¨å¼æµæ§" class="headerlink" title="3 å­˜å‚¨å¼æµæ§"></a>3 å­˜å‚¨å¼æµæ§</h4><p>å­˜å‚¨å¼æµæ§çš„æ€æƒ³æ˜¯é€šè¿‡ä¸€ä¸ªå­˜å‚¨ç³»ç»Ÿæ¥ä¿å­˜æµæ§çš„è®¡æ•°å€¼ç­‰ç»Ÿè®¡ä¿¡æ¯ï¼Œåº”ç”¨ä»å­˜å‚¨ä¸­è·å–ç»Ÿè®¡ä¿¡æ¯ï¼Œç„¶åå°†æœ€æ–°çš„è¯·æ±‚ä¿¡æ¯å†å†™å…¥å­˜å‚¨ä¸­ã€‚å­˜å‚¨ç³»ç»Ÿå¯ä»¥é€‰æ‹©ç°æˆçš„ MySQL æ•°æ®åº“æˆ–è€… Redis ç¼“å­˜ç­‰ï¼Œä¸€èˆ¬ä»æ€§èƒ½å‡ºå‘é€‰æ‹©ç¼“å­˜çš„æ¯”è¾ƒå¤šã€‚è¿™é‡Œé€‰æ‹© Tair å’Œ Redis åšä¾‹å­ã€‚</p>
<p><strong>Tair æµæ§</strong></p>
<p>æ¯”è¾ƒç®€å•ï¼Œç›´æ¥ä¸Šä»£ç å®ç°ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public boolean tryAcquire(String key) &#123;</span><br><span class="line">  // ä»¥ç§’ä¸ºå•ä½æ„å»ºtairçš„key</span><br><span class="line">  String wrappedKey = wrapKey(key);</span><br><span class="line">  // æ¯æ¬¡è¯·æ±‚+1ï¼Œåˆå§‹å€¼ä¸º0ï¼Œkeyçš„æœ‰æ•ˆæœŸè®¾ç½®5s</span><br><span class="line">  Result&lt;Integer&gt; result = tairManager.incr(NAMESPACE, wrappedKey, 1, 0, 5);</span><br><span class="line">  return result.isSuccess() &amp;&amp; result.getValue() &lt;= threshold;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private String wrapKey(String key) &#123;</span><br><span class="line">  long sec = System.currentTimeMillis() / 1000L;</span><br><span class="line">  return key + &quot;:&quot; + sec;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ˜¯ä¸æ˜¯æ„Ÿè§‰å¤ªç®€å•äº†ç‚¹ï¼Ÿå¾—ç›Šäº Tair çš„é«˜æ€§èƒ½ï¼Œè¿™ç§æ–¹å¼å¯ä»¥å¾ˆå¥½åœ°æ”¯æ’‘å¤§æµé‡ã€‚</p>
<p>è¿™ç§ Tair æµæ§çš„æ–¹æ¡ˆå®é™…ä¸Šç”¨çš„ç®€å•çª—å£çš„æ€è·¯ï¼Œæ¯ä¸ª key ä»¥æ¯ç§’ä¸ºä¸€ä¸ªæ—¶é—´çª—å£åš QPS æ§åˆ¶ï¼ˆQPM/QPD åŸç†ç±»ä¼¼ï¼‰ã€‚å…³é”®åœ¨äºç”¨åˆ°äº† Tair çš„è¿™ä¸ª APIï¼š</p>
<blockquote>
<p>incr</p>
</blockquote>
<p>Result incr(int namespace, Serializable key, int value, int defaultValue, int expireTime)<br>æè¿°<br>å¢åŠ è®¡æ•°ã€‚æ³¨æ„ï¼šincr å‰ä¸è¦ putï¼ï¼<br>å‚æ•°<br>namespace - ç”³è¯·æ—¶åˆ†é…çš„ namespace<br>key - key åˆ—è¡¨ï¼Œä¸è¶…è¿‡ 1k<br>value - å¢åŠ é‡<br>defaultValue - ç¬¬ä¸€æ¬¡è°ƒç”¨ incr æ—¶çš„ key çš„ count åˆå§‹å€¼ï¼Œç¬¬ä¸€æ¬¡è¿”å›çš„å€¼ä¸º defaultValue + valueã€‚<br>expireTime - æ•°æ®è¿‡æœŸæ—¶é—´ï¼Œå•ä½ä¸ºç§’ï¼Œå¯è®¾ç›¸å¯¹æ—¶é—´æˆ–ç»å¯¹æ—¶é—´ï¼ˆUnix æ—¶é—´æˆ³ï¼‰ã€‚expireTime = 0ï¼Œè¡¨ç¤ºæ•°æ®æ°¸ä¸è¿‡æœŸã€‚expireTime &gt; 0ï¼Œè¡¨ç¤ºè®¾ç½®è¿‡æœŸæ—¶é—´ã€‚è‹¥ expireTime &gt; å½“å‰æ—¶é—´çš„æ—¶é—´æˆ³ï¼Œåˆ™è¡¨ç¤ºä½¿ç”¨ç»å¯¹æ—¶é—´ï¼Œå¦åˆ™ä½¿ç”¨ç›¸å¯¹æ—¶é—´ã€‚expireTime &lt; 0ï¼Œè¡¨ç¤ºä¸å…³æ³¨è¿‡æœŸæ—¶é—´ï¼Œè‹¥ä¹‹å‰è®¾è¿‡è¿‡æœŸæ—¶é—´ï¼Œåˆ™å·²ä¹‹å‰çš„è¿‡æœŸæ—¶é—´ä¸ºå‡†ï¼Œè‹¥æ²¡æœ‰ï¼Œåˆ™ä½œä¸ºæ°¸ä¸è¿‡æœŸå¤„ç†ï¼Œä½†å½“å‰ mdb ç»Ÿä¸€å½“åšæ°¸ä¸è¿‡æœŸæ¥å¤„ç†ã€‚<br>è¿”å›å€¼<br>Result å¯¹è±¡ï¼Œè¿”å›å€¼å¯ä¸ºè´Ÿå€¼ã€‚å½“ key ä¸å­˜åœ¨æ—¶ï¼Œç¬¬ä¸€æ¬¡è¿”å› defaultValue+ valueã€‚åç»­çš„ incr åŸºäºè¯¥å€¼å¢åŠ  valueã€‚</p>
<p>å½“ç„¶è¿™ç§æ–¹å¼ä¹Ÿæœ‰ç¼ºç‚¹ï¼š</p>
<ul>
<li>ç®€å•çª—å£çš„ä¸´ç•Œçªå˜é—®é¢˜ã€‚</li>
<li>Tair çš„å¯é æ€§é—®é¢˜ï¼Œéœ€è¦æœ‰é™çº§æ–¹æ¡ˆã€‚ä¸Šé¢å…¶å®ä¹Ÿè¯´äº†ï¼Œä¸­å¿ƒåŒ–çš„æµæ§ä¸€èˆ¬éƒ½éœ€è¦æ­é…é™çº§çš„å•æœºæµæ§ã€‚</li>
<li>é›†ç¾¤æœºå™¨çš„æ—¶é—´åŒæ­¥é—®é¢˜ã€‚ç”±äºç”Ÿæˆ key ä¼šç”¨åˆ°é›†ç¾¤æœºå™¨çš„æœ¬åœ°æ—¶é—´ï¼Œå› æ­¤è¦æ±‚æœºå™¨æ—¶é—´å¿…é¡»æ˜¯ä¸€è‡´çš„ã€‚</li>
</ul>
<p>æ‰“ä¸ªæ¯”æ–¹ï¼Œä¸åŒæœºå™¨æ—¶é—´ç¨å¾®å·®ä¸ª 10msï¼Œåœ¨æ—¶é—´çª—å£çš„é—´éš”ç‚¹ä¸Šçš„ç»Ÿè®¡å°±ä¼šäº§ç”Ÿæ¯”è¾ƒå¤§çš„è¯¯å·®ï¼Œæ¯”å¦‚è¯´åœ¨åŒä¸€æ—¶åˆ»ï¼Œä¸€å°æœºå™¨æ—¶é—´æ˜¯ 0.990ï¼Œä¸€å°æ˜¯ 1.000ï¼Œä¸¤è€…è°ƒç”¨ incr æ—¶æ“ä½œçš„ key ä¸ä¸€æ ·ï¼Œç²¾åº¦è‡ªç„¶å°±ä¼šå—å½±å“ã€‚</p>
<p><strong>Redis æµæ§</strong></p>
<p>Redis æ”¯æŒä¸°å¯Œçš„æ•°æ®ç»“æ„ï¼Œæ€§èƒ½ä¹Ÿä¸é”™ï¼Œå…¶â€œå•è¿›ç¨‹â€æ¨¡å‹æ–¹ä¾¿åŒæ­¥æ§åˆ¶ï¼Œå› æ­¤éå¸¸é€‚åˆç”¨æ¥åšåˆ†å¸ƒå¼æµæ§çš„å­˜å‚¨ã€‚</p>
<p>1ï¼‰ç®€å•çª—å£å®ç°</p>
<p>ä½¿ç”¨ Redis å®ç°ç®€å•çª—å£æµæ§çš„æ€è·¯è·Ÿä½¿ç”¨ Tair æ˜¯ä¸€è‡´çš„ã€‚Redis ä¹Ÿæä¾›äº† INCR å‘½ä»¤ç”¨äºè®¡æ•°ï¼ŒåŒæ—¶ Redis çš„â€œå•è¿›ç¨‹â€æ¨¡å‹ä¹Ÿæä¾›äº†å¾ˆå¥½çš„å¹¶å‘ä¿æŠ¤ã€‚Redis çš„å®˜æ–¹æ–‡æ¡£å°±å†™äº†å¦‚ä½•ä½¿ç”¨ INCR æ¥å®ç° Rate Limiterï¼Œæˆ‘è¿™é‡Œç¨ä½œç¿»è¯‘äº†ä¸‹ï¼š</p>
<blockquote>
<p>Redis INCR key(<a href="https://redis.io/commands/incr">https://redis.io/commands/incr</a>)</p>
</blockquote>
<p>ä»¥ç®€å•çª—å£ä¸ºä¾‹ï¼Œæœ€ç®€å•ç›´æ¥çš„å®ç°å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FUNCTION LIMIT_API_CALL(ip)</span><br><span class="line">ts = CURRENT_UNIX_TIME()</span><br><span class="line">keyname = ip+&quot;:&quot;+ts</span><br><span class="line">current = GET(keyname)</span><br><span class="line">IF current != NULL AND current &gt; 10 THEN</span><br><span class="line">    ERROR &quot;too many requests per second&quot;</span><br><span class="line">ELSE</span><br><span class="line">    MULTI</span><br><span class="line">        INCR(keyname,1)</span><br><span class="line">        EXPIRE(keyname,10)</span><br><span class="line">    EXEC</span><br><span class="line">    PERFORM_API_CALL()</span><br><span class="line">END</span><br></pre></td></tr></table></figure>

<p>å®ç°ä¸Šä¸ä¸Šè¿°çš„ Tair ç±»ä¼¼ï¼Œä¹Ÿæ˜¯å¯¹æ¯ä¸ª key ä»¥ç§’ä¸ºå•ä½ç»´æŠ¤ä¸€ä¸ªè®¡æ•°å™¨ï¼Œå·®åˆ«åœ¨äºå› ä¸º Redis æ²¡æœ‰æä¾›åŸå­çš„ INCR + EXPIRE æŒ‡ä»¤ï¼Œæ‰€ä»¥åœ¨ INCR ä¹‹åéœ€è¦å†è°ƒç”¨ä¸€æ¬¡ EXPIRE æ¥è®¾ç½® key çš„æœ‰æ•ˆæœŸã€‚åŒæ—¶åœ¨å¤–å±‚ä»¥ MULTI å’Œ EXEC åŒ…è£¹ä»¥ä¿è¯äº‹åŠ¡æ€§ã€‚</p>
<p>å¦‚æœä¸æƒ³æ¯æ¬¡éƒ½è°ƒç”¨ EXPIREï¼Œå¯ä»¥è€ƒè™‘ç¬¬äºŒç§æ–¹å¼ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FUNCTION LIMIT_API_CALL(ip):</span><br><span class="line">current = GET(ip)</span><br><span class="line">IF current != NULL AND current &gt; 10 THEN</span><br><span class="line">    ERROR &quot;too many requests per second&quot;</span><br><span class="line">ELSE</span><br><span class="line">    value = INCR(ip)</span><br><span class="line">    IF value == 1 THEN</span><br><span class="line">        EXPIRE(ip,1)</span><br><span class="line">    END</span><br><span class="line">    PERFORM_API_CALL()</span><br><span class="line">END</span><br></pre></td></tr></table></figure>

<p>è®¡æ•°å™¨çš„æœ‰æ•ˆæœŸåœ¨ç¬¬ä¸€æ¬¡ INCR æ—¶è®¾ç½®ä¸º 1sï¼Œå› æ­¤ä¸éœ€è¦å¯¹ key è¿›è¡Œé¢å¤–å¤„ç†ã€‚</p>
<p>ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§æ–¹å¼å­˜åœ¨ä¸€ç§éšè—çš„ç«äº‰æ¡ä»¶ã€‚å¦‚æœå®¢æˆ·ç«¯åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨äº† INCR åï¼Œç”±äºåº”ç”¨å´©æºƒæˆ–å…¶ä»–åŸå› æ²¡æœ‰è°ƒç”¨ EXPIREï¼Œè®¡æ•°å™¨ä¼šä¸€ç›´å­˜åœ¨ã€‚</p>
<p>é’ˆå¯¹æ–¹å¼äºŒçš„è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ç”¨ lua è„šæœ¬è§£å†³ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">local current</span><br><span class="line">current = redis.call(&quot;incr&quot;,KEYS[1])</span><br><span class="line">if tonumber(current) == 1 then</span><br><span class="line">    redis.call(&quot;expire&quot;,KEYS[1],1)</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸‰ç§æ–¹å¼æ˜¯é€šè¿‡ Redis çš„ list ç»“æ„æ¥å®ç°ã€‚æ›´å¤æ‚ä¸€äº›ä½†å¯ä»¥è®°å½•ä¸‹æ¯æ¬¡çš„è¯·æ±‚ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FUNCTION LIMIT_API_CALL(ip)</span><br><span class="line">current = LLEN(ip)</span><br><span class="line">IF current &gt; 10 THEN</span><br><span class="line">    ERROR &quot;too many requests per second&quot;</span><br><span class="line">ELSE</span><br><span class="line">    IF EXISTS(ip) == FALSE              #1</span><br><span class="line">        MULTI</span><br><span class="line">            RPUSH(ip,ip)</span><br><span class="line">            EXPIRE(ip,1)</span><br><span class="line">        EXEC</span><br><span class="line">    ELSE</span><br><span class="line">        RPUSHX(ip,ip)</span><br><span class="line">    END</span><br><span class="line">    PERFORM_API_CALL()</span><br><span class="line">END</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä¹Ÿæœ‰ä¸€ä¸ªéšå«çš„ç«äº‰æ¡ä»¶ï¼Œåœ¨æ‰§è¡Œåˆ° EXIST åˆ¤æ–­è¿™ä¸€è¡Œï¼ˆ#1 ä½ç½®ï¼‰æ—¶ï¼Œä¸¤ä¸ªå®¢æˆ·ç«¯çš„ EXIST å‘½ä»¤å¯èƒ½éƒ½ä¼šè¿”å› falseï¼Œå› æ­¤ MULTI/EXEC å—é‡Œçš„å‘½ä»¤ä¼šè¢«æ‰§è¡Œä¸¤æ¬¡ï¼Œä¸è¿‡è¿™ç§æƒ…å†µå¾ˆå°‘å‡ºç°ï¼Œä¸å¤ªä¼šå½±å“è®¡æ•°å™¨çš„å‡†ç¡®æ€§ã€‚</p>
<p>ä¸Šè¿°çš„å‡ ç§æ–¹å¼è¿˜å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œå› ä¸º INCR å’Œ RPUSH è¿™äº›å‘½ä»¤éƒ½ä¼šè¿”å›æ“ä½œåçš„è®¡æ•°å™¨å€¼ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ set-then-get çš„æ–¹å¼è·å–è®¡æ•°å™¨å€¼ã€‚</p>
<p>å°†ç®€å•çª—å£æ”¹é€ æˆæ»‘åŠ¨çª—å£ä¹Ÿæ˜¯ç±»ä¼¼çš„æ€è·¯ï¼ŒæŠŠå•ä¸€çš„ key æ¢æˆä¸€ä¸ª hash ç»“æ„ï¼Œhash é‡Œé¢ä¸ºæ¯ä¸ªå­çª—å£ä¿å­˜ä¸€ä¸ªè®¡æ•°å€¼ï¼Œåœ¨ç»Ÿè®¡æ—¶ï¼Œå°†åŒä¸ª hash ä¸­æ‰€æœ‰å­çª—å£çš„è®¡æ•°å€¼ç›¸åŠ å³å¯ã€‚</p>
<p>2ï¼‰ä»¤ç‰Œæ¡¶/æ¼æ¡¶å®ç°</p>
<p>ç”¨ Redis å®ç°ä»¤ç‰Œæ¡¶æˆ–è€…æ¼æ¡¶ä¹Ÿéå¸¸ç®€å•ã€‚ä»¥ä»¤ç‰Œæ¡¶ä¸ºä¾‹ï¼Œåœ¨å®ç°ä¸Šï¼Œå¯ä»¥ç”¨ä¸¤ä¸ª key åˆ†åˆ«å­˜å‚¨æ¯ä¸ªç”¨æˆ·çš„å¯ç”¨ token æ•°å’Œä¸Šæ¬¡è¯·æ±‚æ—¶é—´ï¼Œå¦ä¸€ç§å¯èƒ½æ›´å¥½çš„åŠæ³•æ˜¯ä½¿ç”¨ Redis çš„ hash æ•°æ®ç»“æ„ã€‚</p>
<p>ä¸‹å›¾çš„ç¤ºä¾‹æ˜¯ä¸€ä¸ªç”¨æˆ· user_1 å½“å‰åœ¨ Redis ä¸­ä¿å­˜çš„æµæ§é…é¢æ•°æ®ï¼šä»¤ç‰Œæ¡¶ä¸­å½“å‰å‰©ä½™ 2 ä¸ª tokenï¼Œæœ€è¿‘ä¸€æ¬¡è®¿é—®çš„æ—¶é—´æˆ³æ˜¯ 1490868000ã€‚</p>
<p><a href="https://ucc.alicdn.com/pic/developer-ecology/7a12af696eef4851ab16afb0d44426ea.png" title="image.png" class="gallery-item" style="box-shadow: none;"> <img src="https://ucc.alicdn.com/pic/developer-ecology/7a12af696eef4851ab16afb0d44426ea.png" alt="image.png"></a></p>
<p>å½“æ”¶åˆ°ä¸€ä¸ªæ–°è¯·æ±‚æ—¶ï¼ŒRedis å®¢æˆ·ç«¯è¦æ‰§è¡Œçš„æ“ä½œä¸æˆ‘ä»¬åœ¨å•æœºæµæ§ç®—æ³•ä¸­çœ‹åˆ°çš„ä¸€æ ·ã€‚é¦–å…ˆï¼Œä»å¯¹åº” hash ä¸­è·å¾—å½“å‰é…é¢æ•°æ®ï¼ˆHGETALLï¼‰ï¼Œæ ¹æ®å½“å‰æ—¶é—´æˆ³ã€ä¸Šæ¬¡è¯·æ±‚çš„æ—¶é—´æˆ³å’Œ token å¡«å……é€Ÿåº¦è®¡ç®—è¦å¡«å……çš„ token æ•°ï¼›ç„¶åï¼Œåˆ¤æ–­æ˜¯å¦æ”¾è¡Œï¼Œæ›´æ–°æ–°çš„æ—¶é—´æˆ³å’Œ token æ•°ï¼ˆHMSETï¼‰ã€‚</p>
<p>ä¸€ä¸ªç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<p><a href="https://ucc.alicdn.com/pic/developer-ecology/2e0a53670860429faca7b77337931117.png" title="image.png" class="gallery-item" style="box-shadow: none;"> <img src="https://ucc.alicdn.com/pic/developer-ecology/2e0a53670860429faca7b77337931117.png" alt="image.png"></a></p>
<p>åŒæ ·çš„ï¼Œå¦‚æœè¦æ±‚æ¯”è¾ƒé«˜çš„ç²¾åº¦ï¼Œè¿™é‡Œå¿…é¡»è¦å¯¹å®¢æˆ·ç«¯çš„æ“ä½œåšå¹¶å‘æ§åˆ¶ã€‚</p>
<p>ä¸åšåŒæ­¥æ§åˆ¶å¯èƒ½å¯¼è‡´çš„é—®é¢˜ç¤ºä¾‹ï¼šæ¡¶é‡Œåªæœ‰ä¸€ä¸ª tokenï¼Œä¸¤ä¸ªå®¢æˆ·ç«¯åŒæ—¶è¯·æ±‚æ—¶å‡ºç°å¹¶å‘å†²çªï¼Œç»“æœæ˜¯è¯·æ±‚éƒ½ä¼šæ”¾è¡Œã€‚</p>
<p><a href="https://ucc.alicdn.com/pic/developer-ecology/c86cda7753e4469b8f517da77be5a4af.png" title="image.png" class="gallery-item" style="box-shadow: none;"> <img src="https://ucc.alicdn.com/pic/developer-ecology/c86cda7753e4469b8f517da77be5a4af.png" alt="image.png"></a></p>
<p>lua ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">local tokens_key = KEYS[1]</span><br><span class="line">local timestamp_key = KEYS[2]</span><br><span class="line"></span><br><span class="line">local rate = tonumber(ARGV[1])</span><br><span class="line">local capacity = tonumber(ARGV[2])</span><br><span class="line">local now = tonumber(ARGV[3])</span><br><span class="line">local requested = tonumber(ARGV[4])</span><br><span class="line"></span><br><span class="line">local fill_time = capacity/rate</span><br><span class="line">local ttl = math.floor(fill_time*2)</span><br><span class="line"></span><br><span class="line">local last_tokens = tonumber(redis.call(&quot;get&quot;, tokens_key))</span><br><span class="line">if last_tokens == nil then</span><br><span class="line">  last_tokens = capacity</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">local last_refreshed = tonumber(redis.call(&quot;get&quot;, timestamp_key))</span><br><span class="line">if last_refreshed == nil then</span><br><span class="line">  last_refreshed = 0</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">local delta = math.max(0, now-last_refreshed)</span><br><span class="line">local filled_tokens = math.min(capacity, last_tokens+(delta*rate))</span><br><span class="line">local allowed = filled_tokens &gt;= requested</span><br><span class="line">local new_tokens = filled_tokens</span><br><span class="line">if allowed then</span><br><span class="line">  new_tokens = filled_tokens - requested</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">redis.call(&quot;setex&quot;, tokens_key, ttl, new_tokens)</span><br><span class="line">redis.call(&quot;setex&quot;, timestamp_key, ttl, now)</span><br><span class="line"></span><br><span class="line">return &#123; allowed, new_tokens &#125;</span><br></pre></td></tr></table></figure>

<p>3ï¼‰æ»‘åŠ¨æ—¥å¿—å®ç°</p>
<p>å¾—ç›Šäº Redis çš„ Sorted Set ç»“æ„ï¼Œå®ç°æ»‘åŠ¨æ—¥å¿—å˜å¾—å¼‚å¸¸ç®€å•ã€‚æµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p>
<p>aï¼‰æ¯ä¸ªç”¨æˆ·æœ‰ä¸€ä¸ªå¯¹åº”çš„ Sorted Set è®°å½•è¯·æ±‚æ—¥å¿—ã€‚</p>
<ul>
<li>å…¶ä¸­æ¯ä¸ªå…ƒç´ çš„ key å’Œ value å¯ä»¥æ˜¯ç›¸åŒçš„ï¼Œå³è¯·æ±‚çš„æ—¶é—´æˆ³ã€‚</li>
<li>Sorted Set å¯ä»¥æ ¹æ®æ—¶é—´çª—å£å¤§å°è®¾ç½®æœ‰æ•ˆæœŸï¼Œæ¯”å¦‚æ—¶é—´çª—å£ä¸º 1s æ—¶è®¾ç½®è¿‡æœŸæ—¶é—´ 5sï¼Œåœ¨è¯·æ±‚é‡ä¸å¤§æ—¶å¯ä»¥èŠ‚çœ Redis æœåŠ¡å™¨å†…å­˜ã€‚</li>
</ul>
<p>bï¼‰å½“æ”¶åˆ°ä¸€ä¸ªæ–°çš„ç”¨æˆ·è¯·æ±‚æ—¶ï¼Œé¦–å…ˆé€šè¿‡ ZREMRANGEBYSCORE å‘½ä»¤åˆ é™¤ Sorted Set ä¸­è¿‡æœŸçš„å…ƒç´ ï¼Œè¿™é‡Œçš„è¿‡æœŸå³ï¼š</p>
<p>è¯·æ±‚æ—¶é—´æˆ³ t &lt; å½“å‰æ—¶é—´æˆ³ now - æ—¶é—´çª—å£å¤§å° interval</p>
<p>cï¼‰ä½¿ç”¨ ZADD å°†å½“å‰è¯·æ±‚æ·»åŠ åˆ° Set ä¸­ã€‚</p>
<p>dï¼‰ä½¿ç”¨ ZCOUNT è·å–å½“å‰å‰©ä½™ Set å¤§å°ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦æµæ§ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">long now = System.currentTimeMillis();</span><br><span class="line">long maxScoreMs = now - windowInSecond * 1000;</span><br><span class="line"></span><br><span class="line">Transaction redis = jedisPool.getResource().multi();</span><br><span class="line">redis.zremrangeByScore(key, 0, maxScoreMs);</span><br><span class="line">redis.zadd(key, now, now + &quot;-&quot; + Math.random()); // åŠ å…¥ä¸€ä¸ªéšæœºå€¼ä½¿å¾—memberä¸é‡å¤</span><br><span class="line">redis.expire(key, windowInSecond);</span><br><span class="line">redis.exec();</span><br></pre></td></tr></table></figure>

<p>å¦ä¸€ä¸ª JS å®ç°çš„ä»£ç ç¤ºä¾‹ï¼š<br><a href="https://github.com/peterkhayes/rolling-rate-limiter/blob/master/index.js">https://github.com/peterkhayes/rolling-rate-limiter/blob/master/index.js</a></p>
<p>ç”±äºæ»‘åŠ¨æ—¥å¿—ç®—æ³•çš„ç©ºé—´å¤æ‚åº¦è¾ƒå…¶ä»–ç®—æ³•é«˜ï¼Œä½¿ç”¨æ»‘åŠ¨æ—¥å¿—ç®—æ³•æ—¶ï¼Œéœ€è¦æ³¨æ„ç›‘æ§ Redis å†…å­˜çš„ä½¿ç”¨é‡ã€‚</p>
<p>4ï¼‰å¹¶å‘æ§åˆ¶</p>
<p>ä¸Šé¢çš„å‡ ç§ç®—æ³•éƒ½æåˆ°äº†ä¸åšå¹¶å‘æ§åˆ¶å¯èƒ½å¸¦æ¥çš„ç«æ€æ¡ä»¶ï¼Œä½†é¢å¤–çš„å¹¶å‘æ§åˆ¶å¿…ç„¶ä¼šå¸¦æ¥æ€§èƒ½ä¸‹é™ï¼Œé€šå¸¸éœ€è¦åœ¨ç²¾åº¦å’Œæ€§èƒ½ä¹‹é—´åšå–èˆã€‚Redis æµæ§çš„å¹¶å‘æ§åˆ¶å¸¸è§çš„æœ‰å‡ ç±»ï¼š</p>
<ul>
<li>ä½¿ç”¨ Redis äº‹åŠ¡ MULTI/EXECã€‚</li>
<li>ä½¿ç”¨ RedLockï¼ˆ<a href="https://redis.io/topics/distlock%EF%BC%89">https://redis.io/topics/distlockï¼‰</a> ç­‰åˆ†å¸ƒå¼é”ï¼Œè¦æ±‚æ¯ä¸ªå®¢æˆ·ç«¯æ“ä½œå‰å…ˆè·å–å¯¹åº” key çš„åˆ†å¸ƒå¼é”ã€‚</li>
<li>Lua è„šæœ¬ã€‚</li>
</ul>
<p>æœ€å¥½é€šè¿‡æ€§èƒ½æµ‹è¯•æ¥å†³å®šä½¿ç”¨å“ªä¸€ç§æ–¹å¼ã€‚</p>
<h4 id="4-æ‰©å±•çš„ä¸€äº›æ€è€ƒ"><a href="#4-æ‰©å±•çš„ä¸€äº›æ€è€ƒ" class="headerlink" title="4 æ‰©å±•çš„ä¸€äº›æ€è€ƒ"></a>4 æ‰©å±•çš„ä¸€äº›æ€è€ƒ</h4><p>åˆ†å¸ƒå¼æµæ§å¸¦æ¥äº†ç½‘ç»œé€šä¿¡ã€åŠ é”åŒæ­¥ç­‰å¼€é”€ï¼Œä¼šå¯¹æ€§èƒ½å¸¦æ¥ä¸€å®šå½±å“ã€‚åŒæ—¶åˆ†å¸ƒå¼ç¯å¢ƒçš„å¯é æ€§ä¹Ÿä¼šå¸¦æ¥æ›´å¤šæŒ‘æˆ˜ã€‚å¦‚ä½•è®¾è®¡ä¸€ä¸ªé«˜æ€§èƒ½ã€é«˜å¯é æ€§çš„åˆ†å¸ƒå¼æµæ§ç³»ç»Ÿï¼Ÿè¿™å¯èƒ½æ˜¯ä¸ªæ¶‰åŠåˆ°æ•´ä¸ªç³»ç»Ÿæ–¹æ–¹é¢é¢çš„å¤§è¯é¢˜ã€‚</p>
<p>åˆ†äº«ä¸€ä¸‹ä¸ªäººçš„ä¸€äº›æ€è€ƒï¼Œæ¬¢è¿è®¨è®ºï¼š</p>
<p>1ï¼‰æ ¹æ®å®é™…è¯‰æ±‚ï¼Œåˆç†æ­é…ä¸åŒå±‚çš„å¤šçº§æµæ§æ˜¯ä¸ªä¸é”™çš„æ–¹å¼ï¼Œå°½é‡æŠŠæµé‡æ‹¦åœ¨å¤–å±‚ã€‚ä¾‹å¦‚å¸¸è§çš„æ¥å£å±‚ Nginx æµæ§ + åº”ç”¨å±‚æµæ§ã€‚</p>
<p>2ï¼‰é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„ç¼“å­˜ç³»ç»Ÿä¿å­˜æµæ§çš„åŠ¨æ€æ•°æ®ï¼Œè¿™ä¸ªä¸€èˆ¬è·Ÿç€å…¬å¸çš„ç»Ÿä¸€æŠ€æœ¯æ¶æ„èµ°ã€‚</p>
<p>3ï¼‰å°†æµæ§çš„é™æ€é…ç½®æ”¾åˆ°é…ç½®ä¸­å¿ƒï¼ˆä¾‹å¦‚ Diamondï¼‰ã€‚</p>
<p>4ï¼‰è®¾è®¡æ—¶è¦è€ƒè™‘åˆ†å¸ƒå¼æµæ§ä¸å¯ç”¨çš„æƒ…å†µï¼ˆä¾‹å¦‚ç¼“å­˜æŒ‚æ‰ï¼‰ï¼Œå¿…è¦æ—¶åˆ‡åˆ°å•æœºæµæ§ï¼Œä½¿ç”¨ Sentinel æˆç†Ÿå¯é ã€‚</p>
<p>5ï¼‰å¾ˆå¤šæ—¶å€™å¯¹ç²¾åº¦çš„è¦æ±‚æ²¡é‚£ä¹ˆé«˜ï¼Œå› ä¸ºä¸€èˆ¬éƒ½ä¼šå…è®¸ä¸€å®šçš„çªå‘é‡ã€‚è¿™æ—¶å€™å¯ä»¥åšä¸€äº›æ€§èƒ½çš„ä¼˜åŒ–ã€‚æ€§èƒ½çš„æœ€å¤§ç“¶é¢ˆåœ¨äºæ¯æ¬¡è¯·æ±‚éƒ½ä¼šè®¿é—®ä¸€æ¬¡ç¼“å­˜ï¼Œæˆ‘ä¹‹å‰åœ¨è®¾è®¡æ—¶å°±é‡‡ç”¨äº†ä¸€ç§æŠ˜ä¸­çš„åŠæ³•ï¼š</p>
<ul>
<li>å°†å¯ç”¨é…é¢çš„ä¸€éƒ¨åˆ†ï¼ŒæŒ‰ä¸€å®šæ¯”ä¾‹ï¼ˆä¾‹å¦‚ 50%ï¼‰ï¼Œå…ˆé¢„åˆ†é…ç»™é›†ç¾¤å†…çš„æœºå™¨ã€‚ä¸€èˆ¬æ˜¯å¹³å‡åˆ†é…ï¼Œå¦‚æœé¢„å…ˆå°±å·²ç»çŸ¥é“æ¯å°æœºå™¨çš„æµé‡æƒé‡ï¼Œå¯ä»¥åŠ æƒåˆ†é…ã€‚æ¯å°æœºå™¨æ¶ˆè€—é…é¢çš„é€Ÿç‡ä¸åŒï¼Œä¸­é—´ä¹Ÿå¯èƒ½æœ‰æœºå™¨å®•æœºï¼Œå¯èƒ½æœ‰æ‰©ç¼©å®¹ï¼Œå› æ­¤é¢„åˆ†é…çš„æ¯”ä¾‹ä¸å®œå¤ªå¤§ï¼Œå½“ç„¶ä¹Ÿä¸å®œå¤ªå°ã€‚</li>
<li>æ¯å°æœºå™¨åœ¨é…é¢è€—å°½æ—¶ï¼Œå‘ä¸­å¿ƒç³»ç»Ÿè¯·æ±‚é…é¢ï¼Œè¿™é‡Œçš„ä¸€ä¸ªä¼˜åŒ–ç‚¹æ˜¯æ¯å°æœºå™¨ä¼šè®°å½•è‡ªèº«é…é¢æ¶ˆè€—çš„é€Ÿç‡ï¼ˆç­‰åŒäºæ‰¿å—çš„æµé‡é€Ÿç‡ï¼‰ï¼ŒæŒ‰ç…§é€Ÿç‡å¤§å°ç”³è¯·ä¸åŒå¤§å°çš„é…é¢ï¼Œæ¶ˆè€—é€Ÿç‡å¤§åˆ™ä¸€æ¬¡æ€§ç”³è¯·æ›´å¤šã€‚</li>
<li>åœ¨æ•´ä½“å¯ç”¨é…é¢ä¸è¶³ä¸€å®šæ¯”ä¾‹æ—¶ï¼ˆä¾‹å¦‚ 10%ï¼‰ï¼Œé™åˆ¶æ¯å°æœºå™¨ä¸€æ¬¡å¯ç”³è¯·çš„é…é¢æ•°ï¼ŒæŒ‰å‰©ä½™çª—å£å¤§å°è®¡ç®—å‘æ”¾é…é¢çš„å¤§å°ï¼Œå¹¶ä¸”æ¯æ¬¡å‘æ”¾é‡ä¸è¶…è¿‡å‰©ä½™é…é¢çš„ä¸€å®šæ¯”ä¾‹ï¼ˆä¾‹å¦‚ 50%ï¼‰ï¼Œä½¿å¾—å‰©ä½™çš„æµé‡èƒ½å¤Ÿå¹³æ»‘åœ°è¿‡æ¸¡ã€‚</li>
</ul>
<p>äº” æ€»ç»“</p>
<p>åˆ†å¸ƒå¼æµæ§çš„ç®—æ³•å…¶å®æ˜¯å•æœºæµæ§çš„å»¶ä¼¸ï¼Œç®—æ³•æœ¬è´¨æ˜¯ä¸€æ ·çš„ã€‚è¿™é‡ŒæŒ‰æˆ‘çš„ä¸ªäººç†è§£æ€»ç»“äº†ä¸Šè¿°å‡ ç§æµæ§ç®—æ³•çš„å¤æ‚åº¦å’Œé€‚ç”¨åœºæ™¯ã€‚<br><a href="https://ucc.alicdn.com/pic/developer-ecology/4ba212a1a7de40a6ba7601faa653b4d9.png" title="image.png" class="gallery-item" style="box-shadow: none;"> <img src="https://ucc.alicdn.com/pic/developer-ecology/4ba212a1a7de40a6ba7601faa653b4d9.png" alt="image.png"></a></p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>é¢è¯•</tag>
        <tag>æœåŠ¡å™¨</tag>
      </tags>
  </entry>
  <entry>
    <title>æŸ¥çœ‹Linuxä¸‹è¿›ç¨‹å ç”¨å†…å­˜</title>
    <url>/linux-memory/</url>
    <content><![CDATA[<div class=".article-gallery"><p>è¿‘æœŸè®¡åˆ’é’ˆå¯¹ Linux ç¯å¢ƒä¸‹DSï¼ˆDedicated Serverï¼‰çš„æ€§èƒ½å±•å¼€æµ‹è¯•ï¼Œé‡ç‚¹å¯¹æ¯”ä¸‹é¢ä¸¤ç§è¿è¡Œæ¨¡å¼çš„è¡¨ç°ï¼š</p>
<ul>
<li>å…±äº«å†…å­˜æ¨¡å¼ï¼ˆåŸºäºForkå®ç°ï¼‰</li>
<li>å•è¿›ç¨‹å¤šGameInstanceæ¨¡å¼</li>
</ul>
<p>åœ¨æŸ¥çœ‹å…±äº«å†…å­˜æ¨¡å¼ä¸‹è¿›ç¨‹å ç”¨çš„å†…å­˜æ—¶ï¼Œç¢°åˆ°ä¸€äº›ç–‘é—®ï¼Œè¿™é‡Œæ•´ç†è®°å½•ä¸‹ã€‚</p>
<h1 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h1><p>ä¸‹é¢æ˜¯ä½¿ç”¨topæŸ¥çœ‹å†…å­˜å ç”¨çš„æƒ…å†µ<br><a href="https://github.com/zhangga/picx-images-hosting/raw/master/lm-top.1hslrostgu.webp" title="top" class="gallery-item" style="box-shadow: none;"> <img src="https://github.com/zhangga/picx-images-hosting/raw/master/lm-top.1hslrostgu.webp" alt="top"></a><br>å‘ç°çˆ¶è¿›ç¨‹(st_seed_Camp)å ç”¨<strong>931m</strong>å†…å­˜ï¼ŒåŒæ—¶å„ä¸ªå­è¿›ç¨‹(st_Camp_2xxxx)å ç”¨<strong>771m</strong>å†…å­˜ã€‚</p>
<p>ä¸Šå›¾è¿˜æ˜¯CampæœåŠ¡åœ¨å¯åŠ¨åï¼Œæ²¡æœ‰ç©å®¶ç™»å…¥çš„æƒ…å†µä¸‹ï¼Œå†…å­˜å ç”¨çš„æƒ…å†µã€‚å¾ˆæ˜æ˜¾ï¼Œ771mä¸æ˜¯å­è¿›ç¨‹çœŸæ­£å ç”¨çš„æƒ…å†µã€‚<br><a href="https://github.com/zhangga/picx-images-hosting/raw/master/lm-freem.45i221myz0.webp" title="freem" class="gallery-item" style="box-shadow: none;"> <img src="https://github.com/zhangga/picx-images-hosting/raw/master/lm-freem.45i221myz0.webp" alt="freem"></a><br>è¦åšæ€§èƒ½æµ‹è¯•ï¼Œå¿…é¡»å…ˆèƒ½æ­£ç¡®æŸ¥çœ‹åˆ°å„è¿›ç¨‹å®é™…å ç”¨çš„å†…å­˜æ‰è¡Œã€‚</p>
<h1 id="å‚æ•°çš„å®é™…å«ä¹‰"><a href="#å‚æ•°çš„å®é™…å«ä¹‰" class="headerlink" title="å‚æ•°çš„å®é™…å«ä¹‰"></a>å‚æ•°çš„å®é™…å«ä¹‰</h1><p>é‚£topå‘½ä»¤ä¸‹çœ‹åˆ°çš„å„å€¼å®é™…å«ä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<h2 id="ç³»ç»Ÿæ€»ä½“ä¿¡æ¯åŒº"><a href="#ç³»ç»Ÿæ€»ä½“ä¿¡æ¯åŒº" class="headerlink" title="ç³»ç»Ÿæ€»ä½“ä¿¡æ¯åŒº"></a>ç³»ç»Ÿæ€»ä½“ä¿¡æ¯åŒº</h2><h4 id="ç¬¬ä¸€è¡Œï¼ˆç³»ç»ŸçŠ¶æ€ï¼‰"><a href="#ç¬¬ä¸€è¡Œï¼ˆç³»ç»ŸçŠ¶æ€ï¼‰" class="headerlink" title="ç¬¬ä¸€è¡Œï¼ˆç³»ç»ŸçŠ¶æ€ï¼‰"></a>ç¬¬ä¸€è¡Œï¼ˆç³»ç»ŸçŠ¶æ€ï¼‰</h4><p><code>top - 16:33:58 up 19 days,  1:41,  0 users,  load average: 0.02, 0.07, 0.08</code></p>
<ul>
<li><code>16:33:58</code> â†’ å½“å‰æ—¶é—´</li>
<li><code>up 19 days,  1:41</code> â†’ ç³»ç»Ÿå·²è¿è¡Œæ—¶é—´</li>
<li><code>0 users</code> â†’ å½“å‰ç™»å½•ç”¨æˆ·æ•°é‡</li>
<li><code>load average</code> â†’ 1åˆ†é’Ÿã€5åˆ†é’Ÿã€15åˆ†é’Ÿå¹³å‡è´Ÿè½½ï¼ˆæ¥è¿‘æˆ–å¤§äºCPUæ ¸å¿ƒæ•°è¡¨ç¤ºå¿™ï¼‰</li>
</ul>
<h4 id="ç¬¬äºŒè¡Œï¼ˆä»»åŠ¡ç»Ÿè®¡ï¼‰"><a href="#ç¬¬äºŒè¡Œï¼ˆä»»åŠ¡ç»Ÿè®¡ï¼‰" class="headerlink" title="ç¬¬äºŒè¡Œï¼ˆä»»åŠ¡ç»Ÿè®¡ï¼‰"></a>ç¬¬äºŒè¡Œï¼ˆä»»åŠ¡ç»Ÿè®¡ï¼‰</h4><p><code>Tasks:  26 total,   1 running,  25 sleeping,   0 stopped,   0 zombie</code></p>
<ul>
<li>â€‹<strong>total</strong>â€‹ï¼šæ€»è¿›ç¨‹æ•°</li>
<li>â€‹<strong>running</strong>â€‹ï¼šæ­£åœ¨è¿è¡Œï¼ˆä½¿ç”¨CPUï¼‰çš„è¿›ç¨‹æ•°</li>
<li>â€‹<strong>sleeping</strong>â€‹ï¼šä¼‘çœ ä¸­çš„è¿›ç¨‹</li>
<li>â€‹<strong>stopped</strong>â€‹ï¼šè¢«åœæ­¢ï¼ˆä¿¡å·æš‚åœï¼‰çš„è¿›ç¨‹</li>
<li>â€‹<strong>zombie</strong>â€‹ï¼šåƒµå°¸è¿›ç¨‹ï¼ˆå·²é€€å‡ºä½†çˆ¶è¿›ç¨‹æœªå›æ”¶ï¼‰</li>
</ul>
<h4 id="ç¬¬ä¸‰è¡Œï¼ˆCPU-ä½¿ç”¨æƒ…å†µï¼‰"><a href="#ç¬¬ä¸‰è¡Œï¼ˆCPU-ä½¿ç”¨æƒ…å†µï¼‰" class="headerlink" title="ç¬¬ä¸‰è¡Œï¼ˆCPU ä½¿ç”¨æƒ…å†µï¼‰"></a>ç¬¬ä¸‰è¡Œï¼ˆCPU ä½¿ç”¨æƒ…å†µï¼‰</h4><p><code>%Cpu(s):  0.6 us,  0.6 sy,  0.0 ni, 98.8 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</code></p>
<p>ğŸ‘‰ é€šå¸¸å…³æ³¨ï¼š</p>
<ul>
<li><strong>us</strong>â€‹<strong>â€‹ + sy â‰ˆ ç³»ç»Ÿæ€» CPU ä½¿ç”¨ç‡</strong></li>
<li><strong>wa</strong> é«˜è¯´æ˜ I/O ç“¶é¢ˆ</li>
<li><strong>id</strong> ä½è¯´æ˜ CPU å¿™ç¢Œ</li>
</ul>
<h4 id="ç¬¬å››ã€äº”è¡Œï¼ˆå†…å­˜ç»Ÿè®¡ï¼‰"><a href="#ç¬¬å››ã€äº”è¡Œï¼ˆå†…å­˜ç»Ÿè®¡ï¼‰" class="headerlink" title="ç¬¬å››ã€äº”è¡Œï¼ˆå†…å­˜ç»Ÿè®¡ï¼‰"></a>ç¬¬å››ã€äº”è¡Œï¼ˆå†…å­˜ç»Ÿè®¡ï¼‰</h4><p><code>MiB Mem :  15492.0 total,    414.3 free,   2578.1 used,  12499.6 buff/cache</code></p>
<p><code>MiB Swap:      0.0 total,      0.0 free,      0.0 used.  12502.4 avail Mem</code></p>
<table>
<thead>
<tr>
<th><strong>å­—æ®µ</strong></th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td><strong>total</strong></td>
<td>å†…å­˜æ€»é‡</td>
</tr>
<tr>
<td><strong>free</strong></td>
<td>å®Œå…¨æœªåˆ†é…çš„</td>
</tr>
<tr>
<td><strong>used</strong></td>
<td>å·²ä½¿ç”¨çš„ï¼ˆåŒ…å« cacheï¼‰</td>
</tr>
<tr>
<td><strong>buff/cache</strong></td>
<td>ç³»ç»Ÿç¼“å­˜ä¸æ–‡ä»¶ç¼“å†²åŒº</td>
</tr>
<tr>
<td><strong>shared</strong></td>
<td>å…±äº«å†…å­˜ï¼ˆtmpfsã€shmï¼‰ä½¿ç”¨</td>
</tr>
<tr>
<td><strong>available</strong></td>
<td>å®é™…å¯ç”¨å†…å­˜ï¼ˆfree + å¯å›æ”¶ cacheï¼‰ï¼Œæ›´å‡†ç¡®</td>
</tr>
</tbody></table>
<p>å¦‚æœ Swap ä½¿ç”¨å¾ˆå¤šï¼ˆused å¾ˆå¤§ï¼‰ï¼Œè¯´æ˜å†…å­˜ç´§å¼ ã€‚</p>
<p>âš ï¸ å¸¸è§è¯¯åŒºï¼š</p>
<blockquote>
<p>â€œfree å¾ˆå°æ˜¯ä¸æ˜¯å†…å­˜ä¸å¤Ÿç”¨äº†ï¼Ÿâ€</p>
<p>âŒ é”™ã€‚Linux ä¼šå°½é‡åˆ©ç”¨ç©ºé—²å†…å­˜åšç¼“å­˜ï¼Œæé«˜æ€§èƒ½ã€‚  çœŸæ­£å¯ç”¨å†…å­˜æ˜¯ â€‹<strong>available</strong>â€‹ã€‚</p>
</blockquote>
<h2 id="è¿›ç¨‹ä¿¡æ¯åŒº"><a href="#è¿›ç¨‹ä¿¡æ¯åŒº" class="headerlink" title="è¿›ç¨‹ä¿¡æ¯åŒº"></a>è¿›ç¨‹ä¿¡æ¯åŒº</h2><p><code>PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND</code></p>
<table>
<thead>
<tr>
<th><strong>åˆ—å</strong></th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td><strong>PID</strong></td>
<td>è¿›ç¨‹å·ï¼ˆProcess IDï¼‰</td>
</tr>
<tr>
<td><strong>USER</strong></td>
<td>å¯åŠ¨è¯¥è¿›ç¨‹çš„ç”¨æˆ·</td>
</tr>
<tr>
<td><strong>PR</strong></td>
<td>ä¼˜å…ˆçº§ï¼ˆPriorityï¼‰æ•°å€¼è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜</td>
</tr>
<tr>
<td><strong>NI</strong></td>
<td>niceå€¼ï¼ˆå½±å“è°ƒåº¦ä¼˜å…ˆçº§ï¼Œé»˜è®¤0ï¼‰</td>
</tr>
<tr>
<td><strong>VIRT</strong></td>
<td>è¿›ç¨‹ä½¿ç”¨çš„è™šæ‹Ÿå†…å­˜æ€»é‡ï¼ˆåŒ…å«å…±äº«åº“ã€æœªå®é™…åˆ†é…çš„å†…å­˜ï¼‰</td>
</tr>
<tr>
<td><strong>RES</strong></td>
<td>å¸¸é©»å†…å­˜ï¼ˆResident Set Sizeï¼‰ï¼Œå³å®é™…å ç”¨çš„ç‰©ç†å†…å­˜ï¼Œä¸å« swap</td>
</tr>
<tr>
<td><strong>SHR</strong></td>
<td>å…±äº«å†…å­˜å¤§å°ï¼ˆå…±äº«åº“ç­‰ï¼‰</td>
</tr>
<tr>
<td><strong>S</strong></td>
<td>è¿›ç¨‹çŠ¶æ€ï¼š<code>R</code>=è¿è¡Œã€<code>S</code>=ç¡çœ ã€<code>D</code>=ä¸å¯ä¸­æ–­ç¡çœ ã€<code>T</code>=åœæ­¢ã€<code>Z</code>=åƒµå°¸</td>
</tr>
<tr>
<td><strong>%CPU</strong></td>
<td>CPU å ç”¨ç™¾åˆ†æ¯”ï¼ˆå¤šæ ¸ç³»ç»Ÿå¯è¶…è¿‡100ï¼‰</td>
</tr>
<tr>
<td><strong>%MEM</strong></td>
<td>å ç‰©ç†å†…å­˜ç™¾åˆ†æ¯”</td>
</tr>
<tr>
<td>â€‹<strong>TIME</strong>â€‹**+**</td>
<td>è¿›ç¨‹ç´¯è®¡å ç”¨ CPU çš„æ—¶é—´ï¼ˆuser + sysï¼‰</td>
</tr>
<tr>
<td><strong>COMMAND</strong></td>
<td>å¯æ‰§è¡Œæ–‡ä»¶æˆ–å‘½ä»¤åç§°</td>
</tr>
</tbody></table>
<h4 id="RES"><a href="#RES" class="headerlink" title="RES"></a>RES</h4><blockquote>
<p><strong>â€‹RES æ˜¯è¿›ç¨‹å½“å‰é©»ç•™åœ¨ç‰©ç†å†…å­˜ï¼ˆâ€‹</strong>â€‹â€‹<strong>RAM</strong>â€‹â€‹<strong>ï¼‰ä¸­çš„æ€»å­—èŠ‚æ•°</strong>â€‹ã€‚ å®ƒè¡¨ç¤ºè¯¥è¿›ç¨‹çš„é¡µè¡¨ä¸­ï¼Œæœ‰å¤šå°‘é¡µçœŸæ­£åŠ è½½åœ¨å†…å­˜ä¸­ï¼ˆæ²¡æœ‰è¢« swap å‡ºå»ï¼‰ã€‚</p>
</blockquote>
<p><strong>RES</strong> å®é™…ä¸Šæ˜¯è¿™ä¸‰ç±»å†…å­˜çš„æ€»å’Œï¼š</p>
<table>
<thead>
<tr>
<th><strong>å†…å­˜ç±»å‹</strong></th>
<th><strong>è¯´æ˜</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>ç§æœ‰åŒ¿åé¡µï¼ˆPrivate Anonymousï¼‰</strong></td>
<td>æ¯”å¦‚å †ï¼ˆmalloc/newï¼‰ã€æ ˆã€ä¸´æ—¶åˆ†é…å†…å­˜</td>
</tr>
<tr>
<td><strong>ç§æœ‰æ–‡ä»¶æ˜ å°„é¡µï¼ˆPrivate Fileï¼‰</strong></td>
<td>æ¯”å¦‚åªè¢«è¯¥è¿›ç¨‹ä½¿ç”¨çš„ mmap æ–‡ä»¶</td>
</tr>
<tr>
<td><strong>å…±äº«é¡µï¼ˆShared Pagesï¼‰</strong></td>
<td>æ¯”å¦‚å…±äº«åº“ã€fork å copy-on-write æœªè§¦å‘çš„é¡µã€shm/tmpfs</td>
</tr>
</tbody></table>
<p>å³ï¼š</p>
<p><strong><code>RES = ç§æœ‰å†…å­˜ + å…±äº«å†…å­˜</code></strong></p>
<h1 id="æŸ¥çœ‹è¿›ç¨‹ç§æœ‰å†…å­˜"><a href="#æŸ¥çœ‹è¿›ç¨‹ç§æœ‰å†…å­˜" class="headerlink" title="æŸ¥çœ‹è¿›ç¨‹ç§æœ‰å†…å­˜"></a>æŸ¥çœ‹è¿›ç¨‹ç§æœ‰å†…å­˜</h1><p>ä½¿ç”¨ä¸‹é¢å‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹æ›´è¯¦ç»†çš„å†…å­˜å ç”¨</p>
<p><code>cat /proc/&lt;pid&gt;/smaps_rollup</code></p>
<table>
<thead>
<tr>
<th><strong>åˆ—å</strong></th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Rss</strong></td>
<td>Resident Set Sizeï¼Œè¿›ç¨‹å®é™…é©»ç•™åœ¨ç‰©ç†å†…å­˜ä¸­çš„æ€»å¤§å°ï¼ˆåŒ…æ‹¬å…±äº«å†…å­˜ï¼‰</td>
</tr>
<tr>
<td><strong>Pss</strong></td>
<td>Proportional Set Sizeï¼Œåˆ†æ‘Šå…±äº«é¡µåçš„çœŸå®å ç”¨</td>
</tr>
<tr>
<td><strong>Shared_Clean</strong></td>
<td>è¢«å¤šä¸ªè¿›ç¨‹å…±äº«ã€ä¸”æœªè¢«ä¿®æ”¹çš„é¡µé¢ï¼ˆé€šå¸¸æ˜¯æ˜ å°„çš„å¯æ‰§è¡Œæ–‡ä»¶ã€åŠ¨æ€åº“ï¼ˆå¦‚<code>.so</code>æ–‡ä»¶ï¼‰ã€æˆ–åªè¯»å…±äº«å†…å­˜ï¼‰</td>
</tr>
<tr>
<td><strong>Shared_Dirty</strong></td>
<td>è¢«å¤šä¸ªè¿›ç¨‹å…±äº«ã€ä¸”å·²ä¿®æ”¹çš„é¡µé¢ï¼ˆé€šå¸¸æ˜¯å…±äº«å†…å­˜ï¼ˆ<code>shm</code>ï¼‰ã€<code>mmap</code>å†™æ˜ å°„æ–‡ä»¶ã€æˆ– copy-on-write å‰çš„çˆ¶å­å…±äº«é¡µï¼‰</td>
</tr>
<tr>
<td><strong>Private_Clean</strong></td>
<td>å½“å‰è¿›ç¨‹ç‹¬å ã€ä½†æœªä¿®æ”¹ï¼ˆcleanï¼‰çš„é¡µé¢</td>
</tr>
<tr>
<td><strong>Private_Dirty</strong></td>
<td>å½“å‰è¿›ç¨‹ç‹¬å ã€ä¸”è¢«ä¿®æ”¹è¿‡ï¼ˆdirtyï¼‰çš„é¡µé¢ï¼ˆå †ã€æ ˆã€å†™æ—¶å¤åˆ¶ (COW) é¡µã€mmap å†™æ˜ å°„ï¼‰</td>
</tr>
</tbody></table>
<ul>
<li>å‡ ä¸ªå…³é”®æŒ‡æ ‡çš„å…³ç³»</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Rss</span> = <span class="title class_">Private</span>_Clean + <span class="title class_">Private</span>_Dirty + <span class="title class_">Shared</span>_Clean + <span class="title class_">Shared</span>_Dirty</span><br><span class="line"><span class="title class_">Private</span> = <span class="title class_">Private</span>_Clean + <span class="title class_">Private</span>_Dirty</span><br><span class="line"><span class="title class_">Shared</span>  = <span class="title class_">Shared</span>_Clean + <span class="title class_">Shared</span>_Dirty</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥ï¼š</p>
<ul>
<li>â€‹<strong>USS</strong>â€‹<strong>ï¼ˆç‹¬å å†…å­˜ï¼‰ = Private = Private_Clean + Private_Dirty</strong></li>
<li><strong>PSS</strong>â€‹<strong>â€‹ = Private + (Shared / N)</strong> ï¼ˆN = å…±äº«è€…æ•°é‡ï¼‰</li>
<li><strong>RSS = Private + Shared</strong></li>
</ul>
<h2 id="ä»¥ä¸Šé¢è¿›ç¨‹ä¸ºä¾‹å®é™…è®¡ç®—ä¸‹"><a href="#ä»¥ä¸Šé¢è¿›ç¨‹ä¸ºä¾‹å®é™…è®¡ç®—ä¸‹" class="headerlink" title="ä»¥ä¸Šé¢è¿›ç¨‹ä¸ºä¾‹å®é™…è®¡ç®—ä¸‹"></a>ä»¥ä¸Šé¢è¿›ç¨‹ä¸ºä¾‹å®é™…è®¡ç®—ä¸‹</h2><h3 id="PID-17ï¼ˆçˆ¶ï¼‰"><a href="#PID-17ï¼ˆçˆ¶ï¼‰" class="headerlink" title="PID 17ï¼ˆçˆ¶ï¼‰"></a>PID 17ï¼ˆçˆ¶ï¼‰</h3><p><a href="https://github.com/zhangga/picx-images-hosting/raw/master/lm-parent.9ddcp1w7po.webp" title="parent" class="gallery-item" style="box-shadow: none;"> <img src="https://github.com/zhangga/picx-images-hosting/raw/master/lm-parent.9ddcp1w7po.webp" alt="parent"></a></p>
<ul>
<li><strong>RSS</strong> = 954,200 kB â‰ˆ <strong>932.6 â€‹</strong>â€‹<strong>MB</strong></li>
<li><strong>PSS</strong> = 249,097 kB â‰ˆ <strong>243.4 â€‹</strong>â€‹<strong>MB</strong>  â† æ¯ä¸ªæ˜ å°„åˆ°çš„è¿›ç¨‹åˆ†æ‘Šåçš„â€œçœŸå®å ç”¨â€</li>
<li><strong>â€‹Private (â€‹</strong>â€‹â€‹<strong>USS</strong>â€‹**)** = Private_Clean + Private_Dirty = 88,256 + 125,528 = <strong>213,784 kB â‰ˆ 208.8 â€‹</strong>â€‹<strong>MB</strong> â† çˆ¶è¿›ç¨‹ç‹¬å çš„å†…å­˜</li>
<li><strong>Shared total</strong> = Shared_Clean + Shared_Dirty = 70,124 + 670,292 = <strong>740,416 kB â‰ˆ 722.9 MB</strong></li>
<li><strong>åˆ†æ‘Šçš„å…±äº«å†…å­˜</strong> = 722.9 MB / 21ï¼ˆçˆ¶è¿›ç¨‹+20ä¸ªå­è¿›ç¨‹ï¼‰ = <strong>34.4 MB</strong></li>
<li>â€‹<strong>éªŒè¯</strong>â€‹ï¼šPSS(243.4) = Private(208.8) + åˆ†æ‘Šçš„å…±äº«å†…å­˜(34.4)</li>
</ul>
<h3 id="PID-20ï¼ˆå­ï¼‰"><a href="#PID-20ï¼ˆå­ï¼‰" class="headerlink" title="PID 20ï¼ˆå­ï¼‰"></a>PID 20ï¼ˆå­ï¼‰</h3><p><a href="https://github.com/zhangga/picx-images-hosting/raw/master/lm-child.8l0h7bfh3k.webp" title="child" class="gallery-item" style="box-shadow: none;"> <img src="https://github.com/zhangga/picx-images-hosting/raw/master/lm-child.8l0h7bfh3k.webp" alt="child"></a></p>
<ul>
<li><strong>RSS</strong> = 790,216 kB â‰ˆ <strong>771.8 â€‹</strong>â€‹<strong>MB</strong></li>
<li><strong>PSS</strong> = 85,198 kB â‰ˆ <strong>83.2 â€‹</strong>â€‹<strong>MB</strong></li>
<li><strong>â€‹Private (â€‹</strong>â€‹â€‹<strong>USS</strong>â€‹**)** = 0 + 49,952 = <strong>49,952 kB â‰ˆ 48.8 â€‹</strong>â€‹<strong>MB</strong></li>
<li><strong>Shared total</strong> = 69,976 + 670,288 = <strong>740,264 kB â‰ˆ 722.8 MB</strong></li>
</ul>
<h3 id="éForkä¸‹"><a href="#éForkä¸‹" class="headerlink" title="éForkä¸‹"></a>éForkä¸‹</h3><p>Privateçš„å€¼å æ¯”ä¼šéå¸¸é«˜ï¼ˆå…±äº«å¾ˆå°‘ï¼‰<br><a href="https://github.com/zhangga/picx-images-hosting/raw/master/lm-nofork.175ryjadc1.webp" title="nonfork" class="gallery-item" style="box-shadow: none;"> <img src="https://github.com/zhangga/picx-images-hosting/raw/master/lm-nofork.175ryjadc1.webp" alt="nonfork"></a></p>
<h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><p>çˆ¶è¿›ç¨‹ fork å­è¿›ç¨‹æ—¶ï¼ŒLinux ä¸ä¼šç«‹å³å¤åˆ¶å†…å­˜é¡µï¼Œè€Œæ˜¯ï¼š</p>
<ul>
<li>çˆ¶å­å…±äº«åŒä¸€ä»½ç‰©ç†é¡µï¼›</li>
<li>è¿™äº›é¡µéƒ½æ ‡è®°ä¸ºåªè¯»ï¼›</li>
<li>å½“ä»»æ„ä¸€æ–¹å†™å…¥æ—¶ï¼Œè§¦å‘ Copy-on-Write (â€‹<strong>COW</strong>â€‹)ï¼Œå†…æ ¸æ‰å¤åˆ¶å‡ºæ–°çš„é¡µã€‚</li>
</ul>
<p>å› æ­¤åˆš fork å®Œæ—¶ï¼š</p>
<ul>
<li>çˆ¶å­å‡ ä¹å®Œå…¨å…±äº«ï¼›</li>
<li>Private å¾ˆå°ï¼ŒShared å¾ˆå¤§ï¼›</li>
<li>RSS å¤§ä½† PSS è¾ƒå°ï¼ˆå› ä¸ºå…±äº«é¡µåˆ†æ‘Šäº†ï¼‰ã€‚</li>
</ul>
<h1 id="COW-åçš„å˜åŒ–è¶‹åŠ¿"><a href="#COW-åçš„å˜åŒ–è¶‹åŠ¿" class="headerlink" title="COW åçš„å˜åŒ–è¶‹åŠ¿"></a>COW åçš„å˜åŒ–è¶‹åŠ¿</h1><p>éšç€è¿è¡Œæ—¶é—´å¢åŠ ã€æ•°æ®å†™å…¥å¢å¤šï¼Œå„è¿›ç¨‹ä¼šå¯¹å†…å­˜é¡µå‘ç”Ÿ COWã€‚æ¥çœ‹å‡ ä¸ªæŒ‡æ ‡çš„å˜åŒ–è¶‹åŠ¿ï¼š</p>
<table>
<thead>
<tr>
<th>æŒ‡æ ‡</th>
<th>å«ä¹‰</th>
<th>COW åå˜åŒ–è¶‹åŠ¿</th>
<th>åŸå› è§£é‡Š</th>
</tr>
</thead>
<tbody><tr>
<td>Private_Dirty</td>
<td>ç§æœ‰çš„ã€å·²è¢«ä¿®æ”¹çš„åŒ¿åé¡µ</td>
<td>ğŸ”º ä¸Šå‡</td>
<td>å†™æ“ä½œå¯¼è‡´å¤åˆ¶é¡µï¼Œæ–°é¡µæ ‡è®°ä¸º dirtyã€‚</td>
</tr>
<tr>
<td>Shared_Clean / Shared_Dirty</td>
<td>å¯å…±äº«çš„é¡µï¼ˆæœªå†™å…¥ï¼‰</td>
<td>ğŸ”» ä¸‹é™</td>
<td>åŸæœ¬å…±äº«çš„é¡µè¢«åˆ†è£‚æˆç§æœ‰å‰¯æœ¬åä¸å†å…±äº«ã€‚</td>
</tr>
<tr>
<td>RSS</td>
<td>å®é™…é©»ç•™ç‰©ç†å†…å­˜æ€»é‡ï¼ˆShared + Privateï¼‰</td>
<td>ğŸ”º ä¸Šå‡</td>
<td>æ¯ä¸ªè¿›ç¨‹éƒ½å¤šäº†è‡ªå·±ç‹¬æœ‰çš„å‰¯æœ¬ï¼Œç‰©ç†å ç”¨ä¸Šå‡ã€‚</td>
</tr>
<tr>
<td>USS (Private_Clean + Private_Dirty)</td>
<td>ç‹¬å çš„é¡µï¼ˆåˆ«çš„è¿›ç¨‹ä¸å…±äº«ï¼‰</td>
<td>ğŸ”º ä¸Šå‡</td>
<td>è¡¨ç¤ºæ¯ä¸ªè¿›ç¨‹ç‹¬å çš„å†…å­˜è¶Šæ¥è¶Šå¤šã€‚</td>
</tr>
<tr>
<td>PSS</td>
<td>å¹³å‡åˆ†æ‘Šçš„çœŸå®å ç”¨</td>
<td>ğŸ”º ä¸Šå‡ç¼“æ…¢</td>
<td>å› ä¸ºæ¯ä¸ªè¿›ç¨‹è·å¾—æ›´å¤šç‹¬å é¡µï¼ˆPSSâ‰ˆUSS+å…±äº«é¡µ/Nï¼‰ï¼Œå…±äº«æ¯”ä¾‹å‡å°‘ã€‚</td>
</tr>
<tr>
<td>å…±äº«æ€»é‡ (Shared_Clean + Shared_Dirty)</td>
<td>å„è¿›ç¨‹å…±åŒæ˜ å°„çš„ç‰©ç†é¡µ</td>
<td>ğŸ”» ä¸‹é™æ˜æ˜¾</td>
<td>é¡µé€æ¸ä¸å†è¢«å¤šä¸ªè¿›ç¨‹å…±äº«ã€‚</td>
</tr>
<tr>
<td>æ€»ç³»ç»Ÿå†…å­˜ä½¿ç”¨é‡</td>
<td>æ‰€æœ‰è¿›ç¨‹ RSS çš„å¹¶é›†</td>
<td>ğŸ”º æ˜¾è‘—ä¸Šå‡</td>
<td>å› ä¸ºåŒä¸€é¡µè¢«å¤šæ¬¡å¤åˆ¶åï¼Œç‰©ç†ä¸Šå˜æˆå¤šä»½ã€‚</td>
</tr>
</tbody></table>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>UE</tag>
      </tags>
  </entry>
  <entry>
    <title>Linuxå¸¸ç”¨å‘½ä»¤</title>
    <url>/linux-note/</url>
    <content><![CDATA[<div class=".article-gallery"><h4 id="LinuxæŸ¥çœ‹ç‰©ç†CPUä¸ªæ•°ã€æ ¸æ•°ã€é€»è¾‘CPUä¸ªæ•°"><a href="#LinuxæŸ¥çœ‹ç‰©ç†CPUä¸ªæ•°ã€æ ¸æ•°ã€é€»è¾‘CPUä¸ªæ•°" class="headerlink" title="LinuxæŸ¥çœ‹ç‰©ç†CPUä¸ªæ•°ã€æ ¸æ•°ã€é€»è¾‘CPUä¸ªæ•°"></a>LinuxæŸ¥çœ‹ç‰©ç†CPUä¸ªæ•°ã€æ ¸æ•°ã€é€»è¾‘CPUä¸ªæ•°</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># æ€»æ ¸æ•° = ç‰©ç†CPUä¸ªæ•° X æ¯é¢—ç‰©ç†CPUçš„æ ¸æ•° </span><br><span class="line"># æ€»é€»è¾‘CPUæ•° = ç‰©ç†CPUä¸ªæ•° X æ¯é¢—ç‰©ç†CPUçš„æ ¸æ•° X è¶…çº¿ç¨‹æ•°</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹ç‰©ç†CPUä¸ªæ•°</span><br><span class="line">cat /proc/cpuinfo| grep &quot;physical id&quot;| sort| uniq| wc -l</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹æ¯ä¸ªç‰©ç†CPUä¸­coreçš„ä¸ªæ•°(å³æ ¸æ•°)</span><br><span class="line">cat /proc/cpuinfo| grep &quot;cpu cores&quot;| uniq</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹é€»è¾‘CPUçš„ä¸ªæ•°</span><br><span class="line">cat /proc/cpuinfo| grep &quot;processor&quot;| wc -l</span><br></pre></td></tr></table></figure>

<h4 id="æŸ¥çœ‹CPUä¿¡æ¯ï¼ˆå‹å·ï¼‰"><a href="#æŸ¥çœ‹CPUä¿¡æ¯ï¼ˆå‹å·ï¼‰" class="headerlink" title="æŸ¥çœ‹CPUä¿¡æ¯ï¼ˆå‹å·ï¼‰"></a>æŸ¥çœ‹CPUä¿¡æ¯ï¼ˆå‹å·ï¼‰</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat /proc/cpuinfo | grep name | cut -f2 -d: | uniq -c</span><br></pre></td></tr></table></figure>

<h4 id="æŸ¥çœ‹å†…å­˜ä¿¡æ¯"><a href="#æŸ¥çœ‹å†…å­˜ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹å†…å­˜ä¿¡æ¯"></a>æŸ¥çœ‹å†…å­˜ä¿¡æ¯</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># cat /proc/meminfo</span><br></pre></td></tr></table></figure>

<h4 id="å¦‚ä½•æŸ¥çœ‹Linux-å†…æ ¸"><a href="#å¦‚ä½•æŸ¥çœ‹Linux-å†…æ ¸" class="headerlink" title="å¦‚ä½•æŸ¥çœ‹Linux å†…æ ¸"></a>å¦‚ä½•æŸ¥çœ‹Linux å†…æ ¸</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">uname -a</span><br><span class="line">cat /proc/version</span><br></pre></td></tr></table></figure>

<h4 id="æŸ¥çœ‹æœºå™¨å‹å·ï¼ˆæœºå™¨ç¡¬ä»¶å‹å·ï¼‰"><a href="#æŸ¥çœ‹æœºå™¨å‹å·ï¼ˆæœºå™¨ç¡¬ä»¶å‹å·ï¼‰" class="headerlink" title="æŸ¥çœ‹æœºå™¨å‹å·ï¼ˆæœºå™¨ç¡¬ä»¶å‹å·ï¼‰"></a>æŸ¥çœ‹æœºå™¨å‹å·ï¼ˆæœºå™¨ç¡¬ä»¶å‹å·ï¼‰</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dmidecode | grep &quot;Product Name&quot;</span><br><span class="line">dmidecode</span><br></pre></td></tr></table></figure>

<h4 id="å¦‚ä½•æŸ¥çœ‹linux-ç³»ç»Ÿç‰ˆæœ¬"><a href="#å¦‚ä½•æŸ¥çœ‹linux-ç³»ç»Ÿç‰ˆæœ¬" class="headerlink" title="å¦‚ä½•æŸ¥çœ‹linux ç³»ç»Ÿç‰ˆæœ¬"></a>å¦‚ä½•æŸ¥çœ‹linux ç³»ç»Ÿç‰ˆæœ¬</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat /etc/redhat-release</span><br><span class="line">lsb_release -a</span><br><span class="line">cat /etc/issue</span><br></pre></td></tr></table></figure>

<h4 id="å¦‚ä½•æŸ¥çœ‹linuxç³»ç»Ÿå’ŒCPUå‹å·ï¼Œç±»å‹å’Œå¤§å°"><a href="#å¦‚ä½•æŸ¥çœ‹linuxç³»ç»Ÿå’ŒCPUå‹å·ï¼Œç±»å‹å’Œå¤§å°" class="headerlink" title="å¦‚ä½•æŸ¥çœ‹linuxç³»ç»Ÿå’ŒCPUå‹å·ï¼Œç±»å‹å’Œå¤§å°"></a>å¦‚ä½•æŸ¥çœ‹linuxç³»ç»Ÿå’ŒCPUå‹å·ï¼Œç±»å‹å’Œå¤§å°</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat /proc/cpuinfo</span><br><span class="line"></span><br><span class="line">å…³äºCPUçš„æ ¸å¿ƒå‚æ•°è¯´æ˜ï¼š</span><br><span class="line">Â· processorï¼šæŒ‡æ˜ç¬¬å‡ ä¸ªCPUå¤„ç†å™¨</span><br><span class="line">Â· cpu coresï¼šæŒ‡æ˜æ¯ä¸ªå¤„ç†å™¨çš„æ ¸å¿ƒæ•°</span><br></pre></td></tr></table></figure>

<h4 id="å¦‚ä½•æŸ¥çœ‹linux-ç³»ç»Ÿå†…å­˜å¤§å°çš„ä¿¡æ¯ï¼Œå¯ä»¥æŸ¥çœ‹æ€»å†…å­˜ï¼Œå‰©ä½™å†…å­˜ï¼Œå¯ä½¿ç”¨å†…å­˜ç­‰ä¿¡æ¯"><a href="#å¦‚ä½•æŸ¥çœ‹linux-ç³»ç»Ÿå†…å­˜å¤§å°çš„ä¿¡æ¯ï¼Œå¯ä»¥æŸ¥çœ‹æ€»å†…å­˜ï¼Œå‰©ä½™å†…å­˜ï¼Œå¯ä½¿ç”¨å†…å­˜ç­‰ä¿¡æ¯" class="headerlink" title="å¦‚ä½•æŸ¥çœ‹linux ç³»ç»Ÿå†…å­˜å¤§å°çš„ä¿¡æ¯ï¼Œå¯ä»¥æŸ¥çœ‹æ€»å†…å­˜ï¼Œå‰©ä½™å†…å­˜ï¼Œå¯ä½¿ç”¨å†…å­˜ç­‰ä¿¡æ¯"></a>å¦‚ä½•æŸ¥çœ‹linux ç³»ç»Ÿå†…å­˜å¤§å°çš„ä¿¡æ¯ï¼Œå¯ä»¥æŸ¥çœ‹æ€»å†…å­˜ï¼Œå‰©ä½™å†…å­˜ï¼Œå¯ä½¿ç”¨å†…å­˜ç­‰ä¿¡æ¯</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat /proc/meminfo</span><br></pre></td></tr></table></figure>

<h4 id="ä½¿ç”¨tasksetå‘½ä»¤è®©è¿›ç¨‹è¿è¡Œåœ¨æŒ‡å®šCPUä¸Š"><a href="#ä½¿ç”¨tasksetå‘½ä»¤è®©è¿›ç¨‹è¿è¡Œåœ¨æŒ‡å®šCPUä¸Š" class="headerlink" title="ä½¿ç”¨tasksetå‘½ä»¤è®©è¿›ç¨‹è¿è¡Œåœ¨æŒ‡å®šCPUä¸Š"></a>ä½¿ç”¨tasksetå‘½ä»¤è®©è¿›ç¨‹è¿è¡Œåœ¨æŒ‡å®šCPUä¸Š</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ŒæŒ‡å®šè¿›ç¨‹è¿è¡Œåœ¨ç¬¬ä¸€ä¸ªCPUï¼ˆCPU0ï¼‰ä¸Šã€‚</span><br><span class="line">[root@VM_32_4_centos ~]# taskset -c 0 ./test.sh&amp;</span><br><span class="line"></span><br><span class="line">æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œè·å–è¿›ç¨‹çŠ¶æ€ï¼ˆä»¥ä¸‹æ“ä½œä»¥è¿›ç¨‹test.shä¸ºä¾‹ï¼Œå¯¹åº”çš„pidä¸º19155ï¼‰</span><br><span class="line">[root@VM_32_4_centos ~]# ps aux|grep test.sh</span><br><span class="line">root     19155  0.0  0.0 113120  1204 pts/3    S+   15:26   0:00 /bin/bash ./test.sh</span><br><span class="line"></span><br><span class="line">æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ŒæŸ¥çœ‹è¿›ç¨‹å½“å‰è¿è¡Œåœ¨å“ªä¸ªCPUä¸Šã€‚</span><br><span class="line">[root@VM_32_4_centos ~]# taskset -p 19155</span><br><span class="line">pid 19155&#x27;s current affinity mask: 1</span><br></pre></td></tr></table></figure>

<h4 id="é˜²ç«å¢™"><a href="#é˜²ç«å¢™" class="headerlink" title="é˜²ç«å¢™"></a>é˜²ç«å¢™</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">æŸ¥çœ‹é˜²ç«å¢™å¼€æ”¾ç«¯å£</span><br><span class="line">[root@VM_32_4_centos ~]# firewall-cmd --list-ports</span><br><span class="line">5000/udp 80/tcp 5044/tcp 8080/tcp 9200/tcp 5043/tcp 9100/tcp 10050/tcp 5601/tcp 5000/tcp</span><br><span class="line"></span><br><span class="line">ç»™é˜²ç«å¢™æ·»åŠ 3000ç«¯å£</span><br><span class="line">[root@VM_32_4_centos ~]# firewall-cmd --add-port=3000/tcp --zone=public --permanent</span><br><span class="line">success</span><br><span class="line"></span><br><span class="line">ç«¯å£ç”Ÿæ•ˆ</span><br><span class="line">[root@VM_32_4_centos ~]# firewall-cmd --reload</span><br><span class="line">success</span><br></pre></td></tr></table></figure>

<h4 id="Gitå¸¸ç”¨å‘½ä»¤"><a href="#Gitå¸¸ç”¨å‘½ä»¤" class="headerlink" title="Gitå¸¸ç”¨å‘½ä»¤"></a>Gitå¸¸ç”¨å‘½ä»¤</h4><ol>
<li><p>ä½¿ç”¨<code>git checkout</code>æ’¤é”€æœ¬åœ°ä¿®æ”¹ï¼Œä»…é™æœª<code>add/commit</code>çš„</p>
<p><code>git checkout .</code></p>
<p><code>git checkout [filename]</code></p>
<p><code>git checkout . &amp;&amp; git clean -xdf</code></p>
</li>
<li><p>ä½¿ç”¨<code>git reset</code>å›é€€é¡¹ç›®ç‰ˆæœ¬ï¼Œå¯ä»¥å›é€€æ‰å·²<code>add/commit</code>çš„</p>
<p><code>git reset --hard [commit-hashcode]</code></p>
</li>
<li><p>ä½¿ç”¨<code>git push origin master -f</code>æ¨é€åˆ°è¿œç«¯</p>
</li>
</ol>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>æ¨¡å‹å¾®è°ƒ</title>
    <url>/llm-lora/</url>
    <content><![CDATA[<div class=".article-gallery"><h2 id="è®­ç»ƒå¤§æ¨¡å‹çš„ä¸‰ä¸ªé˜¶æ®µ"><a href="#è®­ç»ƒå¤§æ¨¡å‹çš„ä¸‰ä¸ªé˜¶æ®µ" class="headerlink" title="è®­ç»ƒå¤§æ¨¡å‹çš„ä¸‰ä¸ªé˜¶æ®µ"></a>è®­ç»ƒå¤§æ¨¡å‹çš„ä¸‰ä¸ªé˜¶æ®µ</h2><ul>
<li>é¢„è®­ç»ƒï¼šå­¦è¯´è¯</li>
<li>å¾®è°ƒï¼šå­¦æ ¹æ®æŒ‡ä»¤å›ç­”</li>
<li>åå¥½å¯¹é½ï¼šå­¦ä¼šæŒ‰ç…§äººç±»åå¥½å›ç­”</li>
</ul>
<h2 id="å¢é‡é¢„è®­ç»ƒ"><a href="#å¢é‡é¢„è®­ç»ƒ" class="headerlink" title="å¢é‡é¢„è®­ç»ƒ"></a>å¢é‡é¢„è®­ç»ƒ</h2><h3 id="ä½œç”¨"><a href="#ä½œç”¨" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h3><ul>
<li>æ›´æ–°çŸ¥è¯†</li>
<li>ä¿®æ”¹å¸¸è¯†æ€§é”™è¯¯</li>
<li>æ‰©å……é¢†åŸŸçŸ¥è¯†</li>
<li>â€¦â€¦</li>
</ul>
<h3 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h3><ul>
<li>æ¯”å¦‚æŠŠçŸ¥è¯†ä»å»å¹´æ‰©å……åˆ°ä»Šå¹´</li>
<li>æ¯”å¦‚è®­ç»ƒä¸€ä¸ªå°è¯´å®¶å°è¯´å®¶</li>
<li>æ¯”å¦‚ä»–å¯¹æŸä¸ªå†å²äººç‰©è®°å¿†æœ‰é”™è¯¯</li>
</ul>
<h2 id="å¾®è°ƒ"><a href="#å¾®è°ƒ" class="headerlink" title="å¾®è°ƒ"></a>å¾®è°ƒ</h2><h3 id="ä½œç”¨-1"><a href="#ä½œç”¨-1" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h3><ul>
<li>å›ç­”ç‰¹å®šé¢†åŸŸé—®é¢˜</li>
<li>å®Œæˆç‰¹å®šä»»åŠ¡</li>
<li>ä¸ªæ€§åŒ–éœ€æ±‚ï¼Œæ¯”æ–¹å½“æˆ‘è®©ä»–ç”¨æŸç§ç‰¹æ®Šæ–¹å¼å›ç­”æŸä¸ªç‰¹å®šé—®é¢˜</li>
<li>â€¦â€¦</li>
</ul>
<h3 id="åœºæ™¯-1"><a href="#åœºæ™¯-1" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h3><ul>
<li>åŒ»ç–—å®¢æœ</li>
<li>é‡‘èå’¨è¯¢</li>
<li>è§’è‰²æ‰®æ¼”</li>
</ul>
<h2 id="å¾®è°ƒç›®æ ‡åˆ†ç±»"><a href="#å¾®è°ƒç›®æ ‡åˆ†ç±»" class="headerlink" title="å¾®è°ƒç›®æ ‡åˆ†ç±»"></a>å¾®è°ƒç›®æ ‡åˆ†ç±»</h2><ul>
<li>æŒ‡ä»¤å¾®è°ƒ ï¼ˆæ€»ç»“ã€æƒ…æ„Ÿåˆ†æï¼‰</li>
<li>é¢†åŸŸå¾®è°ƒ( é‡‘èç±»é—®é¢˜å›ç­”ã€åŒ»ç–—ç±»é—®é¢˜å›ç­”)</li>
<li>å¤šä»»åŠ¡å¾®è°ƒ</li>
<li>çŸ¥è¯†è’¸é¦ï¼ˆè€å¸ˆæ¨¡å‹å¾®è°ƒå­¦ç”Ÿæ¨¡å‹ï¼‰</li>
<li>å·¥å…·è°ƒç”¨</li>
<li>â€¦â€¦</li>
</ul>
<h2 id="å¾®è°ƒçš„ä¸¤ä¸ªä¸»è¦ç±»å‹"><a href="#å¾®è°ƒçš„ä¸¤ä¸ªä¸»è¦ç±»å‹" class="headerlink" title="å¾®è°ƒçš„ä¸¤ä¸ªä¸»è¦ç±»å‹"></a>å¾®è°ƒçš„ä¸¤ä¸ªä¸»è¦ç±»å‹</h2><ol>
<li>ç›‘ç£å¾®è°ƒï¼ˆSupervised Fine-tuningï¼‰ï¼šç›‘ç£å¾®è°ƒæ˜¯æŒ‡åœ¨è¿›è¡Œå¾®è°ƒæ—¶ä½¿ç”¨æœ‰æ ‡ç­¾çš„è®­ç»ƒæ•°æ®é›†ã€‚è¿™äº›æ ‡ç­¾æä¾›äº†æ¨¡å‹åœ¨å¾®è°ƒè¿‡ç¨‹ä¸­çš„ç›®æ ‡è¾“å‡ºã€‚åœ¨ç›‘ç£å¾®è°ƒä¸­ï¼Œé€šå¸¸ä½¿ç”¨å¸¦æœ‰æ ‡ç­¾çš„ä»»åŠ¡ç‰¹å®šæ•°æ®é›†ï¼Œä¾‹å¦‚åˆ†ç±»ä»»åŠ¡çš„æ•°æ®é›†ï¼Œå…¶ä¸­æ¯ä¸ªæ ·æœ¬éƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å…³è”çš„æ ‡ç­¾ã€‚é€šè¿‡ä½¿ç”¨è¿™äº›æ ‡ç­¾æ¥æŒ‡å¯¼æ¨¡å‹çš„å¾®è°ƒï¼Œå¯ä»¥ä½¿æ¨¡å‹æ›´å¥½åœ°é€‚åº”ç‰¹å®šä»»åŠ¡ã€‚</li>
<li>æ— ç›‘ç£å¾®è°ƒï¼ˆUnsupervised Fine-tuningï¼‰ï¼šæ— ç›‘ç£å¾®è°ƒæ˜¯æŒ‡åœ¨è¿›è¡Œå¾®è°ƒæ—¶ä½¿ç”¨æ— æ ‡ç­¾çš„è®­ç»ƒæ•°æ®é›†ã€‚è¿™æ„å‘³ç€åœ¨å¾®è°ƒè¿‡ç¨‹ä¸­ï¼Œæ¨¡å‹åªèƒ½åˆ©ç”¨è¾“å…¥æ•°æ®æœ¬èº«çš„ä¿¡æ¯ï¼Œè€Œæ²¡æœ‰æ˜ç¡®çš„ç›®æ ‡è¾“å‡ºã€‚è¿™äº›æ–¹æ³•é€šè¿‡å­¦ä¹ æ•°æ®çš„å†…åœ¨ç»“æ„æˆ–ç”Ÿæˆæ•°æ®æ¥è¿›è¡Œå¾®è°ƒï¼Œä»¥æå–æœ‰ç”¨çš„ç‰¹å¾æˆ–æ”¹è¿›æ¨¡å‹çš„è¡¨ç¤ºèƒ½åŠ›ã€‚</li>
</ol>
<h2 id="å¾®è°ƒæ–¹æ³•"><a href="#å¾®è°ƒæ–¹æ³•" class="headerlink" title="å¾®è°ƒæ–¹æ³•"></a>å¾®è°ƒæ–¹æ³•</h2><ul>
<li>Loraå¾®è°ƒ</li>
<li>å…¨å‚æ•°å¾®è°ƒ</li>
<li>å†»ç»“éƒ¨åˆ†å‚æ•°å¾®è°ƒ</li>
</ul>
<h2 id="Loraå¾®è°ƒ"><a href="#Loraå¾®è°ƒ" class="headerlink" title="Loraå¾®è°ƒ"></a>Loraå¾®è°ƒ</h2><h3 id="ä»€ä¹ˆæ˜¯Lora"><a href="#ä»€ä¹ˆæ˜¯Lora" class="headerlink" title="ä»€ä¹ˆæ˜¯Lora"></a>ä»€ä¹ˆæ˜¯Lora</h3><p>Low Rank Adapter</p>
<p><a href="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2024-11/lora1-6ZPzRm.png" title="img" class="gallery-item" style="box-shadow: none;"> <img src="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2024-11/lora1-6ZPzRm.png" alt="img"></a></p>
<p><a href="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2024-11/lora2-AxMP25.png" title="lora2-AxMP25" class="gallery-item" style="box-shadow: none;"> <img src="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2024-11/lora2-AxMP25.png" alt="lora2-AxMP25"></a></p>
<h3 id="Loraå¾®è°ƒçš„ä¼˜åŠ¿"><a href="#Loraå¾®è°ƒçš„ä¼˜åŠ¿" class="headerlink" title="Loraå¾®è°ƒçš„ä¼˜åŠ¿"></a>Loraå¾®è°ƒçš„ä¼˜åŠ¿</h3><ol>
<li><strong>æ•ˆç‡é«˜</strong>ï¼šåªéœ€æ›´æ–°ä½ç§©é€‚åº”å±‚ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ¨¡å‹ï¼Œæ›´å¿«ã€æ›´é«˜æ•ˆåœ°å¯¹å¤§å‹è¯­è¨€æ¨¡å‹è¿›è¡Œå¾®è°ƒã€‚</li>
<li><strong>èŠ‚çœèµ„æº</strong>ï¼šé™ä½å¾®è°ƒè¿‡ç¨‹çš„å¤æ‚æ€§ï¼ŒèŠ‚çœè®¡ç®—èµ„æºã€èƒ½æºå’Œæ—¶é—´ã€‚</li>
<li><strong><a href="https://ai-bot.cn/what-is-lora/">çµæ´»æ€§ï¼šé€‚ç”¨äºå„ç§å¤§è§„æ¨¡è¯­è¨€æ¨¡å‹ï¼Œæ˜“äºé€‚åº”ä¸åŒçš„ä»»åŠ¡æˆ–é¢†åŸŸ</a></strong></li>
</ol>
<h2 id="è¯­è¨€æ¨¡å‹å¾®è°ƒè¿‡ç¨‹"><a href="#è¯­è¨€æ¨¡å‹å¾®è°ƒè¿‡ç¨‹" class="headerlink" title="è¯­è¨€æ¨¡å‹å¾®è°ƒè¿‡ç¨‹"></a>è¯­è¨€æ¨¡å‹å¾®è°ƒè¿‡ç¨‹</h2><ol>
<li>ç¡®å®šè®­ç»ƒç›®æ ‡</li>
<li>é€‰æ‹©åˆé€‚çš„åŸºåº§æ¨¡å‹ (Baseã€Instrcutionã€Chatã€Codeã€MOEã€Toolcallã€VLM)ï¼Œå‚æ•°é‡</li>
<li>é€‰æ‹©å¾®è°ƒæ¡†æ¶ æ¨èç”¨ <a href="https://github.com/hiyouga/LLaMA-Factory">https://github.com/hiyouga/LLaMA-Factory</a></li>
<li>å‡†å¤‡å¾®è°ƒæ•°æ®<ol>
<li>æ‰¾åˆé€‚çš„æ•°æ®æºï¼ˆè‡ªæœ‰æ•°æ®\çˆ¬è™«\huggingface\github\wiki\kaggle\modelscopeï¼‰</li>
<li>æ•°æ®æ¸…æ´—ï¼ˆè¿‡æ»¤ã€å»é‡ã€è„±æ•ï¼‰</li>
<li>æ•°æ®å¤„ç†<ul>
<li>æ•°æ®å¢å¼º</li>
<li>åˆæˆæ•°æ®</li>
<li>æ•°æ®æ ¼å¼ï¼ˆtextï¼Œinstrcutionï¼Œconversationï¼‰</li>
</ul>
</li>
</ol>
</li>
<li>ç¡®å®šå¾®è°ƒå‚æ•°ï¼Œå¼€å§‹å¾®è°ƒ</li>
<li>è§‚å¯Ÿlosså˜åŒ–</li>
<li>æ¨¡å‹è¯„ä¼°</li>
<li>åˆå¹¶æ¨¡å‹ï¼Œå°†Loraå‚æ•°å’ŒBaseæ¨¡å‹å‚æ•°åˆå¹¶å¯¼å‡º</li>
<li>æ¨¡å‹é‡åŒ–ï¼ˆå¯é€‰ï¼‰</li>
</ol>
<h2 id="éƒ¨ç½²æ¨ç†æœåŠ¡"><a href="#éƒ¨ç½²æ¨ç†æœåŠ¡" class="headerlink" title="éƒ¨ç½²æ¨ç†æœåŠ¡"></a>éƒ¨ç½²æ¨ç†æœåŠ¡</h2><p>æ¨ç†æ¡†æ¶</p>
<ol>
<li>Transformers</li>
<li>vllm </li>
<li>Ollama</li>
<li>Xinference</li>
<li>onnx</li>
</ol>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>å­¦ä¹ </tag>
      </tags>
  </entry>
  <entry>
    <title>centoså®‰è£…LLVMå’ŒCLANG</title>
    <url>/llvm-clang/</url>
    <content><![CDATA[<div class=".article-gallery"><p>åœ¨ CentOS ä¸Šå®‰è£… LLVM Clang çš„è¿‡ç¨‹å¦‚ä¸‹:</p>
<ol>
<li>é¦–å…ˆï¼Œç¡®ä¿ç³»ç»Ÿå·²ç»æ›´æ–°å¹¶å®‰è£…äº†å¿…è¦çš„ç¼–è¯‘å·¥å…·ï¼Œå¦‚gccå’Œmakeï¼Œå¯ä»¥é€šè¿‡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®Œæˆ:</li>
</ol>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line">sudo yum update</span><br><span class="line">sudo yum install gcc <span class="built_in">make</span></span><br><span class="line">å¤åˆ¶ä»£ç </span><br></pre></td></tr></table></figure>

<ol>
<li>ä¸‹è½½LLVMå’ŒClangçš„æºç åŒ…ã€‚å¯ä»¥åœ¨LLVMå®˜ç½‘ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„æºç åŒ…ï¼Œæˆ–è€…ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¸‹è½½:</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wget http://releases.llvm.org/&lt;version&gt;/llvm-&lt;version&gt;.src.tar.xz</span><br><span class="line">wget http://releases.llvm.org/&lt;version&gt;/cfe-&lt;version&gt;.src.tar.xz</span><br><span class="line">å¤åˆ¶ä»£ç </span><br></pre></td></tr></table></figure>

<ol>
<li>è§£å‹æºç åŒ…å¹¶è¿›å…¥ç›®å½•:</li>
</ol>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">tar xf llvm-<span class="tag">&lt;<span class="name">version</span>&gt;</span>.src.tar.xz</span><br><span class="line">tar xf cfe-<span class="tag">&lt;<span class="name">version</span>&gt;</span>.src.tar.xz</span><br><span class="line">mv cfe-<span class="tag">&lt;<span class="name">version</span>&gt;</span>.src llvm-<span class="tag">&lt;<span class="name">version</span>&gt;</span>.src/tools/clang</span><br><span class="line">cd llvm-<span class="tag">&lt;<span class="name">version</span>&gt;</span>.src</span><br><span class="line">å¤åˆ¶ä»£ç </span><br></pre></td></tr></table></figure>

<ol>
<li>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥é…ç½®ã€ç¼–è¯‘å’Œå®‰è£…LLVMå’ŒClang:</li>
</ol>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> build</span><br><span class="line"><span class="built_in">cd</span> build</span><br><span class="line">cmake -G <span class="string">&quot;Unix Makefiles&quot;</span> ../</span><br><span class="line">make</span><br><span class="line"><span class="built_in">sudo</span> make install</span><br><span class="line">å¤åˆ¶ä»£ç </span><br></pre></td></tr></table></figure>

<ol>
<li>ç¼–è¯‘å®Œæˆåï¼Œå¯ä»¥ä½¿ç”¨ clang å’Œ llvm-config å‘½ä»¤æ¥æ£€æŸ¥å®‰è£…æ˜¯å¦æˆåŠŸã€‚</li>
</ol>
<p>æ³¨æ„: ä¸Šè¿°çš„è¯·æ›¿æ¢æˆä½ è¦å®‰è£…çš„ç‰ˆæœ¬å·ï¼Œå¦‚llvm-11.0.0</p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>ç»™luaå‡½æ•°æ·»åŠ è°ƒç”¨æ—¶é•¿é™åˆ¶</title>
    <url>/lua-settime/</url>
    <content><![CDATA[<div class=".article-gallery"><h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><p>æˆ˜æ–—éªŒè¯æœåŠ¡ä¼šè°ƒç”¨å®¢æˆ·ç«¯åŒå­¦å†™çš„luaå‡½æ•°ï¼Œluaå†™å‡ºäº†æ­»å¾ªç¯å¯¼è‡´å†…å­˜é£™å‡æœ€ç»ˆOOM</p>
<h2 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h2><p>ç”¨luaçš„debug.sethookæ–¹æ³•åŠ è°ƒç”¨é’©å­</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-- è®¾ç½®ä¸€ä¸ªæ—¶é—´é™åˆ¶é’©å­</span><br><span class="line"><span class="keyword">function</span> set_time_limit(seconds)</span><br><span class="line">    <span class="built_in">local</span> start = os.clock()</span><br><span class="line">    debug.sethook(<span class="keyword">function</span>()</span><br><span class="line">        <span class="keyword">if</span> os.clock() - start &gt;= seconds <span class="keyword">then</span></span><br><span class="line">            debug.sethook() -- ç§»é™¤é’©å­</span><br><span class="line">            error(<span class="string">&quot;Time limit exceeded&quot;</span>) -- ç»ˆæ­¢æ‰§è¡Œ</span><br><span class="line">        end</span><br><span class="line">    end, <span class="string">&quot;&quot;</span>, 1e7) -- ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯é’©å­çš„è°ƒç”¨é¢‘ç‡ï¼Œè¿™é‡Œæ˜¯æ¯æ‰§è¡Œå¤§çº¦1000ä¸‡æ¡æŒ‡ä»¤æ£€æŸ¥ä¸€æ¬¡</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>æ—¥å¿—ä¸­è½¬æœ</title>
    <url>/log-relay/</url>
    <content><![CDATA[<div class=".article-gallery"><p>æœ€è¿‘åœ¨å°†å•äººæˆ˜åœºçš„DSæœåŠ¡å™¨ä»åœ¨çº¿æ”¹æˆå®¢æˆ·ç«¯æœ¬åœ°è¿è¡Œï¼Œé™ä½åœ¨çº¿DSæœåŠ¡å™¨çš„æˆæœ¬ã€‚å…¶ä¸­åŸæœ¬åœ¨DSè¿›è¡Œçš„BIåŸ‹ç‚¹æ—¥å¿—ï¼Œéœ€è¦å®¢æˆ·ç«¯æ¥è¿›è¡Œä¸ŠæŠ¥äº†ã€‚</p>
<h2 id="é¢ä¸´çš„é—®é¢˜"><a href="#é¢ä¸´çš„é—®é¢˜" class="headerlink" title="é¢ä¸´çš„é—®é¢˜"></a>é¢ä¸´çš„é—®é¢˜</h2><h4 id="ä¸šåŠ¡ä¸Š"><a href="#ä¸šåŠ¡ä¸Š" class="headerlink" title="ä¸šåŠ¡ä¸Š"></a>ä¸šåŠ¡ä¸Š</h4><ol>
<li>å®¢æˆ·ç«¯åœ¨æœ¬åœ°Standaloneæ¨¡å¼ä¸‹ï¼ŒåŸºæœ¬æ‰€æœ‰ä¸ŠæŠ¥çš„ä»£ç éƒ½æ˜¯å¯ä»¥è¿è¡Œçš„ï¼ˆåªæœ‰æå°‘éƒ¨åˆ†DedicateServer.tsä¸­çš„ä¾èµ–æ¶ˆæ¯çš„ä»£ç éœ€è¦å•ç‹¬åœ¨Standaloneæ¨¡å¼å…¼å®¹ä¸‹æ—¥å¿—åŸ‹ç‚¹ï¼‰ï¼Œè¿™å—å·¥ä½œé‡éå¸¸å°‘ã€‚</li>
<li>æ€ªç‰©å’Œå®ç®±çš„æ‰è½ç”±GameServeræ¥è¿›è¡Œæ§åˆ¶ã€‚</li>
</ol>
<h4 id="æ¡†æ¶ä¸Š"><a href="#æ¡†æ¶ä¸Š" class="headerlink" title="æ¡†æ¶ä¸Š"></a>æ¡†æ¶ä¸Š</h4><ol>
<li>å®¢æˆ·ç«¯ç›´æ¥å‘æ•°ä»“ä¸ŠæŠ¥æ—¥å¿—é¢ä¸´çš„é—®é¢˜ï¼š<ol>
<li>å®¹æ˜“ä½œå¼Šï¼Œåƒåœ¾æ•°æ®æ±¡æŸ“æ•°ä»“</li>
<li>ä¸ŠæŠ¥æ—¥å¿—å¯èƒ½ä¸å®Œæ•´ï¼Œå½±å“æ•°ä»“çš„æ•°æ®å‡†ç¡®æ€§</li>
<li>è¿è¥å’Œæ•°åˆ†çš„è¦æ±‚æ˜¯ä¸€åœºæˆ˜æ–—çš„æ—¥å¿—å¿…é¡»æ˜¯å®Œæ•´çš„ï¼Œå¦‚æœä¸­é—´ä¸¢äº†ä¸€éƒ¨åˆ†éå¸¸å½±å“æ•´ä½“çš„åˆ†æ</li>
</ol>
</li>
<li>æœ€ç»ˆå†³å®šé‡‡ç”¨å®¢æˆ·ç«¯å°†æ•´åœºæˆ˜æ–—çš„æ—¥å¿—æ–‡ä»¶å‘å¾€æ—¥å¿—ä¸­è½¬æœï¼Œç”±ä¸­è½¬æœè¿›è¡Œæ—¥å¿—é‡‡é›†å‘å¾€æ•°ä»“ã€‚</li>
</ol>
<h2 id="è®¾è®¡è¦æ±‚"><a href="#è®¾è®¡è¦æ±‚" class="headerlink" title="è®¾è®¡è¦æ±‚"></a>è®¾è®¡è¦æ±‚</h2><p><strong>çœ‹ä¼¼ç®€å•çš„ä¸€ä¸ªæ–‡ä»¶æœåŠ¡å™¨ï¼Œå…¶å®åœ¨è®¾è®¡ä¸Šå¯¹å®‰å…¨æ€§å’Œæ€§èƒ½æœ‰è¾ƒé«˜çš„è¦æ±‚</strong></p>
<ol>
<li>æ ¡éªŒæ—¥å¿—æ–‡ä»¶æ˜¯å¦åˆæ³•ï¼Œå®¢æˆ·ç«¯ä¸èƒ½ç¯¡æ”¹æ–‡ä»¶éšæ„ä¸Šä¼ </li>
<li>æŒ‰è¡Œæ ¡éªŒæ–‡ä»¶ä¸­jsonæ ¼å¼å†…å®¹æ•°æ®</li>
<li>å°†æ ¡éªŒåçš„å¤šä¸ªæ—¥å¿—æ–‡ä»¶ï¼Œæœ€åæŒ‰å°æ—¶ä¸ºå•ä½åˆå¹¶å…¥ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼ˆæ–¹ä¾¿æ—¥å¿—é‡‡é›†ç»„ä»¶ï¼‰ï¼Œæœ€å¥½èƒ½åšåˆ°é›¶æ‹·è´ã€é›¶GC</li>
</ol>
<p><a href="https://github.com/zhangga/picx-images-hosting/raw/master/filerelay-1.3gotv9pdhw.webp" title="pic-1" class="gallery-item" style="box-shadow: none;"> <img src="https://github.com/zhangga/picx-images-hosting/raw/master/filerelay-1.3gotv9pdhw.webp" alt="pic-1"></a></p>
<p><a href="https://github.com/zhangga/picx-images-hosting/raw/master/filerelay-2.5c1enw202k.webp" title="pic-2" class="gallery-item" style="box-shadow: none;"> <img src="https://github.com/zhangga/picx-images-hosting/raw/master/filerelay-2.5c1enw202k.webp" alt="pic-2"></a></p>
<h2 id="è¯·æ±‚æ ¡éªŒ"><a href="#è¯·æ±‚æ ¡éªŒ" class="headerlink" title="è¯·æ±‚æ ¡éªŒ"></a>è¯·æ±‚æ ¡éªŒ</h2><ol>
<li><strong>é€šè¿‡GameServeræ¥ç”Ÿæˆç­¾åï¼Œæ§åˆ¶æ•´ä½“æˆ˜åœºæ—¥å¿—è¯·æ±‚çš„çœŸå®æ€§</strong><ol>
<li>å®¢æˆ·ç«¯æ— æ³•ä¼ªé€ ç­¾åï¼Œåªæœ‰çœŸæ­£é€šè¿‡GSè¯·æ±‚æ‹¿åˆ°å•æœºå…³å¡çš„ç­¾åæ‰èƒ½å‘èµ·æœ‰æ•ˆè¯·æ±‚</li>
<li>ä¸€ä¸ªæˆ˜åœºçš„ç­¾ååªèƒ½æˆåŠŸä½¿ç”¨ä¸€æ¬¡ï¼Œå³æˆ˜æ–—æ—¥å¿—è¢«æœåŠ¡å™¨æ¥æ”¶æˆåŠŸåå°±ä¸èƒ½å†æ¬¡ä½¿ç”¨</li>
<li>ç­¾åæœ‰æ•ˆæœŸ2å°æ—¶</li>
</ol>
</li>
<li>æ—¥å¿—æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡500k</li>
<li><strong>æ—¥å¿—æ–‡ä»¶å†…å®¹æ ¡éªŒï¼Œé˜²æ­¢å®¢æˆ·ç«¯æ¶æ„ç¯¡æ”¹æ–‡ä»¶æ±¡æŸ“æ•°ä»“</strong><ol>
<li>ç­¾åä¸­å¸¦æœ‰RoleId,BattleIdï¼Œå®¢æˆ·ç«¯æ— æ³•ç¯¡æ”¹ï¼ŒæœåŠ¡å™¨æ¥æ”¶å®Œæ–‡ä»¶åï¼Œåå°çº¿ç¨‹æ ¡éªŒæ–‡ä»¶å†…å®¹ï¼Œæ¯æ¡æ—¥å¿—çš„RoleId,BattleIdæ²¡æœ‰è¢«ç¯¡æ”¹ï¼Œæ‰ä¼šå°†è¯¥æ—¥å¿—æ–‡ä»¶æ”¾åˆ°<code>log-collector</code>é‡‡é›†çš„ç›®å½•</li>
<li>è¿™æ ·å³ä½¿å®¢æˆ·ç«¯æ¶æ„ç¯¡æ”¹æ—¥å¿—æ–‡ä»¶ï¼Œä¹Ÿåªä¼šå½±å“åˆ°ä»–è‡ªå·±çš„æŸä¸€åœºæˆ˜æ–—</li>
</ol>
</li>
</ol>
<h2 id="è¯·æ±‚é¢‘æ§"><a href="#è¯·æ±‚é¢‘æ§" class="headerlink" title="è¯·æ±‚é¢‘æ§"></a>è¯·æ±‚é¢‘æ§</h2><ol>
<li>è¯¥HTTPæ¥å£æœ€å¤–å±‚LBåŠ ä¸ªé˜²æŠ¤ï¼ˆæ¯”å¦‚é’ˆå¯¹æ¯ä¸ªå®¢æˆ·ç«¯ï¼Œæ¯åˆ†é’Ÿæœ€å¤šè¯·æ±‚5æ¬¡ï¼‰</li>
<li>æ—¥å¿—æœå†…éƒ¨ä¹Ÿä¼šå¯¹è¯·æ±‚åšé™æµ</li>
</ol>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>UE</tag>
      </tags>
  </entry>
  <entry>
    <title>Macä½¿ç”¨æ‰‹å†Œ</title>
    <url>/mac-manual/</url>
    <content><![CDATA[<div class=".article-gallery"><h3 id="Macæ–°æ‰‹ä½¿ç”¨æŒ‡å—"><a href="#Macæ–°æ‰‹ä½¿ç”¨æŒ‡å—" class="headerlink" title="Macæ–°æ‰‹ä½¿ç”¨æŒ‡å—"></a><a href="https://post.smzdm.com/p/679153/">Macæ–°æ‰‹ä½¿ç”¨æŒ‡å—</a></h3><h1 id="MACç¯å¢ƒå®‰è£…"><a href="#MACç¯å¢ƒå®‰è£…" class="headerlink" title="MACç¯å¢ƒå®‰è£…"></a>MACç¯å¢ƒå®‰è£…</h1><ol>
<li><strong>iTerm2å®‰è£…</strong></li>
</ol>
<p><a href="https://iterm2.com/">https://iterm2.com/</a></p>
<ol start="2">
<li><strong>brewå®‰è£…</strong></li>
</ol>
<p><code>/bin/bash -c &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)&quot;</code></p>
<p>å°†ä»¥ä¸Šå‘½ä»¤ç²˜è´´è‡³ç»ˆç«¯ã€‚å‚è€ƒï¼š<a href="https://brew.sh/index_zh-cn">https://brew.sh/index_zh-cn</a></p>
<span id="more"></span>

<ol start="3">
<li><strong>golangç¯å¢ƒå®‰è£…</strong></li>
</ol>
<p>å®‰è£…golangæœ€æ–°ç‰ˆã€‚</p>
<p><code>brew install go</code></p>
<p>æŸ¥çœ‹ç‰ˆæœ¬ï¼š</p>
<p><code>go version</code></p>
<p>é…ç½®golangç¯å¢ƒå˜é‡ï¼š</p>
<p>æ‰“å¼€ ~/.bash_profile æ–‡ä»¶ï¼Œæ²¡æœ‰çš„è¯æ–°å»ºï¼Œåœ¨æœ€åè¾“å…¥</p>
<p><code>export GOPATH=Go å¼€å‘åŒ…çš„é»˜è®¤å®‰è£…ç›®å½•å¦‚ï¼š/usr/local/go</code></p>
<p><code>export GOBIN=$GOPATH/bin</code></p>
<p><code>export PATH=$PATH:$GOBIN</code></p>
<p><code>source  ~/.bash_profile</code> æ–‡ä»¶ï¼Œä½¿ä¹‹ç”Ÿæ•ˆ</p>
<p>zshçš„é…ç½®æ–‡ä»¶ä¸ºï¼š~/.zshrc</p>
<p>å¤šç‰ˆæœ¬å…±å­˜å’Œåˆ‡æ¢ï¼š</p>
<p><a href="https://www.jianshu.com/p/363e4d39e694">https://www.jianshu.com/p/363e4d39e694</a></p>
<ol start="4">
<li><strong>golandå®‰è£…</strong></li>
</ol>
<p>å®˜ç½‘ä¸‹è½½æœ€æ–°ç‰ˆï¼š<a href="https://www.jetbrains.com/go/">https://www.jetbrains.com/go/</a></p>
<p>æŒ‰ç…§ä¸‹é¢æ–‡æ¡£ä¸­<strong>åœ¨çº¿å®‰è£…æ–¹å¼</strong>ï¼Œå®‰è£…golandæ— é™è¯•ç”¨æ’ä»¶ï¼š</p>
<p><a href="https://cloud.tencent.com/developer/article/1822218">https://cloud.tencent.com/developer/article/1822218</a></p>
<ol start="5">
<li><strong>GitLab sshkey</strong></li>
</ol>
<p>å®‰è£…gitï¼š</p>
<p><code>brew install git</code></p>
<p>å®‰è£…æ­¥éª¤ç”Ÿæˆssh keyï¼š</p>
<p><a href="https://www.jianshu.com/p/253ca7c2e80c">https://www.jianshu.com/p/253ca7c2e80c</a></p>
<p>å°†ssh keyæ·»åŠ åˆ°gitlabä¸­ï¼š</p>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><a href="https://i.loli.net/2021/11/02/gJaKmOF4U6WVLhA.png" title="gJaKmOF4U6WVLhA" class="gallery-item" style="box-shadow: none;"> <img src="https://i.loli.net/2021/11/02/gJaKmOF4U6WVLhA.png" alt="gJaKmOF4U6WVLhA"></a></p>
<ol start="6">
<li><strong>Dockerå®‰è£…</strong></li>
</ol>
<p><code>brew install --cask --appdir=/Applications docker</code></p>
<ol start="7">
<li><strong>svnå®‰è£…</strong></li>
</ol>
<p>svn clientå‘½ä»¤è¡Œå®‰è£…ï¼š</p>
<p><code>brew install svn</code></p>
<p>macä¹Ÿå¯é€‰æ‹©Cornerstoneã€‚</p>
<ol start="8">
<li><strong>MongoDBå®‰è£…</strong></li>
</ol>
<p><code>brew tap mongodb/brew</code></p>
<p><code>brew install mongodb-community@4.4</code></p>
<p>é…ç½®mongo binçš„PATH</p>
<p>åœ¨~/.bash_profileä¸­è¿½åŠ PATH</p>
<p><code>export MONGO_BIN=/usr/local/opt/mongodb-community@4.4/bin</code></p>
<p><code>export PATH=$PATH:$MONGO_BIN:.</code></p>
<ol start="9">
<li><strong>goluaç¯å¢ƒ</strong></li>
</ol>
<ul>
<li><strong>é¦–å…ˆå®‰è£…luaç¯å¢ƒï¼š</strong></li>
</ul>
<p><a href="http://www.lua.org/download.html">å®˜ç½‘</a>ä¸‹è½½æœ€æ–°ç‰ˆ lua-5.4.3.tar.gz</p>
<p>è§£å‹ä¸‹è½½çš„å‹ç¼©åŒ…ï¼Œè¿è¡Œç»ˆç«¯ï¼Œè¿›å…¥è§£å‹åçš„æ–‡ä»¶å¤¹</p>
<p>æ‰§è¡Œå‘½ä»¤ <code>make macosx</code></p>
<p>æ‰§è¡Œå‘½ä»¤ <code>make test</code></p>
<p>ç»“æœæ˜¾ç¤ºå¦‚ä¸‹ï¼š</p>
<p>![image(1)-QKzyA4](<a href="https://cdn.jsdelivr.net/gh/zhangga/gitment-comments@master/uPic/2021-11/image">https://cdn.jsdelivr.net/gh/zhangga/gitment-comments@master/uPic/2021-11/image</a> (1)-QKzyA4.png)</p>
<p>æ‰§è¡Œå‘½ä»¤ <code>sudo make install</code>ï¼Œå¹¶è¾“å…¥å¯†ç ï¼Œå¼€å§‹æ‰§è¡Œå®‰è£…</p>
<p>å®‰è£…å®Œæˆåä½¿ç”¨<code>lua -v</code> æŸ¥çœ‹ç‰ˆæœ¬</p>
<ul>
<li><strong>goluaç¯å¢ƒ</strong></li>
</ul>
<ol>
<li><strong>æ·»åŠ æ–‡ä»¶/usr/local/lib/pkgconfig/lua5.4.pc</strong></li>
</ol>
<p>å†…å®¹å¦‚ä¸‹ï¼š</p>
<p>prefix=/usr/local<br>exec_prefix=${prefix}<br>libdir=${exec_prefix}/lib<br>includedir=${prefix}/include</p>
<p>Name: liblua<br>Description: Lua5.4.3<br>Version: 5.4.3<br>Requires:<br>Libs: -L${libdir} -llua<br>Cflags: -I${includedir} -I${includedir}/lua</p>
<ol>
<li><p><strong>ç»ˆç«¯æ‰§è¡Œï¼š</strong><code>brew install pkg-config</code></p>
</li>
<li><p><strong>ç»ˆç«¯æ‰§è¡Œï¼š</strong><code>go get github.com/zhao02game/golua/lua</code></p>
</li>
<li><p><strong>å…¶ä»–å®‰è£…</strong></p>
</li>
</ol>
<p><code>brew install coreutils ag etcd redis zsh</code></p>
<ol start="11">
<li><strong>ç»ˆç«¯å®šåˆ¶</strong></li>
</ol>
<p><a href="https://segmentfault.com/a/1190000014992947">https://segmentfault.com/a/1190000014992947</a></p>
<ol start="12">
<li><p>ç¿»è¯‘è½¯ä»¶</p>
<p>æ¬§é™†è¯å…¸</p>
</li>
<li><p>å›¾åºŠè½¯ä»¶</p>
<p><a href="https://github.com/gee1k/uPic">https://github.com/gee1k/uPic</a></p>
<p>ä½¿ç”¨GitHubåšä¸ºå›¾åºŠï¼Œè®¾ç½®</p>
<p><a href="https://cdn.jsdelivr.net/gh/zhangga/gitment-comments@master/uPic/2021-11/20211102183650-TrCWY6.jpg" title="20211102183650-TrCWY6" class="gallery-item" style="box-shadow: none;"> <img src="https://cdn.jsdelivr.net/gh/zhangga/gitment-comments@master/uPic/2021-11/20211102183650-TrCWY6.jpg" alt="20211102183650-TrCWY6"></a></p>
</li>
<li><p>ä½¿ç”¨vscodeæŸ¥çœ‹csvçš„å·®å¼‚ï¼Œvscodeå®‰è£…Edit csv å’Œ SVNæ’ä»¶ã€‚</p>
<p>Edit csvè®¾ç½®ï¼š</p>
<p><a href="https://cdn.jsdelivr.net/gh/zhangga/gitment-comments@master/uPic/2021-11/20211102184046-NvJ5ti.jpg" title="20211102184046-NvJ5ti" class="gallery-item" style="box-shadow: none;"> <img src="https://cdn.jsdelivr.net/gh/zhangga/gitment-comments@master/uPic/2021-11/20211102184046-NvJ5ti.jpg" alt="20211102184046-NvJ5ti"></a></p>
</li>
<li></li>
</ol>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>MongoDBç´¢å¼•è¯¦è§£</title>
    <url>/mongodb-index/</url>
    <content><![CDATA[<div class=".article-gallery"><h1 id="ç´¢å¼•åŸºç¡€çŸ¥è¯†"><a href="#ç´¢å¼•åŸºç¡€çŸ¥è¯†" class="headerlink" title="ç´¢å¼•åŸºç¡€çŸ¥è¯†"></a>ç´¢å¼•åŸºç¡€çŸ¥è¯†</h1><h2 id="ä»€ä¹ˆæ˜¯ç´¢å¼•"><a href="#ä»€ä¹ˆæ˜¯ç´¢å¼•" class="headerlink" title="ä»€ä¹ˆæ˜¯ç´¢å¼•"></a>ä»€ä¹ˆæ˜¯ç´¢å¼•</h2><p>ç´¢å¼•æœ€å¸¸ç”¨çš„æ¯”å–»å°±æ˜¯ä¹¦ç±çš„ç›®å½•ï¼ŒæŸ¥è¯¢ç´¢å¼•å°±åƒæŸ¥è¯¢ä¸€æœ¬ä¹¦çš„ç›®å½•ã€‚æœ¬è´¨ä¸Šç›®å½•æ˜¯å°†ä¹¦ä¸­ä¸€å°éƒ¨åˆ†å†…å®¹ä¿¡æ¯ï¼ˆæ¯”å¦‚é¢˜ç›®ï¼‰å’Œå†…å®¹çš„ä½ç½®ä¿¡æ¯ï¼ˆé¡µç ï¼‰å…±åŒæ„æˆï¼Œè€Œç”±äºä¿¡æ¯é‡å°ï¼ˆåªæœ‰é¢˜ç›®ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾ˆå¿«æ‰¾åˆ°æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ç‰‡æ®µï¼Œå†æ ¹æ®é¡µç æ‰¾åˆ°ç›¸åº”çš„å†…å®¹ã€‚åŒæ ·ç´¢å¼•ä¹Ÿæ˜¯åªä¿ç•™æŸä¸ªåŸŸçš„ä¸€éƒ¨åˆ†ä¿¡æ¯ï¼ˆå»ºç«‹äº†ç´¢å¼•çš„fieldçš„ä¿¡æ¯ï¼‰ï¼Œä»¥åŠå¯¹åº”çš„æ–‡æ¡£çš„ä½ç½®ä¿¡æ¯ã€‚ å‡è®¾æˆ‘ä»¬æœ‰å¦‚ä¸‹æ–‡æ¡£ï¼ˆæ¯è¡Œçš„æ•°æ®åœ¨MongoDBä¸­æ˜¯å­˜åœ¨äºä¸€ä¸ªDocumentå½“ä¸­ï¼‰</p>
<table>
<thead>
<tr>
<th align="left">å§“å</th>
<th align="left">id</th>
<th align="left">éƒ¨é—¨</th>
<th align="left">city</th>
<th align="left">score</th>
</tr>
</thead>
<tbody><tr>
<td align="left">å¼ ä¸‰</td>
<td align="left">2</td>
<td align="left">xxx</td>
<td align="left">Beijing</td>
<td align="left">90</td>
</tr>
<tr>
<td align="left">æå››</td>
<td align="left">1</td>
<td align="left">xxx</td>
<td align="left">Shanghai</td>
<td align="left">70</td>
</tr>
<tr>
<td align="left">ç‹äº”</td>
<td align="left">3</td>
<td align="left">xxx</td>
<td align="left">guangzhou</td>
<td align="left">60</td>
</tr>
</tbody></table>
<span id="more"></span>

<p>å‡å¦‚æˆ‘ä»¬æƒ³æ‰¾idä¸º2çš„document(å³å¼ ä¸‰çš„è®°å½•)ï¼Œå¦‚æœæ²¡æœ‰ç´¢å¼•ï¼Œæˆ‘ä»¬å°±éœ€è¦æ‰«ææ•´ä¸ªæ•°æ®è¡¨ï¼Œç„¶åæ‰¾å‡ºæ‰€æœ‰ä¸º2çš„documentã€‚å½“æ•°æ®è¡¨ä¸­æœ‰å¤§é‡documentsçš„æ—¶å€™ï¼Œè¿™ä¸ªæ—¶é—´å°±ä¼šéå¸¸é•¿ï¼ˆä»ç£ç›˜ä¸ŠæŸ¥æ‰¾æ•°æ®è¿˜æ¶‰åŠå¤§é‡çš„IOæ“ä½œ)ã€‚å»ºç«‹ç´¢å¼•åä¼šæœ‰ä»€ä¹ˆå˜åŒ–å‘¢ï¼ŸMongoDBä¼šå°†idæ•°æ®æ‹¿å‡ºæ¥å»ºç«‹ç´¢å¼•æ•°æ®ï¼Œå¦‚ä¸‹</p>
<table>
<thead>
<tr>
<th align="left">ç´¢å¼•å€¼</th>
<th align="left">ä½ç½®</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1</td>
<td align="left">pos2</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">pos1</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">pos3</td>
</tr>
</tbody></table>
<p>è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ‰«æè¿™ä¸ªå°è¡¨æ‰¾åˆ°documentå¯¹åº”çš„ä½ç½®ã€‚</p>
<p>æŸ¥æ‰¾è¿‡ç¨‹ç¤ºæ„å›¾å¦‚ä¸‹ï¼š<a href="https://upload-images.jianshu.io/upload_images/3959253-7e2a31d0b5301c9f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" title="å›¾ç‰‡æ¥æºMongoDBå®˜ç½‘" class="gallery-item" style="box-shadow: none;"> <img src="https://upload-images.jianshu.io/upload_images/3959253-7e2a31d0b5301c9f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å›¾ç‰‡æ¥æºMongoDBå®˜ç½‘"></a></p>
<p>ä¸ºä»€ä¹ˆè¿™æ ·é€Ÿåº¦ä¼šå¿«å‘¢ï¼Ÿè¿™ä¸»è¦æœ‰å‡ æ–¹é¢çš„å› ç´ </p>
<ol>
<li>ç´¢å¼•æ•°æ®é€šè¿‡B+æ ‘æ¥å­˜å‚¨ï¼Œä»è€Œä½¿å¾—æœç´¢çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(log<sub>d</sub><sup>N</sup>)çº§åˆ«çš„(dæ˜¯B+æ ‘çš„åº¦, é€šå¸¸dçš„å€¼æ¯”è¾ƒå¤§ï¼Œæ¯”å¦‚å¤§äº100)ï¼Œæ¯”åŸå…ˆO(N)çš„å¤æ‚åº¦å¤§å¹…ä¸‹é™ã€‚è¿™ä¸ªå·®è·æ˜¯æƒŠäººçš„ï¼Œä»¥ä¸€ä¸ªå®é™…ä¾‹å­æ¥çœ‹ï¼Œå‡è®¾d=100ï¼ŒN=1äº¿ï¼Œé‚£ä¹ˆO(log<sub>d</sub><sup>N</sup>) = 8, è€ŒO(N)æ˜¯1äº¿ã€‚æ˜¯çš„ï¼Œè¿™å°±æ˜¯ç®—æ³•çš„å¨åŠ›ã€‚</li>
<li>ç´¢å¼•æœ¬èº«æ˜¯åœ¨é«˜é€Ÿç¼“å­˜å½“ä¸­ï¼Œç›¸æ¯”ç£ç›˜IOæ“ä½œä¼šæœ‰å¤§å¹…çš„æ€§èƒ½æå‡ã€‚ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæœ‰çš„æ—¶å€™æ•°æ®é‡éå¸¸å¤§çš„æ—¶å€™ï¼Œç´¢å¼•æ•°æ®ä¹Ÿä¼šéå¸¸å¤§ï¼Œå½“å¤§åˆ°è¶…å‡ºå†…å­˜å®¹é‡çš„æ—¶å€™ï¼Œä¼šå¯¼è‡´éƒ¨åˆ†ç´¢å¼•æ•°æ®å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œè¿™ä¼šå¯¼è‡´ç£ç›˜IOçš„å¼€é”€å¤§å¹…å¢åŠ ï¼Œä»è€Œå½±å“æ€§èƒ½ï¼Œæ‰€ä»¥åŠ¡å¿…è¦ä¿è¯æœ‰è¶³å¤Ÿçš„å†…å­˜èƒ½å®¹ä¸‹æ‰€æœ‰çš„ç´¢å¼•æ•°æ®ï¼‰</li>
</ol>
<p>å½“ç„¶ï¼Œäº‹ç‰©æ€»æœ‰å…¶ä¸¤é¢æ€§ï¼Œåœ¨æå‡æŸ¥è¯¢é€Ÿåº¦çš„åŒæ—¶ï¼Œç”±äºè¦å»ºç«‹ç´¢å¼•ï¼Œæ‰€ä»¥å†™å…¥æ“ä½œæ—¶å°±éœ€è¦é¢å¤–çš„æ·»åŠ ç´¢å¼•çš„æ“ä½œï¼Œè¿™å¿…ç„¶ä¼šå½±å“å†™å…¥çš„æ€§èƒ½ï¼Œæ‰€ä»¥å½“æœ‰å¤§é‡å†™æ“ä½œè€Œè¯»æ“ä½œæ¯”è¾ƒå°‘çš„æ—¶å€™ï¼Œä¸”å¯¹è¯»æ“ä½œæ€§èƒ½ä¸éœ€è¦è€ƒè™‘çš„æ—¶å€™ï¼Œå°±ä¸é€‚åˆå»ºç«‹ç´¢å¼•ã€‚å½“ç„¶ï¼Œç›®å‰å¤§å¤šæ•°äº’è”ç½‘åº”ç”¨éƒ½æ˜¯è¯»æ“ä½œè¿œå¤§äºå†™æ“ä½œï¼Œå› æ­¤å»ºç«‹ç´¢å¼•å¾ˆå¤šæ—¶å€™æ˜¯éå¸¸åˆ’ç®—å’Œå¿…è¦çš„æ“ä½œã€‚</p>
<p>å…³äºç´¢å¼•åŸç†çš„è¯¦ç»†è§£é‡Šå¯ä»¥å‚è€ƒæ–‡ç« <a href="http://blog.codinglabs.org/articles/theory-of-mysql-index.html">MySQLç´¢å¼•èƒŒåçš„æ•°æ®ç»“æ„åŠç®—æ³•åŸç†</a>ï¼Œè™½ç„¶è®²å¾—æ˜¯MySQLä½†æ˜¯åŸç†ç›¸ä¼¼ã€‚</p>
<h2 id="MongoDBæœ‰å“ªäº›ç±»å‹çš„ç´¢å¼•"><a href="#MongoDBæœ‰å“ªäº›ç±»å‹çš„ç´¢å¼•" class="headerlink" title="MongoDBæœ‰å“ªäº›ç±»å‹çš„ç´¢å¼•"></a>MongoDBæœ‰å“ªäº›ç±»å‹çš„ç´¢å¼•</h2><h3 id="å•å­—æ®µç´¢å¼•-ï¼ˆSingle-Field-Indexï¼‰"><a href="#å•å­—æ®µç´¢å¼•-ï¼ˆSingle-Field-Indexï¼‰" class="headerlink" title="å•å­—æ®µç´¢å¼• ï¼ˆSingle Field Indexï¼‰"></a>å•å­—æ®µç´¢å¼• ï¼ˆSingle Field Indexï¼‰</h3><p>è¿™ä¸ªæ˜¯æœ€ç®€å•æœ€å¸¸ç”¨çš„ç´¢å¼•ç±»å‹ï¼Œæ¯”å¦‚æˆ‘ä»¬ä¸Šè¾¹çš„ä¾‹å­ï¼Œä¸ºidå»ºç«‹ä¸€ä¸ªå•ç‹¬çš„ç´¢å¼•å°±æ˜¯æ­¤ç§ç±»å‹ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> # ä¸ºid fieldå»ºç«‹ç´¢å¼•ï¼Œ1è¡¨ç¤ºå‡åºï¼Œ-1è¡¨ç¤ºé™åºï¼Œæ²¡æœ‰å·®åˆ«</span><br><span class="line">db.employee.createIndex(&#123;&#x27;id&#x27;: 1&#125;)</span><br></pre></td></tr></table></figure>



<p>éœ€è¦æ³¨æ„çš„æ˜¯é€šå¸¸MongoDBä¼šè‡ªåŠ¨ä¸ºæˆ‘ä»¬çš„æ–‡æ¡£æ’å…¥â€™_idâ€™ fieldï¼Œä¸”å·²ç»æŒ‰ç…§å‡åºè¿›è¡Œç´¢å¼•ï¼Œå¦‚æœæˆ‘ä»¬æ’å…¥çš„æ–‡æ¡£ä¸­åŒ…å«æœ‰â€™_idâ€™ fieldï¼Œåˆ™MongoDBå°±ä¸ä¼šè‡ªåŠ¨åˆ›å»ºâ€™_idâ€™ fieldï¼Œä½†æ˜¯éœ€è¦æˆ‘ä»¬è‡ªå·±æ¥ä¿è¯å”¯ä¸€æ€§ä»è€Œå”¯ä¸€æ ‡è¯†ä¸€ä¸ªæ–‡æ¡£</p>
<h3 id="å¤åˆç´¢å¼•-Compound-Index"><a href="#å¤åˆç´¢å¼•-Compound-Index" class="headerlink" title="å¤åˆç´¢å¼• (Compound Index)"></a>å¤åˆç´¢å¼• (Compound Index)</h3><p>ç¬¦åˆç´¢å¼•çš„åŸç†å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<a href="https://upload-images.jianshu.io/upload_images/3959253-6b00f39c08c49406.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" title="å¤åˆç´¢å¼•ç¤ºæ„å›¾" class="gallery-item" style="box-shadow: none;"> <img src="https://upload-images.jianshu.io/upload_images/3959253-6b00f39c08c49406.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å¤åˆç´¢å¼•ç¤ºæ„å›¾"></a>ä¸Šå›¾æŸ¥è¯¢ç´¢å¼•çš„æ—¶å€™ä¼šå…ˆæŸ¥è¯¢useridï¼Œå†æŸ¥è¯¢scoreï¼Œç„¶åå°±å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„æ–‡æ¡£ã€‚ å¯¹äºå¤åˆç´¢å¼•éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<h4 id="ç´¢å¼•fieldçš„å…ˆåé¡ºåºå¾ˆå…³é”®ï¼Œå½±å“æœ‰ä¸¤æ–¹é¢ï¼š"><a href="#ç´¢å¼•fieldçš„å…ˆåé¡ºåºå¾ˆå…³é”®ï¼Œå½±å“æœ‰ä¸¤æ–¹é¢ï¼š" class="headerlink" title="ç´¢å¼•fieldçš„å…ˆåé¡ºåºå¾ˆå…³é”®ï¼Œå½±å“æœ‰ä¸¤æ–¹é¢ï¼š"></a>ç´¢å¼•fieldçš„å…ˆåé¡ºåºå¾ˆå…³é”®ï¼Œå½±å“æœ‰ä¸¤æ–¹é¢ï¼š</h4><ol>
<li><p>MongoDBåœ¨å¤åˆç´¢å¼•ä¸­æ˜¯æ ¹æ®prefixæ’åºæŸ¥è¯¢ï¼Œå°±æ˜¯è¯´æ’åœ¨å‰é¢çš„å¯ä»¥å•ç‹¬ä½¿ç”¨ã€‚æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¦‚ä¸‹çš„ç´¢å¼•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">db.collection.createIndex(&#123;&#x27;id&#x27;: 1, &#x27;city&#x27;: 1, &#x27;score&#x27;: 1&#125;)</span><br></pre></td></tr></table></figure></li>
</ol>
<p>æˆ‘ä»¬å¦‚ä¸‹çš„æŸ¥è¯¢å¯ä»¥åˆ©ç”¨ç´¢å¼•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">db.collection.find(&#123;&#x27;id&#x27;: xxx&#125;)</span><br><span class="line">db.collection.find(&#123;&#x27;id&#x27;: xxx, &#x27;city&#x27;: xxx&#125;)</span><br><span class="line">db.collection.find(&#123;&#x27;id&#x27;: xxx, &#x27;city&#x27;:xxx, &#x27;score&#x27;: xxxx&#125;)</span><br></pre></td></tr></table></figure>



<p>ä½†æ˜¯å¦‚ä¸‹çš„æŸ¥è¯¢æ— æ³•åˆ©ç”¨è¯¥ç´¢å¼•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">db.collection.find(&#123;&#x27;city&#x27;: xxx&#125;)</span><br><span class="line">db.collection.find(&#123;&#x27;city&#x27;:xxx, &#x27;score&#x27;: xxxx&#125;)</span><br></pre></td></tr></table></figure>



<p>è¿˜æœ‰ä¸€ç§ç‰¹æ®Šçš„æƒ…å†µï¼Œå°±æ˜¯å¦‚ä¸‹æŸ¥è¯¢ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">db.collection.find(&#123;&#x27;id&#x27;: xxx, &#x27;score&#x27;: xxxx&#125;)</span><br></pre></td></tr></table></figure>



<p>è¿™ä¸ªæŸ¥è¯¢ä¹Ÿå¯ä»¥åˆ©ç”¨ç´¢å¼•çš„å‰ç¼€â€™idâ€™æ¥æŸ¥è¯¢ï¼Œä½†æ˜¯å´ä¸èƒ½é’ˆå¯¹scoreè¿›è¡ŒæŸ¥è¯¢ï¼Œä½ å¯ä»¥è¯´æ˜¯éƒ¨åˆ†åˆ©ç”¨äº†ç´¢å¼•ï¼Œå› æ­¤å…¶æ•ˆç‡å¯èƒ½ä¸å¦‚å¦‚ä¸‹ç´¢å¼•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">db.collection.createIndex(&#123;&#x27;id&#x27;: 1, &#x27;score&#x27;: 1&#125;)</span><br></pre></td></tr></table></figure>



<p>2.è¿‡æ»¤å‡ºçš„documentè¶Šå°‘çš„fieldè¶Šåº”è¯¥æ”¾åœ¨å‰é¢ï¼Œæ¯”å¦‚æ­¤ä¾‹ä¸­idå¦‚æœæ˜¯å”¯ä¸€çš„ï¼Œé‚£ä¹ˆå°±åº”è¯¥æ”¾åœ¨æœ€å‰é¢ï¼Œå› ä¸ºè¿™æ ·é€šè¿‡idå°±å¯ä»¥é”å®šå”¯ä¸€ä¸€ä¸ªæ–‡æ¡£ã€‚è€Œå¦‚æœé€šè¿‡cityæˆ–è€…scoreè¿‡æ»¤å®Œæˆåè¿˜æ˜¯ä¼šæœ‰å¤§é‡æ–‡æ¡£ï¼Œè¿™å°±ä¼šå½±å“æœ€ç»ˆçš„æ€§èƒ½ã€‚</p>
<h4 id="ç´¢å¼•çš„æ’åºé¡ºåºä¸åŒ"><a href="#ç´¢å¼•çš„æ’åºé¡ºåºä¸åŒ" class="headerlink" title="ç´¢å¼•çš„æ’åºé¡ºåºä¸åŒ"></a>ç´¢å¼•çš„æ’åºé¡ºåºä¸åŒ</h4><p>å¤åˆç´¢å¼•æœ€æœ«å°¾çš„fieldï¼Œå…¶æ’åºé¡ºåºä¸åŒå¯¹äºMongoDBçš„æŸ¥è¯¢æ’åºæ“ä½œæ˜¯æœ‰å½±å“çš„ã€‚ æ¯”å¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">db.events.createIndex( &#123; username: 1, date: -1 &#125; )</span><br></pre></td></tr></table></figure>



<p>è¿™ç§æƒ…å†µä¸‹ï¼Œ å¦‚ä¸‹çš„queryå¯ä»¥åˆ©ç”¨ç´¢å¼•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">db.events.find().sort( &#123; username: 1, date: -1 &#125; )</span><br></pre></td></tr></table></figure>



<p>ä½†æ˜¯å¦‚ä¸‹queryåˆ™æ— æ³•åˆ©ç”¨indexè¿›è¡Œæ’åº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">db.events.find().sort( &#123; username: 1, date: 1 &#125; )</span><br></pre></td></tr></table></figure>



<h3 id="å¤škeyç´¢å¼•-ï¼ˆMultikey-Indexï¼‰"><a href="#å¤škeyç´¢å¼•-ï¼ˆMultikey-Indexï¼‰" class="headerlink" title="å¤škeyç´¢å¼• ï¼ˆMultikey Indexï¼‰"></a>å¤škeyç´¢å¼• ï¼ˆMultikey Indexï¼‰</h3><p>è¿™ä¸ªä¸»è¦æ˜¯é’ˆå¯¹æ•°æ®ç±»å‹ä¸ºæ•°ç»„çš„ç±»å‹ï¼Œå¦‚ä¸‹ç¤ºä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&quot;name&quot; : &quot;jack&quot;, &quot;age&quot; : 19, habbit: [&quot;football, runnning&quot;]&#125;</span><br><span class="line">db.person.createIndex( &#123;habbit: 1&#125; )  // è‡ªåŠ¨åˆ›å»ºå¤škeyç´¢å¼•</span><br><span class="line">db.person.find( &#123;habbit: &quot;football&quot;&#125; )</span><br></pre></td></tr></table></figure>



<h3 id="å…¶å®ƒç±»å‹ç´¢å¼•"><a href="#å…¶å®ƒç±»å‹ç´¢å¼•" class="headerlink" title="å…¶å®ƒç±»å‹ç´¢å¼•"></a>å…¶å®ƒç±»å‹ç´¢å¼•</h3><p>å¦å¤–ï¼ŒMongoDBä¸­è¿˜æœ‰å…¶å®ƒå¦‚å“ˆå¸Œç´¢å¼•ï¼Œåœ°ç†ä½ç½®ç´¢å¼•ä»¥åŠæ–‡æœ¬ç´¢å¼•ï¼Œä¸»è¦ç”¨äºä¸€äº›ç‰¹å®šåœºæ™¯ï¼Œå…·ä½“å¯ä»¥å‚è€ƒå®˜ç½‘ï¼Œåœ¨æ­¤ä¸å†è¯¦è§£</p>
<h3 id="ç´¢å¼•å±æ€§"><a href="#ç´¢å¼•å±æ€§" class="headerlink" title="ç´¢å¼•å±æ€§"></a>ç´¢å¼•å±æ€§</h3><p>ç´¢å¼•ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªå±æ€§:</p>
<ul>
<li><p>uniqueï¼šè¿™ä¸ªéå¸¸å¸¸ç”¨ï¼Œç”¨äºé™åˆ¶ç´¢å¼•çš„fieldæ˜¯å¦å…·æœ‰å”¯ä¸€æ€§å±æ€§ï¼Œå³ä¿è¯è¯¥fieldçš„å€¼å”¯ä¸€</p>
</li>
<li><p>partialï¼šå¾ˆæœ‰ç”¨ï¼Œåœ¨ç´¢å¼•çš„æ—¶å€™åªé’ˆå¯¹ç¬¦åˆç‰¹å®šæ¡ä»¶çš„æ–‡æ¡£æ¥å»ºç«‹ç´¢å¼•ï¼Œå¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">db.restaurants.createIndex(</span><br><span class="line">   &#123; cuisine: 1, name: 1 &#125;,</span><br><span class="line">   &#123; partialFilterExpression: &#123; rating: &#123; $gt: 5 &#125; &#125; &#125; //åªæœ‰å½“ratingå¤§äº5æ—¶æ‰ä¼šå»ºç«‹ç´¢å¼•</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
</ul>
<p>è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åªä¸ºéƒ¨åˆ†æ•°æ®å»ºç«‹ç´¢å¼•ï¼Œä»è€Œå¯ä»¥å‡å°‘ç´¢å¼•æ•°æ®çš„é‡ï¼Œé™¤èŠ‚çœç©ºé—´å¤–ï¼Œå…¶æ£€ç´¢æ€§èƒ½ä¹Ÿä¼šå› ä¸ºè¾ƒå°‘çš„æ•°æ®é‡è€Œå¾—åˆ°æå‡ã€‚</p>
<ul>
<li>sparseï¼šå¯ä»¥è®¤ä¸ºæ˜¯partialç´¢å¼•çš„ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œç”±äºMongoDB3.2ä¹‹åå·²ç»æ”¯æŒpartialå±æ€§ï¼Œæ‰€ä»¥å»ºè®®ç›´æ¥ä½¿ç”¨partialå±æ€§ã€‚</li>
<li>TTLã€‚ å¯ä»¥ç”¨äºè®¾å®šæ–‡æ¡£æœ‰æ•ˆæœŸï¼Œæœ‰æ•ˆæœŸåˆ°è‡ªåŠ¨åˆ é™¤å¯¹åº”çš„æ–‡æ¡£ã€‚</li>
</ul>
<h1 id="é€šè¿‡explainç»“æœæ¥åˆ†ææ€§èƒ½"><a href="#é€šè¿‡explainç»“æœæ¥åˆ†ææ€§èƒ½" class="headerlink" title="é€šè¿‡explainç»“æœæ¥åˆ†ææ€§èƒ½"></a>é€šè¿‡explainç»“æœæ¥åˆ†ææ€§èƒ½</h1><p>æˆ‘ä»¬å¾€å¾€ä¼šé€šè¿‡æ‰“ç‚¹æ•°æ®æ¥åˆ†æä¸šåŠ¡çš„æ€§èƒ½ç“¶é¢ˆï¼Œè¿™æ—¶ï¼Œæˆ‘ä»¬ä¼šå‘ç°å¾ˆå¤šç“¶é¢ˆéƒ½æ˜¯å‡ºç°åœ¨æ•°æ®åº“ç›¸å…³çš„æ“ä½œä¸Šï¼Œè¿™æ—¶ç”±äºæ•°æ®åº“çš„æŸ¥è¯¢å’Œå­˜å–éƒ½æ¶‰åŠå¤§é‡çš„IOæ“ä½œï¼Œè€Œä¸”æœ‰æ—¶ç”±äºä½¿ç”¨ä¸å½“ï¼Œä¼šå¯¼è‡´IOæ“ä½œçš„å¤§å¹…åº¦å¢é•¿ï¼Œä»è€Œå¯¼è‡´äº†äº§ç”Ÿæ€§èƒ½é—®é¢˜ã€‚è€ŒMongoDBæä¾›äº†ä¸€ä¸ªexplainå·¥å…·æ¥ç”¨äºåˆ†ææ•°æ®åº“çš„æ“ä½œã€‚ç›´æ¥æ‹¿å®˜ç½‘çš„ç¤ºä¾‹æ¥åšè¯´æ˜ï¼š</p>
<p>å‡è®¾æˆ‘ä»¬åœ¨inventory collectionä¸­æœ‰å¦‚ä¸‹æ–‡æ¡£ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123; &quot;_id&quot; : 1, &quot;item&quot; : &quot;f1&quot;, type: &quot;food&quot;, quantity: 500 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : 2, &quot;item&quot; : &quot;f2&quot;, type: &quot;food&quot;, quantity: 100 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : 3, &quot;item&quot; : &quot;p1&quot;, type: &quot;paper&quot;, quantity: 200 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : 4, &quot;item&quot; : &quot;p2&quot;, type: &quot;paper&quot;, quantity: 150 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : 5, &quot;item&quot; : &quot;f3&quot;, type: &quot;food&quot;, quantity: 300 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : 6, &quot;item&quot; : &quot;t1&quot;, type: &quot;toys&quot;, quantity: 500 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : 7, &quot;item&quot; : &quot;a1&quot;, type: &quot;apparel&quot;, quantity: 250 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : 8, &quot;item&quot; : &quot;a2&quot;, type: &quot;apparel&quot;, quantity: 400 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : 9, &quot;item&quot; : &quot;t2&quot;, type: &quot;toys&quot;, quantity: 50 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : 10, &quot;item&quot; : &quot;f4&quot;, type: &quot;food&quot;, quantity: 75 &#125;</span><br></pre></td></tr></table></figure>



<p>å‡è®¾æ­¤æ—¶æ²¡æœ‰å»ºç«‹ç´¢å¼•ï¼Œåšå¦‚ä¸‹æŸ¥è¯¢ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">db.inventory.find( &#123; quantity: &#123; $gte: 100, $lte: 200 &#125; &#125; )</span><br></pre></td></tr></table></figure>



<p>è¿”å›ç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123; &quot;_id&quot; : 2, &quot;item&quot; : &quot;f2&quot;, &quot;type&quot; : &quot;food&quot;, &quot;quantity&quot; : 100 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : 3, &quot;item&quot; : &quot;p1&quot;, &quot;type&quot; : &quot;paper&quot;, &quot;quantity&quot; : 200 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : 4, &quot;item&quot; : &quot;p2&quot;, &quot;type&quot; : &quot;paper&quot;, &quot;quantity&quot; : 150 &#125;</span><br></pre></td></tr></table></figure>



<p>è¿™æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡explainæ¥åˆ†ææ•´ä¸ªæŸ¥è¯¢çš„è¿‡ç¨‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># explain æœ‰ä¸‰ç§æ¨¡å¼ï¼š &quot;queryPlanner&quot;, &quot;executionStats&quot;, and &quot;allPlansExecution&quot;.</span><br><span class="line"># å…¶ä¸­æœ€å¸¸ç”¨çš„å°±æ˜¯ç¬¬äºŒç§&quot;executionStats&quot;ï¼Œå®ƒä¼šè¿”å›å…·ä½“æ‰§è¡Œçš„æ—¶å€™çš„ç»Ÿè®¡æ•°æ®</span><br><span class="line">db.inventory.find(</span><br><span class="line">   &#123; quantity: &#123; $gte: 100, $lte: 200 &#125; &#125;</span><br><span class="line">).explain(&quot;executionStats&quot;)</span><br></pre></td></tr></table></figure>



<p>explainçš„ç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   &quot;queryPlanner&quot; : &#123;</span><br><span class="line">         &quot;plannerVersion&quot; : 1,</span><br><span class="line">         ...</span><br><span class="line">         &quot;winningPlan&quot; : &#123;</span><br><span class="line">            &quot;stage&quot; : &quot;COLLSCAN&quot;,</span><br><span class="line">            ...</span><br><span class="line">         &#125;</span><br><span class="line">   &#125;,</span><br><span class="line">   &quot;executionStats&quot; : &#123;</span><br><span class="line">      &quot;executionSuccess&quot; : true,</span><br><span class="line">      &quot;nReturned&quot; : 3,  # æŸ¥è¯¢è¿”å›çš„documentæ•°é‡</span><br><span class="line">      &quot;executionTimeMillis&quot; : 0, # æ‰§è¡ŒæŸ¥è¯¢æ‰€ç”¨çš„æ—¶é—´</span><br><span class="line">      &quot;totalKeysExamined&quot; : 0, # æ€»å…±æŸ¥è¯¢äº†å¤šå°‘ä¸ªkeyï¼Œç”±äºæ²¡æœ‰ä½¿ç”¨ç´¢å¼•ï¼Œå› æ­¤è¿™é‡Œä¸º0</span><br><span class="line">      &quot;totalDocsExamined&quot; : 10, # æ€»å…±åœ¨ç£ç›˜æŸ¥è¯¢äº†å¤šå°‘ä¸ªdocumentï¼Œç”±äºæ˜¯å…¨è¡¨æ‰«æï¼Œæˆ‘ä»¬æ€»å…±æœ‰10ä¸ªdocumentsï¼Œå› æ­¤ï¼Œè¿™é‡Œä¸º10</span><br><span class="line">      &quot;executionStages&quot; : &#123;</span><br><span class="line">         &quot;stage&quot; : &quot;COLLSCAN&quot;,  # æ³¨æ„è¿™é‡Œï¼Œ&quot;COLLSCAN&quot;æ„å‘³ç€å…¨è¡¨æ‰«æ</span><br><span class="line">         ...</span><br><span class="line">      &#125;,</span><br><span class="line">      ...</span><br><span class="line">   &#125;,</span><br><span class="line">   ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>ä¸Šé¢çš„ç»“æœä¸­æœ‰ä¸€ä¸ªâ€stageâ€å­—æ®µï¼Œä¸Šä¾‹ä¸­stageä¸ºâ€COLLSCANâ€ï¼Œè€ŒMongoDBæ€»å…±æœ‰å¦‚ä¸‹å‡ ç§stageï¼š</p>
<ul>
<li>COLLSCAN â€“ Collection scan</li>
<li>IXSCAN â€“ Scan of data in index keys</li>
<li>FETCH â€“ Retrieving documents</li>
<li>SHARD_MERGE â€“ Merging results from shards</li>
<li>SORT â€“ Explicit sort rather than using index order</li>
</ul>
<p>ç°åœ¨æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªç´¢å¼•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">db.inventory.createIndex( &#123; quantity: 1 &#125; )</span><br></pre></td></tr></table></figure>



<p>å†æ¥çœ‹ä¸‹explainçš„ç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">db.inventory.find(</span><br><span class="line">   &#123; quantity: &#123; $gte: 100, $lte: 200 &#125; &#125;</span><br><span class="line">).explain(&quot;executionStats&quot;)</span><br></pre></td></tr></table></figure>



<p>ç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   &quot;queryPlanner&quot; : &#123;</span><br><span class="line">         &quot;plannerVersion&quot; : 1,</span><br><span class="line">         ...</span><br><span class="line">         &quot;winningPlan&quot; : &#123;</span><br><span class="line">               &quot;stage&quot; : &quot;FETCH&quot;,</span><br><span class="line">               &quot;inputStage&quot; : &#123;</span><br><span class="line">                  &quot;stage&quot; : &quot;IXSCAN&quot;,  # è¿™é‡Œ&quot;IXSCAN&quot;æ„å‘³ç€ç´¢å¼•æ‰«æ</span><br><span class="line">                  &quot;keyPattern&quot; : &#123;</span><br><span class="line">                     &quot;quantity&quot; : 1</span><br><span class="line">                  &#125;,</span><br><span class="line">                  ...</span><br><span class="line">               &#125;</span><br><span class="line">         &#125;,</span><br><span class="line">         &quot;rejectedPlans&quot; : [ ]</span><br><span class="line">   &#125;,</span><br><span class="line">   &quot;executionStats&quot; : &#123;</span><br><span class="line">         &quot;executionSuccess&quot; : true,</span><br><span class="line">         &quot;nReturned&quot; : 3,</span><br><span class="line">         &quot;executionTimeMillis&quot; : 0,</span><br><span class="line">         &quot;totalKeysExamined&quot; : 3,  # è¿™é‡ŒnReturnedã€totalKeysExaminedå’ŒtotalDocsExaminedç›¸ç­‰è¯´æ˜ç´¢å¼•æ²¡æœ‰é—®é¢˜ï¼Œå› ä¸ºæˆ‘ä»¬é€šè¿‡ç´¢å¼•å¿«é€ŸæŸ¥æ‰¾åˆ°äº†ä¸‰ä¸ªæ–‡æ¡£ï¼Œä¸”ä»ç£ç›˜ä¸Šä¹Ÿæ˜¯å»å–è¿™ä¸‰ä¸ªæ–‡æ¡£ï¼Œå¹¶è¿”å›ä¸‰ä¸ªæ–‡æ¡£ã€‚</span><br><span class="line">         &quot;totalDocsExamined&quot; : 3,</span><br><span class="line">         &quot;executionStages&quot; : &#123;</span><br><span class="line">            ...</span><br><span class="line">         &#125;,</span><br><span class="line">         ...</span><br><span class="line">   &#125;,</span><br><span class="line">   ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>å†æ¥çœ‹ä¸‹å¦‚ä½•é€šè¿‡explainæ¥æ¯”è¾ƒcompound indexçš„æ€§èƒ½ï¼Œä¹‹å‰æˆ‘ä»¬åœ¨ä»‹ç»å¤åˆç´¢å¼•çš„æ—¶å€™å·²ç»è¯´è¿‡fieldçš„é¡ºåºä¼šå½±å“æŸ¥è¯¢çš„æ•ˆç‡ã€‚æœ‰æ—¶è¿™ç§é¡ºåºå¹¶ä¸å¤ªå¥½ç¡®å®šï¼ˆæ¯”å¦‚fieldçš„å€¼éƒ½ä¸æ˜¯uniqueçš„ï¼‰ï¼Œé‚£ä¹ˆæ€ä¹ˆåˆ¤æ–­å“ªç§é¡ºåºçš„å¤åˆç´¢å¼•çš„æ•ˆç‡é«˜å‘¢ï¼Œè¿™å°±åƒéœ€è¦explainç»“åˆhintæ¥è¿›è¡Œåˆ†æã€‚ æ¯”å¦‚æˆ‘ä»¬è¦åšå¦‚ä¸‹æŸ¥è¯¢ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">db.inventory.find( &#123;</span><br><span class="line">   quantity: &#123;</span><br><span class="line">      $gte: 100, $lte: 300</span><br><span class="line">   &#125;,</span><br><span class="line">   type: &quot;food&quot;</span><br><span class="line">&#125; )</span><br></pre></td></tr></table></figure>



<p>ä¼šè¿”å›å¦‚ä¸‹æ–‡æ¡£ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123; &quot;_id&quot; : 2, &quot;item&quot; : &quot;f2&quot;, &quot;type&quot; : &quot;food&quot;, &quot;quantity&quot; : 100 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : 5, &quot;item&quot; : &quot;f3&quot;, &quot;type&quot; : &quot;food&quot;, &quot;quantity&quot; : 300 &#125;</span><br></pre></td></tr></table></figure>



<p>ç°åœ¨æˆ‘ä»¬è¦æ¯”è¾ƒå¦‚ä¸‹ä¸¤ç§å¤åˆç´¢å¼•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">db.inventory.createIndex( &#123; quantity: 1, type: 1 &#125; )</span><br><span class="line">db.inventory.createIndex( &#123; type: 1, quantity: 1 &#125; )</span><br></pre></td></tr></table></figure>



<p>åˆ†æç´¢å¼• { quantity: 1, type: 1 }çš„æƒ…å†µ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># ç»“åˆhintå’Œexplainæ¥è¿›è¡Œåˆ†æ</span><br><span class="line">db.inventory.find(</span><br><span class="line">   &#123; quantity: &#123; $gte: 100, $lte: 300 &#125;, type: &quot;food&quot; &#125;</span><br><span class="line">).hint(&#123; quantity: 1, type: 1 &#125;).explain(&quot;executionStats&quot;) # è¿™é‡Œä½¿ç”¨hintä¼šå¼ºåˆ¶æ•°æ®åº“ä½¿ç”¨ç´¢å¼• &#123; quantity: 1, type: 1 &#125;</span><br></pre></td></tr></table></figure>



<p>explainç»“æœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   &quot;queryPlanner&quot; : &#123;</span><br><span class="line">      ...</span><br><span class="line">      &quot;winningPlan&quot; : &#123;</span><br><span class="line">         &quot;stage&quot; : &quot;FETCH&quot;,</span><br><span class="line">         &quot;inputStage&quot; : &#123;</span><br><span class="line">            &quot;stage&quot; : &quot;IXSCAN&quot;,</span><br><span class="line">            &quot;keyPattern&quot; : &#123;</span><br><span class="line">               &quot;quantity&quot; : 1,</span><br><span class="line">               &quot;type&quot; : 1</span><br><span class="line">            &#125;,</span><br><span class="line">            ...</span><br><span class="line">            &#125;</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;rejectedPlans&quot; : [ ]</span><br><span class="line">   &#125;,</span><br><span class="line">   &quot;executionStats&quot; : &#123;</span><br><span class="line">      &quot;executionSuccess&quot; : true,</span><br><span class="line">      &quot;nReturned&quot; : 2,</span><br><span class="line">      &quot;executionTimeMillis&quot; : 0,</span><br><span class="line">      &quot;totalKeysExamined&quot; : 5,  # è¿™é‡Œæ˜¯5ä¸totalDocsExaminedã€nReturnedéƒ½ä¸ç›¸ç­‰</span><br><span class="line">      &quot;totalDocsExamined&quot; : 2,</span><br><span class="line">      &quot;executionStages&quot; : &#123;</span><br><span class="line">      ...</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;,</span><br><span class="line">   ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>å†æ¥çœ‹ä¸‹ç´¢å¼• { type: 1, quantity: 1 } çš„åˆ†æ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">db.inventory.find(</span><br><span class="line">   &#123; quantity: &#123; $gte: 100, $lte: 300 &#125;, type: &quot;food&quot; &#125;</span><br><span class="line">).hint(&#123; type: 1, quantity: 1 &#125;).explain(&quot;executionStats&quot;)</span><br></pre></td></tr></table></figure>



<p>ç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   &quot;queryPlanner&quot; : &#123;</span><br><span class="line">      ...</span><br><span class="line">      &quot;winningPlan&quot; : &#123;</span><br><span class="line">         &quot;stage&quot; : &quot;FETCH&quot;,</span><br><span class="line">         &quot;inputStage&quot; : &#123;</span><br><span class="line">            &quot;stage&quot; : &quot;IXSCAN&quot;,</span><br><span class="line">            &quot;keyPattern&quot; : &#123;</span><br><span class="line">               &quot;type&quot; : 1,</span><br><span class="line">               &quot;quantity&quot; : 1</span><br><span class="line">            &#125;,</span><br><span class="line">            ...</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &quot;rejectedPlans&quot; : [ ]</span><br><span class="line">   &#125;,</span><br><span class="line">   &quot;executionStats&quot; : &#123;</span><br><span class="line">      &quot;executionSuccess&quot; : true,</span><br><span class="line">      &quot;nReturned&quot; : 2,</span><br><span class="line">      &quot;executionTimeMillis&quot; : 0,</span><br><span class="line">      &quot;totalKeysExamined&quot; : 2, # è¿™é‡Œæ˜¯2ï¼Œä¸totalDocsExaminedã€nReturnedç›¸åŒ</span><br><span class="line">      &quot;totalDocsExamined&quot; : 2,</span><br><span class="line">      &quot;executionStages&quot; : &#123;</span><br><span class="line">         ...</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;,</span><br><span class="line">   ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>å¯ä»¥çœ‹å‡ºåä¸€ç§ç´¢å¼•çš„totalKeysExaminedè¿”å›æ˜¯2ï¼Œç›¸æ¯”å‰ä¸€ç§ç´¢å¼•çš„5ï¼Œæ˜¾ç„¶æ›´æœ‰æ•ˆç‡ã€‚</p>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><ul>
<li><a href="https://docs.mongodb.com/manual/indexes/">MongoDB Index</a></li>
<li><a href="http://blog.codinglabs.org/articles/theory-of-mysql-index.html">MySQLç´¢å¼•èƒŒåçš„æ•°æ®ç»“æ„åŠç®—æ³•åŸç†</a></li>
<li><a href="http://www.mongoing.com/archives/2797">MongoDBç´¢å¼•åŸç†</a></li>
<li><a href="https://docs.mongodb.com/manual/tutorial/analyze-query-plan/">Analyze Query Performance</a></li>
</ul>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>é¢è¯•</tag>
        <tag>æ•°æ®åº“</tag>
      </tags>
  </entry>
  <entry>
    <title>IDEA+MAVEN+GITé¡¹ç›®ç®¡ç†</title>
    <url>/mvn-git/</url>
    <content><![CDATA[<div class=".article-gallery"><h2 id="å®‰è£…maven"><a href="#å®‰è£…maven" class="headerlink" title="å®‰è£…maven"></a>å®‰è£…maven</h2><p>ä¸‹è½½åœ°å€ï¼š<a href="http://maven.apache.org/download.cgi#">http://maven.apache.org/download.cgi#</a></p>
<p>è§£å‹åˆ°Dç›˜Mavenæ–‡ä»¶å¤¹ä¸‹ï¼š</p>
<p>åœ¨Mavenæ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ªRepositoryæ–‡ä»¶å¤¹ï¼Œç”¨ä½œä»“åº“ã€‚</p>
<p>ä¿®æ”¹D:\Maven\apache-maven-3.6.0\confä¸‹settings.xmlæ–‡ä»¶ï¼š</p>
<p>æ·»åŠ ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;localRepository&gt;D:\Maven\Repository&lt;/localRepository&gt;</span><br></pre></td></tr></table></figure>

<span id="more"></span>

<p>åœ¨mirrorsä¸‹æ·»åŠ é˜¿é‡Œäº‘è¿œç¨‹é•œåƒï¼Œé€Ÿåº¦è´¼å¿«ï¼š</p>
<p>&lt;!â€“ é˜¿é‡Œäº‘ä»“åº“ â€“&gt;<br><mirror><br><id>alimaven</id><br><mirrorOf>central</mirrorOf><br><name>aliyun maven</name><br><url><a href="http://maven.aliyun.com/nexus/content/repositories/central/">http://maven.aliyun.com/nexus/content/repositories/central/</a></url><br></mirror></p>
<mirror>
<id>alimaven</id>
<name>aliyun maven</name>
<url>http://maven.aliyun.com/nexus/content/groups/public/</url>
<mirrorOf>central</mirrorOf>
</mirror>

<p>åœ¨profilesä¸‹æ·»åŠ ï¼Œä¿®æ”¹jdkä¸º11ï¼š</p>
<profile>
<id>jdk-11</id>
<activation>
<activeByDefault>true</activeByDefault>
<jdk>11</jdk>
</activation>
<properties>
<maven.compiler.source>11</maven.compiler.source>
<maven.compiler.target>11</maven.compiler.target>
<maven.compiler.compilerVersion>11</maven.compiler.compilerVersion>
</properties>
</profile>

<p>æ·»åŠ ç¯å¢ƒå˜é‡ï¼š<br>M2_HOME<br>D:\Maven\apache-maven-3.6.0<br>Path<br>%M2_HOME%\bin;</p>
<h2 id="ideaå»ºç«‹maven"><a href="#ideaå»ºç«‹maven" class="headerlink" title="ideaå»ºç«‹maven"></a>ideaå»ºç«‹maven</h2><p>åœ¨settingsé‡Œé¢ï¼š</p>
<p><a href="https://img-blog.csdn.net/20170818231853882?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHV5YW9xaWFveWFvZ2U=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" title="IDEA+MAVEN+GITé¡¹ç›®ç®¡ç† - ç¬¬1å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://img-blog.csdn.net/20170818231853882?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveHV5YW9xaWFveWFvZ2U=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="IDEA+MAVEN+GITé¡¹ç›®ç®¡ç† - ç¬¬1å¼   | å¼ å˜"></a></p>
<h2 id="å®‰è£…git"><a href="#å®‰è£…git" class="headerlink" title="å®‰è£…git"></a>å®‰è£…git</h2><p>gitä¸‹è½½åœ°å€ ï¼š<a href="https://gitforwindows.org/">https://gitforwindows.org/</a><br>å®‰è£…å®Œæˆåï¼Œåœ¨å¼€å§‹èœå•é‡Œæ‰¾åˆ°â€œGitâ€-&gt;â€œGit Bashâ€ï¼Œè¹¦å‡ºä¸€ä¸ªç±»ä¼¼å‘½ä»¤è¡Œçª—å£çš„ä¸œè¥¿ï¼Œå°±è¯´æ˜Gitå®‰è£…æˆåŠŸï¼<br>å®‰è£…å®Œæˆåï¼Œè¿˜éœ€è¦æœ€åä¸€æ­¥è®¾ç½®ï¼Œåœ¨å‘½ä»¤è¡Œè¾“å…¥ï¼š</p>
<p>$ git config â€“global user.name â€œYour Nameâ€<br>$ git config â€“global user.email â€œ<a href="mailto:&#101;&#109;&#97;&#105;&#108;&#x40;&#101;&#x78;&#97;&#x6d;&#112;&#x6c;&#x65;&#x2e;&#99;&#111;&#109;">&#101;&#109;&#97;&#105;&#108;&#x40;&#101;&#x78;&#97;&#x6d;&#112;&#x6c;&#x65;&#x2e;&#99;&#111;&#109;</a>â€</p>
<p>å…·ä½“è¿‡ç¨‹è¯·å‚è§ï¼š<br><a href="https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000/00137396287703354d8c6c01c904c7d9ff056ae23da865a000">å»–é›ªå³°Gitå®‰è£…</a></p>
<h2 id="git-cloneè¿œç¨‹é¡¹ç›®"><a href="#git-cloneè¿œç¨‹é¡¹ç›®" class="headerlink" title="git cloneè¿œç¨‹é¡¹ç›®"></a>git cloneè¿œç¨‹é¡¹ç›®</h2><p>åœ¨â€œGit Bashâ€å‘½ä»¤è¡Œé‡Œè¾“å…¥ï¼šssh-keygen -t rsa -C â€œ<a href="mailto:&#121;&#x6f;&#x75;&#x72;&#x2e;&#101;&#109;&#x61;&#x69;&#108;&#x40;&#101;&#x78;&#x61;&#109;&#112;&#108;&#x65;&#x2e;&#x63;&#x6f;&#x6d;">&#121;&#x6f;&#x75;&#x72;&#x2e;&#101;&#109;&#x61;&#x69;&#108;&#x40;&#101;&#x78;&#x61;&#109;&#112;&#108;&#x65;&#x2e;&#x63;&#x6f;&#x6d;</a>â€ -b 4096</p>
<p>ä¼šåœ¨æœ¬åœ°ç”¨æˆ·ç›®å½•ä¸‹çš„.sshæ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆid_rsaå’Œid_rsa.pubæ–‡ä»¶ï¼Œ</p>
<p>å°†id_rsa.pubå…¬é’¥æ–‡ä»¶åŠ å…¥åˆ°è¿œç¨‹git/Setttings/SSH Keysé‡Œé¢ã€‚</p>
<p>å³é”®èœå•â€œGit GUIâ€</p>
<h2 id="ç äº‘"><a href="#ç äº‘" class="headerlink" title="ç äº‘"></a>ç äº‘</h2><p>ç äº‘æ˜¯ç›®å‰å›½å†…æ¯”è¾ƒå¥½çš„ä»£ç æ‰˜ç®¡å¹³å°ã€‚<br>ç äº‘å®˜æ–¹æ•™ç¨‹å¦‚ä¸‹ï¼š<br><a href="http://git.mydoc.io/?t=153739">ç äº‘æ•™ç¨‹</a><br>å®‰è£…å¥½æ’ä»¶åå¯ä»¥å°†ä¹‹å‰å»ºç«‹çš„é¡¹ç›®æ‰˜ç®¡åˆ°ç äº‘ä¸Šã€‚</p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>æ‚ä¹±</tag>
      </tags>
  </entry>
  <entry>
    <title>Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“</title>
    <url>/nexus/</url>
    <content><![CDATA[<div class=".article-gallery"><p><strong>ç›®å½•</strong></p>
<ul>
<li><a href="https://www.cnblogs.com/fanzhenyong/p/7709434.html#_label0">ä¸€ã€ç§æœ‰ä»“åº“çš„ä»·å€¼</a></li>
<li>äºŒã€å‡†å¤‡å·¥ä½œ<ul>
<li>2.1ã€å®‰è£…Javaç¼–è¯‘ç¯å¢ƒ<ul>
<li><a href="https://www.cnblogs.com/fanzhenyong/p/7709434.html#_label1_0">2.1.1ã€å®‰è£…</a></li>
<li><a href="https://www.cnblogs.com/fanzhenyong/p/7709434.html#_label1_0">2.1.2ã€éªŒè¯</a></li>
<li><a href="https://www.cnblogs.com/fanzhenyong/p/7709434.html#_label1_0">2.1.3ã€è®¾ç½®ç¯å¢ƒå˜é‡</a></li>
</ul>
</li>
<li><a href="https://www.cnblogs.com/fanzhenyong/p/7709434.html#_label1_1">2.2ã€è™šæ‹Ÿæœºè®¿é—®äº’è”ç½‘</a></li>
</ul>
</li>
<li>ä¸‰ã€å®‰è£…Nexus<ul>
<li><a href="https://www.cnblogs.com/fanzhenyong/p/7709434.html#_label2_0">3.1ã€ä¸‹è½½nexus</a></li>
<li><a href="https://www.cnblogs.com/fanzhenyong/p/7709434.html#_label2_1">3.2ã€éƒ¨ç½²</a></li>
<li>3.3ã€ç³»ç»ŸæœåŠ¡<ul>
<li><a href="https://www.cnblogs.com/fanzhenyong/p/7709434.html#_label2_2">3.3.1ã€ç¼–è¾‘ç³»ç»ŸæœåŠ¡æ–‡ä»¶</a></li>
<li><a href="https://www.cnblogs.com/fanzhenyong/p/7709434.html#_label2_2">3.3.2ã€è®¾ç½®ä¸ºè‡ªå¯åŠ¨æœåŠ¡</a></li>
</ul>
</li>
</ul>
</li>
<li>å››ã€è®¾ç½®Nexus<ul>
<li><a href="https://www.cnblogs.com/fanzhenyong/p/7709434.html#_label3_0">4.1ã€æµè§ˆå™¨ç™»å½•</a></li>
<li><a href="https://www.cnblogs.com/fanzhenyong/p/7709434.html#_label3_1">4.2ã€è¿›å…¥ç®¡ç†ç•Œé¢</a></li>
<li><a href="https://www.cnblogs.com/fanzhenyong/p/7709434.html#_label3_2">4.3ã€å¢åŠ æ–°çš„ä»£ç†æº</a></li>
<li><a href="https://www.cnblogs.com/fanzhenyong/p/7709434.html#_label3_3">4.3ã€è®¾ç½®ç§ç”¨ä»“åº“å¯é‡å¤å‘å¸ƒ</a></li>
</ul>
</li>
<li>äº”ã€å®‰è£…mavenå¹¶è®¾ç½®ç§ç”¨ä»“åº“<ul>
<li><a href="https://www.cnblogs.com/fanzhenyong/p/7709434.html#_label4_0">5.1ã€ä¸‹è½½å®‰è£…</a></li>
<li><a href="https://www.cnblogs.com/fanzhenyong/p/7709434.html#_label4_1">5.2ã€è®¾ç½®ç¯å¢ƒå˜é‡</a></li>
<li><a href="https://www.cnblogs.com/fanzhenyong/p/7709434.html#_label4_2">5.3ã€æµ‹è¯•</a></li>
<li><a href="https://www.cnblogs.com/fanzhenyong/p/7709434.html#_label4_3">5.4ã€é…ç½®</a></li>
</ul>
</li>
</ul>
<p><strong>æ­£æ–‡</strong><a href="https://www.cnblogs.com/fanzhenyong/p/7709434.html#_labelTop">å›åˆ°é¡¶éƒ¨</a></p>
<span id="more"></span>

<p><a href="https://i0.wp.com/192.144.167.243/blog/wp-content/uploads/3-1-1024x495.png?resize=640,309" title="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬1å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/192.144.167.243/blog/wp-content/uploads/3-1-1024x495.png?resize=640,309" alt="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬1å¼   | å¼ å˜"></a></p>
<h1 id="ä¸€ã€ç§æœ‰ä»“åº“çš„ä»·å€¼"><a href="#ä¸€ã€ç§æœ‰ä»“åº“çš„ä»·å€¼" class="headerlink" title="ä¸€ã€ç§æœ‰ä»“åº“çš„ä»·å€¼"></a>ä¸€ã€ç§æœ‰ä»“åº“çš„ä»·å€¼</h1><p>ã€€ã€€å¼€å‘Javaåº”ç”¨ç³»ç»Ÿï¼Œç”¨åˆ°Mavenã€sbtå’Œ Gradleç­‰æ„å»ºå·¥å…·ï¼Œåœ¨æ„å»ºè¿‡ç¨‹ä¸­ä¸€èˆ¬éœ€è¦ä»äº’è”ç½‘ä¸‹è½½ä¾èµ–åº“ï¼Œæ„å»ºç§æœ‰ä»“åº“å°±æ˜¯ä¸ºäº†åœ¨å¼€å‘ç»„æˆ–è€…éƒ¨é—¨å†…å…±ç”¨ï¼Œä»è€ŒèŠ‚çœæ•´ä½“çš„ä¸‹è½½æˆæœ¬å’Œæ„å»ºæˆæœ¬ã€‚ä¸‹é¢å…ˆä»¥Mavenä¸ºä¾‹è¯´æ˜ã€‚</p>
<p>ã€€ã€€Mavenæ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ„å»ºå·¥å…·ï¼Œä¸€èˆ¬ç”¨äºJavaé¡¹ç›®ã€‚Mavené¡¹ç›®åŸºäºå¯¹è±¡æ¨¡å‹(POM)ï¼Œå¯ä»¥é€šè¿‡ä¸€å°æ®µæè¿°ä¿¡æ¯æ¥ç®¡ç†é¡¹ç›®çš„æ„å»ºï¼ŒæŠ¥å‘Šå’Œæ–‡æ¡£çš„è½¯ä»¶é¡¹ç›®ç®¡ç†å·¥å…·ã€‚Maven é™¤äº†ä»¥ç¨‹åºæ„å»ºèƒ½åŠ›ä¸ºç‰¹è‰²ä¹‹å¤–ï¼Œè¿˜æä¾›é«˜çº§é¡¹ç›®ç®¡ç†å·¥å…·ã€‚ç”±äº Maven çš„ç¼ºçœæ„å»ºè§„åˆ™æœ‰è¾ƒé«˜çš„å¯é‡ç”¨æ€§ï¼Œæ‰€ä»¥å¸¸å¸¸ç”¨ä¸¤ä¸‰è¡Œ Maven æ„å»ºè„šæœ¬å°±å¯ä»¥æ„å»ºç®€å•çš„é¡¹ç›®ã€‚</p>
<p>Mavençš„Javaé¡¹ç›®ä¸€èˆ¬éœ€è¦ä¸‹è½½ç¬¬ä¸‰æ–¹ç»„ä»¶ï¼Œä¸‹è½½åæ„æˆæœ¬åœ°ä»“åº“ï¼Œä¸ºäº†å‡å°‘ç½‘ç»œå¯¹æ„å»ºé¡¹ç›®çš„å½±å“ï¼Œä¸€èˆ¬ä¼šæ„å»ºç§æœä»“åº“ï¼Œä»£ç†ç¬¬ä¸‰æ–¹åº“ã€‚Nexuså°±æ˜¯æ„å»ºç§æœä»“åº“çš„ä¼˜ç§€è½¯ä»¶ã€‚</p>
<p><a href="https://i1.wp.com/images2017.cnblogs.com/blog/1082089/201710/1082089-20171022220431849-1095286350.png?w=640&ssl=1" title="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬2å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i1.wp.com/images2017.cnblogs.com/blog/1082089/201710/1082089-20171022220431849-1095286350.png?w=640&ssl=1" alt="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬2å¼   | å¼ å˜"></a></p>
<p>å›¾ 1 ä¸‰å±‚ä»“åº“æ¶æ„<a href="https://www.cnblogs.com/fanzhenyong/p/7709434.html#_labelTop">å›åˆ°é¡¶éƒ¨</a></p>
<h1 id="äºŒã€å‡†å¤‡å·¥ä½œ"><a href="#äºŒã€å‡†å¤‡å·¥ä½œ" class="headerlink" title="äºŒã€å‡†å¤‡å·¥ä½œ"></a>äºŒã€å‡†å¤‡å·¥ä½œ</h1><h2 id="2-1ã€å®‰è£…Javaç¼–è¯‘ç¯å¢ƒ"><a href="#2-1ã€å®‰è£…Javaç¼–è¯‘ç¯å¢ƒ" class="headerlink" title="2.1ã€å®‰è£…Javaç¼–è¯‘ç¯å¢ƒ"></a>2.1ã€å®‰è£…Javaç¼–è¯‘ç¯å¢ƒ</h2><p>Javaç¼–è¯‘ç¯å¢ƒåŒ…æ‹¬æ ¸å¿ƒçš„JDKå’Œç¼–è¯‘å·¥å…·ï¼Œå› ä¸ºJavaçš„ç¼–è¯‘å·¥å…·æœ‰å¾ˆå¤šç§ï¼Œè€Œå¼€æºé¡¹ç›®ä½œè€…çš„éšæ„æ€§å¾ˆé«˜ï¼Œå¸¸ç”¨çš„å·¥å…·æœ‰mavenï¼Œgradle,sbtï¼Œantç­‰ç­‰ï¼Œæœ¬æ–‡å…³æ³¨Mavenã€‚</p>
<p>å› ä¸ºOracleä¸å†ç»´æŠ¤Java1.7ï¼Œæ‰€ä»¥é‡‡ç”¨Java 1.8ä½œä¸ºç¼–è¯‘æ ¸å¿ƒ.</p>
<h3 id="2-1-1ã€å®‰è£…"><a href="#2-1-1ã€å®‰è£…" class="headerlink" title="2.1.1ã€å®‰è£…"></a>2.1.1ã€å®‰è£…</h3><p>æ“ä½œç³»ç»Ÿé‡‡ç”¨Centos7.4</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yum install java-1.8.0-openjdk-devel java-1.8.0-openjdk java-1.8.0-openjdk-headless -y</span><br></pre></td></tr></table></figure>

<h3 id="2-1-2ã€éªŒè¯"><a href="#2-1-2ã€éªŒè¯" class="headerlink" title="2.1.2ã€éªŒè¯"></a>2.1.2ã€éªŒè¯</h3><p>æŸ¥çœ‹jdkç‰ˆæœ¬å·</p>
<p><a href="https://i0.wp.com/common.cnblogs.com/images/copycode.gif?w=640&ssl=1" title="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬3å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/common.cnblogs.com/images/copycode.gif?w=640&ssl=1" alt="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬3å¼   | å¼ å˜"></a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">java -version</span><br><span class="line">Picked up _JAVA_OPTIONS: -Xmx2048m -XX:MaxMetaspaceSize=512m -Djava.awt.headless=true</span><br><span class="line">openjdk version &quot;1.8.0_131&quot;</span><br><span class="line">OpenJDK Runtime Environment (build 1.8.0_131-b12)</span><br><span class="line">OpenJDK 64-Bit Server VM (build 25.131-b12, mixed mode)</span><br></pre></td></tr></table></figure>

<p><a href="https://i0.wp.com/common.cnblogs.com/images/copycode.gif?w=640&ssl=1" title="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬4å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/common.cnblogs.com/images/copycode.gif?w=640&ssl=1" alt="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬4å¼   | å¼ å˜"></a></p>
<h3 id="2-1-3ã€è®¾ç½®ç¯å¢ƒå˜é‡"><a href="#2-1-3ã€è®¾ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="2.1.3ã€è®¾ç½®ç¯å¢ƒå˜é‡"></a>2.1.3ã€è®¾ç½®ç¯å¢ƒå˜é‡</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vi ~/.bashrc</span><br></pre></td></tr></table></figure>

<p>å¢åŠ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">export JAVA_HOME=/usr/lib/jvm/java</span><br><span class="line">export JRE_HOME=$&#123;JAVA_HOME&#125;/jre</span><br><span class="line">export CLASSPATH=.:$JRE_HOME/lib/rt.jar:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</span><br><span class="line">export PATH=$JAVA_HOME/bin:$PATH</span><br></pre></td></tr></table></figure>

<p>å³åˆ»ç”Ÿæ•ˆ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure>

<h2 id="2-2ã€è™šæ‹Ÿæœºè®¿é—®äº’è”ç½‘"><a href="#2-2ã€è™šæ‹Ÿæœºè®¿é—®äº’è”ç½‘" class="headerlink" title="2.2ã€è™šæ‹Ÿæœºè®¿é—®äº’è”ç½‘"></a>2.2ã€è™šæ‹Ÿæœºè®¿é—®äº’è”ç½‘</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vi /etc/sysconfig/network-scripts/ifcfg-ens32</span><br></pre></td></tr></table></figure>

<p>æ³¨ï¼šç¯å¢ƒä¸åŒç½‘å¡åä¼šä¸åŒ</p>
<p>å¢åŠ å¤©æ´¥è”é€šçš„DNSï¼ˆæ³¨ï¼šä½œè€…åœ¨å¤©æ´¥ï¼Œè¯·æŒ‰ä¸ªäººæœ¬åœ°çš„è¿è¡Œå•†åšç›¸åº”ä¿®æ”¹ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DNS1=202.99.96.68</span><br><span class="line">DNS2=202.99.104.68</span><br></pre></td></tr></table></figure>

<p>åœ¨å®é™…æµ‹è¯•ä¸­æ„Ÿè§‰å¤©æ´¥ç”µä¿¡çš„DNSæ›´åŠ é è°±ï¼Œè®¿é—®ä¸€äº›ç‰¹æ®Šç½‘ç«™è¿”å›çš„IPèƒ½å¤Ÿé¡ºåˆ©è®¿é—®ï¼Œå¤§å®¶æ ¹æ®å®è·µé€‰æ‹©å§</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DNS1=219.150.32.132</span><br><span class="line">DNS2=219.146.0.130</span><br></pre></td></tr></table></figure>

<p>é‡æ–°å¯åŠ¨ç½‘ç»œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">systemctl restart network</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ping www.163.com</span><br><span class="line">PING 163.xdwscache.ourglb0.com (42.81.9.47) 56(84) bytes of data.</span><br><span class="line">64 bytes from 42.81.9.47 (42.81.9.47): icmp_seq=1 ttl=128 time=9.66 ms</span><br><span class="line">64 bytes from 42.81.9.47 (42.81.9.47): icmp_seq=2 ttl=128 time=10.4 msâ€¦</span><br></pre></td></tr></table></figure>

<p><a href="https://www.cnblogs.com/fanzhenyong/p/7709434.html#_labelTop">å›åˆ°é¡¶éƒ¨</a></p>
<h1 id="ä¸‰ã€å®‰è£…Nexus"><a href="#ä¸‰ã€å®‰è£…Nexus" class="headerlink" title="ä¸‰ã€å®‰è£…Nexus"></a>ä¸‰ã€å®‰è£…Nexus</h1><h2 id="3-1ã€ä¸‹è½½nexus"><a href="#3-1ã€ä¸‹è½½nexus" class="headerlink" title="3.1ã€ä¸‹è½½nexus"></a>3.1ã€ä¸‹è½½nexus</h2><p>ä»å®˜æ–¹ç½‘ç«™ç°åœ¨æœ€æ–°3.Xç‰ˆ</p>
<p><a href="https://www.sonatype.com/download-oss-sonatype">https://www.sonatype.com/download-oss-sonatype</a></p>
<p>ä¸‹è½½ï¼ˆ2018å¹´3æœˆï¼‰æœ€æ–°ç‰ˆnexus-3.9.0-01-unix.tar.gz ï¼ˆï¼‰</p>
<h2 id="3-2ã€éƒ¨ç½²"><a href="#3-2ã€éƒ¨ç½²" class="headerlink" title="3.2ã€éƒ¨ç½²"></a>3.2ã€éƒ¨ç½²</h2><p>å…ˆè§„åˆ’å­˜å‚¨ç§æœ‰ä»“åº“çš„ç›®å½•ï¼Œä½œè€…æœ¬æœºçš„/optç›®å½•ç©ºé—´è¾ƒå¤šï¼Œæ‰€ä»¥ä»¥/optä¸ºä¾‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /opt/scm</span><br><span class="line">tar -xf ~/download/nexus-3.9.0-01-unix.tar.gz -C .</span><br></pre></td></tr></table></figure>

<p>ç”Ÿæˆä¸¤ä¸ªç›®å½•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nexus-3.9.0-01</span><br><span class="line">sonatype-work</span><br></pre></td></tr></table></figure>

<h2 id="3-3ã€ç³»ç»ŸæœåŠ¡"><a href="#3-3ã€ç³»ç»ŸæœåŠ¡" class="headerlink" title="3.3ã€ç³»ç»ŸæœåŠ¡"></a>3.3ã€ç³»ç»ŸæœåŠ¡</h2><h3 id="3-3-1ã€ç¼–è¾‘ç³»ç»ŸæœåŠ¡æ–‡ä»¶"><a href="#3-3-1ã€ç¼–è¾‘ç³»ç»ŸæœåŠ¡æ–‡ä»¶" class="headerlink" title="3.3.1ã€ç¼–è¾‘ç³»ç»ŸæœåŠ¡æ–‡ä»¶"></a>3.3.1ã€ç¼–è¾‘ç³»ç»ŸæœåŠ¡æ–‡ä»¶</h3><p><a href="https://i0.wp.com/common.cnblogs.com/images/copycode.gif?w=640&ssl=1" title="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬5å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/common.cnblogs.com/images/copycode.gif?w=640&ssl=1" alt="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬5å¼   | å¼ å˜"></a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vi /etc/systemd/system/nexus.service</span><br><span class="line"></span><br><span class="line">[Unit]</span><br><span class="line">Description=nexus service</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]Type=forking</span><br><span class="line">LimitNOFILE=65536</span><br><span class="line">ExecStart=/opt/scm/nexus-3.9.0-01/bin/nexus start</span><br><span class="line">ExecStop=/opt/scm/nexus-3.9.0-01/bin/nexus stop</span><br><span class="line">User=ansible</span><br><span class="line">Restart=on-abort</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>

<p><a href="https://i0.wp.com/common.cnblogs.com/images/copycode.gif?w=640&ssl=1" title="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬6å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/common.cnblogs.com/images/copycode.gif?w=640&ssl=1" alt="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬6å¼   | å¼ å˜"></a></p>
<h3 id="3-3-2ã€è®¾ç½®ä¸ºè‡ªå¯åŠ¨æœåŠ¡"><a href="#3-3-2ã€è®¾ç½®ä¸ºè‡ªå¯åŠ¨æœåŠ¡" class="headerlink" title="3.3.2ã€è®¾ç½®ä¸ºè‡ªå¯åŠ¨æœåŠ¡"></a>3.3.2ã€è®¾ç½®ä¸ºè‡ªå¯åŠ¨æœåŠ¡</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl  daemon-reload</span><br><span class="line">sudo systemctl start nexus.service</span><br><span class="line">sudo systemctl status nexus.service</span><br><span class="line">sudo systemctl enable nexus.service</span><br></pre></td></tr></table></figure>

<p>å¯åŠ¨æŠ¥é”™ï¼š1./etc/systemd/system/nexus.serviceæ–‡ä»¶çš„userä¸å¯¹<br>2.ä¿®æ”¹/opt/scm/nexus/bin/nexus å¯åŠ¨çš„JAVA_HOME å¦‚ï¼šINSTALL4J_JAVA_HOME_OVERRIDE=/usr/local/java/jdk1.8/</p>
<p><a href="https://www.cnblogs.com/fanzhenyong/p/7709434.html#_labelTop">å›åˆ°é¡¶éƒ¨</a></p>
<h1 id="å››ã€è®¾ç½®Nexus"><a href="#å››ã€è®¾ç½®Nexus" class="headerlink" title="å››ã€è®¾ç½®Nexus"></a>å››ã€è®¾ç½®Nexus</h1><h2 id="4-1ã€æµè§ˆå™¨ç™»å½•"><a href="#4-1ã€æµè§ˆå™¨ç™»å½•" class="headerlink" title="4.1ã€æµè§ˆå™¨ç™»å½•"></a>4.1ã€æµè§ˆå™¨ç™»å½•</h2><p><a href="http://192.168.154.11:8081/">http://192.168.154.11:8081/</a></p>
<p><a href="https://i0.wp.com/images2017.cnblogs.com/blog/1082089/201710/1082089-20171022220256240-534211558.png?w=640&ssl=1" title="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬7å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/images2017.cnblogs.com/blog/1082089/201710/1082089-20171022220256240-534211558.png?w=640&ssl=1" alt="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬7å¼   | å¼ å˜"></a></p>
<p>ç”¨æˆ·åçš„å¯†ç ä¸ºï¼šadmin admin123</p>
<h2 id="4-2ã€è¿›å…¥ç®¡ç†ç•Œé¢"><a href="#4-2ã€è¿›å…¥ç®¡ç†ç•Œé¢" class="headerlink" title="4.2ã€è¿›å…¥ç®¡ç†ç•Œé¢"></a>4.2ã€è¿›å…¥ç®¡ç†ç•Œé¢</h2><p><a href="https://i1.wp.com/images2017.cnblogs.com/blog/1082089/201710/1082089-20171022220317318-1530787694.png?w=640&ssl=1" title="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬8å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i1.wp.com/images2017.cnblogs.com/blog/1082089/201710/1082089-20171022220317318-1530787694.png?w=640&ssl=1" alt="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬8å¼   | å¼ å˜"></a></p>
<h2 id="4-3ã€å¢åŠ æ–°çš„ä»£ç†æº"><a href="#4-3ã€å¢åŠ æ–°çš„ä»£ç†æº" class="headerlink" title="4.3ã€å¢åŠ æ–°çš„ä»£ç†æº"></a>4.3ã€å¢åŠ æ–°çš„ä»£ç†æº</h2><p><a href="https://i0.wp.com/images2017.cnblogs.com/blog/1082089/201710/1082089-20171022220331802-1557956595.png?w=640&ssl=1" title="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬9å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/images2017.cnblogs.com/blog/1082089/201710/1082089-20171022220331802-1557956595.png?w=640&ssl=1" alt="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬9å¼   | å¼ å˜"></a></p>
<p>è®¾ç½®åç§°å’ŒURL</p>
<p><a href="https://i1.wp.com/images2017.cnblogs.com/blog/1082089/201710/1082089-20171022220342224-1667350164.png?w=640&ssl=1" title="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬10å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i1.wp.com/images2017.cnblogs.com/blog/1082089/201710/1082089-20171022220342224-1667350164.png?w=640&ssl=1" alt="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬10å¼   | å¼ å˜"></a></p>
<p>Cacheç»Ÿä¸€è®¾ç½®ä¸º200å¤© 288000</p>
<p><a href="https://i1.wp.com/images2017.cnblogs.com/blog/1082089/201710/1082089-20171022220350271-1209294422.png?w=640&ssl=1" title="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬11å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i1.wp.com/images2017.cnblogs.com/blog/1082089/201710/1082089-20171022220350271-1209294422.png?w=640&ssl=1" alt="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬11å¼   | å¼ å˜"></a></p>
<p> é€ä¸ªå¢åŠ å¸¸ç”¨ä»£ç†</p>
<p><a href="https://i0.wp.com/common.cnblogs.com/images/copycode.gif?w=640&ssl=1" title="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬12å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/common.cnblogs.com/images/copycode.gif?w=640&ssl=1" alt="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬12å¼   | å¼ å˜"></a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1. aliyun</span><br><span class="line">http://maven.aliyun.com/nexus/content/groups/public</span><br><span class="line">2. apache_snapshot</span><br><span class="line">https://repository.apache.org/content/repositories/snapshots/</span><br><span class="line">3. apache_release</span><br><span class="line">https://repository.apache.org/content/repositories/releases/</span><br><span class="line">4. atlassian</span><br><span class="line">https://maven.atlassian.com/content/repositories/atlassian-public/</span><br><span class="line">5. central.maven.org</span><br><span class="line">http://central.maven.org/maven2/</span><br><span class="line">6. datanucleus</span><br><span class="line">http://www.datanucleus.org/downloads/maven2</span><br><span class="line">7. maven-central ï¼ˆå®‰è£…åè‡ªå¸¦ï¼Œä»…éœ€è®¾ç½®Cacheæœ‰æ•ˆæœŸå³å¯ï¼‰</span><br><span class="line">https://repo1.maven.org/maven2/</span><br><span class="line">8. nexus.axiomalaska.com</span><br><span class="line">http://nexus.axiomalaska.com/nexus/content/repositories/public</span><br><span class="line">9. oss.sonatype.org</span><br><span class="line">https://oss.sonatype.org/content/repositories/snapshots</span><br><span class="line">10.pentaho</span><br><span class="line">https://public.nexus.pentaho.org/content/groups/omni/</span><br></pre></td></tr></table></figure>

<p><a href="https://i0.wp.com/common.cnblogs.com/images/copycode.gif?w=640&ssl=1" title="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬13å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/common.cnblogs.com/images/copycode.gif?w=640&ssl=1" alt="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬13å¼   | å¼ å˜"></a></p>
<p>å†æ¬¡å¼ºè°ƒï¼Œåœ¨</p>
<p>How long (in minutes) to cache metadata before rechecking the remote repository.å¤„</p>
<p>ç»Ÿä¸€è®¾ç½®ä¸º</p>
<p>288000 å³200å¤©ï¼Œå½“ç„¶å¯ä»¥è®¾ç½®ä¸ºæ›´é•¿çš„æ—¶é—´</p>
<p>è®¾ç½®maven-public</p>
<p>å°†è¿™äº›ä»£ç†åŠ å…¥Group</p>
<p><a href="https://i0.wp.com/images2017.cnblogs.com/blog/1082089/201710/1082089-20171022220400959-1653481781.png?w=640&ssl=1" title="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬14å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/images2017.cnblogs.com/blog/1082089/201710/1082089-20171022220400959-1653481781.png?w=640&ssl=1" alt="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬14å¼   | å¼ å˜"></a></p>
<h2 id="4-3ã€è®¾ç½®ç§ç”¨ä»“åº“å¯é‡å¤å‘å¸ƒ"><a href="#4-3ã€è®¾ç½®ç§ç”¨ä»“åº“å¯é‡å¤å‘å¸ƒ" class="headerlink" title="4.3ã€è®¾ç½®ç§ç”¨ä»“åº“å¯é‡å¤å‘å¸ƒ"></a>4.3ã€è®¾ç½®ç§ç”¨ä»“åº“å¯é‡å¤å‘å¸ƒ</h2><p>ã€€ã€€Nexuså®‰è£…åè‡ªå¸¦maven-releasesï¼Œmaven-snapshotsä¸¤ä¸ªä»“åº“ï¼Œç”¨äºå°†ç”Ÿæˆçš„jaråŒ…å‘å¸ƒåœ¨è¿™ä¸¤ä¸ªä»“åº“ä¸­ï¼Œåœ¨å®é™…å¼€å‘ä¸­éœ€è¦å°†maven-releasesè®¾ç½®ä¸ºå¯ä»¥é‡å¤å‘å¸ƒã€‚</p>
<p>ã€€ã€€maven-releases</p>
<p><a href="https://i0.wp.com/images2018.cnblogs.com/blog/1082089/201803/1082089-20180317135112096-935379506.png?w=640&ssl=1" title="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬15å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/images2018.cnblogs.com/blog/1082089/201803/1082089-20180317135112096-935379506.png?w=640&ssl=1" alt="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬15å¼   | å¼ å˜"></a></p>
<p>ã€€ã€€æ³¨ï¼šmaven-snapshotsç¼ºçœæ˜¯å¯ä»¥é‡æ–°éƒ¨ç½²çš„ã€‚<a href="https://www.cnblogs.com/fanzhenyong/p/7709434.html#_labelTop">å›åˆ°é¡¶éƒ¨</a></p>
<h1 id="äº”ã€å®‰è£…mavenå¹¶è®¾ç½®ç§ç”¨ä»“åº“"><a href="#äº”ã€å®‰è£…mavenå¹¶è®¾ç½®ç§ç”¨ä»“åº“" class="headerlink" title="äº”ã€å®‰è£…mavenå¹¶è®¾ç½®ç§ç”¨ä»“åº“"></a>äº”ã€å®‰è£…mavenå¹¶è®¾ç½®ç§ç”¨ä»“åº“</h1><h2 id="5-1ã€ä¸‹è½½å®‰è£…"><a href="#5-1ã€ä¸‹è½½å®‰è£…" class="headerlink" title="5.1ã€ä¸‹è½½å®‰è£…"></a>5.1ã€ä¸‹è½½å®‰è£…</h2><p>ä»mavenå®˜ç½‘ä¸‹è½½3.5.0 <a href="http://maven.apache.org/download.cgi">http://maven.apache.org/download.cgi</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd tools</span><br><span class="line">tar -xf ../download/apache-maven-3.5.0-bin.tar.gz â€“C .</span><br></pre></td></tr></table></figure>

<h2 id="5-2ã€è®¾ç½®ç¯å¢ƒå˜é‡"><a href="#5-2ã€è®¾ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="5.2ã€è®¾ç½®ç¯å¢ƒå˜é‡"></a>5.2ã€è®¾ç½®ç¯å¢ƒå˜é‡</h2><p>vi ~/.bashrc</p>
<p>å¢åŠ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">export PATH=/home/ansible/tools/apache-maven-3.5.0/bin:$PATH</span><br></pre></td></tr></table></figure>

<p>å³åˆ»ç”Ÿæ•ˆ</p>
<p>source ~/.bashrc</p>
<h2 id="5-3ã€æµ‹è¯•"><a href="#5-3ã€æµ‹è¯•" class="headerlink" title="5.3ã€æµ‹è¯•"></a>5.3ã€æµ‹è¯•</h2><p><a href="https://i0.wp.com/common.cnblogs.com/images/copycode.gif?w=640&ssl=1" title="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬16å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/common.cnblogs.com/images/copycode.gif?w=640&ssl=1" alt="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬16å¼   | å¼ å˜"></a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mvn -v</span><br><span class="line"></span><br><span class="line">Picked up _JAVA_OPTIONS: -Xmx2048m -XX:MaxMetaspaceSize=512m -Djava.awt.headless=true</span><br><span class="line">Apache Maven 3.5.0 (ff8f5e7444045639af65f6095c62210b5713f426; 2017-04-04T03:39:06+08:00)</span><br><span class="line">Maven home: /home/ansible/tools/apache-maven-3.5.0</span><br><span class="line">Java version: 1.8.0_102, vendor: Oracle Corporation</span><br><span class="line">Java home: /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.102-4.b14.el7.x86_64/jre</span><br><span class="line">Default locale: en_US, platform encoding: UTF-8</span><br><span class="line">OS name: &quot;linux&quot;, version: &quot;3.10.0-514.el7.x86_64&quot;, arch: &quot;amd64&quot;, family: &quot;unix&quot;</span><br></pre></td></tr></table></figure>

<h2 id="5-4ã€é…ç½®"><a href="#5-4ã€é…ç½®" class="headerlink" title="5.4ã€é…ç½®"></a>5.4ã€é…ç½®</h2><p>vi ~/tools/apache-maven-3.5.0/conf/settings.xmlï¼ˆæœ¬åœ°æœåŠ¡å™¨å¯ä»¥ä½¿ç”¨localhostï¼Œå¼€å‘ç»„å…¶ä»–æœåŠ¡å™¨åˆ™ä¿®æ”¹ä¸ºå¯¹åº”NexusæœåŠ¡å™¨çš„åŸŸåæˆ–è€…IPåœ°å€ï¼‰</p>
<p><a href="https://i0.wp.com/common.cnblogs.com/images/copycode.gif?w=640&ssl=1" title="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬17å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/common.cnblogs.com/images/copycode.gif?w=640&ssl=1" alt="Nexusæ­å»ºå¼€å‘ç»„çš„ç§æœ‰ä»“åº“ - ç¬¬17å¼   | å¼ å˜"></a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;settings&gt;</span><br><span class="line">  &lt;pluginGroups&gt;  </span><br><span class="line">     &lt;pluginGroup&gt;org.sonatype.plugins&lt;/pluginGroup&gt;  </span><br><span class="line">  &lt;/pluginGroups&gt; </span><br><span class="line">  &lt;mirrors&gt;</span><br><span class="line">    &lt;mirror&gt;</span><br><span class="line">      &lt;id&gt;nexus&lt;/id&gt;</span><br><span class="line">      &lt;mirrorOf&gt;*&lt;/mirrorOf&gt;</span><br><span class="line">      &lt;url&gt;http://localhost:8081/repository/maven-public/&lt;/url&gt;</span><br><span class="line">    &lt;/mirror&gt;</span><br><span class="line">  &lt;/mirrors&gt;</span><br><span class="line">  &lt;profiles&gt;</span><br><span class="line">    &lt;profile&gt;</span><br><span class="line">      &lt;id&gt;nexus&lt;/id&gt;</span><br><span class="line">      &lt;!--Enable snapshots for the built in central repo to direct --&gt;</span><br><span class="line">      &lt;!--all requests to nexus via the mirror --&gt;</span><br><span class="line">      &lt;repositories&gt;</span><br><span class="line">        &lt;repository&gt;</span><br><span class="line">          &lt;id&gt;central&lt;/id&gt;</span><br><span class="line">          &lt;url&gt;http://central&lt;/url&gt;</span><br><span class="line">          &lt;releases&gt;&lt;enabled&gt;true&lt;/enabled&gt;&lt;/releases&gt;</span><br><span class="line">          &lt;snapshots&gt;&lt;enabled&gt;true&lt;/enabled&gt;&lt;/snapshots&gt;</span><br><span class="line">        &lt;/repository&gt;</span><br><span class="line">      &lt;/repositories&gt;</span><br><span class="line">     &lt;pluginRepositories&gt;</span><br><span class="line">        &lt;pluginRepository&gt;</span><br><span class="line">          &lt;id&gt;central&lt;/id&gt;</span><br><span class="line">          &lt;url&gt;http://central&lt;/url&gt;</span><br><span class="line">          &lt;releases&gt;&lt;enabled&gt;true&lt;/enabled&gt;&lt;/releases&gt;</span><br><span class="line">          &lt;snapshots&gt;&lt;enabled&gt;true&lt;/enabled&gt;&lt;/snapshots&gt;</span><br><span class="line">        &lt;/pluginRepository&gt;</span><br><span class="line">      &lt;/pluginRepositories&gt;</span><br><span class="line">    &lt;/profile&gt;</span><br><span class="line">  &lt;/profiles&gt;</span><br><span class="line">  &lt;activeProfiles&gt;</span><br><span class="line">    &lt;!--make the profile active all the time --&gt;</span><br><span class="line">    &lt;activeProfile&gt;nexus&lt;/activeProfile&gt;</span><br><span class="line">  &lt;/activeProfiles&gt;</span><br><span class="line">  &lt;servers&gt;</span><br><span class="line">    &lt;server&gt;</span><br><span class="line">      &lt;id&gt;nexus&lt;/id&gt;</span><br><span class="line">      &lt;username&gt;admin&lt;/username&gt;</span><br><span class="line">      &lt;password&gt;admin123&lt;/password&gt;</span><br><span class="line">    &lt;/server&gt;</span><br><span class="line">  &lt;/servers&gt;</span><br><span class="line">&lt;/settings&gt;</span><br></pre></td></tr></table></figure>

</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>æ‚ä¹±</tag>
      </tags>
  </entry>
  <entry>
    <title>prometheus+grafanaæ­å»ºç›‘æ§æœåŠ¡</title>
    <url>/prometheus/</url>
    <content><![CDATA[<div class=".article-gallery"><h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>ä¹‹å‰ä½¿ç”¨è¿‡InfluxDB+Grafanaçš„æ–¹æ¡ˆï¼Œä¸»åŠ¨pushç›‘æ§æ•°æ®ï¼Œç°åœ¨ä½¿ç”¨Prometheus pullæ•°æ®çš„æ–¹æ¡ˆï¼Œç›¸æ¯”å‰ä¸€ç§æ–¹æ¡ˆï¼Œç°åœ¨è¿™ç§åœ¨éƒ¨ç½²ä¸Šæ›´åŠ æ–¹ä¾¿ã€‚<strong>æ¨è</strong>ã€‚</p>
<h1 id="Grafana"><a href="#Grafana" class="headerlink" title="Grafana"></a>Grafana</h1><h4 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h4><p>å¯ä»¥å‚è€ƒå¦å¤–ä¸€ç¯‡æ–‡ç« : <a href="http://kwaibook.com/influxdb-grafana/">InfluxDBå’ŒGrafanaæ­å»ºç›‘æ§æœåŠ¡</a></p>
<h4 id="LinuxæœåŠ¡å™¨å®‰è£…"><a href="#LinuxæœåŠ¡å™¨å®‰è£…" class="headerlink" title="LinuxæœåŠ¡å™¨å®‰è£…"></a>LinuxæœåŠ¡å™¨å®‰è£…</h4><ol>
<li><p><a href="https://grafana.com/grafana/download">å®˜ç½‘</a>é€‰æ‹©å¯¹åº”çš„ç‰ˆæœ¬ä¸‹è½½å¹¶å®‰è£…ã€‚</p>
</li>
<li><p>å¯åŠ¨grafana</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@cxm ~]#systemctl daemon-reload</span><br><span class="line">[root@cxm ~]#systemctl start grafana-server</span><br><span class="line">[root@cxm ~]#systemctl stop grafana-server</span><br><span class="line">[root@cxm ~]#systemctl restart grafana-server</span><br><span class="line">[root@cxm ~]#systemctl status grafana-server</span><br><span class="line">[root@cxm ~]#systemctl enable grafana-server</span><br></pre></td></tr></table></figure></li>
<li><p>å¼€æ”¾3000ç«¯å£</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@cxm ~]#firewall-cmd --list-ports</span><br><span class="line">[root@cxm ~]#firewall-cmd --add-port=3000/tcp --zone=public --permanent</span><br><span class="line">[root@cxm ~]#firewall-cmd --reload</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…ç›´æ¥å…³é—­é˜²ç«å¢™</p>
</li>
</ol>
<h1 id="Prometheus"><a href="#Prometheus" class="headerlink" title="Prometheus"></a>Prometheus</h1><h4 id="å®‰è£…Prometheus"><a href="#å®‰è£…Prometheus" class="headerlink" title="å®‰è£…Prometheus"></a>å®‰è£…Prometheus</h4><ol>
<li>åˆ›å»ºprometheusç”¨æˆ·ï¼Œå°†ç›¸å…³çš„éƒ½æ”¾åœ¨è¯¥ç”¨æˆ·ä¸‹ï¼Œå‚è€ƒ<a href="https://cloud.tencent.com/developer/article/1445255">æ–‡ç« </a></li>
<li><a href="https://prometheus.io/download/">å®˜ç½‘</a>ä¸‹è½½</li>
<li>æŒ‰ç…§<a href="https://cloud.tencent.com/developer/article/1445255">æ–‡ç« </a>ä¸­çš„æ­¥éª¤ä»¥systemctlæ–¹å¼å¯åŠ¨ï¼Œæ³¨æ„æ–°å»ºçš„dataæ–‡ä»¶å¤¹éœ€è¦æ˜¯prometheusç”¨æˆ·æƒé™çš„</li>
</ol>
<h4 id="å®‰è£…node-exporter"><a href="#å®‰è£…node-exporter" class="headerlink" title="å®‰è£…node_exporter"></a>å®‰è£…node_exporter</h4><ul>
<li><p>ç”¨æ¥ä¸ŠæŠ¥æœºå™¨æ€§èƒ½æ•°æ®ï¼Œåœ¨prometheusçš„å®˜ç½‘æœ‰ã€‚</p>
</li>
<li><p>æŒ‰ç…§<a href="https://cloud.tencent.com/developer/article/1445255">æ–‡ç« </a>ä¸­çš„æ–¹å¼ä»¥systemctl å¯åŠ¨ã€‚</p>
</li>
</ul>
<p>è¯¦ç»†å‚è€ƒæ–‡ç« ï¼š</p>
<p><a href="https://mp.weixin.qq.com/s/ZXlBPHGcWeYh2hjBzacc3A">https://mp.weixin.qq.com/s/ZXlBPHGcWeYh2hjBzacc3A</a></p>
<p><a href="https://blog.csdn.net/shenyuanhaojie/article/details/121775976">https://blog.csdn.net/shenyuanhaojie/article/details/121775976</a></p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ç›‘æ§</tag>
      </tags>
  </entry>
  <entry>
    <title>Redisç¬”è®°</title>
    <url>/redis-mode/</url>
    <content><![CDATA[<div class=".article-gallery"><p>1.å•çº¿ç¨‹ï¼šRedisæ˜¯å•çº¿ç¨‹æ¥å¤„ç†å‘½ä»¤çš„ï¼Œæ‰€ä»¥ä¸€æ¡å‘½ä»¤ä»å®¢æˆ·ç«¯åˆ°è¾¾æœåŠ¡å™¨ä¸ä¼šç«‹åˆ»è¢«æ‰§è¡Œï¼Œæ‰€æœ‰å‘½ä»¤éƒ½ä¼šè¿›å…¥ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œç„¶åé€ä¸ªæ‰§è¡Œã€‚</p>
<p>2.Redisä½¿ç”¨I/Oå¤šè·¯å¤ç”¨æŠ€æœ¯æ¥è§£å†³I/Oçš„é—®é¢˜ã€‚</p>
<span id="more"></span>

<p>3.æ€§èƒ½ï¼šçº¯å†…å­˜è®¿é—®ã€éé˜»å¡IOï¼ŒRedisä½¿ç”¨epollä½œä¸ºI/Oå¤šè·¯å¤ç”¨æŠ€æœ¯çš„å®ç°ã€‚å•çº¿ç¨‹é¿å…äº†çº¿ç¨‹åˆ‡æ¢å’Œç«æ€äº§ç”Ÿçš„æ¶ˆè€—ã€‚</p>
<p>4.å•çº¿ç¨‹çš„é—®é¢˜ï¼šå¯¹äºæ¯ä¸ªå‘½ä»¤çš„æ‰§è¡Œæ—¶é—´æ˜¯æœ‰è¦æ±‚çš„ã€‚å¦‚æœæŸä¸ªå‘½ä»¤æ‰§è¡Œè¿‡é•¿ï¼Œä¼šé€ æˆå…¶ä»–å‘½ä»¤çš„é˜»å¡ã€‚è‡´å‘½çš„ï¼</p>
<p>5.setnxå¯ä»¥ä½œä¸ºåˆ†å¸ƒå¼é”çš„ä¸€ç§å®ç°æ–¹æ¡ˆã€‚<a href="http://redis.io/topics/distlock">http://redis.io/topics/distlock</a></p>
<p>6.æ‰¹é‡æ“ä½œè§£å†³ç½‘ç»œæ€§èƒ½çš„ç“¶é¢ˆï¼ŒRedisæ”¯æŒæ¯ç§’æ•°ä¸‡çš„è¯»å†™æ“ä½œï¼Œç½‘ç»œå¯èƒ½ä¼šæˆä¸ºæ€§èƒ½çš„ç“¶é¢ˆã€‚</p>
<p>7.Redisæ”¯æŒç®€å•çš„äº‹åŠ¡ï¼Œmultiå¼€å§‹  execæ‰§è¡Œ  discardèˆå¼ƒã€‚Redisä¸æ”¯æŒå›æ»šåŠŸèƒ½ï¼Œäº‹åŠ¡ä¸­å¯èƒ½ç¬¬ä¸€æ¡æ‰§è¡ŒæˆåŠŸï¼Œç¬¬äºŒæ¡æ‰§è¡Œå¤±è´¥ï¼Œç¬¬ä¸€æ¡ä¹Ÿä¼šç”Ÿæ•ˆã€‚</p>
<p>8.watchå‘½ä»¤ï¼Œç¡®ä¿äº‹åŠ¡ä¸­çš„keyæ²¡æœ‰è¢«å…¶ä»–å®¢æˆ·ç«¯ä¿®æ”¹è¿‡ï¼Œæ‰æ‰§è¡Œäº‹åŠ¡ï¼Œå¦åˆ™ä¸æ‰§è¡Œï¼ˆç±»ä¼¼ä¹è§‚é”ï¼‰ã€‚</p>
<p>9.çº¿ä¸Šç¯å¢ƒï¼šredis-cli è¶…æ—¶çš„æ£€æµ‹ï¼Œtimeoutè®¾ç½®ä¸ºå¤§äº0ï¼Œå®¢æˆ·ç«¯åšç©ºé—²æ£€æµ‹ï¼Œjedis-poolçš„common-poolã€‚</p>
<p>10.client pause å‘½ä»¤åº”ç”¨ï¼šè®©ä¸»ã€ä»ä¿æŒä¸€è‡´ã€‚å¯æ§çš„å°†å®¢æˆ·ç«¯è¿æ¥ä»ä¸€ä¸ªèŠ‚ç‚¹åˆ‡æ¢åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ã€‚çº¿ä¸Šæš‚åœæˆæœ¬éå¸¸é«˜ã€‚</p>
<p>11.rename-commandå‘½ä»¤é‡å‘½åæŒ‡ä»¤ã€‚</p>
<p>12.forkæ“ä½œè·Ÿå†…å­˜é‡æˆæ­£æ¯”ï¼Œçº¿ä¸Šå»ºè®®å•ä¸ªRediså®ä¾‹å†…å­˜æ§åˆ¶åœ¨10GBä»¥å†…ã€‚</p>
<p>13.Redisæ˜¯CPUå¯†é›†å‹æœåŠ¡ï¼Œä¸è¦å’Œå…¶ä»–CPUå¯†é›†å‹æœåŠ¡éƒ¨ç½²åœ¨ä¸€èµ·ã€‚</p>
<p>14.ä¸»ä»ï¼šå†™é«˜å¹¶å‘æ—¶ï¼Œå¯ä»¥å¼€å¯ä»çš„AOFï¼Œå…³é—­ä¸»çš„æŒä¹…åŒ–ï¼Œè¦æ³¨æ„ä¸»åº“è‡ªåŠ¨é‡å¯åæ²¡æœ‰æ•°æ®ï¼Œé¿å…ä»åº“åŒæ­¥æ¸…ç©ºï¼Œè¡€å´©ã€‚</p>
<p>15.ä¸»ä»ï¼šè¯»é«˜å¹¶å‘æ—¶ï¼Œå¯ä»¥è®©å®¢æˆ·ç«¯ä»ä»åº“è¯»å–ã€‚</p>
<p>16.ä¸»ä»ï¼šå†™å¹¶å‘é«˜çš„ä¸»åº“ä¸é€‚å®œæœ‰å¤šä¸ªä»åº“ã€‚å¯ä»¥ä½¿ç”¨æ ‘çŠ¶ç»“æ„ã€‚</p>
<p>17.Redisæ‰§è¡Œforkæ“ä½œäº§ç”Ÿçš„å­è¿›ç¨‹ï¼Œä½¿ç”¨å†™æ—¶å¤åˆ¶æŠ€æœ¯ï¼ˆcopy-on-writeï¼‰ï¼Œå‡å°‘å†…å­˜çš„å ç”¨ã€‚</p>
<p>18.å°½é‡å‡å°‘å­—ç¬¦ä¸²é¢‘ç¹ä¿®æ”¹æ“ä½œå¦‚appendã€setrangeï¼Œæ”¹ä¸ºç›´æ¥ä½¿ç”¨setä¿®æ”¹å­—ç¬¦ä¸²ï¼Œé™ä½é¢„åˆ†é…å¸¦æ¥çš„å†…å­˜æµªè´¹å’Œå†…å­˜ç¢ç‰‡åŒ–ã€‚</p>
<p>19.æ§åˆ¶æ•°æ®ç±»å‹çš„ç¼–ç æ¥å®ç°æ—¶é—´å’Œç©ºé—´çš„å¹³è¡¡ã€‚</p>
<p>20.é”®å€¼å¯¹å¾ˆå¤šæ—¶ï¼Œå¯ä»¥åˆ†ç»„æ˜ å°„åˆ°å¤šä¸ªhashç»“æ„ä¸­ï¼Œæ¥é™ä½é”®çš„æ•°é‡ã€‚å¦‚100Wä¸ªé”®åˆ†ç»„æ˜ å°„åˆ°1000ä¸ªhashä¸­ï¼Œæ¯ä¸ª1000ä¸ªfieldã€valueã€‚</p>
<p>21.é›†ç¾¤æ•…éšœè½¬ç§»æ—¶ä¸å½±å“å…¶ä»–ä¸»èŠ‚ç‚¹ï¼Œé…ç½®cluster-require-full-coverage noã€‚</p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>æ•°æ®åº“</tag>
      </tags>
  </entry>
  <entry>
    <title>Rediså¸¸è§é¢è¯•é¢˜</title>
    <url>/redis-pre/</url>
    <content><![CDATA[<div class=".article-gallery"><p>å’ŒRedisç»“ç¼˜è¿˜æ˜¯2011å¹´åˆšå¼€å§‹å®ä¹ ï¼Œåšçš„ç¬¬ä¸€æ¬¾æ¸¸æˆã€Šéƒ¨è½æˆ˜äº‰ã€‹ï¼Œ<br>å°±æ˜¯ä½¿ç”¨çš„Redisä½œä¸ºæŒä¹…å±‚å’Œç¼“å­˜ã€‚ å½“æ—¶å¯¹Redisçš„è®¤è¯†è¿˜æ¯”è¾ƒæµ…ï¼Œä½†æ˜¯Redisçš„å¥½å¤šç‰¹æ€§å·²ç»å¼€å§‹æ…¢æ…¢äº†è§£ã€‚</p>
<p>è¿™é‡Œæ¨èä¸€ä¸‹å¤§ç¥çš„Rediså…¬ä¼—å·ã€‚ä»˜ç£Šã€‚å¿«æ‰‹åŒäº‹ï¼Œã€ŠRediså¼€å‘ä¸è¿ç»´ã€‹ä¸€ä¹¦çš„ä½œè€…ï¼Œå¼ºçƒˆæ¨èè¿™æœ¬ä¹¦ï¼Œåå‘å®æˆ˜ï¼Œå¦å¤–ä¸€æœ¬å¾ˆæœ‰åçš„ä¹¦ã€ŠRedisè®¾è®¡ä¸å®ç°ã€‹æ›´æ³¨é‡åŸç†ã€‚ä¸¤æœ¬ä¹¦éƒ½éå¸¸å€¼å¾—å¥½å¥½è¯»ä¸‹ã€‚</p>
<span id="more"></span>

<p><a href="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/4-576x1024.jpg?resize=640,1138" title="Rediså¸¸è§é¢è¯•é¢˜ - ç¬¬1å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/4-576x1024.jpg?resize=640,1138" alt="Rediså¸¸è§é¢è¯•é¢˜ - ç¬¬1å¼   | å¼ å˜"></a></p>
<p><a href="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/3-1-576x1024.jpg?resize=576,1024" title="Rediså¸¸è§é¢è¯•é¢˜ - ç¬¬2å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i2.wp.com/192.144.167.243/blog/wp-content/uploads/3-1-576x1024.jpg?resize=576,1024" alt="Rediså¸¸è§é¢è¯•é¢˜ - ç¬¬2å¼   | å¼ å˜"></a></p>
<h4 id="Memcachedç›¸æ¯”äºRedisçš„ä¸»è¦ç‰¹ç‚¹æœ‰å¦‚ä¸‹ï¼š"><a href="#Memcachedç›¸æ¯”äºRedisçš„ä¸»è¦ç‰¹ç‚¹æœ‰å¦‚ä¸‹ï¼š" class="headerlink" title="Memcachedç›¸æ¯”äºRedisçš„ä¸»è¦ç‰¹ç‚¹æœ‰å¦‚ä¸‹ï¼š"></a>Memcachedç›¸æ¯”äºRedisçš„ä¸»è¦ç‰¹ç‚¹æœ‰å¦‚ä¸‹ï¼š</h4><p>\1. è¶…é«˜OPSï¼šä¾‹å¦‚åƒä¸‡çº§åˆ«ä»¥ä¸Šï¼ˆçº¿ä¸Šåƒä¸‡OPSä»¥ä¸Šçš„Redisä¹Ÿå­˜åœ¨ï¼‰<br>\2. å¤šçº¿ç¨‹ï¼šæŠ—çƒ­ç‚¹èƒ½åŠ›å¼ºã€‚<br>\3. æ”¯æŒå¤§valueï¼šä¾‹å¦‚Memcached 5æ”¯æŒ100MBä»¥ä¸Šçš„value</p>
<p>ä½†Memcachedç›¸æ¯”äºRedisç»´æŠ¤æˆæœ¬ä¼šæ›´é«˜ï¼Œè€Œä¸”å¯¹äºå¾ˆå¤šåŸºç¡€è®¾æ–½æ”¯æŒä¹Ÿä¸å¥½ï¼ˆåŒæœºæˆ¿ã€é”®å€¼åˆ†æã€å†…å­˜ä¼˜åŒ–ã€æœåŠ¡ç«¯é«˜å¯ç”¨ï¼‰ã€‚</p>
<p>æœ€è¿‘å‘ç°KCCä¸Šå‡ºç°Memcachedæ»¥ç”¨çš„æƒ…å†µ</p>
<p>ä¸ºé˜²æ­¢æ»¥ç”¨ï¼Œå¿…é¡»æ»¡è¶³å¦‚ä¸‹è§„åˆ™æ‰ä¼šå¼€é€šï¼š</p>
<p>\1. OPS: è¶…è¿‡100ä¸‡<br>\2. big valueï¼š10MB+<br>\3. æ˜æ˜¾çƒ­ç‚¹<br>\4. CASéœ€æ±‚</p>
<p><strong>ä¸€ã€Rediså¸¸è§çš„æ•°æ®ç»“æ„å’Œä½¿ç”¨åœºæ™¯</strong></p>
<p>(ä¸€)String è¿™ä¸ªå…¶å®æ²¡å•¥å¥½è¯´çš„ï¼Œæœ€å¸¸è§„çš„set/getæ“ä½œï¼Œvalueå¯ä»¥æ˜¯Stringä¹Ÿå¯ä»¥æ˜¯æ•°å­—ã€‚ä¸€èˆ¬åš<strong>ä¸€äº›å¤æ‚çš„è®¡æ•°åŠŸèƒ½çš„ç¼“å­˜ã€‚</strong></p>
<p>(äºŒ)hash è¿™é‡Œvalueå­˜æ”¾çš„æ˜¯ç»“æ„åŒ–çš„å¯¹è±¡ï¼Œæ¯”è¾ƒæ–¹ä¾¿çš„å°±æ˜¯æ“ä½œå…¶ä¸­çš„æŸä¸ªå­—æ®µã€‚åšä¸»åœ¨åš<strong>å•ç‚¹ç™»å½•</strong>çš„æ—¶å€™ï¼Œå°±æ˜¯ç”¨è¿™ç§æ•°æ®ç»“æ„å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼Œä»¥cookieIdä½œä¸ºkeyï¼Œè®¾ç½®30åˆ†é’Ÿä¸ºç¼“å­˜è¿‡æœŸæ—¶é—´ï¼Œèƒ½å¾ˆå¥½çš„æ¨¡æ‹Ÿå‡ºç±»ä¼¼sessionçš„æ•ˆæœã€‚</p>
<p>(ä¸‰)list ä½¿ç”¨Listçš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥<strong>åšç®€å•çš„æ¶ˆæ¯é˜Ÿåˆ—çš„åŠŸèƒ½</strong>ã€‚å¦å¤–è¿˜æœ‰ä¸€ä¸ªå°±æ˜¯ï¼Œå¯ä»¥åˆ©ç”¨lrangeå‘½ä»¤ï¼Œ<strong>åšåŸºäºredisçš„åˆ†é¡µåŠŸèƒ½</strong>ï¼Œæ€§èƒ½æä½³ï¼Œç”¨æˆ·ä½“éªŒå¥½ã€‚</p>
<p>(å››)set å› ä¸ºsetå †æ”¾çš„æ˜¯ä¸€å †ä¸é‡å¤å€¼çš„é›†åˆã€‚æ‰€ä»¥å¯ä»¥åš<strong>å…¨å±€å»é‡çš„åŠŸèƒ½</strong>ã€‚ä¸ºä»€ä¹ˆä¸ç”¨JVMè‡ªå¸¦çš„Setè¿›è¡Œå»é‡ï¼Ÿå› ä¸ºæˆ‘ä»¬çš„ç³»ç»Ÿä¸€èˆ¬éƒ½æ˜¯é›†ç¾¤éƒ¨ç½²ï¼Œä½¿ç”¨JVMè‡ªå¸¦çš„Setï¼Œæ¯”è¾ƒéº»çƒ¦ï¼Œéš¾é“ä¸ºäº†ä¸€ä¸ªåšä¸€ä¸ªå…¨å±€å»é‡ï¼Œå†èµ·ä¸€ä¸ªå…¬å…±æœåŠ¡ï¼Œå¤ªéº»çƒ¦äº†ã€‚ å¦å¤–ï¼Œå°±æ˜¯åˆ©ç”¨äº¤é›†ã€å¹¶é›†ã€å·®é›†ç­‰æ“ä½œï¼Œå¯ä»¥<strong>è®¡ç®—å…±åŒå–œå¥½ï¼Œå…¨éƒ¨çš„å–œå¥½ï¼Œè‡ªå·±ç‹¬æœ‰çš„å–œå¥½ç­‰åŠŸèƒ½</strong>ã€‚</p>
<p>(äº”)sorted set sorted setå¤šäº†ä¸€ä¸ªæƒé‡å‚æ•°score,é›†åˆä¸­çš„å…ƒç´ èƒ½å¤ŸæŒ‰scoreè¿›è¡Œæ’åˆ—ã€‚å¯ä»¥åš<strong>æ’è¡Œæ¦œåº”ç”¨ï¼Œå–TOP Næ“ä½œ</strong>ã€‚å¦å¤–ï¼Œå‚ç…§å¦ä¸€ç¯‡<a href="http://link.zhihu.com/?target=https://www.cnblogs.com/rjzheng/p/8972725.html">ã€Šåˆ†å¸ƒå¼ä¹‹å»¶æ—¶ä»»åŠ¡æ–¹æ¡ˆè§£æã€‹</a>ï¼Œè¯¥æ–‡æŒ‡å‡ºäº†sorted setå¯ä»¥ç”¨æ¥åš<strong>å»¶æ—¶ä»»åŠ¡</strong>ã€‚æœ€åä¸€ä¸ªåº”ç”¨å°±æ˜¯å¯ä»¥åš<strong>èŒƒå›´æŸ¥æ‰¾</strong>ã€‚</p>
<p><strong>äºŒã€Redisçš„hashæ€ä¹ˆå®ç°çš„</strong><br>æ»¡è¶³ä»¥ä¸‹ä¸¤æ¡ä»¶æ—¶ï¼š<br>1ã€é”®å’Œå€¼çš„é•¿åº¦éƒ½å°äº64å­—èŠ‚<br>2ã€é”®å€¼å¯¹æ•°é‡å°äº512ä¸ª<br>ä½¿ç”¨ziplistç¼–ç ã€‚ä¸æ»¡è¶³æ—¶è½¬åŒ–ä¸ºhashtableç¼–ç ï¼Œå¹¶ä¸”è¿™ä¸ªè½¬åŒ–è¿‡ç¨‹æ˜¯ä¸å¯é€†çš„ã€‚<br>hashtableçš„å®ç°æ–¹å¼å’ŒJavaçš„hashmapç±»ä¼¼ï¼Œæ•°ç»„ä¸Šæ•£åˆ—ï¼Œæ•£åˆ—å†²çªçš„ä½¿ç”¨é“¾è¡¨ï¼Œä¸åŒçš„æ˜¯redisé‡‡ç”¨æ¸è¿›å¼çš„rehashç­–ç•¥ã€‚<br>ä½•ä¸º<strong>æ¸è¿›å¼rehash</strong>ï¼Ÿå°±æ˜¯æŠŠæ‹·è´èŠ‚ç‚¹æ•°æ®çš„è¿‡ç¨‹å¹³æ‘Šåˆ°åç»­çš„æ“ä½œä¸­ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§æ‹·è´ã€‚ç»´æŠ¤ä¸¤å¼ å“ˆå¸Œè¡¨ï¼Œ1ä¸ªç´¢å¼•æ¥æŒ‡ç¤ºå½“å‰çš„rehashè¿›åº¦ã€‚<br>rehashæ˜¯ä»¥bucket(æ¡¶)ä¸ºåŸºæœ¬å•ä½è¿›è¡Œæ¸è¿›å¼çš„æ•°æ®è¿ç§»çš„ï¼Œæ¯æ­¥å®Œæˆä¸€ä¸ªbucketçš„è¿ç§»ï¼Œç›´è‡³æ‰€æœ‰æ•°æ®è¿ç§»å®Œæ¯•ã€‚ä¸€ä¸ªbucketå¯¹åº”å“ˆå¸Œè¡¨æ•°ç»„ä¸­çš„ä¸€æ¡entryé“¾è¡¨ã€‚<br><strong>Java HashMap</strong>çš„rehashï¼Œæ¯æ¬¡åˆ›å»ºä¸€ä¸ªæ•°ç»„ï¼ˆå“ˆå¸Œè¡¨ï¼‰ï¼Œä¸€æ¬¡æ€§å°†oldè¡¨rehashè¿‡å»ã€‚</p>
<p><strong>ä¸‰ã€ä¸ºä»€ä¹ˆä¸èƒ½ç”¨Redisåšä¸“é—¨çš„æŒä¹…åŒ–</strong><br>æ€§ä»·æ¯”ï¼šå†…å­˜åƒç´§ ï¼Œæµ·é‡æ•°æ®åœ¨é‡å¯ååŠ è½½è€—æ—¶ã€‚RDBåŠ è½½å¿«ã€‚<br>æƒé™æ§åˆ¶ã€‚<br>æ•°æ®å®Œæ•´ï¼šMySQL åœ¨å´©æºƒå¤„ç†ï¼Œæ•°æ®æ¢å¤æ–¹é¢æ¯”reidså¥½ã€‚<br>redisä½œä¸ºæ•°æ®åº“æŸ¥è¯¢åŠŸèƒ½å¤ªå¼±ã€‚æ•°æ®KVå¼±äºç»“æ„åŒ–ã€‚<br>æ•°æ®éš”ç¦»ã€‚</p>
<h1 id="Redis-Cluster-åŠŸèƒ½é™åˆ¶"><a href="#Redis-Cluster-åŠŸèƒ½é™åˆ¶" class="headerlink" title="Redis Cluster|åŠŸèƒ½é™åˆ¶"></a>Redis Cluster|åŠŸèƒ½é™åˆ¶</h1><p>1.Keyæ‰¹é‡æ“ä½œæ”¯æŒæœ‰é™ã€‚ç›®å‰åªæ”¯æŒåŒslotå†…çš„keyæ‰§è¡Œæ‰¹é‡æ“ä½œï¼ˆå¦‚mget,msetï¼‰ã€‚</p>
<p>2.Keyäº‹åŠ¡æ“ä½œæ”¯æŒæœ‰é™ã€‚åªæ”¯æŒå¤škeyåœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šçš„äº‹åŠ¡æ“ä½œï¼Œå¤šä¸ªkeyåˆ†å¸ƒåœ¨ä¸åŒèŠ‚ç‚¹ä¸Šæ—¶æ— æ³•ä½¿ç”¨äº‹åŠ¡åŠŸèƒ½ã€‚</p>
<p>3.Keyä½œä¸ºæ•°æ®åˆ†åŒºçš„æœ€å°ç²’åº¦ï¼Œå› æ­¤ä¸èƒ½å°†ä¸€ä¸ªå¤§çš„é”®å€¼å¯¹è±¡å¦‚hashï¼Œlistç­‰æ˜ å°„åˆ°ä¸åŒèŠ‚ç‚¹ã€‚</p>
<p>4.ä¸æ”¯æŒå¤šæ•°æ®åº“ç©ºé—´ï¼Œé›†ç¾¤æ¨¡å¼ä¸‹åªèƒ½ä½¿ç”¨db0ç©ºé—´ã€‚</p>
<p>5.å¤åˆ¶ç»“æ„åªæ”¯æŒä¸€å±‚ï¼Œä»èŠ‚ç‚¹åªèƒ½å¤åˆ¶ä¸»èŠ‚ç‚¹ï¼Œä¸æ”¯æŒåµŒå¥—æ ‘çŠ¶å¤åˆ¶ç»“æ„ã€‚</p>
<h1 id="Redis-Clusteré«˜å¯ç”¨"><a href="#Redis-Clusteré«˜å¯ç”¨" class="headerlink" title="Redis Clusteré«˜å¯ç”¨"></a>Redis Clusteré«˜å¯ç”¨</h1><p>æä¾›äº†çµæ´»çš„èŠ‚ç‚¹æ‰©å®¹å’Œæ”¶ç¼©æ–¹æ¡ˆï¼Œåœ¨ä¸å½±å“é›†ç¾¤å¯¹å¤–æœåŠ¡çš„æƒ…å†µä¸‹è¿›è¡Œã€‚<br>è‡ªåŠ¨æ•…éšœè½¬ç§»ä¿è¯é›†ç¾¤å¯ä»¥æ­£å¸¸å¯¹å¤–æä¾›æœåŠ¡ã€‚ä¸»è§‚ä¸‹çº¿ï¼Œå®¢è§‚ä¸‹çº¿ï¼ŒæŠ•ç¥¨é€‰ä¸¾ç­–ç•¥ã€‚é€‰å‡ºä»èŠ‚ç‚¹æ›¿æ¢ä¸»èŠ‚ç‚¹ï¼Œä¿è¯é›†ç¾¤é«˜å¯ç”¨ã€‚</p>
<p><strong>ä¸‹é¢æ˜¯ä¸¤ç¯‡å¼•ç”¨çš„æ–‡ç« ã€‚<a href="https://zhuanlan.zhihu.com/p/59168140">https://zhuanlan.zhihu.com/p/59168140</a></strong></p>
<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><h2 id="ä¸ºä»€ä¹ˆå†™è¿™ç¯‡æ–‡ç« "><a href="#ä¸ºä»€ä¹ˆå†™è¿™ç¯‡æ–‡ç« " class="headerlink" title="ä¸ºä»€ä¹ˆå†™è¿™ç¯‡æ–‡ç« ?"></a>ä¸ºä»€ä¹ˆå†™è¿™ç¯‡æ–‡ç« ?</h2><p>åšä¸»çš„<a href="http://link.zhihu.com/?target=http://www.cnblogs.com/rjzheng/p/8994962.html">ã€Šåˆ†å¸ƒå¼ä¹‹æ¶ˆæ¯é˜Ÿåˆ—å¤ä¹ ç²¾è®²ã€‹</a>å¾—åˆ°äº†å¤§å®¶çš„å¥½è¯„ï¼Œå†…å¿ƒè¯šæƒ¶è¯šæï¼Œæƒ³ç€å†å‡ºä¸€ç¯‡å…³äºå¤ä¹ ç²¾è®²çš„æ–‡ç« ã€‚ä½†æ˜¯è¿˜æ˜¯è¦è¯´æ˜ä¸€ä¸‹ï¼Œå¤ä¹ ç²¾è®²çš„æ–‡ç« åé¢è¯•å‡†å¤‡ï¼ŒçœŸæ­£åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œè¿˜æ˜¯è„šè¸å®åœ°ï¼Œä¸€æ­¥ä¸€ä¸ªè„šå°ï¼Œä¸è¦æŠ•æœºå–å·§ã€‚ è€ƒè™‘åˆ°ç»å¤§éƒ¨åˆ†å†™ä¸šåŠ¡çš„ç¨‹åºå‘˜ï¼Œåœ¨å®é™…å¼€å‘ä¸­ä½¿ç”¨redisçš„æ—¶å€™ï¼Œåªä¼šsetvalueå’Œgetvalueä¸¤ä¸ªæ“ä½œï¼Œå¯¹redisæ•´ä½“ç¼ºä¹ä¸€ä¸ªè®¤çŸ¥ã€‚åˆæ°é€¢åšä¸»æŸä¸ªåŒäº‹ä¸‹å‘¨è¦å»åŸ¹è®­redisï¼Œæ‰€ä»¥åšä¸»æ–—èƒ†ä»¥redisä¸ºé¢˜æï¼Œå¯¹rediså¸¸è§é—®é¢˜åšä¸€ä¸ªæ€»ç»“ï¼Œå¸Œæœ›èƒ½å¤Ÿå¼¥è¡¥å¤§å®¶çš„çŸ¥è¯†ç›²ç‚¹ã€‚</p>
<h2 id="å¤ä¹ è¦ç‚¹"><a href="#å¤ä¹ è¦ç‚¹" class="headerlink" title="å¤ä¹ è¦ç‚¹?"></a>å¤ä¹ è¦ç‚¹?</h2><p>æœ¬æ–‡å›´ç»•ä»¥ä¸‹å‡ ç‚¹è¿›è¡Œé˜è¿°</p>
<ul>
<li>1ã€ä¸ºä»€ä¹ˆä½¿ç”¨redis</li>
<li>2ã€ä½¿ç”¨redisæœ‰ä»€ä¹ˆç¼ºç‚¹</li>
<li>3ã€å•çº¿ç¨‹çš„redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«</li>
<li>4ã€redisçš„æ•°æ®ç±»å‹ï¼Œä»¥åŠæ¯ç§æ•°æ®ç±»å‹çš„ä½¿ç”¨åœºæ™¯</li>
<li>5ã€redisçš„è¿‡æœŸç­–ç•¥ä»¥åŠå†…å­˜æ·˜æ±°æœºåˆ¶</li>
<li>6ã€rediså’Œæ•°æ®åº“åŒå†™ä¸€è‡´æ€§é—®é¢˜</li>
<li>7ã€å¦‚ä½•åº”å¯¹ç¼“å­˜ç©¿é€å’Œç¼“å­˜é›ªå´©é—®é¢˜</li>
<li>8ã€å¦‚ä½•è§£å†³redisçš„å¹¶å‘ç«äº‰é—®é¢˜</li>
</ul>
<h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h2 id="1ã€ä¸ºä»€ä¹ˆä½¿ç”¨redis"><a href="#1ã€ä¸ºä»€ä¹ˆä½¿ç”¨redis" class="headerlink" title="1ã€ä¸ºä»€ä¹ˆä½¿ç”¨redis"></a>1ã€ä¸ºä»€ä¹ˆä½¿ç”¨redis</h2><p><strong>åˆ†æ</strong>:åšä¸»è§‰å¾—åœ¨é¡¹ç›®ä¸­ä½¿ç”¨redisï¼Œä¸»è¦æ˜¯ä»ä¸¤ä¸ªè§’åº¦å»è€ƒè™‘:<strong>æ€§èƒ½</strong>å’Œ<strong>å¹¶å‘</strong>ã€‚å½“ç„¶ï¼Œredisè¿˜å…·å¤‡å¯ä»¥åšåˆ†å¸ƒå¼é”ç­‰å…¶ä»–åŠŸèƒ½ï¼Œä½†æ˜¯å¦‚æœåªæ˜¯ä¸ºäº†åˆ†å¸ƒå¼é”è¿™äº›å…¶ä»–åŠŸèƒ½ï¼Œå®Œå…¨è¿˜æœ‰å…¶ä»–ä¸­é—´ä»¶(å¦‚zookpeerç­‰)ä»£æ›¿ï¼Œå¹¶ä¸æ˜¯éè¦ä½¿ç”¨redisã€‚å› æ­¤ï¼Œè¿™ä¸ªé—®é¢˜ä¸»è¦ä»æ€§èƒ½å’Œå¹¶å‘ä¸¤ä¸ªè§’åº¦å»ç­”ã€‚</p>
<p><strong>å›ç­”</strong>:å¦‚ä¸‹æ‰€ç¤ºï¼Œåˆ†ä¸ºä¸¤ç‚¹</p>
<p><strong>ï¼ˆä¸€ï¼‰æ€§èƒ½</strong> å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬åœ¨ç¢°åˆ°éœ€è¦æ‰§è¡Œè€—æ—¶ç‰¹åˆ«ä¹…ï¼Œä¸”ç»“æœä¸é¢‘ç¹å˜åŠ¨çš„SQLï¼Œå°±ç‰¹åˆ«é€‚åˆå°†è¿è¡Œç»“æœæ”¾å…¥ç¼“å­˜ã€‚è¿™æ ·ï¼Œåé¢çš„è¯·æ±‚å°±å»ç¼“å­˜ä¸­è¯»å–ï¼Œä½¿å¾—è¯·æ±‚èƒ½å¤Ÿ<strong>è¿…é€Ÿå“åº”</strong>ã€‚</p>
<p><a href="https://i0.wp.com/pic4.zhimg.com/80/v2-8200a2192b95b1596dc8d02c71b9abcf_hd.jpg?w=640&ssl=1" title="Rediså¸¸è§é¢è¯•é¢˜ - ç¬¬3å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/pic4.zhimg.com/80/v2-8200a2192b95b1596dc8d02c71b9abcf_hd.jpg?w=640&ssl=1" alt="Rediså¸¸è§é¢è¯•é¢˜ - ç¬¬3å¼   | å¼ å˜"></a></p>
<p><strong>é¢˜å¤–è¯ï¼š</strong>å¿½ç„¶æƒ³èŠä¸€ä¸‹è¿™ä¸ª<strong>è¿…é€Ÿå“åº”</strong>çš„æ ‡å‡†ã€‚å…¶å®æ ¹æ®äº¤äº’æ•ˆæœçš„ä¸åŒï¼Œè¿™ä¸ªå“åº”æ—¶é—´æ²¡æœ‰å›ºå®šæ ‡å‡†ã€‚ä¸è¿‡æ›¾ç»æœ‰äººè¿™ä¹ˆå‘Šè¯‰æˆ‘:â€åœ¨ç†æƒ³çŠ¶æ€ä¸‹ï¼Œæˆ‘ä»¬çš„é¡µé¢è·³è½¬éœ€è¦åœ¨<strong>ç¬é—´</strong>è§£å†³ï¼Œå¯¹äºé¡µå†…æ“ä½œåˆ™éœ€è¦åœ¨<strong>åˆ¹é‚£</strong>é—´è§£å†³ã€‚å¦å¤–ï¼Œè¶…è¿‡<strong>ä¸€å¼¹æŒ‡</strong>çš„è€—æ—¶æ“ä½œè¦æœ‰è¿›åº¦æç¤ºï¼Œå¹¶ä¸”å¯ä»¥éšæ—¶ä¸­æ­¢æˆ–å–æ¶ˆï¼Œè¿™æ ·æ‰èƒ½ç»™ç”¨æˆ·æœ€å¥½çš„ä½“éªŒã€‚â€ é‚£ä¹ˆ<strong>ç¬é—´ã€åˆ¹é‚£ã€ä¸€å¼¹æŒ‡</strong>å…·ä½“æ˜¯å¤šå°‘æ—¶é—´å‘¢ï¼Ÿ æ ¹æ®ã€Šæ‘©è¯ƒåƒ§ç¥—å¾‹ã€‹è®°è½½</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä¸€åˆ¹é‚£è€…ä¸ºä¸€å¿µï¼ŒäºŒåå¿µä¸ºä¸€ç¬ï¼ŒäºŒåç¬ä¸ºä¸€å¼¹æŒ‡ï¼ŒäºŒåå¼¹æŒ‡ä¸ºä¸€ç½—é¢„ï¼ŒäºŒåç½—é¢„ä¸ºä¸€é¡»è‡¾ï¼Œä¸€æ—¥ä¸€å¤œæœ‰ä¸‰åé¡»è‡¾ã€‚</span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆï¼Œç»è¿‡å‘¨å¯†çš„è®¡ç®—ï¼Œä¸€<strong>ç¬é—´</strong>ä¸º0.36 ç§’,ä¸€<strong>åˆ¹é‚£</strong>æœ‰ 0.018 ç§’.ä¸€<strong>å¼¹æŒ‡</strong>é•¿è¾¾ 7.2 ç§’ã€‚</p>
<p><strong>ï¼ˆäºŒï¼‰å¹¶å‘</strong> å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨å¤§å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œæ‰€æœ‰çš„è¯·æ±‚ç›´æ¥è®¿é—®æ•°æ®åº“ï¼Œæ•°æ®åº“ä¼šå‡ºç°è¿æ¥å¼‚å¸¸ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå°±éœ€è¦ä½¿ç”¨redisåšä¸€ä¸ªç¼“å†²æ“ä½œï¼Œè®©è¯·æ±‚å…ˆè®¿é—®åˆ°redisï¼Œè€Œä¸æ˜¯ç›´æ¥è®¿é—®æ•°æ®åº“ã€‚</p>
<p><a href="https://i2.wp.com/pic3.zhimg.com/80/v2-ee0f4577491f13d82e185e7ef6aa8eae_hd.jpg?w=640&ssl=1" title="Rediså¸¸è§é¢è¯•é¢˜ - ç¬¬4å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i2.wp.com/pic3.zhimg.com/80/v2-ee0f4577491f13d82e185e7ef6aa8eae_hd.jpg?w=640&ssl=1" alt="Rediså¸¸è§é¢è¯•é¢˜ - ç¬¬4å¼   | å¼ å˜"></a></p>
<h2 id="2ã€ä½¿ç”¨redisæœ‰ä»€ä¹ˆç¼ºç‚¹"><a href="#2ã€ä½¿ç”¨redisæœ‰ä»€ä¹ˆç¼ºç‚¹" class="headerlink" title="2ã€ä½¿ç”¨redisæœ‰ä»€ä¹ˆç¼ºç‚¹"></a>2ã€ä½¿ç”¨redisæœ‰ä»€ä¹ˆç¼ºç‚¹</h2><p><strong>åˆ†æ</strong>:å¤§å®¶ç”¨redisè¿™ä¹ˆä¹…ï¼Œè¿™ä¸ªé—®é¢˜æ˜¯å¿…é¡»è¦äº†è§£çš„ï¼ŒåŸºæœ¬ä¸Šä½¿ç”¨rediséƒ½ä¼šç¢°åˆ°ä¸€äº›é—®é¢˜ï¼Œå¸¸è§çš„ä¹Ÿå°±å‡ ä¸ªã€‚</p>
<p><strong>å›ç­”</strong>:ä¸»è¦æ˜¯å››ä¸ªé—®é¢˜</p>
<ul>
<li>(ä¸€)ç¼“å­˜å’Œæ•°æ®åº“åŒå†™ä¸€è‡´æ€§é—®é¢˜</li>
<li>(äºŒ)ç¼“å­˜é›ªå´©é—®é¢˜</li>
<li>(ä¸‰)ç¼“å­˜å‡»ç©¿é—®é¢˜</li>
<li>(å››)ç¼“å­˜çš„å¹¶å‘ç«äº‰é—®é¢˜</li>
</ul>
<p>è¿™å››ä¸ªé—®é¢˜ï¼Œæˆ‘ä¸ªäººæ˜¯è§‰å¾—åœ¨é¡¹ç›®ä¸­ï¼Œæ¯”è¾ƒå¸¸é‡è§çš„ï¼Œå…·ä½“è§£å†³æ–¹æ¡ˆï¼Œåæ–‡ç»™å‡ºã€‚</p>
<h2 id="3ã€å•çº¿ç¨‹çš„redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«"><a href="#3ã€å•çº¿ç¨‹çš„redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«" class="headerlink" title="3ã€å•çº¿ç¨‹çš„redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«"></a>3ã€å•çº¿ç¨‹çš„redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«</h2><p><strong>åˆ†æ</strong>:è¿™ä¸ªé—®é¢˜å…¶å®æ˜¯å¯¹rediså†…éƒ¨æœºåˆ¶çš„ä¸€ä¸ªè€ƒå¯Ÿã€‚å…¶å®æ ¹æ®åšä¸»çš„é¢è¯•ç»éªŒï¼Œå¾ˆå¤šäººå…¶å®éƒ½ä¸çŸ¥é“redisæ˜¯å•çº¿ç¨‹å·¥ä½œæ¨¡å‹ã€‚æ‰€ä»¥ï¼Œè¿™ä¸ªé—®é¢˜è¿˜æ˜¯åº”è¯¥è¦å¤ä¹ ä¸€ä¸‹çš„ã€‚</p>
<p><strong>å›ç­”</strong>:ä¸»è¦æ˜¯ä»¥ä¸‹ä¸‰ç‚¹ (ä¸€)çº¯å†…å­˜æ“ä½œ (äºŒ)å•çº¿ç¨‹æ“ä½œï¼Œé¿å…äº†é¢‘ç¹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ (ä¸‰)é‡‡ç”¨äº†éé˜»å¡<strong>I/Oå¤šè·¯å¤ç”¨æœºåˆ¶</strong></p>
<p><strong>é¢˜å¤–è¯ï¼š</strong>æˆ‘ä»¬ç°åœ¨è¦ä»”ç»†çš„è¯´ä¸€è¯´I/Oå¤šè·¯å¤ç”¨æœºåˆ¶ï¼Œå› ä¸ºè¿™ä¸ªè¯´æ³•å®åœ¨æ˜¯å¤ªé€šä¿—äº†ï¼Œé€šä¿—åˆ°ä¸€èˆ¬äººéƒ½ä¸æ‡‚æ˜¯ä»€ä¹ˆæ„æ€ã€‚åšä¸»æ‰“ä¸€ä¸ªæ¯”æ–¹ï¼šå°æ›²åœ¨SåŸå¼€äº†ä¸€å®¶å¿«é€’åº—ï¼Œè´Ÿè´£åŒåŸå¿«é€æœåŠ¡ã€‚å°æ›²å› ä¸ºèµ„é‡‘é™åˆ¶ï¼Œé›‡ä½£äº†<strong>ä¸€æ‰¹</strong>å¿«é€’å‘˜ï¼Œç„¶åå°æ›²å‘ç°èµ„é‡‘ä¸å¤Ÿäº†ï¼Œåªå¤Ÿä¹°<strong>ä¸€è¾†</strong>è½¦é€å¿«é€’ã€‚</p>
<p><strong>ç»è¥æ–¹å¼ä¸€</strong> å®¢æˆ·æ¯é€æ¥ä¸€ä»½å¿«é€’ï¼Œå°æ›²å°±è®©ä¸€ä¸ªå¿«é€’å‘˜ç›¯ç€ï¼Œç„¶åå¿«é€’å‘˜å¼€è½¦å»é€å¿«é€’ã€‚æ…¢æ…¢çš„å°æ›²å°±å‘ç°äº†è¿™ç§ç»è¥æ–¹å¼å­˜åœ¨ä¸‹è¿°é—®é¢˜ â€“ å‡ åä¸ªå¿«é€’å‘˜åŸºæœ¬ä¸Šæ—¶é—´éƒ½èŠ±åœ¨äº†æŠ¢è½¦ä¸Šäº†ï¼Œå¤§éƒ¨åˆ†å¿«é€’å‘˜éƒ½å¤„åœ¨é—²ç½®çŠ¶æ€ï¼Œè°æŠ¢åˆ°äº†è½¦ï¼Œè°å°±èƒ½å»é€å¿«é€’ â€“ éšç€å¿«é€’çš„å¢å¤šï¼Œå¿«é€’å‘˜ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œå°æ›²å‘ç°å¿«é€’åº—é‡Œè¶Šæ¥è¶ŠæŒ¤ï¼Œæ²¡åŠæ³•é›‡ä½£æ–°çš„å¿«é€’å‘˜äº† â€“ å¿«é€’å‘˜ä¹‹é—´çš„åè°ƒå¾ˆèŠ±æ—¶é—´</p>
<p>ç»¼åˆä¸Šè¿°ç¼ºç‚¹ï¼Œå°æ›²ç—›å®šæ€ç—›ï¼Œæå‡ºäº†ä¸‹é¢çš„ç»è¥æ–¹å¼</p>
<p><strong>ç»è¥æ–¹å¼äºŒ</strong> å°æ›²åªé›‡ä½£ä¸€ä¸ªå¿«é€’å‘˜ã€‚ç„¶åå‘¢ï¼Œå®¢æˆ·é€æ¥çš„å¿«é€’ï¼Œå°æ›²æŒ‰<strong>é€è¾¾åœ°ç‚¹</strong>æ ‡æ³¨å¥½ï¼Œç„¶å<strong>ä¾æ¬¡</strong>æ”¾åœ¨ä¸€ä¸ªåœ°æ–¹ã€‚æœ€åï¼Œé‚£ä¸ªå¿«é€’å‘˜<strong>ä¾æ¬¡</strong>çš„å»å–å¿«é€’ï¼Œä¸€æ¬¡æ‹¿ä¸€ä¸ªï¼Œç„¶åå¼€ç€è½¦å»é€å¿«é€’ï¼Œé€å¥½äº†å°±å›æ¥æ‹¿ä¸‹ä¸€ä¸ªå¿«é€’ã€‚</p>
<p><strong>å¯¹æ¯”</strong> ä¸Šè¿°ä¸¤ç§ç»è¥æ–¹å¼å¯¹æ¯”ï¼Œæ˜¯ä¸æ˜¯æ˜æ˜¾è§‰å¾—ç¬¬äºŒç§ï¼Œæ•ˆç‡æ›´é«˜ï¼Œæ›´å¥½å‘¢ã€‚</p>
<p>åœ¨ä¸Šè¿°æ¯”å–»ä¸­:</p>
<ul>
<li>æ¯ä¸ªå¿«é€’å‘˜â€”â€”â€”â€”â€”â€”&gt;æ¯ä¸ªçº¿ç¨‹</li>
<li>æ¯ä¸ªå¿«é€’â€”â€”â€”â€”â€”â€”â€“&gt;æ¯ä¸ªsocket(I/Oæµ)</li>
<li>å¿«é€’çš„é€è¾¾åœ°ç‚¹â€”â€”â€”â€”â€“&gt;socketçš„ä¸åŒçŠ¶æ€</li>
<li>å®¢æˆ·é€å¿«é€’è¯·æ±‚â€”â€”â€”â€”â€“&gt;æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚</li>
<li>å°æ›²çš„ç»è¥æ–¹å¼â€”â€”â€”â€”â€“&gt;æœåŠ¡ç«¯è¿è¡Œçš„ä»£ç </li>
<li>ä¸€è¾†è½¦â€”â€”â€”â€”â€”â€”â€”-&gt;CPUçš„æ ¸æ•°</li>
</ul>
<p>äºæ˜¯æˆ‘ä»¬æœ‰å¦‚ä¸‹ç»“è®º</p>
<ol>
<li>ç»è¥æ–¹å¼ä¸€å°±æ˜¯ä¼ ç»Ÿçš„å¹¶å‘æ¨¡å‹ï¼Œæ¯ä¸ªI/Oæµ(å¿«é€’)éƒ½æœ‰ä¸€ä¸ªæ–°çš„çº¿ç¨‹(å¿«é€’å‘˜)ç®¡ç†ã€‚</li>
<li>ç»è¥æ–¹å¼äºŒå°±æ˜¯I/Oå¤šè·¯å¤ç”¨ã€‚åªæœ‰å•ä¸ªçº¿ç¨‹(ä¸€ä¸ªå¿«é€’å‘˜)ï¼Œé€šè¿‡è·Ÿè¸ªæ¯ä¸ªI/Oæµçš„çŠ¶æ€(æ¯ä¸ªå¿«é€’çš„é€è¾¾åœ°ç‚¹)ï¼Œæ¥ç®¡ç†å¤šä¸ªI/Oæµã€‚</li>
</ol>
<p>ä¸‹é¢ç±»æ¯”åˆ°çœŸå®çš„redisçº¿ç¨‹æ¨¡å‹ï¼Œå¦‚å›¾æ‰€ç¤º</p>
<p><a href="https://i0.wp.com/pic1.zhimg.com/80/v2-fa81e4bb9560b8ac6470bfa322f36a98_hd.jpg?w=640&ssl=1" title="Rediså¸¸è§é¢è¯•é¢˜ - ç¬¬5å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/pic1.zhimg.com/80/v2-fa81e4bb9560b8ac6470bfa322f36a98_hd.jpg?w=640&ssl=1" alt="Rediså¸¸è§é¢è¯•é¢˜ - ç¬¬5å¼   | å¼ å˜"></a></p>
<p>å‚ç…§ä¸Šå›¾ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯ã€‚æˆ‘ä»¬çš„redis-clientåœ¨æ“ä½œçš„æ—¶å€™ï¼Œä¼šäº§ç”Ÿå…·æœ‰ä¸åŒäº‹ä»¶ç±»å‹çš„socketã€‚åœ¨æœåŠ¡ç«¯ï¼Œæœ‰ä¸€æ®µI/0å¤šè·¯å¤ç”¨ç¨‹åºï¼Œå°†å…¶ç½®å…¥é˜Ÿåˆ—ä¹‹ä¸­ã€‚ç„¶åï¼Œæ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨ï¼Œä¾æ¬¡å»é˜Ÿåˆ—ä¸­å–ï¼Œè½¬å‘åˆ°ä¸åŒçš„äº‹ä»¶å¤„ç†å™¨ä¸­ã€‚ éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œè¿™ä¸ªI/Oå¤šè·¯å¤ç”¨æœºåˆ¶ï¼Œredisè¿˜æä¾›äº†selectã€epollã€evportã€kqueueç­‰å¤šè·¯å¤ç”¨å‡½æ•°åº“ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œå»äº†è§£ã€‚</p>
<h2 id="5ã€redisçš„è¿‡æœŸç­–ç•¥ä»¥åŠå†…å­˜æ·˜æ±°æœºåˆ¶"><a href="#5ã€redisçš„è¿‡æœŸç­–ç•¥ä»¥åŠå†…å­˜æ·˜æ±°æœºåˆ¶" class="headerlink" title="5ã€redisçš„è¿‡æœŸç­–ç•¥ä»¥åŠå†…å­˜æ·˜æ±°æœºåˆ¶"></a>5ã€redisçš„è¿‡æœŸç­–ç•¥ä»¥åŠå†…å­˜æ·˜æ±°æœºåˆ¶</h2><p><strong>åˆ†æ</strong>:è¿™ä¸ªé—®é¢˜å…¶å®ç›¸å½“é‡è¦ï¼Œåˆ°åº•redisæœ‰æ²¡ç”¨åˆ°å®¶ï¼Œè¿™ä¸ªé—®é¢˜å°±å¯ä»¥çœ‹å‡ºæ¥ã€‚æ¯”å¦‚ä½ redisåªèƒ½å­˜5Gæ•°æ®ï¼Œå¯æ˜¯ä½ å†™äº†10Gï¼Œé‚£ä¼šåˆ 5Gçš„æ•°æ®ã€‚æ€ä¹ˆåˆ çš„ï¼Œè¿™ä¸ªé—®é¢˜æ€è€ƒè¿‡ä¹ˆï¼Ÿè¿˜æœ‰ï¼Œä½ çš„æ•°æ®å·²ç»è®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼Œä½†æ˜¯æ—¶é—´åˆ°äº†ï¼Œå†…å­˜å ç”¨ç‡è¿˜æ˜¯æ¯”è¾ƒé«˜ï¼Œæœ‰æ€è€ƒè¿‡åŸå› ä¹ˆ?</p>
<p><strong>å›ç­”</strong>: redisé‡‡ç”¨çš„æ˜¯å®šæœŸåˆ é™¤+æƒ°æ€§åˆ é™¤ç­–ç•¥ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆä¸ç”¨å®šæ—¶åˆ é™¤ç­–ç•¥?</strong> å®šæ—¶åˆ é™¤,ç”¨ä¸€ä¸ªå®šæ—¶å™¨æ¥è´Ÿè´£ç›‘è§†key,è¿‡æœŸåˆ™è‡ªåŠ¨åˆ é™¤ã€‚è™½ç„¶å†…å­˜åŠæ—¶é‡Šæ”¾ï¼Œä½†æ˜¯ååˆ†æ¶ˆè€—CPUèµ„æºã€‚åœ¨å¤§å¹¶å‘è¯·æ±‚ä¸‹ï¼ŒCPUè¦å°†æ—¶é—´åº”ç”¨åœ¨å¤„ç†è¯·æ±‚ï¼Œè€Œä¸æ˜¯åˆ é™¤key,å› æ­¤æ²¡æœ‰é‡‡ç”¨è¿™ä¸€ç­–ç•¥.</p>
<p><strong>å®šæœŸåˆ é™¤+æƒ°æ€§åˆ é™¤æ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢?</strong></p>
<p>å®šæœŸåˆ é™¤ï¼Œredisé»˜è®¤æ¯ä¸ª100msæ£€æŸ¥ï¼Œæ˜¯å¦æœ‰è¿‡æœŸçš„key,æœ‰è¿‡æœŸkeyåˆ™åˆ é™¤ã€‚éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œredisä¸æ˜¯æ¯ä¸ª100mså°†æ‰€æœ‰çš„keyæ£€æŸ¥ä¸€æ¬¡ï¼Œè€Œæ˜¯éšæœºæŠ½å–è¿›è¡Œæ£€æŸ¥(å¦‚æœæ¯éš”100ms,å…¨éƒ¨keyè¿›è¡Œæ£€æŸ¥ï¼Œrediså²‚ä¸æ˜¯å¡æ­»)ã€‚å› æ­¤ï¼Œå¦‚æœåªé‡‡ç”¨å®šæœŸåˆ é™¤ç­–ç•¥ï¼Œä¼šå¯¼è‡´å¾ˆå¤škeyåˆ°æ—¶é—´æ²¡æœ‰åˆ é™¤ã€‚ äºæ˜¯ï¼Œæƒ°æ€§åˆ é™¤æ´¾ä¸Šç”¨åœºã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨ä½ è·å–æŸä¸ªkeyçš„æ—¶å€™ï¼Œredisä¼šæ£€æŸ¥ä¸€ä¸‹ï¼Œè¿™ä¸ªkeyå¦‚æœè®¾ç½®äº†è¿‡æœŸæ—¶é—´é‚£ä¹ˆæ˜¯å¦è¿‡æœŸäº†ï¼Ÿå¦‚æœè¿‡æœŸäº†æ­¤æ—¶å°±ä¼šåˆ é™¤ã€‚</p>
<p><strong>é‡‡ç”¨å®šæœŸåˆ é™¤+æƒ°æ€§åˆ é™¤å°±æ²¡å…¶ä»–é—®é¢˜äº†ä¹ˆ?</strong></p>
<p>ä¸æ˜¯çš„ï¼Œå¦‚æœå®šæœŸåˆ é™¤æ²¡åˆ é™¤keyã€‚ç„¶åä½ ä¹Ÿæ²¡å³æ—¶å»è¯·æ±‚keyï¼Œä¹Ÿå°±æ˜¯è¯´æƒ°æ€§åˆ é™¤ä¹Ÿæ²¡ç”Ÿæ•ˆã€‚è¿™æ ·ï¼Œredisçš„å†…å­˜ä¼šè¶Šæ¥è¶Šé«˜ã€‚é‚£ä¹ˆå°±åº”è¯¥é‡‡ç”¨<strong>å†…å­˜æ·˜æ±°æœºåˆ¶</strong>ã€‚ åœ¨redis.confä¸­æœ‰ä¸€è¡Œé…ç½®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># maxmemory-policy volatile-lru</span><br></pre></td></tr></table></figure>

<p>è¯¥é…ç½®å°±æ˜¯é…å†…å­˜æ·˜æ±°ç­–ç•¥çš„(ä»€ä¹ˆï¼Œä½ æ²¡é…è¿‡ï¼Ÿå¥½å¥½åçœä¸€ä¸‹è‡ªå·±)</p>
<p>1ï¼‰noevictionï¼šå½“å†…å­˜ä¸è¶³ä»¥å®¹çº³æ–°å†™å…¥æ•°æ®æ—¶ï¼Œæ–°å†™å…¥æ“ä½œä¼šæŠ¥é”™ã€‚<strong>åº”è¯¥æ²¡äººç”¨å§ã€‚</strong></p>
<p>2ï¼‰allkeys-lruï¼šå½“å†…å­˜ä¸è¶³ä»¥å®¹çº³æ–°å†™å…¥æ•°æ®æ—¶ï¼Œåœ¨é”®ç©ºé—´ä¸­ï¼Œç§»é™¤æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„keyã€‚<strong>æ¨èä½¿ç”¨ï¼Œç›®å‰é¡¹ç›®åœ¨ç”¨è¿™ç§ã€‚</strong></p>
<p>3ï¼‰allkeys-randomï¼šå½“å†…å­˜ä¸è¶³ä»¥å®¹çº³æ–°å†™å…¥æ•°æ®æ—¶ï¼Œåœ¨é”®ç©ºé—´ä¸­ï¼Œéšæœºç§»é™¤æŸä¸ªkeyã€‚<strong>åº”è¯¥ä¹Ÿæ²¡äººç”¨å§ï¼Œä½ ä¸åˆ æœ€å°‘ä½¿ç”¨Key,å»éšæœºåˆ ã€‚</strong></p>
<p>4ï¼‰volatile-lruï¼šå½“å†…å­˜ä¸è¶³ä»¥å®¹çº³æ–°å†™å…¥æ•°æ®æ—¶ï¼Œåœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ä¸­ï¼Œç§»é™¤æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„keyã€‚<strong>è¿™ç§æƒ…å†µä¸€èˆ¬æ˜¯æŠŠredisæ—¢å½“ç¼“å­˜ï¼ŒåˆåšæŒä¹…åŒ–å­˜å‚¨çš„æ—¶å€™æ‰ç”¨ã€‚ä¸æ¨è</strong></p>
<p>5ï¼‰volatile-randomï¼šå½“å†…å­˜ä¸è¶³ä»¥å®¹çº³æ–°å†™å…¥æ•°æ®æ—¶ï¼Œåœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ä¸­ï¼Œéšæœºç§»é™¤æŸä¸ªkeyã€‚<strong>ä¾ç„¶ä¸æ¨è</strong> 6ï¼‰volatile-ttlï¼šå½“å†…å­˜ä¸è¶³ä»¥å®¹çº³æ–°å†™å…¥æ•°æ®æ—¶ï¼Œåœ¨è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ä¸­ï¼Œæœ‰æ›´æ—©è¿‡æœŸæ—¶é—´çš„keyä¼˜å…ˆç§»é™¤ã€‚<strong>ä¸æ¨è</strong> psï¼šå¦‚æœæ²¡æœ‰è®¾ç½® expire çš„key, ä¸æ»¡è¶³å…ˆå†³æ¡ä»¶(prerequisites); é‚£ä¹ˆ volatile-lru, volatile-random å’Œ volatile-ttl ç­–ç•¥çš„è¡Œä¸º, å’Œ noeviction(ä¸åˆ é™¤) åŸºæœ¬ä¸Šä¸€è‡´ã€‚</p>
<h2 id="6ã€rediså’Œæ•°æ®åº“åŒå†™ä¸€è‡´æ€§é—®é¢˜"><a href="#6ã€rediså’Œæ•°æ®åº“åŒå†™ä¸€è‡´æ€§é—®é¢˜" class="headerlink" title="6ã€rediså’Œæ•°æ®åº“åŒå†™ä¸€è‡´æ€§é—®é¢˜"></a>6ã€rediså’Œæ•°æ®åº“åŒå†™ä¸€è‡´æ€§é—®é¢˜</h2><p><strong>åˆ†æ</strong>:ä¸€è‡´æ€§é—®é¢˜æ˜¯åˆ†å¸ƒå¼å¸¸è§é—®é¢˜ï¼Œè¿˜å¯ä»¥å†åˆ†ä¸ºæœ€ç»ˆä¸€è‡´æ€§å’Œå¼ºä¸€è‡´æ€§ã€‚æ•°æ®åº“å’Œç¼“å­˜åŒå†™ï¼Œå°±å¿…ç„¶ä¼šå­˜åœ¨ä¸ä¸€è‡´çš„é—®é¢˜ã€‚ç­”è¿™ä¸ªé—®é¢˜ï¼Œå…ˆæ˜ç™½ä¸€ä¸ªå‰æã€‚å°±æ˜¯<strong>å¦‚æœå¯¹æ•°æ®æœ‰å¼ºä¸€è‡´æ€§è¦æ±‚ï¼Œä¸èƒ½æ”¾ç¼“å­˜ã€‚</strong>æˆ‘ä»¬æ‰€åšçš„ä¸€åˆ‡ï¼Œåªèƒ½ä¿è¯æœ€ç»ˆä¸€è‡´æ€§ã€‚å¦å¤–ï¼Œæˆ‘ä»¬æ‰€åšçš„æ–¹æ¡ˆå…¶å®ä»æ ¹æœ¬ä¸Šæ¥è¯´ï¼Œåªèƒ½è¯´<strong>é™ä½ä¸ä¸€è‡´å‘ç”Ÿçš„æ¦‚ç‡</strong>ï¼Œæ— æ³•å®Œå…¨é¿å…ã€‚å› æ­¤ï¼Œæœ‰å¼ºä¸€è‡´æ€§è¦æ±‚çš„æ•°æ®ï¼Œä¸èƒ½æ”¾ç¼“å­˜ã€‚</p>
<p><strong>å›ç­”</strong>:<a href="http://link.zhihu.com/?target=https://www.cnblogs.com/rjzheng/p/9041659.html">ã€Šåˆ†å¸ƒå¼ä¹‹æ•°æ®åº“å’Œç¼“å­˜åŒå†™ä¸€è‡´æ€§æ–¹æ¡ˆè§£æã€‹</a>ç»™å‡ºäº†è¯¦ç»†çš„åˆ†æï¼Œåœ¨è¿™é‡Œç®€å•çš„è¯´ä¸€è¯´ã€‚é¦–å…ˆï¼Œé‡‡å–æ­£ç¡®æ›´æ–°ç­–ç•¥ï¼Œå…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜ã€‚å…¶æ¬¡ï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨åˆ é™¤ç¼“å­˜å¤±è´¥çš„é—®é¢˜ï¼Œæä¾›ä¸€ä¸ªè¡¥å¿æªæ–½å³å¯ï¼Œä¾‹å¦‚åˆ©ç”¨æ¶ˆæ¯é˜Ÿåˆ—ã€‚</p>
<h2 id="7ã€å¦‚ä½•åº”å¯¹ç¼“å­˜ç©¿é€å’Œç¼“å­˜é›ªå´©é—®é¢˜"><a href="#7ã€å¦‚ä½•åº”å¯¹ç¼“å­˜ç©¿é€å’Œç¼“å­˜é›ªå´©é—®é¢˜" class="headerlink" title="7ã€å¦‚ä½•åº”å¯¹ç¼“å­˜ç©¿é€å’Œç¼“å­˜é›ªå´©é—®é¢˜"></a>7ã€å¦‚ä½•åº”å¯¹ç¼“å­˜ç©¿é€å’Œç¼“å­˜é›ªå´©é—®é¢˜</h2><p><strong>åˆ†æ</strong>:è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œè¯´å¥å®åœ¨è¯ï¼Œä¸€èˆ¬ä¸­å°å‹ä¼ ç»Ÿè½¯ä»¶ä¼ä¸šï¼Œå¾ˆéš¾ç¢°åˆ°è¿™ä¸ªé—®é¢˜ã€‚å¦‚æœæœ‰å¤§å¹¶å‘çš„é¡¹ç›®ï¼Œæµé‡æœ‰å‡ ç™¾ä¸‡å·¦å³ã€‚è¿™ä¸¤ä¸ªé—®é¢˜ä¸€å®šè¦æ·±åˆ»è€ƒè™‘ã€‚</p>
<p><strong>å›ç­”</strong>:å¦‚ä¸‹æ‰€ç¤º</p>
<p><strong>ç¼“å­˜ç©¿é€</strong>ï¼Œå³é»‘å®¢æ•…æ„å»è¯·æ±‚ç¼“å­˜ä¸­ä¸å­˜åœ¨çš„æ•°æ®ï¼Œå¯¼è‡´æ‰€æœ‰çš„è¯·æ±‚éƒ½æ€¼åˆ°æ•°æ®åº“ä¸Šï¼Œä»è€Œæ•°æ®åº“è¿æ¥å¼‚å¸¸ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>: (ä¸€)åˆ©ç”¨äº’æ–¥é”ï¼Œç¼“å­˜å¤±æ•ˆçš„æ—¶å€™ï¼Œå…ˆå»è·å¾—é”ï¼Œå¾—åˆ°é”äº†ï¼Œå†å»è¯·æ±‚æ•°æ®åº“ã€‚æ²¡å¾—åˆ°é”ï¼Œåˆ™ä¼‘çœ ä¸€æ®µæ—¶é—´é‡è¯• (äºŒ)é‡‡ç”¨å¼‚æ­¥æ›´æ–°ç­–ç•¥ï¼Œæ— è®ºkeyæ˜¯å¦å–åˆ°å€¼ï¼Œéƒ½ç›´æ¥è¿”å›ã€‚valueå€¼ä¸­ç»´æŠ¤ä¸€ä¸ªç¼“å­˜å¤±æ•ˆæ—¶é—´ï¼Œç¼“å­˜å¦‚æœè¿‡æœŸï¼Œå¼‚æ­¥èµ·ä¸€ä¸ªçº¿ç¨‹å»è¯»æ•°æ®åº“ï¼Œæ›´æ–°ç¼“å­˜ã€‚éœ€è¦åš<strong>ç¼“å­˜é¢„çƒ­</strong>(é¡¹ç›®å¯åŠ¨å‰ï¼Œå…ˆåŠ è½½ç¼“å­˜)æ“ä½œã€‚ (ä¸‰)æä¾›ä¸€ä¸ªèƒ½è¿…é€Ÿåˆ¤æ–­è¯·æ±‚æ˜¯å¦æœ‰æ•ˆçš„æ‹¦æˆªæœºåˆ¶ï¼Œæ¯”å¦‚ï¼Œåˆ©ç”¨å¸ƒéš†è¿‡æ»¤å™¨ï¼Œå†…éƒ¨ç»´æŠ¤ä¸€ç³»åˆ—åˆæ³•æœ‰æ•ˆçš„keyã€‚è¿…é€Ÿåˆ¤æ–­å‡ºï¼Œè¯·æ±‚æ‰€æºå¸¦çš„Keyæ˜¯å¦åˆæ³•æœ‰æ•ˆã€‚å¦‚æœä¸åˆæ³•ï¼Œåˆ™ç›´æ¥è¿”å›ã€‚</p>
<p><strong>ç¼“å­˜é›ªå´©</strong>ï¼Œå³ç¼“å­˜åŒä¸€æ—¶é—´å¤§é¢ç§¯çš„å¤±æ•ˆï¼Œè¿™ä¸ªæ—¶å€™åˆæ¥äº†ä¸€æ³¢è¯·æ±‚ï¼Œç»“æœè¯·æ±‚éƒ½æ€¼åˆ°æ•°æ®åº“ä¸Šï¼Œä»è€Œå¯¼è‡´æ•°æ®åº“è¿æ¥å¼‚å¸¸ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>: (ä¸€)ç»™ç¼“å­˜çš„å¤±æ•ˆæ—¶é—´ï¼ŒåŠ ä¸Šä¸€ä¸ªéšæœºå€¼ï¼Œé¿å…é›†ä½“å¤±æ•ˆã€‚ (äºŒ)ä½¿ç”¨äº’æ–¥é”ï¼Œä½†æ˜¯è¯¥æ–¹æ¡ˆååé‡æ˜æ˜¾ä¸‹é™äº†ã€‚ (ä¸‰)åŒç¼“å­˜ã€‚æˆ‘ä»¬æœ‰ä¸¤ä¸ªç¼“å­˜ï¼Œç¼“å­˜Aå’Œç¼“å­˜Bã€‚ç¼“å­˜Açš„å¤±æ•ˆæ—¶é—´ä¸º20åˆ†é’Ÿï¼Œç¼“å­˜Bä¸è®¾å¤±æ•ˆæ—¶é—´ã€‚è‡ªå·±åšç¼“å­˜é¢„çƒ­æ“ä½œã€‚ç„¶åç»†åˆ†ä»¥ä¸‹å‡ ä¸ªå°ç‚¹ â€“ I ä»ç¼“å­˜Aè¯»æ•°æ®åº“ï¼Œæœ‰åˆ™ç›´æ¥è¿”å› â€“ II Aæ²¡æœ‰æ•°æ®ï¼Œç›´æ¥ä»Bè¯»æ•°æ®ï¼Œç›´æ¥è¿”å›ï¼Œå¹¶ä¸”å¼‚æ­¥å¯åŠ¨ä¸€ä¸ªæ›´æ–°çº¿ç¨‹ã€‚ â€“ III æ›´æ–°çº¿ç¨‹åŒæ—¶æ›´æ–°ç¼“å­˜Aå’Œç¼“å­˜Bã€‚</p>
<h2 id="8ã€å¦‚ä½•è§£å†³redisçš„å¹¶å‘ç«äº‰keyé—®é¢˜"><a href="#8ã€å¦‚ä½•è§£å†³redisçš„å¹¶å‘ç«äº‰keyé—®é¢˜" class="headerlink" title="8ã€å¦‚ä½•è§£å†³redisçš„å¹¶å‘ç«äº‰keyé—®é¢˜"></a>8ã€å¦‚ä½•è§£å†³redisçš„å¹¶å‘ç«äº‰keyé—®é¢˜</h2><p><strong>åˆ†æ</strong>:è¿™ä¸ªé—®é¢˜å¤§è‡´å°±æ˜¯ï¼ŒåŒæ—¶æœ‰å¤šä¸ªå­ç³»ç»Ÿå»setä¸€ä¸ªkeyã€‚è¿™ä¸ªæ—¶å€™è¦æ³¨æ„ä»€ä¹ˆå‘¢ï¼Ÿå¤§å®¶æ€è€ƒè¿‡ä¹ˆã€‚éœ€è¦è¯´æ˜ä¸€ä¸‹ï¼Œåšä¸»æå‰ç™¾åº¦äº†ä¸€ä¸‹ï¼Œå‘ç°ç­”æ¡ˆåŸºæœ¬éƒ½æ˜¯æ¨èç”¨redisäº‹åŠ¡æœºåˆ¶ã€‚åšä¸»<strong>ä¸æ¨èä½¿ç”¨redisçš„äº‹åŠ¡æœºåˆ¶ã€‚</strong>å› ä¸ºæˆ‘ä»¬çš„ç”Ÿäº§ç¯å¢ƒï¼ŒåŸºæœ¬éƒ½æ˜¯redisé›†ç¾¤ç¯å¢ƒï¼Œåšäº†æ•°æ®åˆ†ç‰‡æ“ä½œã€‚ä½ ä¸€ä¸ªäº‹åŠ¡ä¸­æœ‰æ¶‰åŠåˆ°å¤šä¸ªkeyæ“ä½œçš„æ—¶å€™ï¼Œè¿™å¤šä¸ªkeyä¸ä¸€å®šéƒ½å­˜å‚¨åœ¨åŒä¸€ä¸ªredis-serverä¸Šã€‚å› æ­¤ï¼Œ<strong>redisçš„äº‹åŠ¡æœºåˆ¶ï¼Œååˆ†é¸¡è‚‹ã€‚</strong></p>
<p>**å›ç­”:**å¦‚ä¸‹æ‰€ç¤º</p>
<p>(1)å¦‚æœå¯¹è¿™ä¸ªkeyæ“ä½œï¼Œ<strong>ä¸è¦æ±‚é¡ºåº</strong> è¿™ç§æƒ…å†µä¸‹ï¼Œå‡†å¤‡ä¸€ä¸ªåˆ†å¸ƒå¼é”ï¼Œå¤§å®¶å»æŠ¢é”ï¼ŒæŠ¢åˆ°é”å°±åšsetæ“ä½œå³å¯ï¼Œæ¯”è¾ƒç®€å•ã€‚</p>
<p>(2)å¦‚æœå¯¹è¿™ä¸ªkeyæ“ä½œï¼Œ<strong>è¦æ±‚é¡ºåº</strong> å‡è®¾æœ‰ä¸€ä¸ªkey1,ç³»ç»ŸAéœ€è¦å°†key1è®¾ç½®ä¸ºvalueA,ç³»ç»ŸBéœ€è¦å°†key1è®¾ç½®ä¸ºvalueB,ç³»ç»ŸCéœ€è¦å°†key1è®¾ç½®ä¸ºvalueC. æœŸæœ›æŒ‰ç…§key1çš„valueå€¼æŒ‰ç…§ valueAâ€“&gt;valueBâ€“&gt;valueCçš„é¡ºåºå˜åŒ–ã€‚è¿™ç§æ—¶å€™æˆ‘ä»¬åœ¨æ•°æ®å†™å…¥æ•°æ®åº“çš„æ—¶å€™ï¼Œéœ€è¦ä¿å­˜ä¸€ä¸ªæ—¶é—´æˆ³ã€‚å‡è®¾æ—¶é—´æˆ³å¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç³»ç»ŸA key 1 &#123;valueA  3:00&#125;</span><br><span class="line">ç³»ç»ŸB key 1 &#123;valueB  3:05&#125;</span><br><span class="line">ç³»ç»ŸC key 1 &#123;valueC  3:10&#125;</span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆï¼Œå‡è®¾è¿™ä¼šç³»ç»ŸBå…ˆæŠ¢åˆ°é”ï¼Œå°†key1è®¾ç½®ä¸º{valueB 3:05}ã€‚æ¥ä¸‹æ¥ç³»ç»ŸAæŠ¢åˆ°é”ï¼Œå‘ç°è‡ªå·±çš„valueAçš„æ—¶é—´æˆ³æ—©äºç¼“å­˜ä¸­çš„æ—¶é—´æˆ³ï¼Œé‚£å°±ä¸åšsetæ“ä½œäº†ã€‚ä»¥æ­¤ç±»æ¨ã€‚</p>
<p>å…¶ä»–æ–¹æ³•ï¼Œæ¯”å¦‚åˆ©ç”¨é˜Ÿåˆ—ï¼Œå°†setæ–¹æ³•å˜æˆä¸²è¡Œè®¿é—®ä¹Ÿå¯ä»¥ã€‚æ€»ä¹‹ï¼Œçµæ´»å˜é€šã€‚</p>
<h1 id="ã€åŸåˆ›ã€‘åˆ†å¸ƒå¼ä¹‹æ•°æ®åº“å’Œç¼“å­˜åŒå†™ä¸€è‡´æ€§æ–¹æ¡ˆè§£æ"><a href="#ã€åŸåˆ›ã€‘åˆ†å¸ƒå¼ä¹‹æ•°æ®åº“å’Œç¼“å­˜åŒå†™ä¸€è‡´æ€§æ–¹æ¡ˆè§£æ" class="headerlink" title="ã€åŸåˆ›ã€‘åˆ†å¸ƒå¼ä¹‹æ•°æ®åº“å’Œç¼“å­˜åŒå†™ä¸€è‡´æ€§æ–¹æ¡ˆè§£æ"></a><a href="https://www.cnblogs.com/rjzheng/p/9041659.html">ã€åŸåˆ›ã€‘åˆ†å¸ƒå¼ä¹‹æ•°æ®åº“å’Œç¼“å­˜åŒå†™ä¸€è‡´æ€§æ–¹æ¡ˆè§£æ</a></h1><h2 id="å¼•è¨€-1"><a href="#å¼•è¨€-1" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><h3 id="ä¸ºä»€ä¹ˆå†™è¿™ç¯‡æ–‡ç« ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆå†™è¿™ç¯‡æ–‡ç« ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆå†™è¿™ç¯‡æ–‡ç« ï¼Ÿ"></a>ä¸ºä»€ä¹ˆå†™è¿™ç¯‡æ–‡ç« ï¼Ÿ</h3><p><a href="https://i0.wp.com/images.cnblogs.com/cnblogs_com/rjzheng/1202350/o_getkeyflow.png?w=640&ssl=1" title="Rediså¸¸è§é¢è¯•é¢˜ - ç¬¬6å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/images.cnblogs.com/cnblogs_com/rjzheng/1202350/o_getkeyflow.png?w=640&ssl=1" alt="Rediså¸¸è§é¢è¯•é¢˜ - ç¬¬6å¼   | å¼ å˜"></a></p>
<p>é¦–å…ˆï¼Œç¼“å­˜ç”±äºå…¶é«˜å¹¶å‘å’Œé«˜æ€§èƒ½çš„ç‰¹æ€§ï¼Œå·²ç»åœ¨é¡¹ç›®ä¸­è¢«å¹¿æ³›ä½¿ç”¨ã€‚åœ¨è¯»å–ç¼“å­˜æ–¹é¢ï¼Œå¤§å®¶æ²¡å•¥ç–‘é—®ï¼Œéƒ½æ˜¯æŒ‰ç…§ä¸‹å›¾çš„æµç¨‹æ¥è¿›è¡Œä¸šåŠ¡æ“ä½œã€‚</p>
<p>ä½†æ˜¯åœ¨æ›´æ–°ç¼“å­˜æ–¹é¢ï¼Œå¯¹äºæ›´æ–°å®Œæ•°æ®åº“ï¼Œæ˜¯æ›´æ–°ç¼“å­˜å‘¢ï¼Œè¿˜æ˜¯åˆ é™¤ç¼“å­˜ã€‚åˆæˆ–è€…æ˜¯å…ˆåˆ é™¤ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“ï¼Œå…¶å®å¤§å®¶å­˜åœ¨å¾ˆå¤§çš„äº‰è®®ã€‚ç›®å‰æ²¡æœ‰ä¸€ç¯‡å…¨é¢çš„åšå®¢ï¼Œå¯¹è¿™å‡ ç§æ–¹æ¡ˆè¿›è¡Œè§£æã€‚äºæ˜¯åšä¸»æˆ˜æˆ˜å…¢å…¢ï¼Œé¡¶ç€è¢«å¤§å®¶å–·çš„é£é™©ï¼Œå†™äº†è¿™ç¯‡æ–‡ç« ã€‚</p>
<h3 id="æ–‡ç« ç»“æ„"><a href="#æ–‡ç« ç»“æ„" class="headerlink" title="æ–‡ç« ç»“æ„"></a>æ–‡ç« ç»“æ„</h3><p>æœ¬æ–‡ç”±ä»¥ä¸‹ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆ<br>1ã€è®²è§£ç¼“å­˜æ›´æ–°ç­–ç•¥<br>2ã€å¯¹æ¯ç§ç­–ç•¥è¿›è¡Œç¼ºç‚¹åˆ†æ<br>3ã€é’ˆå¯¹ç¼ºç‚¹ç»™å‡ºæ”¹è¿›æ–¹æ¡ˆ</p>
<h2 id="æ­£æ–‡-1"><a href="#æ­£æ–‡-1" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>å…ˆåšä¸€ä¸ªè¯´æ˜ï¼Œä»ç†è®ºä¸Šæ¥è¯´ï¼Œç»™ç¼“å­˜è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œæ˜¯ä¿è¯æœ€ç»ˆä¸€è‡´æ€§çš„è§£å†³æ–¹æ¡ˆã€‚è¿™ç§æ–¹æ¡ˆä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å­˜å…¥ç¼“å­˜çš„æ•°æ®è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œæ‰€æœ‰çš„å†™æ“ä½œä»¥æ•°æ®åº“ä¸ºå‡†ï¼Œå¯¹ç¼“å­˜æ“ä½œåªæ˜¯å°½æœ€å¤§åŠªåŠ›å³å¯ã€‚ä¹Ÿå°±æ˜¯è¯´å¦‚æœæ•°æ®åº“å†™æˆåŠŸï¼Œç¼“å­˜æ›´æ–°å¤±è´¥ï¼Œé‚£ä¹ˆåªè¦åˆ°è¾¾è¿‡æœŸæ—¶é—´ï¼Œåˆ™åé¢çš„è¯»è¯·æ±‚è‡ªç„¶ä¼šä»æ•°æ®åº“ä¸­è¯»å–æ–°å€¼ç„¶åå›å¡«ç¼“å­˜ã€‚å› æ­¤ï¼Œæ¥ä¸‹æ¥è®¨è®ºçš„æ€è·¯ä¸ä¾èµ–äºç»™ç¼“å­˜è®¾ç½®è¿‡æœŸæ—¶é—´è¿™ä¸ªæ–¹æ¡ˆã€‚<br>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è®¨è®º<strong>ä¸‰ç§</strong>æ›´æ–°ç­–ç•¥ï¼š</p>
<ol>
<li>å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†æ›´æ–°ç¼“å­˜</li>
<li>å…ˆåˆ é™¤ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“</li>
<li>å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜</li>
</ol>
<p>åº”è¯¥æ²¡äººé—®æˆ‘ï¼Œä¸ºä»€ä¹ˆæ²¡æœ‰å…ˆæ›´æ–°ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“è¿™ç§ç­–ç•¥ã€‚</p>
<h3 id="1-å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†æ›´æ–°ç¼“å­˜"><a href="#1-å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†æ›´æ–°ç¼“å­˜" class="headerlink" title="(1)å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†æ›´æ–°ç¼“å­˜"></a>(1)å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†æ›´æ–°ç¼“å­˜</h3><p>è¿™å¥—æ–¹æ¡ˆï¼Œå¤§å®¶æ˜¯æ™®éåå¯¹çš„ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæœ‰å¦‚ä¸‹ä¸¤ç‚¹åŸå› ã€‚<br><strong>åŸå› ä¸€ï¼ˆçº¿ç¨‹å®‰å…¨è§’åº¦ï¼‰</strong><br>åŒæ—¶æœ‰è¯·æ±‚Aå’Œè¯·æ±‚Bè¿›è¡Œæ›´æ–°æ“ä½œï¼Œé‚£ä¹ˆä¼šå‡ºç°<br>ï¼ˆ1ï¼‰çº¿ç¨‹Aæ›´æ–°äº†æ•°æ®åº“<br>ï¼ˆ2ï¼‰çº¿ç¨‹Bæ›´æ–°äº†æ•°æ®åº“<br>ï¼ˆ3ï¼‰çº¿ç¨‹Bæ›´æ–°äº†ç¼“å­˜<br>ï¼ˆ4ï¼‰çº¿ç¨‹Aæ›´æ–°äº†ç¼“å­˜<br>è¿™å°±å‡ºç°è¯·æ±‚Aæ›´æ–°ç¼“å­˜åº”è¯¥æ¯”è¯·æ±‚Bæ›´æ–°ç¼“å­˜æ—©æ‰å¯¹ï¼Œä½†æ˜¯å› ä¸ºç½‘ç»œç­‰åŸå› ï¼ŒBå´æ¯”Aæ›´æ—©æ›´æ–°äº†ç¼“å­˜ã€‚è¿™å°±å¯¼è‡´äº†è„æ•°æ®ï¼Œå› æ­¤ä¸è€ƒè™‘ã€‚<br><strong>åŸå› äºŒï¼ˆä¸šåŠ¡åœºæ™¯è§’åº¦ï¼‰</strong><br>æœ‰å¦‚ä¸‹ä¸¤ç‚¹ï¼š<br>ï¼ˆ1ï¼‰å¦‚æœä½ æ˜¯ä¸€ä¸ªå†™æ•°æ®åº“åœºæ™¯æ¯”è¾ƒå¤šï¼Œè€Œè¯»æ•°æ®åœºæ™¯æ¯”è¾ƒå°‘çš„ä¸šåŠ¡éœ€æ±‚ï¼Œé‡‡ç”¨è¿™ç§æ–¹æ¡ˆå°±ä¼šå¯¼è‡´ï¼Œæ•°æ®å‹æ ¹è¿˜æ²¡è¯»åˆ°ï¼Œç¼“å­˜å°±è¢«é¢‘ç¹çš„æ›´æ–°ï¼Œæµªè´¹æ€§èƒ½ã€‚<br>ï¼ˆ2ï¼‰å¦‚æœä½ å†™å…¥æ•°æ®åº“çš„å€¼ï¼Œå¹¶ä¸æ˜¯ç›´æ¥å†™å…¥ç¼“å­˜çš„ï¼Œè€Œæ˜¯è¦ç»è¿‡ä¸€ç³»åˆ—å¤æ‚çš„è®¡ç®—å†å†™å…¥ç¼“å­˜ã€‚é‚£ä¹ˆï¼Œæ¯æ¬¡å†™å…¥æ•°æ®åº“åï¼Œéƒ½å†æ¬¡è®¡ç®—å†™å…¥ç¼“å­˜çš„å€¼ï¼Œæ— ç–‘æ˜¯æµªè´¹æ€§èƒ½çš„ã€‚æ˜¾ç„¶ï¼Œåˆ é™¤ç¼“å­˜æ›´ä¸ºé€‚åˆã€‚</p>
<p>æ¥ä¸‹æ¥è®¨è®ºçš„å°±æ˜¯äº‰è®®æœ€å¤§çš„ï¼Œå…ˆåˆ ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“ã€‚è¿˜æ˜¯å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜çš„é—®é¢˜ã€‚</p>
<h3 id="2-å…ˆåˆ ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“"><a href="#2-å…ˆåˆ ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“" class="headerlink" title="(2)å…ˆåˆ ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“"></a>(2)å…ˆåˆ ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“</h3><p>è¯¥æ–¹æ¡ˆä¼šå¯¼è‡´ä¸ä¸€è‡´çš„åŸå› æ˜¯ã€‚åŒæ—¶æœ‰ä¸€ä¸ªè¯·æ±‚Aè¿›è¡Œæ›´æ–°æ“ä½œï¼Œå¦ä¸€ä¸ªè¯·æ±‚Bè¿›è¡ŒæŸ¥è¯¢æ“ä½œã€‚é‚£ä¹ˆä¼šå‡ºç°å¦‚ä¸‹æƒ…å½¢:<br>ï¼ˆ1ï¼‰è¯·æ±‚Aè¿›è¡Œå†™æ“ä½œï¼Œåˆ é™¤ç¼“å­˜<br>ï¼ˆ2ï¼‰è¯·æ±‚BæŸ¥è¯¢å‘ç°ç¼“å­˜ä¸å­˜åœ¨<br>ï¼ˆ3ï¼‰è¯·æ±‚Bå»æ•°æ®åº“æŸ¥è¯¢å¾—åˆ°æ—§å€¼<br>ï¼ˆ4ï¼‰è¯·æ±‚Bå°†æ—§å€¼å†™å…¥ç¼“å­˜<br>ï¼ˆ5ï¼‰è¯·æ±‚Aå°†æ–°å€¼å†™å…¥æ•°æ®åº“<br>ä¸Šè¿°æƒ…å†µå°±ä¼šå¯¼è‡´ä¸ä¸€è‡´çš„æƒ…å½¢å‡ºç°ã€‚è€Œä¸”ï¼Œå¦‚æœä¸é‡‡ç”¨ç»™ç¼“å­˜è®¾ç½®è¿‡æœŸæ—¶é—´ç­–ç•¥ï¼Œè¯¥æ•°æ®æ°¸è¿œéƒ½æ˜¯è„æ•°æ®ã€‚<br>é‚£ä¹ˆï¼Œ<strong>å¦‚ä½•è§£å†³å‘¢ï¼Ÿé‡‡ç”¨å»¶æ—¶åŒåˆ ç­–ç•¥</strong><br>ä¼ªä»£ç å¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public void write(String key,Object data)&#123;</span><br><span class="line">        redis.delKey(key);</span><br><span class="line">        db.updateData(data);</span><br><span class="line">        Thread.sleep(1000);</span><br><span class="line">        redis.delKey(key);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>è½¬åŒ–ä¸ºä¸­æ–‡æè¿°å°±æ˜¯<br>ï¼ˆ1ï¼‰å…ˆæ·˜æ±°ç¼“å­˜<br>ï¼ˆ2ï¼‰å†å†™æ•°æ®åº“ï¼ˆè¿™ä¸¤æ­¥å’ŒåŸæ¥ä¸€æ ·ï¼‰<br>ï¼ˆ3ï¼‰ä¼‘çœ 1ç§’ï¼Œå†æ¬¡æ·˜æ±°ç¼“å­˜<br>è¿™ä¹ˆåšï¼Œå¯ä»¥å°†1ç§’å†…æ‰€é€ æˆçš„ç¼“å­˜è„æ•°æ®ï¼Œå†æ¬¡åˆ é™¤ã€‚<br><strong>é‚£ä¹ˆï¼Œè¿™ä¸ª1ç§’æ€ä¹ˆç¡®å®šçš„ï¼Œå…·ä½“è¯¥ä¼‘çœ å¤šä¹…å‘¢ï¼Ÿ</strong><br>é’ˆå¯¹ä¸Šé¢çš„æƒ…å½¢ï¼Œè¯»è€…åº”è¯¥è‡ªè¡Œè¯„ä¼°è‡ªå·±çš„é¡¹ç›®çš„è¯»æ•°æ®ä¸šåŠ¡é€»è¾‘çš„è€—æ—¶ã€‚ç„¶åå†™æ•°æ®çš„ä¼‘çœ æ—¶é—´åˆ™åœ¨è¯»æ•°æ®ä¸šåŠ¡é€»è¾‘çš„è€—æ—¶åŸºç¡€ä¸Šï¼ŒåŠ å‡ ç™¾mså³å¯ã€‚è¿™ä¹ˆåšçš„ç›®çš„ï¼Œå°±æ˜¯ç¡®ä¿è¯»è¯·æ±‚ç»“æŸï¼Œå†™è¯·æ±‚å¯ä»¥åˆ é™¤è¯»è¯·æ±‚é€ æˆçš„ç¼“å­˜è„æ•°æ®ã€‚<br><strong>å¦‚æœä½ ç”¨äº†mysqlçš„è¯»å†™åˆ†ç¦»æ¶æ„æ€ä¹ˆåŠï¼Ÿ</strong><br>okï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé€ æˆæ•°æ®ä¸ä¸€è‡´çš„åŸå› å¦‚ä¸‹ï¼Œè¿˜æ˜¯ä¸¤ä¸ªè¯·æ±‚ï¼Œä¸€ä¸ªè¯·æ±‚Aè¿›è¡Œæ›´æ–°æ“ä½œï¼Œå¦ä¸€ä¸ªè¯·æ±‚Bè¿›è¡ŒæŸ¥è¯¢æ“ä½œã€‚<br>ï¼ˆ1ï¼‰è¯·æ±‚Aè¿›è¡Œå†™æ“ä½œï¼Œåˆ é™¤ç¼“å­˜<br>ï¼ˆ2ï¼‰è¯·æ±‚Aå°†æ•°æ®å†™å…¥æ•°æ®åº“äº†ï¼Œ<br>ï¼ˆ3ï¼‰è¯·æ±‚BæŸ¥è¯¢ç¼“å­˜å‘ç°ï¼Œç¼“å­˜æ²¡æœ‰å€¼<br>ï¼ˆ4ï¼‰è¯·æ±‚Bå»ä»åº“æŸ¥è¯¢ï¼Œè¿™æ—¶ï¼Œè¿˜æ²¡æœ‰å®Œæˆä¸»ä»åŒæ­¥ï¼Œå› æ­¤æŸ¥è¯¢åˆ°çš„æ˜¯æ—§å€¼<br>ï¼ˆ5ï¼‰è¯·æ±‚Bå°†æ—§å€¼å†™å…¥ç¼“å­˜<br>ï¼ˆ6ï¼‰æ•°æ®åº“å®Œæˆä¸»ä»åŒæ­¥ï¼Œä»åº“å˜ä¸ºæ–°å€¼<br>ä¸Šè¿°æƒ…å½¢ï¼Œå°±æ˜¯æ•°æ®ä¸ä¸€è‡´çš„åŸå› ã€‚è¿˜æ˜¯ä½¿ç”¨åŒåˆ å»¶æ—¶ç­–ç•¥ã€‚åªæ˜¯ï¼Œç¡çœ æ—¶é—´ä¿®æ”¹ä¸ºåœ¨ä¸»ä»åŒæ­¥çš„å»¶æ—¶æ—¶é—´åŸºç¡€ä¸Šï¼ŒåŠ å‡ ç™¾msã€‚<br><strong>é‡‡ç”¨è¿™ç§åŒæ­¥æ·˜æ±°ç­–ç•¥ï¼Œååé‡é™ä½æ€ä¹ˆåŠï¼Ÿ</strong><br>okï¼Œé‚£å°±å°†ç¬¬äºŒæ¬¡åˆ é™¤ä½œä¸ºå¼‚æ­¥çš„ã€‚è‡ªå·±èµ·ä¸€ä¸ªçº¿ç¨‹ï¼Œå¼‚æ­¥åˆ é™¤ã€‚è¿™æ ·ï¼Œå†™çš„è¯·æ±‚å°±ä¸ç”¨æ²‰ç¡ä¸€æ®µæ—¶é—´åäº†ï¼Œå†è¿”å›ã€‚è¿™ä¹ˆåšï¼ŒåŠ å¤§ååé‡ã€‚<br><strong>ç¬¬äºŒæ¬¡åˆ é™¤,å¦‚æœåˆ é™¤å¤±è´¥æ€ä¹ˆåŠï¼Ÿ</strong><br>è¿™æ˜¯ä¸ªéå¸¸å¥½çš„é—®é¢˜ï¼Œå› ä¸ºç¬¬äºŒæ¬¡åˆ é™¤å¤±è´¥ï¼Œå°±ä¼šå‡ºç°å¦‚ä¸‹æƒ…å½¢ã€‚è¿˜æ˜¯æœ‰ä¸¤ä¸ªè¯·æ±‚ï¼Œä¸€ä¸ªè¯·æ±‚Aè¿›è¡Œæ›´æ–°æ“ä½œï¼Œå¦ä¸€ä¸ªè¯·æ±‚Bè¿›è¡ŒæŸ¥è¯¢æ“ä½œï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œå‡è®¾æ˜¯å•åº“ï¼š<br>ï¼ˆ1ï¼‰è¯·æ±‚Aè¿›è¡Œå†™æ“ä½œï¼Œåˆ é™¤ç¼“å­˜<br>ï¼ˆ2ï¼‰è¯·æ±‚BæŸ¥è¯¢å‘ç°ç¼“å­˜ä¸å­˜åœ¨<br>ï¼ˆ3ï¼‰è¯·æ±‚Bå»æ•°æ®åº“æŸ¥è¯¢å¾—åˆ°æ—§å€¼<br>ï¼ˆ4ï¼‰è¯·æ±‚Bå°†æ—§å€¼å†™å…¥ç¼“å­˜<br>ï¼ˆ5ï¼‰è¯·æ±‚Aå°†æ–°å€¼å†™å…¥æ•°æ®åº“<br>ï¼ˆ6ï¼‰è¯·æ±‚Aè¯•å›¾å»åˆ é™¤è¯·æ±‚Bå†™å…¥å¯¹ç¼“å­˜å€¼ï¼Œç»“æœå¤±è´¥äº†ã€‚<br>ok,è¿™ä¹Ÿå°±æ˜¯è¯´ã€‚å¦‚æœç¬¬äºŒæ¬¡åˆ é™¤ç¼“å­˜å¤±è´¥ï¼Œä¼šå†æ¬¡å‡ºç°ç¼“å­˜å’Œæ•°æ®åº“ä¸ä¸€è‡´çš„é—®é¢˜ã€‚<br><strong>å¦‚ä½•è§£å†³å‘¢ï¼Ÿ</strong><br>å…·ä½“è§£å†³æ–¹æ¡ˆï¼Œä¸”çœ‹åšä¸»å¯¹ç¬¬(3)ç§æ›´æ–°ç­–ç•¥çš„è§£æã€‚</p>
<h3 id="3-å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜"><a href="#3-å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜" class="headerlink" title="(3)å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜"></a>(3)å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜</h3><p>é¦–å…ˆï¼Œå…ˆè¯´ä¸€ä¸‹ã€‚è€å¤–æå‡ºäº†ä¸€ä¸ªç¼“å­˜æ›´æ–°å¥—è·¯ï¼Œåä¸º<a href="https://docs.microsoft.com/en-us/azure/architecture/patterns/cache-aside">ã€ŠCache-Aside patternã€‹</a>ã€‚å…¶ä¸­å°±æŒ‡å‡º</p>
<ul>
<li><strong>å¤±æ•ˆ</strong>ï¼šåº”ç”¨ç¨‹åºå…ˆä»cacheå–æ•°æ®ï¼Œæ²¡æœ‰å¾—åˆ°ï¼Œåˆ™ä»æ•°æ®åº“ä¸­å–æ•°æ®ï¼ŒæˆåŠŸåï¼Œæ”¾åˆ°ç¼“å­˜ä¸­ã€‚</li>
<li><strong>å‘½ä¸­</strong>ï¼šåº”ç”¨ç¨‹åºä»cacheä¸­å–æ•°æ®ï¼Œå–åˆ°åè¿”å›ã€‚</li>
<li><strong>æ›´æ–°</strong>ï¼šå…ˆæŠŠæ•°æ®å­˜åˆ°æ•°æ®åº“ä¸­ï¼ŒæˆåŠŸåï¼Œå†è®©ç¼“å­˜å¤±æ•ˆã€‚</li>
</ul>
<p><a href="https://i2.wp.com/images.cnblogs.com/cnblogs_com/rjzheng/1202350/o_update1.png?w=640&ssl=1" title="Rediså¸¸è§é¢è¯•é¢˜ - ç¬¬7å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i2.wp.com/images.cnblogs.com/cnblogs_com/rjzheng/1202350/o_update1.png?w=640&ssl=1" alt="Rediså¸¸è§é¢è¯•é¢˜ - ç¬¬7å¼   | å¼ å˜"></a></p>
<p><a href="https://i0.wp.com/images.cnblogs.com/cnblogs_com/rjzheng/1202350/o_update2.png?w=640&ssl=1" title="Rediså¸¸è§é¢è¯•é¢˜ - ç¬¬8å¼   | å¼ å˜" class="gallery-item" style="box-shadow: none;"> <img src="https://i0.wp.com/images.cnblogs.com/cnblogs_com/rjzheng/1202350/o_update2.png?w=640&ssl=1" alt="Rediså¸¸è§é¢è¯•é¢˜ - ç¬¬8å¼   | å¼ å˜"></a></p>
<p>å¦å¤–ï¼ŒçŸ¥åç¤¾äº¤ç½‘ç«™facebookä¹Ÿåœ¨è®ºæ–‡<a href="https://www.usenix.org/system/files/conference/nsdi13/nsdi13-final170_update.pdf">ã€ŠScaling Memcache at Facebookã€‹</a>ä¸­æå‡ºï¼Œä»–ä»¬ç”¨çš„ä¹Ÿæ˜¯å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ ç¼“å­˜çš„ç­–ç•¥ã€‚<br><strong>è¿™ç§æƒ…å†µä¸å­˜åœ¨å¹¶å‘é—®é¢˜ä¹ˆï¼Ÿ</strong><br>ä¸æ˜¯çš„ã€‚å‡è®¾è¿™ä¼šæœ‰ä¸¤ä¸ªè¯·æ±‚ï¼Œä¸€ä¸ªè¯·æ±‚AåšæŸ¥è¯¢æ“ä½œï¼Œä¸€ä¸ªè¯·æ±‚Båšæ›´æ–°æ“ä½œï¼Œé‚£ä¹ˆä¼šæœ‰å¦‚ä¸‹æƒ…å½¢äº§ç”Ÿ<br>ï¼ˆ1ï¼‰ç¼“å­˜åˆšå¥½å¤±æ•ˆ<br>ï¼ˆ2ï¼‰è¯·æ±‚AæŸ¥è¯¢æ•°æ®åº“ï¼Œå¾—ä¸€ä¸ªæ—§å€¼<br>ï¼ˆ3ï¼‰è¯·æ±‚Bå°†æ–°å€¼å†™å…¥æ•°æ®åº“<br>ï¼ˆ4ï¼‰è¯·æ±‚Båˆ é™¤ç¼“å­˜<br>ï¼ˆ5ï¼‰è¯·æ±‚Aå°†æŸ¥åˆ°çš„æ—§å€¼å†™å…¥ç¼“å­˜<br>okï¼Œå¦‚æœå‘ç”Ÿä¸Šè¿°æƒ…å†µï¼Œç¡®å®æ˜¯ä¼šå‘ç”Ÿè„æ•°æ®ã€‚<br><strong>ç„¶è€Œï¼Œå‘ç”Ÿè¿™ç§æƒ…å†µçš„æ¦‚ç‡åˆæœ‰å¤šå°‘å‘¢ï¼Ÿ</strong><br>å‘ç”Ÿä¸Šè¿°æƒ…å†µæœ‰ä¸€ä¸ªå…ˆå¤©æ€§æ¡ä»¶ï¼Œå°±æ˜¯æ­¥éª¤ï¼ˆ3ï¼‰çš„å†™æ•°æ®åº“æ“ä½œæ¯”æ­¥éª¤ï¼ˆ2ï¼‰çš„è¯»æ•°æ®åº“æ“ä½œè€—æ—¶æ›´çŸ­ï¼Œæ‰æœ‰å¯èƒ½ä½¿å¾—æ­¥éª¤ï¼ˆ4ï¼‰å…ˆäºæ­¥éª¤ï¼ˆ5ï¼‰ã€‚å¯æ˜¯ï¼Œå¤§å®¶æƒ³æƒ³ï¼Œæ•°æ®åº“çš„è¯»æ“ä½œçš„é€Ÿåº¦è¿œå¿«äºå†™æ“ä½œçš„ï¼ˆä¸ç„¶åšè¯»å†™åˆ†ç¦»å¹²å˜›ï¼Œåšè¯»å†™åˆ†ç¦»çš„æ„ä¹‰å°±æ˜¯å› ä¸ºè¯»æ“ä½œæ¯”è¾ƒå¿«ï¼Œè€—èµ„æºå°‘ï¼‰ï¼Œå› æ­¤æ­¥éª¤ï¼ˆ3ï¼‰è€—æ—¶æ¯”æ­¥éª¤ï¼ˆ2ï¼‰æ›´çŸ­ï¼Œè¿™ä¸€æƒ…å½¢å¾ˆéš¾å‡ºç°ã€‚<br>å‡è®¾ï¼Œæœ‰äººéè¦æŠ¬æ ï¼Œæœ‰å¼ºè¿«ç—‡ï¼Œä¸€å®šè¦è§£å†³æ€ä¹ˆåŠï¼Ÿ<br><strong>å¦‚ä½•è§£å†³ä¸Šè¿°å¹¶å‘é—®é¢˜ï¼Ÿ</strong><br>é¦–å…ˆï¼Œç»™ç¼“å­˜è®¾æœ‰æ•ˆæ—¶é—´æ˜¯ä¸€ç§æ–¹æ¡ˆã€‚å…¶æ¬¡ï¼Œé‡‡ç”¨ç­–ç•¥ï¼ˆ2ï¼‰é‡Œç»™å‡ºçš„å¼‚æ­¥å»¶æ—¶åˆ é™¤ç­–ç•¥ï¼Œä¿è¯è¯»è¯·æ±‚å®Œæˆä»¥åï¼Œå†è¿›è¡Œåˆ é™¤æ“ä½œã€‚<br><strong>è¿˜æœ‰å…¶ä»–é€ æˆä¸ä¸€è‡´çš„åŸå› ä¹ˆï¼Ÿ</strong><br>æœ‰çš„ï¼Œè¿™ä¹Ÿæ˜¯ç¼“å­˜æ›´æ–°ç­–ç•¥ï¼ˆ2ï¼‰å’Œç¼“å­˜æ›´æ–°ç­–ç•¥ï¼ˆ3ï¼‰éƒ½å­˜åœ¨çš„ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœåˆ ç¼“å­˜å¤±è´¥äº†æ€ä¹ˆåŠï¼Œé‚£ä¸æ˜¯ä¼šæœ‰ä¸ä¸€è‡´çš„æƒ…å†µå‡ºç°ä¹ˆã€‚æ¯”å¦‚ä¸€ä¸ªå†™æ•°æ®è¯·æ±‚ï¼Œç„¶åå†™å…¥æ•°æ®åº“äº†ï¼Œåˆ ç¼“å­˜å¤±è´¥äº†ï¼Œè¿™ä¼šå°±å‡ºç°ä¸ä¸€è‡´çš„æƒ…å†µäº†ã€‚è¿™ä¹Ÿæ˜¯ç¼“å­˜æ›´æ–°ç­–ç•¥ï¼ˆ2ï¼‰é‡Œç•™ä¸‹çš„æœ€åä¸€ä¸ªç–‘é—®ã€‚<br><strong>å¦‚ä½•è§£å†³ï¼Ÿ</strong><br>æä¾›ä¸€ä¸ªä¿éšœçš„é‡è¯•æœºåˆ¶å³å¯ï¼Œè¿™é‡Œç»™å‡ºä¸¤å¥—æ–¹æ¡ˆã€‚<br><strong>æ–¹æ¡ˆä¸€</strong>ï¼š<br>å¦‚ä¸‹å›¾æ‰€ç¤º</p>
<p>æµç¨‹å¦‚ä¸‹æ‰€ç¤º<br>ï¼ˆ1ï¼‰æ›´æ–°æ•°æ®åº“æ•°æ®ï¼›<br>ï¼ˆ2ï¼‰ç¼“å­˜å› ä¸ºç§ç§é—®é¢˜åˆ é™¤å¤±è´¥<br>ï¼ˆ3ï¼‰å°†éœ€è¦åˆ é™¤çš„keyå‘é€è‡³æ¶ˆæ¯é˜Ÿåˆ—<br>ï¼ˆ4ï¼‰è‡ªå·±æ¶ˆè´¹æ¶ˆæ¯ï¼Œè·å¾—éœ€è¦åˆ é™¤çš„key<br>ï¼ˆ5ï¼‰ç»§ç»­é‡è¯•åˆ é™¤æ“ä½œï¼Œç›´åˆ°æˆåŠŸ<br>ç„¶è€Œï¼Œè¯¥æ–¹æ¡ˆæœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå¯¹ä¸šåŠ¡çº¿ä»£ç é€ æˆå¤§é‡çš„ä¾µå…¥ã€‚äºæ˜¯æœ‰äº†æ–¹æ¡ˆäºŒï¼Œåœ¨æ–¹æ¡ˆäºŒä¸­ï¼Œå¯åŠ¨ä¸€ä¸ªè®¢é˜…ç¨‹åºå»è®¢é˜…æ•°æ®åº“çš„binlogï¼Œè·å¾—éœ€è¦æ“ä½œçš„æ•°æ®ã€‚åœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œå¦èµ·ä¸€æ®µç¨‹åºï¼Œè·å¾—è¿™ä¸ªè®¢é˜…ç¨‹åºä¼ æ¥çš„ä¿¡æ¯ï¼Œè¿›è¡Œåˆ é™¤ç¼“å­˜æ“ä½œã€‚<br><strong>æ–¹æ¡ˆäºŒ</strong>ï¼š</p>
<p>æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br>ï¼ˆ1ï¼‰æ›´æ–°æ•°æ®åº“æ•°æ®<br>ï¼ˆ2ï¼‰æ•°æ®åº“ä¼šå°†æ“ä½œä¿¡æ¯å†™å…¥binlogæ—¥å¿—å½“ä¸­<br>ï¼ˆ3ï¼‰è®¢é˜…ç¨‹åºæå–å‡ºæ‰€éœ€è¦çš„æ•°æ®ä»¥åŠkey<br>ï¼ˆ4ï¼‰å¦èµ·ä¸€æ®µéä¸šåŠ¡ä»£ç ï¼Œè·å¾—è¯¥ä¿¡æ¯<br>ï¼ˆ5ï¼‰å°è¯•åˆ é™¤ç¼“å­˜æ“ä½œï¼Œå‘ç°åˆ é™¤å¤±è´¥<br>ï¼ˆ6ï¼‰å°†è¿™äº›ä¿¡æ¯å‘é€è‡³æ¶ˆæ¯é˜Ÿåˆ—<br>ï¼ˆ7ï¼‰é‡æ–°ä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­è·å¾—è¯¥æ•°æ®ï¼Œé‡è¯•æ“ä½œã€‚</p>
<p><strong>å¤‡æ³¨è¯´æ˜ï¼š</strong>ä¸Šè¿°çš„è®¢é˜…binlogç¨‹åºåœ¨mysqlä¸­æœ‰ç°æˆçš„ä¸­é—´ä»¶å«canalï¼Œå¯ä»¥å®Œæˆè®¢é˜…binlogæ—¥å¿—çš„åŠŸèƒ½ã€‚è‡³äºoracleä¸­ï¼Œåšä¸»ç›®å‰ä¸çŸ¥é“æœ‰æ²¡æœ‰ç°æˆä¸­é—´ä»¶å¯ä»¥ä½¿ç”¨ã€‚å¦å¤–ï¼Œé‡è¯•æœºåˆ¶ï¼Œåšä¸»æ˜¯é‡‡ç”¨çš„æ˜¯æ¶ˆæ¯é˜Ÿåˆ—çš„æ–¹å¼ã€‚å¦‚æœå¯¹ä¸€è‡´æ€§è¦æ±‚ä¸æ˜¯å¾ˆé«˜ï¼Œç›´æ¥åœ¨ç¨‹åºä¸­å¦èµ·ä¸€ä¸ªçº¿ç¨‹ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´å»é‡è¯•å³å¯ï¼Œè¿™äº›å¤§å®¶å¯ä»¥çµæ´»è‡ªç”±å‘æŒ¥ï¼Œåªæ˜¯æä¾›ä¸€ä¸ªæ€è·¯ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡å…¶å®æ˜¯å¯¹ç›®å‰äº’è”ç½‘ä¸­å·²æœ‰çš„ä¸€è‡´æ€§æ–¹æ¡ˆï¼Œè¿›è¡Œäº†ä¸€ä¸ªæ€»ç»“ã€‚å¯¹äºå…ˆåˆ ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“çš„æ›´æ–°ç­–ç•¥ï¼Œè¿˜æœ‰æ–¹æ¡ˆæå‡ºç»´æŠ¤ä¸€ä¸ªå†…å­˜é˜Ÿåˆ—çš„æ–¹å¼ï¼Œåšä¸»çœ‹äº†ä¸€ä¸‹ï¼Œè§‰å¾—å®ç°å¼‚å¸¸å¤æ‚ï¼Œæ²¡æœ‰å¿…è¦ï¼Œå› æ­¤æ²¡æœ‰å¿…è¦åœ¨æ–‡ä¸­ç»™å‡ºã€‚æœ€åï¼Œå¸Œæœ›å¤§å®¶æœ‰æ‰€æ”¶è·ã€‚</p>
<h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><p>1ã€<a href="https://mp.weixin.qq.com/s?__biz=MjM5ODYxMDA5OQ==&mid=404308725&idx=1&sn=1a25ce76dd1956014ceb8a011855268e&scene=21#wechat_redirect">ä¸»ä»DBä¸cacheä¸€è‡´æ€§</a><br>2ã€<a href="https://coolshell.cn/articles/17416.html">ç¼“å­˜æ›´æ–°çš„å¥—è·¯</a></p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>é¢è¯•</tag>
        <tag>æ•°æ®åº“</tag>
      </tags>
  </entry>
  <entry>
    <title>æ²™ç›’æ¸¸æˆ3Dåœºæ™¯å»ºæ¨¡</title>
    <url>/sandbox-scene/</url>
    <content><![CDATA[<div class=".article-gallery"><p>åœ¨ä¸€æ¬¡èšé¤ä¹‹åï¼Œæ™šä¸Šç¡è§‰å‰çªç„¶çµæ„Ÿçˆ†æ£šæƒ³åˆ°çš„å®ç°æ–¹æ¡ˆã€‚</p>
<p>ä¸‹é¢æ˜¯åœ¨é¡¹ç›®å†…éƒ¨åˆ†äº«çš„PPTï¼Œå…·ä½“ä»£ç å®ç°åœ¨githubï¼š<a href="https://github.com/zhangga/JAVAZSet">https://github.com/zhangga/JAVAZSet</a></p>
<p><a href="https://imgtu.com/i/hNUOo9"><a href="https://z3.ax1x.com/2021/08/30/hNUOo9.md.png" title="hNUOo9.md.png" class="gallery-item" style="box-shadow: none;"> <img src="https://z3.ax1x.com/2021/08/30/hNUOo9.md.png" alt="hNUOo9.md.png"></a></a></p>
<span id="more"></span>

<p><a href="https://imgtu.com/i/hNULdJ"><a href="https://z3.ax1x.com/2021/08/30/hNULdJ.md.png" title="hNULdJ.md.png" class="gallery-item" style="box-shadow: none;"> <img src="https://z3.ax1x.com/2021/08/30/hNULdJ.md.png" alt="hNULdJ.md.png"></a></a></p>
<p><a href="https://imgtu.com/i/hNUjiR"><a href="https://z3.ax1x.com/2021/08/30/hNUjiR.md.png" title="hNUjiR.md.png" class="gallery-item" style="box-shadow: none;"> <img src="https://z3.ax1x.com/2021/08/30/hNUjiR.md.png" alt="hNUjiR.md.png"></a></a></p>
<h2 id="å®é™…ç¢°åˆ°çš„ä¸€ç‚¹é—®é¢˜ï¼š"><a href="#å®é™…ç¢°åˆ°çš„ä¸€ç‚¹é—®é¢˜ï¼š" class="headerlink" title="å®é™…ç¢°åˆ°çš„ä¸€ç‚¹é—®é¢˜ï¼š"></a>å®é™…ç¢°åˆ°çš„ä¸€ç‚¹é—®é¢˜ï¼š</h2><p>1.æŠŠ9å¼ 1024*1024çš„navmeshåˆä¸€å¼ çš„æ—¶å€™ï¼ŒåŸç”Ÿçš„recastæ˜¯ç”¨32ä½åˆ†é…ç©ºé—´ï¼Œå…¶ä¸­14ä½åˆ†é…ç»™tileï¼Œæ‰€ä»¥tileæœ‰ä¸Šé™çš„è€ƒè™‘ã€‚</p>
<p>ç°åœ¨æŠŠrecastæ”¹ä¸ºç”¨64ä½è¡¨ç¤ºï¼Œéœ€è¦å®å®šä¹‰ã€‚åœ¨DetourNavMesh.hä¸­å®šä¹‰ #define DT_POLYREF64 1</p>
<p>è¿™æ ·tileå°±æœ‰28ä½äº†ï¼Œä¸å¤ªå­˜åœ¨è¶…è¿‡ä¸Šé™çš„å¯èƒ½äº†ã€‚</p>
<p>å‘ç°é—®é¢˜ã€‚æ”¹å®Œä¹‹åçš„dllåœ¨åŠ è½½æ–°åœ°å›¾çš„æ—¶å€™ï¼Œå†…å­˜ç›´æ¥é£™å‡ã€‚</p>
<p>æ‰“å°è¾“å‡ºï¼Œå®šä½åˆ°é—®é¢˜å‘ç”Ÿåœ¨ï¼ŒdtLoadNavMeshæ—¶è¯»å–åˆ°çš„tileçš„å†…å­˜sizeå€¼ä¸æ­£å¸¸ï¼Œå¯¼è‡´å†…å­˜ç”³è¯·å¼‚å¸¸ã€‚</p>
<p>è‡³æ­¤é—®é¢˜å·²ç»å®šä½ï¼Œnavmeshæ–‡ä»¶æ ¼å¼å’Œè¯»å–çš„æ ¼å¼ä¸ä¸€è‡´ï¼Œæ•°æ®é”™ä½ï¼Œè¯»å–å¼‚å¸¸ã€‚</p>
<p>è¿›ä¸€æ­¥è·Ÿè¸ªï¼Œå‘ç°æ˜¯C++ structå†…å­˜å¯¹é½ä¸åŒå¯¼è‡´çš„ã€‚å®¢æˆ·ç«¯ç”Ÿæˆé»˜è®¤æ˜¯8ï¼ŒæœåŠ¡å™¨è¯»å–æ˜¯æŒ‰4ï¼Œç»“æœæœåŠ¡å™¨å°‘è¯»4å­—èŠ‚ã€‚</p>
<p>åœ¨DetourInit.hæ–‡ä»¶ä¸­æœ‰å¦‚ä¸‹ä»£ç ï¼š#pragma pack(push,4) æ§åˆ¶ï¼Œå‰åç«¯ä¿®æ”¹ä¸€è‡´å³å¯ã€‚</p>
<p>pptåœ¨GitHubä¸Šã€‚<a href="https://github.com/zhangga/JAVAZSet">JavaZSet</a></p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>æœåŠ¡å™¨</tag>
      </tags>
  </entry>
  <entry>
    <title>æ¸¸æˆæœåŠ¡å™¨ç½‘ç»œåº“</title>
    <url>/servernet/</url>
    <content><![CDATA[<div class=".article-gallery"><p>æœ€è¿‘åœ¨å¼€å‘golangçš„æ¸¸æˆæœç½‘ç»œåº“ï¼ŒåŸºç¡€å¼€å‘å·²ç»å®Œæˆï¼Œå‡†å¤‡åšæ€§èƒ½æµ‹è¯•ï¼Œåœ¨æ€è€ƒæµ‹è¯•ç”¨ä¾‹çš„æ—¶å€™ï¼Œå‚è€ƒäº†ä¸‹ä¸»è¦ç½‘ç»œåº“çš„æµ‹è¯•åœºæ™¯ï¼Œåœ¨è¿™é‡Œåšä¸€ä¸‹æ±‡æ€»ã€‚</p>
<h2 id="æ¸¸æˆç½‘ç»œåº“"><a href="#æ¸¸æˆç½‘ç»œåº“" class="headerlink" title="æ¸¸æˆç½‘ç»œåº“"></a>æ¸¸æˆç½‘ç»œåº“</h2><h4 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h4><p>é€šè¿‡å°è£…TCP/UDPç½‘ç»œè¿æ¥ï¼Œå‘ä¸Šå±‚ä¸šåŠ¡æä¾› <strong>å¯é ã€æ˜“ç”¨</strong> çš„ç½‘ç»œåº“ã€‚</p>
<p>è·å–ç½‘ç»œå±‚çš„æ§åˆ¶æƒï¼Œå…ˆäºä¸šåŠ¡åšä¸€äº›æ¢ç´¢å¹¶æœ€ç»ˆèµ‹èƒ½ä¸šåŠ¡ã€‚</p>
<span id="more"></span>

<h4 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h4><ol>
<li>æ˜“ç”¨æ€§</li>
</ol>
<ul>
<li>éµå¾ªgolang netçš„æ¥å£è§„èŒƒï¼Œä¿è¯é€šç”¨æ€§ã€‚</li>
<li>å¼±ç½‘ç¯å¢ƒä¸‹ä¿è¯æ¶ˆæ¯é¡ºåºã€å¯é ï¼Œä¸éœ€è¦ä¸šåŠ¡å±‚åšé¢å¤–å·¥ä½œã€‚</li>
<li>å¯ä»¥å‘é€å¯é æ¶ˆæ¯ï¼ŒTCPæ¶ˆæ¯ï¼ŒUDPæ¶ˆæ¯ã€‚</li>
<li>æ–¹ä¾¿å¼€å¯/å…³é—­TCP/UDPä»¥åŠåŒé€šé“é€šä¿¡ã€‚</li>
</ul>
<ol start="2">
<li>å¯é æ€§</li>
</ol>
<ul>
<li>å¯¹ç½‘ç»œè¿æ¥è¿›ä¸€æ­¥å°è£…æˆé€»è¾‘è¿æ¥(session)ï¼Œå°†çŸ­æ—¶é—´å†…çš„æ–­çº¿é‡è¿ä½œä¸ºåŒä¸€ä¸ªè¿æ¥ï¼Œå¯¹ä¸šåŠ¡å±‚é€æ˜ã€‚</li>
<li>ä¿è¯ä»»ä½•æƒ…å†µä¸‹æ¶ˆæ¯çš„å¯é ï¼Œåœ¨TCP/UDPä¸Šå°è£…KCPï¼Œä¿è¯UDPçš„å¯é ï¼Œä»¥åŠæ–­çº¿é‡è¿ä¸‹åŒä¸€ä¸ªé€»è¾‘è¿æ¥(ä¸åŒçš„TCPè¿æ¥)æ¶ˆæ¯çš„å¯é æ€§ã€‚</li>
<li>æ”¯æŒä¸Šè¡Œ/ä¸‹è¡Œåˆ†åˆ«èµ°ä¸åŒçš„é€šé“ã€‚</li>
<li>é’ˆå¯¹æ¸¸æˆå¤§åŒ…ä¸‹å‘çš„åœºæ™¯(å¦‚ç™»å½•æ¸¸æˆï¼Œè¿›å…¥åœºæ™¯/å‰¯æœ¬ç­‰)ï¼Œä¼˜å…ˆä½¿ç”¨TCPå‘åŒ…ã€‚</li>
<li>æ ¹æ®ç½‘ç»œæ—¶å»¶è‡ªåŠ¨é€‰æ‹©TCPæˆ–UDPã€‚</li>
<li>ç½‘ç»œè¿æ¥è‡ªåŠ¨é€‰æ‹©å°±è¿‘IPï¼Œç™»å½•åˆ°å°±è¿‘éƒ¨ç½²åŒºåŸŸã€‚</li>
</ul>
<h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>é’ˆå¯¹æ¸¸æˆæœåŠ¡å™¨ç‰¹æ€§åœ¨è®¾è®¡ç½‘ç»œåº“çš„æ—¶å€™éœ€è¦ç‰¹åˆ«å…³æ³¨çš„ä¸€äº›åœ°æ–¹ï¼š</p>
<ol>
<li>æ¸¸æˆä¸šåŠ¡é‡ã€‚åœ¨handlerä¸­å¤„ç†ä¸€æ¡æ¶ˆæ¯ä¸šåŠ¡çš„æ—¶å€™ä¸€èˆ¬éƒ½æ¶‰åŠåˆ°I/Oæ“ä½œï¼Œå¦‚æœåŒæ­¥æ‰§è¡Œçš„è¯ï¼ŒCPUä¸»è¦æ¶ˆè€—ä¼šåœ¨ç­‰å¾…I/Oæ“ä½œä¸Šã€‚æ­¤æ—¶handlerå¿…é¡»è¦å¼‚æ­¥å¤„ç†ï¼Œè¿™å°±æ¶‰åŠåˆ°ä¸Šä¸‹æ–‡åˆ‡æ¢ã€I/Oåä½œç­‰éœ€è¦è€ƒè™‘çš„ä»£ä»·ã€‚</li>
<li>è¿‡å¤šé•¿é“¾æ¥çš„é—®é¢˜ã€‚åœ¨ä½¿ç”¨golang netç½‘è·¯åº“è®¾è®¡æ¡†æ¶æ—¶ï¼Œä¸€èˆ¬éƒ½æ˜¯æ–°å¯ä¸€ä¸ªåç¨‹goroutineå»å¤„ç†ä¸€ä¸ªè¿æ¥çš„readäº‹ä»¶ï¼Œåœ¨å¤§é‡è¿æ¥çš„æƒ…å†µä¸‹éœ€è¦è€ƒè™‘åç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ï¼Œä»¥åŠç©ºé—²è¿æ¥å ç”¨çš„é—®é¢˜ã€‚</li>
<li>ç½‘ç»œåº“åœ¨å¤„ç†æ¶ˆæ¯åˆåŒ…/æ‹†åŒ…çš„æƒ…å†µä¸‹ï¼Œå¯¹æ¶ˆæ¯bufferçš„æ‹·è´æ¬¡æ•°ã€‚å¸¸ç”¨çš„æ–¹æ¡ˆæ˜¯RingBufferå’Œ<a href="https://www.infoq.cn/article/fea7chf9moohbxbtyres">Nocopy Buffer</a>ï¼Œå‚è€ƒnettyå’Œnetpollã€‚</li>
<li>å¿…é¡»æ”¶åˆ°å®Œæ•´çš„æ•°æ®åŒ…æ‰å¯ä»¥ç»§ç»­å¤„ç†ï¼Œä¸èƒ½æ”¶åˆ°ä¸€åŠå°±å¼€å§‹å¤„ç†ã€‚</li>
<li>æ°´å¹³è§¦å‘ã€è¾¹ç¼˜è§¦å‘ï¼Œå¯¹ç¼–ç¨‹æ¨¡å‹çš„å½±å“ã€‚</li>
</ol>
<h2 id="ç½‘ç»œåº“æ€§èƒ½è°ƒç ”"><a href="#ç½‘ç»œåº“æ€§èƒ½è°ƒç ”" class="headerlink" title="ç½‘ç»œåº“æ€§èƒ½è°ƒç ”"></a>ç½‘ç»œåº“æ€§èƒ½è°ƒç ”</h2><h3 id="ç°çŠ¶"><a href="#ç°çŠ¶" class="headerlink" title="ç°çŠ¶"></a>ç°çŠ¶</h3><p>ç°åœ¨çš„ç½‘ç»œåº“åŸºäºgolang/netå®ç°ï¼Œgolang/netæœ¬èº«å·²ç»æ˜¯ä¸€ä¸ªç®€æ´é«˜æ•ˆçš„ç½‘ç»œåº“ã€‚</p>
<p>ä½†åœ¨æµ·é‡è¿æ¥çš„ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œç‰¹åˆ«æ˜¯æˆ‘ä»¬è¿™ç§å¤§ç½‘å…³çš„èƒŒæ™¯ä¸‹ï¼Œæ¯ä¸ªè¿æ¥ä¸€ç»„goroutine(ä¸€ä¸ªæ¥æ”¶æ¶ˆæ¯çš„ï¼Œä¸€ä¸ªå‘é€æ¶ˆæ¯çš„)ï¼Œæ­¤æ—¶å¤§é‡goroutineå­˜åœ¨çš„æƒ…å†µä¸‹å¯èƒ½å‡ºç°çš„é—®é¢˜ï¼š</p>
<ol>
<li><p>èµ„æºå æœ‰ï¼šæ¶ˆè€—çš„èµ„æºå°±ä¼šå‘ˆçº¿æ€§è¶‹åŠ¿æš´æ¶¨ï¼Œé¦–å…ˆç»™go runtime scheduleré€ æˆæå¤§çš„å‹åŠ›å’Œä¾µå ç³»ç»Ÿèµ„æºï¼Œç„¶åèµ„æºå ç”¨åˆåè¿‡æ¥å½±å“runtimeçš„è°ƒåº¦ï¼Œå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚</p>
</li>
<li><p>ç½‘ç»œæŠ–åŠ¨ï¼šåœ¨ç³»ç»ŸæŠ–åŠ¨æ—¶ï¼Œå¤§é‡ç½‘ç»œè¯·æ±‚æ–­å¼€å¹¶é‡è¿ï¼Œä¼´éšç€çš„æ˜¯å¤§é‡åç¨‹çš„åˆ›å»ºï¼Œé€€å‡ºçš„åç¨‹ä¾æ—§åœ¨allgç»“æ„ä¸­ï¼Œé€ æˆgcçš„æ‰«æã€‚</p>
</li>
<li><p>å‡å°‘å†…å­˜æ‹·è´ï¼šæ–°çš„ç½‘ç»œåº“ä¸­è§£æè¿‡ä¸€æ¬¡åè®®äº†ï¼Œç›´æ¥å°†bufferäº¤ç»™ä¸Šå±‚ï¼Œå‡å°‘copyã€‚å€Ÿé‰´netpollçš„è®¾è®¡ï¼Œæ— é”ä¸”zero copyã€‚</p>
</li>
<li><p>bufferæ‰©å®¹æ—¶copyåŸæ•°ç»„çš„é—®é¢˜ï¼Œåªèƒ½æ‰©å®¹æ— æ³•ç¼©å®¹ï¼Œå æœ‰å¤§é‡å†…å­˜ã€‚linkedbufferã€‚</p>
</li>
</ol>
<h3 id="å¸¸è§å¼€æºåº“"><a href="#å¸¸è§å¼€æºåº“" class="headerlink" title="å¸¸è§å¼€æºåº“"></a>å¸¸è§å¼€æºåº“</h3><h3 id="gnet"><a href="#gnet" class="headerlink" title="gnet"></a><a href="https://github.com/panjf2000/gnet">gnet</a></h3><p><a href="https://strikefreedom.top/go-netpoll-io-multiplexing-reactor">gnetä»‹ç»</a></p>
<h4 id="ä¼˜åŠ¿"><a href="#ä¼˜åŠ¿" class="headerlink" title="ä¼˜åŠ¿"></a>ä¼˜åŠ¿</h4><ul>
<li><p>æµ·é‡è¿æ¥ï¼Œé«˜é¢‘åˆ›å»ºé”€æ¯ã€‚</p>
</li>
<li><p>é«˜æ€§èƒ½ï¼Œä½æŸè€—ã€‚</p>
</li>
<li><p>æ”¯æŒTCPã€UDPã€‚</p>
</li>
<li><p>Multi-Reactorsã€Multi-Reactors+Goruntine Poolä¸¤ç§ç½‘ç»œæ¨¡å‹ã€‚</p>
</li>
</ul>
<h4 id="å¯å€Ÿé‰´ä¼˜åŒ–"><a href="#å¯å€Ÿé‰´ä¼˜åŒ–" class="headerlink" title="å¯å€Ÿé‰´ä¼˜åŒ–"></a>å¯å€Ÿé‰´ä¼˜åŒ–</h4><ul>
<li><p>ğŸ”²å†…ç½® goroutine æ± ï¼Œç”±å¼€æºåº“ <a href="https://github.com/panjf2000/ants">ants</a> æä¾›æ”¯æŒ</p>
</li>
<li><p>ğŸ”²å†…ç½® bytes å†…å­˜æ± ï¼Œç”±å¼€æºåº“ <a href="https://github.com/valyala/bytebufferpool">bytebufferpool</a> æä¾›æ”¯æŒ</p>
</li>
<li><p>ğŸ”²é«˜æ•ˆã€å¯é‡ç”¨è€Œä¸”è‡ªåŠ¨ä¼¸ç¼©çš„ç¯å½¢å†…å­˜ buffer</p>
</li>
<li><p>ğŸ”²æ”¯æŒå¼‚æ­¥å†™æ“ä½œ</p>
</li>
</ul>
<h3 id="netpoll"><a href="#netpoll" class="headerlink" title="netpoll"></a><a href="https://github.com/cloudwego/netpoll">netpoll</a></h3><p><a href="https://blog.csdn.net/ByteDanceTech/article/details/106066621?utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~aggregatepage~first_rank_ecpm_v1~rank_v31_ecpm-6-106066621.pc_agg_new_rank&utm_term=netpoll%E5%92%8Cgnet&spm=1000.2123.3001.4430">netpollä»‹ç»</a></p>
<h4 id="ä¼˜åŠ¿-1"><a href="#ä¼˜åŠ¿-1" class="headerlink" title="ä¼˜åŠ¿"></a>ä¼˜åŠ¿</h4><ul>
<li><p>é€‚åˆé‡ä¸šåŠ¡çš„RPCã€‚</p>
</li>
<li><p>é«˜æ•ˆè¿æ¥æ± ï¼Œç®¡ç†è¿æ¥çŠ¶æ€ã€‚</p>
</li>
<li><p>åç¨‹æ± ï¼Œæ§åˆ¶goroutineã€‚</p>
</li>
<li><p>å†…å­˜ç®¡ç†ã€‚</p>
</li>
<li><p>NoCopy Bufferã€‚</p>
</li>
</ul>
<h4 id="åŠ£åŠ¿"><a href="#åŠ£åŠ¿" class="headerlink" title="åŠ£åŠ¿"></a>åŠ£åŠ¿</h4><ul>
<li>ä¸æ”¯æŒUDPã€‚</li>
</ul>
<h4 id="å¯å€Ÿé‰´ä¼˜åŒ–-1"><a href="#å¯å€Ÿé‰´ä¼˜åŒ–-1" class="headerlink" title="å¯å€Ÿé‰´ä¼˜åŒ–"></a>å¯å€Ÿé‰´ä¼˜åŒ–</h4><ul>
<li><p>ğŸ”²ä¸°å¯Œçš„æµ‹è¯•åœºæ™¯</p>
</li>
<li><p>ğŸ”²<a href="https://github.com/cloudwego/netpoll/blob/main/nocopy_linkbuffer.go">LinkBuffer</a> æä¾›å¯ä»¥æµå¼è¯»å†™çš„ nocopy API</p>
</li>
<li><p>ğŸ”²<a href="https://github.com/bytedance/gopkg/tree/develop/util/gopool">gopool</a> æä¾›é«˜æ€§èƒ½çš„ goroutine æ± </p>
</li>
<li><p>ğŸ”²<a href="https://github.com/bytedance/gopkg/tree/develop/lang/mcache">mcache</a> æä¾›é«˜æ•ˆçš„å†…å­˜å¤ç”¨</p>
</li>
<li><p>ğŸ”²IsActive æ”¯æŒæ£€æŸ¥è¿æ¥æ˜¯å¦å­˜æ´»</p>
</li>
</ul>
</div>]]></content>
      <categories>
        <category>æœåŠ¡å™¨æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œ</tag>
      </tags>
  </entry>
  <entry>
    <title>setroubleshootdå¼•èµ·çš„CPUé«˜è´Ÿè½½é—®é¢˜</title>
    <url>/setroubleshootd/</url>
    <content><![CDATA[<div class=".article-gallery"><h2 id="è®°ä¸€æ¬¡setroubleshootdè¿›ç¨‹å¼•èµ·çš„CPUé«˜è´Ÿè½½é—®é¢˜"><a href="#è®°ä¸€æ¬¡setroubleshootdè¿›ç¨‹å¼•èµ·çš„CPUé«˜è´Ÿè½½é—®é¢˜" class="headerlink" title="è®°ä¸€æ¬¡setroubleshootdè¿›ç¨‹å¼•èµ·çš„CPUé«˜è´Ÿè½½é—®é¢˜"></a>è®°ä¸€æ¬¡setroubleshootdè¿›ç¨‹å¼•èµ·çš„CPUé«˜è´Ÿè½½é—®é¢˜</h2><p><a href="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2022-08/20220804145148-hCCDzh.jpg" title="20220804145148-hCCDzh" class="gallery-item" style="box-shadow: none;"> <img src="https://raw.githubusercontent.com/zhangga/gitment-comments/master/uPic/2022-08/20220804145148-hCCDzh.jpg" alt="20220804145148-hCCDzh"></a></p>
<p>ä¸Šå›¾å¯ä»¥çœ‹åˆ°CPUå’Œå†…å­˜åœ¨æœºå™¨ä¸Šéƒ½ä¸æ­£å¸¸</p>
<p><code>$ top</code>æŸ¥çœ‹å…·ä½“è¿›ç¨‹ä¸º<code>setroubleshootd</code></p>
<p>ç»§ç»­é€šè¿‡æŒ‡ä»¤æŸ¥çœ‹ï¼š<code>tail -f  /var/log/audit/audit.log</code></p>
<p>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">type=SYSCALL msg=audit(1659596208.000:3732435): arch=c000003e syscall=4 success=no exit=-13 a0=7fd01c268280 a1=7fd01c267fc0 a2=7fd01c267fc0 a3=0 items=0 ppid=1 pid=75904 auid=4294967295 uid=986 gid=980 euid=986 suid=986 fsuid=986 egid=980 sgid=980 fsgid=980 tty=(none) ses=4294967295 comm=&quot;ftdc&quot; exe=&quot;/usr/bin/mongod&quot; subj=system_u:system_r:mongod_t:s0 key=(null)</span><br><span class="line">type=PROCTITLE msg=audit(1659596208.000:3732435): proctitle=2F7573722F62696E2F6D6F6E676F64002D66002F6574632F6D6F6E676F642E636F6E66</span><br><span class="line">type=AVC msg=audit(1659596208.000:3732436): avc:  denied  &#123; getattr &#125; for  pid=75904 comm=&quot;ftdc&quot; path=&quot;/sys/fs/fuse/connections&quot; dev=&quot;fusectl&quot; ino=1 scontext=system_u:system_r:mongod_t:s0 tcontext=system_u:object_r:fusefs_t:s0 tclass=dir permissive=0</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°pidï¼Œå¹¶ä¸”æ˜¯mongodbå¼•èµ·çš„ã€‚</p>
<p>ç»§ç»­æŸ¥çœ‹mongodbçš„æ—¥å¿—ï¼š<code>tail -f /var/log/messages</code></p>
<p>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">**************************#012#012If you believe that mongod should be allowed getattr access on the cgroup directory by default.#012Then you should report this as a bug.#012You can generate a local policy module to allow this access.#012Do#012allow this access for now by executing:#012# ausearch -c &#x27;ftdc&#x27; --raw | audit2allow -M my-ftdc#012# semodule -i my-ftdc.pp#012</span><br><span class="line">Aug  3 23:58:48 localhost setroubleshoot: failed to retrieve rpm info for /sys/fs/cgroup</span><br><span class="line">Aug  3 23:58:48 localhost setroubleshoot: SELinux is preventing /usr/bin/mongod from search access on the directory /sys/fs/cgroup. For complete SELinux messages run: sealert -l 8df77a62-a31a-4213-8d52-f65ae3ffce6f</span><br><span class="line">Aug  3 23:58:48 localhost python: SELinux is preventing /usr/bin/mongod from search access on the directory /sys/fs/cgroup.#012#012*****  Plugin catchall (100. confidence) suggests   </span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢æ—¥å¿—ä¸­å¯ä»¥çœ‹åˆ°åŸå› æ˜¯ï¼š<code>/usr/bin/mongod from search access on the directory /sys/fs/cgroup</code></p>
<p>å¹¶ä¸”æç¤ºäº†å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼š<code>sealert -l 8df77a62-a31a-4213-8d52-f65ae3ffce6f</code> æŸ¥çœ‹å®Œæ•´ä¿¡æ¯ã€‚</p>
<p>å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[root@vmcommon fs]# sealert -l 8df77a62-a31a-4213-8d52-f65ae3ffce6f</span><br><span class="line"></span><br><span class="line">(setroubleshoot:123729): Gtk-WARNING **: 15:02:31.126: Locale not supported by C library.</span><br><span class="line">	Using the fallback &#x27;C&#x27; locale.</span><br><span class="line">SELinux is preventing /usr/bin/mongod from search access on the directory /sys/fs/cgroup.</span><br><span class="line"></span><br><span class="line">*****  Plugin catchall (100. confidence) suggests   **************************</span><br><span class="line"></span><br><span class="line">If you believe that mongod should be allowed search access on the cgroup directory by default.</span><br><span class="line">Then you should report this as a bug.</span><br><span class="line">You can generate a local policy module to allow this access.</span><br><span class="line">Do</span><br><span class="line">allow this access for now by executing:</span><br><span class="line"># ausearch -c &#x27;mongod&#x27; --raw | audit2allow -M my-mongod</span><br><span class="line"># semodule -i my-mongod.pp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Additional Information:</span><br><span class="line">Source Context                system_u:system_r:mongod_t:s0</span><br><span class="line">Target Context                system_u:object_r:cgroup_t:s0</span><br><span class="line">Target Objects                /sys/fs/cgroup [ dir ]</span><br><span class="line">Source                        mongod</span><br><span class="line">Source Path                   /usr/bin/mongod</span><br><span class="line">Port                          &lt;Unknown&gt;</span><br><span class="line">Host                          localhost.localdomain</span><br><span class="line">Source RPM Packages           mongodb-org-server-6.0.0-1.el7.x86_64</span><br><span class="line">Target RPM Packages</span><br><span class="line">Policy RPM                    selinux-policy-3.13.1-268.el7.noarch</span><br><span class="line">Selinux Enabled               True</span><br><span class="line">Policy Type                   targeted</span><br><span class="line">Enforcing Mode                Enforcing</span><br><span class="line">Host Name                     vmcommon</span><br><span class="line">Platform                      Linux vmcommon 3.10.0-1160.el7.x86_64 #1 SMP Mon</span><br><span class="line">                              Oct 19 16:18:59 UTC 2020 x86_64 x86_64</span><br><span class="line">Alert Count                   184449</span><br><span class="line">First Seen                    2022-08-02 11:11:38 CST</span><br><span class="line">Last Seen                     2022-08-04 14:52:59 CST</span><br><span class="line">Local ID                      8df77a62-a31a-4213-8d52-f65ae3ffce6f</span><br><span class="line"></span><br><span class="line">Raw Audit Messages</span><br><span class="line">type=AVC msg=audit(1659595979.0:3727845): avc:  denied  &#123; search &#125; for  pid=75904 comm=&quot;ftdc&quot; name=&quot;/&quot; dev=&quot;tmpfs&quot; ino=1164 scontext=system_u:system_r:mongod_t:s0 tcontext=system_u:object_r:cgroup_t:s0 tclass=dir permissive=0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">type=SYSCALL msg=audit(1659595979.0:3727845): arch=x86_64 syscall=statfs success=no exit=EACCES a0=5567cc31f9a0 a1=7fd01c267f40 a2=7fd01c2681a0 a3=0 items=0 ppid=1 pid=75904 auid=4294967295 uid=986 gid=980 euid=986 suid=986 fsuid=986 egid=980 sgid=980 fsgid=980 tty=(none) ses=4294967295 comm=ftdc exe=/usr/bin/mongod subj=system_u:system_r:mongod_t:s0 key=(null)</span><br><span class="line"></span><br><span class="line">Hash: mongod,mongod_t,cgroup_t,dir,search</span><br></pre></td></tr></table></figure>

<ul>
<li>å…·ä½“åŸå› æ˜¯å› ä¸ºå®‰è£…çš„MongoDB 6ç‰ˆæœ¬éœ€è¦çš„SELinuxçš„é—®é¢˜ï¼Œå…·ä½“å¯ä»¥æŸ¥çœ‹å®˜ç½‘æ–‡æ¡£ï¼š</li>
</ul>
<p><a href="https://www.mongodb.com/docs/manual/tutorial/install-mongodb-on-red-hat/#configure-selinux">configure-selinux</a></p>
<h3 id="è¿˜æœ‰ä¸€ç§æƒ…å†µéœ€è¦æ³¨æ„"><a href="#è¿˜æœ‰ä¸€ç§æƒ…å†µéœ€è¦æ³¨æ„" class="headerlink" title="è¿˜æœ‰ä¸€ç§æƒ…å†µéœ€è¦æ³¨æ„"></a>è¿˜æœ‰ä¸€ç§æƒ…å†µéœ€è¦æ³¨æ„</h3><p>ä¹‹å‰mongodbå¯åŠ¨è¿›ç¨‹çš„æ–‡ä»¶<code>/tmp/mongodb-27017.sock</code>æƒé™ä¸æ˜¯ç”¨æˆ·mongodçš„ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ ll /tmp/</span><br><span class="line">total 824</span><br><span class="line">drwxr-xr-x. 2 root  root      18 Aug  1 21:33 hsperfdata_root</span><br><span class="line">-rwx------. 1 root  root     836 Aug  1 21:36 ks-script-0MAoJL</span><br><span class="line">-rwx------. 1 root  root    1237 Aug  1 21:36 ks-script-EGB51o</span><br><span class="line">srwx------. 1 root  root       0 Aug  4 15:44 mongodb-27017.sock</span><br></pre></td></tr></table></figure>

<p>éœ€è¦æŠŠ<code>/tmp/mongodb-27017.sock</code>è¿™ä¸ªæ–‡ä»¶åˆ é™¤åå†å°è¯•å¯åŠ¨mongo</p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>æœåŠ¡å™¨æ€§èƒ½ä¼˜åŒ–</title>
    <url>/srv-optimize/</url>
    <content><![CDATA[<div class=".article-gallery"><p><em>åœ¨ä¸€äº›é«˜QPSçš„åœºæ™¯ä¸‹ï¼ŒæœåŠ¡å™¨å¯èƒ½é¢ä¸´çš„æŒ‘æˆ˜å’Œé—®é¢˜æ€»ç»“ã€‚</em></p>
<ol>
<li>æœåŠ¡å™¨ä¸€å®šè¦æœ‰æµæ§åŠŸèƒ½å’Œé™çº§é¢„æ¡ˆï¼Œä¸€äº›æ¥å£å¯ä»¥æä¾›æœ‰æŸæœåŠ¡ï¼Œæœ€å·®æƒ…å†µåªè¦ä¿è¯æ ¸å¿ƒä¸šåŠ¡ä¸å‡ºé—®é¢˜ã€‚</li>
<li>æ¢³ç†å‡ºå„ä¸ªå…³é”®æ¥å£åœ¨ä¸å¯ç”¨æ—¶çš„è¡¨ç°ï¼Œå’Œå¤„ç†æ–¹æ¡ˆï¼Œå·²ç»å¯èƒ½é¢ä¸´çš„é—®é¢˜ï¼Œè½å®åˆ°æ–‡æ¡£ï¼Œä¸€æ­¥æ­¥æ”»åšã€‚</li>
<li>æ ¸å¿ƒä¸šåŠ¡å’Œæ¥å£é¢„ä¼°æœ€é«˜QPSï¼Œæ ¹æ®QPSæŒ‡æ ‡åšå¥½å…¨é“¾è·¯å‹æµ‹ã€‚</li>
<li>åšå¥½æ€§èƒ½ç›‘æ§å’ŒæŠ¥è­¦ï¼Œå®æ—¶æŸ¥çœ‹å¤§ç›˜æ•°æ®ã€‚</li>
<li>æœ€å¸¸å‡ºç°æ€§èƒ½ç“¶é¢ˆçš„åœ°æ–¹ï¼š<ul>
<li>ç™»å½•ï¼Œç‰¹åˆ«æ˜¯æ³¨å†Œæ–°ç”¨æˆ·ã€‚æµæ§é™åˆ¶æœåŠ¡çš„æ‰¿è½½ä¸Šé™ï¼Œä¸€å®šä¸èƒ½è¶…è¿‡å½“å‰æœåŠ¡çš„æ‰¿è½½ã€‚æµæ§è§¦å‘åï¼Œå‰ç«¯è¿›è¡Œå‹å¥½çš„è¿‡æ¸¡ï¼Œæ ¹æ®ä¸åŒçš„æ¸¸æˆç±»å‹è¿›è¡Œç‰¹å®šåœºæ™¯çš„å¤„ç†ï¼Œæ¯”å¦‚è¿›è¡Œä¸€å±€å•æœºæ¸¸æˆã€‚</li>
<li>é’ˆå¯¹ä¸€äº›æ›´æç«¯çš„åœºæ™¯ï¼Œå¯é¢„è§çš„æŸä¸ªæ—¶é—´æ®µï¼Œä¼šæœ‰å¤§é‡çš„ç”¨æˆ·ç™»å½•å’Œåˆ›å»ºï¼Œå‰ç«¯ä¸éªŒè¯æµæ§å‰ï¼Œç›´æ¥é¢„å…ˆå°†ç™»å½•è¿›è¡Œæ‰“æ•£ã€‚é’ˆå¯¹å¤§é‡åˆ›å»ºç”¨æˆ·å¼•èµ·çš„æ•°æ®åº“æ€§èƒ½ç“¶é¢ˆé—®é¢˜ï¼Œå¯ä»¥é¢„å…ˆç”Ÿæˆä¸€å¤§æ‰¹æ–°ç”¨æˆ·æ•°æ®ï¼Œæ”¾å…¥ç¼“å­˜ã€‚</li>
<li>æ³¨æ„ç©å®¶é€€å‡ºæˆ–æ‰çº¿çš„é€»è¾‘ï¼Œæ˜¯å¦æœ‰ä¸€äº›æ•°æ®å›å†™ï¼Œåˆ¤æ–­æ˜¯å¦ä¼šæˆä¸ºç“¶é¢ˆã€‚</li>
</ul>
</li>
<li>æ•°æ®åº“å¯èƒ½å‡ºç°é—®é¢˜çš„åœ°æ–¹ï¼š<ul>
<li>Mongo æå‰å…³é—­autosplitï¼Œmovechunkï¼ŒretryWritesã€‚</li>
<li>æ•°æ®åº“è¿æ¥è¦é¢„çƒ­ã€‚</li>
</ul>
</li>
<li>å‰ç«¯è¦æ³¨æ„çš„ä¸€äº›ç‚¹ï¼š<ul>
<li>æä¾›1åˆ°2ä¸ªå¤‡ç”¨çš„èµ„æºCDNã€‚</li>
<li>æœåŠ¡å™¨æä¾›ä¸¤ä¸ªä¸€çº§åŸŸåå’Œå‡ ä¸ªäºŒçº§åŸŸåè®©å®¢æˆ·ç«¯éšæœºé€‰å–ä½¿ç”¨ã€‚</li>
<li>è€ƒè™‘å‰ç«¯SDKä¸€äº›æ¥å£é‡åˆ°æ€§èƒ½ç“¶é¢ˆçš„æƒ…å†µï¼Œç‰¹åˆ«æ˜¯ç™»å½•éªŒè¯ï¼Œåšå¥½é¢„æ¡ˆå’Œé™çº§å¤„ç†ã€‚</li>
</ul>
</li>
<li>æ—¥å¿—åœ¨è¿™ç§çº§åˆ«ä¸‹ä¹Ÿå¯èƒ½å‡ºç°æ€§èƒ½ç“¶é¢ˆï¼Œçœ‹ä¸‹æ—¥å¿—åº“è¿˜æœ‰æ²¡æœ‰å¯ä¼˜åŒ–çš„åœ°æ–¹ï¼Œåœ¨æœ€é«˜å³°å¯ä»¥å…è®¸çŸ­æš‚çš„å°†infoçº§åˆ«æ—¥å¿—å…³é—­ï¼Œæµé‡ä¸‹æ¥ä¹‹åå°½å¿«åŠ¨æ€æ‰“å¼€ã€‚</li>
<li>æå‰åšå¥½ä¸Šçº¿å‰çš„å„ç§é¢„æ¡ˆå’Œä¸Šçº¿æµç¨‹ï¼Œä»¥åŠå¼‚å¸¸æƒ…å†µä¸‹çš„é™çº§å¤„ç†æµç¨‹ï¼Œè´£ä»»åˆ°äººï¼Œæ–‡æ¡£åŒ–ï¼Œæœ‰è¿¹å¯å¾ªï¼Œä¸æ…Œä¹±ã€‚</li>
<li>æ£€æŸ¥æœ€åæ˜¯å¦è¿˜æœ‰é—æ¼çš„åœ°æ–¹ï¼Œç‰¹åˆ«æ˜¯å‡†å¤‡è€ç”¨æˆ·æˆ–è€…å‹æµ‹æœªè¦†ç›–çš„åœºæ™¯ï¼Œä»¥åŠå…¨æœå¹¿æ’­ä¹‹ç±»çš„ã€‚</li>
</ol>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>é¢è¯•</tag>
        <tag>æœåŠ¡å™¨</tag>
      </tags>
  </entry>
  <entry>
    <title>SVN/Git å·®å¼‚æ¯”å¯¹æ’ä»¶</title>
    <url>/svn-git-diff/</url>
    <content><![CDATA[<div class=".article-gallery"><h2 id="å®‰è£…ç¯å¢ƒ"><a href="#å®‰è£…ç¯å¢ƒ" class="headerlink" title="å®‰è£…ç¯å¢ƒ"></a>å®‰è£…ç¯å¢ƒ</h2><p>ç³»ç»Ÿç¯å¢ƒï¼šWindows10ã€Officeå¥—ä»¶ã€‚å…¬å¸ç”µè„‘å·²é»˜è®¤å®‰è£…ã€‚</p>
<p>å¿…å¤‡è½¯ä»¶ï¼š<a href="https://osdn.net/projects/tortoisesvn/storage/1.14.1/Application/TortoiseSVN-1.14.1.29085-x64-svn-1.14.1.msi/">TortoiseSVN</a>æˆ–<a href="https://tortoisegit.org/download/">TortoiseGit</a>ã€‚å¤§éƒ¨åˆ†äººåº”è¯¥å·²å®‰è£…ã€‚</p>
<h2 id="å®‰è£…è¯´æ˜"><a href="#å®‰è£…è¯´æ˜" class="headerlink" title="å®‰è£…è¯´æ˜"></a>å®‰è£…è¯´æ˜</h2><p><strong>æ–¹æ³•ä¸€</strong>ã€</p>
<p>ä¸‹è½½batæ–‡ä»¶åˆ°æœ¬åœ°ï¼Œé¼ æ ‡å³é”®ç‚¹å‡»ï¼Œä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œå³å¯ã€‚</p>
<p>diff-xlsx-ssc.bat</p>
<p>ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡</p>
<span id="more"></span>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"></span><br><span class="line">CHCP 65001</span><br><span class="line"></span><br><span class="line">:: ç³»ç»Ÿç¯å¢ƒå˜é‡</span><br><span class="line"><span class="built_in">set</span> ENV_PATH=%PATH%</span><br><span class="line">@<span class="built_in">echo</span> ====current environmentï¼š</span><br><span class="line">@<span class="built_in">echo</span> %ENV_PATH%</span><br><span class="line"></span><br><span class="line">:: å¯ç”¨å‘½ä»¤æ‰©å±•</span><br><span class="line">setlocal enabledelayedexpansion</span><br><span class="line"><span class="built_in">set</span> svnStr=SVN</span><br><span class="line"><span class="built_in">set</span> gitStr=Git</span><br><span class="line">:: è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¼ å…¥å­—ç¬¦ä¸²ENV_PATHå’Œè¦æŸ¥æ‰¾çš„å­—ç¬¦ä¸²svnStrã€‚lensæ˜¯å®ƒçš„è¿”å›å€¼</span><br><span class="line">call :getSubIndex ENV_PATH svnStr lensSvn</span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;%lensSvn%&quot;</span>==<span class="string">&quot;&quot;</span> (</span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&quot;æ²¡æœ‰æ‰¾åˆ°SVN&quot;</span></span><br><span class="line">	goto :notSetSVN</span><br><span class="line">) <span class="keyword">else</span> (</span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&quot;æ‰¾åˆ°TortoiseSVNç¯å¢ƒå˜é‡&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:: æ›¿æ¢svnçš„jsæ–‡ä»¶</span><br><span class="line">call :getLastIndex ENV_PATH lensSvn svnPath</span><br><span class="line"><span class="built_in">set</span> svnDiffPath=<span class="string">&quot;%svnPath%\Diff-Scripts\diff-xls.js&quot;</span></span><br><span class="line"><span class="built_in">echo</span> %svnDiffPath%</span><br><span class="line">call :writeJSFile svnDiffPath</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;æˆåŠŸè®¾ç½®SVN&quot;</span></span><br><span class="line"></span><br><span class="line">:notSetSVN</span><br><span class="line"></span><br><span class="line">call :getSubIndex ENV_PATH gitStr lensGit</span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;%lensGit%&quot;</span>==<span class="string">&quot;&quot;</span> (</span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&quot;æ²¡æœ‰æ‰¾åˆ°Git&quot;</span></span><br><span class="line">) <span class="keyword">else</span> (</span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&quot;æ‰¾åˆ°TortoiseGitç¯å¢ƒå˜é‡&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:: æ›¿æ¢gitçš„jsæ–‡ä»¶</span><br><span class="line">call :getLastIndex ENV_PATH lensGit gitPath</span><br><span class="line"><span class="built_in">set</span> gitDiffPath=<span class="string">&quot;%gitPath%\Diff-Scripts\diff-xls.js&quot;</span></span><br><span class="line"><span class="built_in">echo</span> %gitDiffPath%</span><br><span class="line">call :writeJSFile gitDiffPath</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;æˆåŠŸè®¾ç½®Git&quot;</span></span><br><span class="line"></span><br><span class="line">:notSetGit</span><br><span class="line"></span><br><span class="line">pause</span><br><span class="line"></span><br><span class="line"><span class="built_in">exit</span> /b</span><br><span class="line">:getLastIndex</span><br><span class="line">setlocal enabledelayedexpansion</span><br><span class="line"><span class="built_in">set</span> /A len+=%2</span><br><span class="line"><span class="built_in">set</span> value=</span><br><span class="line">:strLen_LoopIndex</span><br><span class="line">	<span class="built_in">set</span> /A num=len-1</span><br><span class="line">	<span class="keyword">if</span> not <span class="string">&quot;!%1:~%num%,1!&quot;</span>==<span class="string">&quot;&quot;</span> (</span><br><span class="line">		<span class="keyword">if</span> <span class="string">&quot;!%1:~%num%,1!&quot;</span>==<span class="string">&quot;;&quot;</span> (</span><br><span class="line">			<span class="built_in">echo</span> <span class="string">&quot;%value%&quot;</span></span><br><span class="line">			endlocal &amp; <span class="built_in">set</span> %3=%value%</span><br><span class="line">		) <span class="keyword">else</span> (</span><br><span class="line">			<span class="built_in">set</span> /A len=len-1</span><br><span class="line">			<span class="built_in">set</span> value=!%1:~%num%,1!%value%</span><br><span class="line">			goto :strLen_LoopIndex</span><br><span class="line">		)</span><br><span class="line">	) <span class="keyword">else</span> (</span><br><span class="line">		endlocal &amp; <span class="built_in">set</span> %3=%value%</span><br><span class="line">	)</span><br><span class="line"><span class="built_in">exit</span> /b</span><br><span class="line"></span><br><span class="line"><span class="built_in">exit</span> /b</span><br><span class="line">:getSubIndex</span><br><span class="line">setlocal enabledelayedexpansion</span><br><span class="line">:strLen_Loop</span><br><span class="line">    <span class="built_in">set</span> /A len+=1</span><br><span class="line">    <span class="built_in">set</span> /A len1+=0</span><br><span class="line">    <span class="built_in">set</span> /A num=len-1</span><br><span class="line">    ::åˆ¤æ–­ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°è¦æŸ¥æ‰¾çš„å­—ç¬¦æ˜¯å¦å·²ç»éå†åˆ°äº†ç»“å°¾ï¼Œå¦‚æœç»“å°¾äº†å°±è¯´æ˜åŒ¹é…åˆ°äº†</span><br><span class="line">    <span class="keyword">if</span> not <span class="string">&quot;!%2:~%len1%!&quot;</span>==<span class="string">&quot;&quot;</span> (</span><br><span class="line">    ::åˆ¤æ–­ç¬¬ä¸€ä¸ªä¼ å…¥çš„å­—ç¬¦ä¸²æ˜¯å¦å·²ç»éå†åˆ°äº†ç»“å°¾</span><br><span class="line">    <span class="keyword">if</span> not <span class="string">&quot;!%1:~%num%!&quot;</span>==<span class="string">&quot;&quot;</span> (</span><br><span class="line">        <span class="keyword">if</span> not <span class="string">&quot;!%2:~%len1%!&quot;</span>==<span class="string">&quot;&quot;</span> (</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;!%1:~%num%,1!&quot;</span>==<span class="string">&quot;!%2:~%len1%,1!&quot;</span> (</span><br><span class="line">				<span class="built_in">set</span> /A len1=len1+1</span><br><span class="line">            ) <span class="keyword">else</span> (</span><br><span class="line">                <span class="built_in">set</span> /A len1=0</span><br><span class="line">            )</span><br><span class="line">            goto :strLen_Loop</span><br><span class="line">        ) <span class="keyword">else</span> (</span><br><span class="line">			endlocal &amp; <span class="built_in">set</span> %3=%num%</span><br><span class="line">          )</span><br><span class="line">        )</span><br><span class="line">    ) <span class="keyword">else</span> (</span><br><span class="line">        endlocal &amp; <span class="built_in">set</span> %3=%num%</span><br><span class="line">    )</span><br><span class="line"><span class="built_in">exit</span> /b</span><br><span class="line"></span><br><span class="line"><span class="built_in">exit</span> /b</span><br><span class="line">:writeJSFile</span><br><span class="line">setlocal enabledelayedexpansion</span><br><span class="line"></span><br><span class="line">more +109 %~dp0\diff-xlsx-ssc.bat &gt; !%1!</span><br><span class="line"><span class="built_in">exit</span> /b</span><br><span class="line"></span><br><span class="line">:: jsæ¯”å¯¹è„šæœ¬</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">var objArgs = WScript.Arguments;</span><br><span class="line"><span class="keyword">if</span> (objArgs.length &lt; 2)</span><br><span class="line">&#123;</span><br><span class="line">    Abort(<span class="string">&quot;Usage: [CScript | WScript] diff-xls.js base.xls new.xls&quot;</span>, <span class="string">&quot;Invalid arguments&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var sBaseDoc = objArgs(0);</span><br><span class="line">var sNewDoc = objArgs(1);</span><br><span class="line"></span><br><span class="line">var objScript = new ActiveXObject(<span class="string">&quot;Scripting.FileSystemObject&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (objScript.GetBaseName(sBaseDoc) === objScript.GetBaseName(sNewDoc))</span><br><span class="line">&#123;</span><br><span class="line">    Abort(<span class="string">&quot;File &#x27;&quot;</span> + sBaseDoc + <span class="string">&quot;&#x27; and &#x27;&quot;</span> + sNewDoc + <span class="string">&quot;&#x27; is same file name.\nCannot compare the documents.&quot;</span>, <span class="string">&quot;Same file name&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!objScript.FileExists(sBaseDoc))</span><br><span class="line">&#123;</span><br><span class="line">    Abort(<span class="string">&quot;File &#x27;&quot;</span> + sBaseDoc + <span class="string">&quot;&#x27; does not exist.\nCannot compare the documents.&quot;</span>, <span class="string">&quot;File not found&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!objScript.FileExists(sNewDoc))</span><br><span class="line">&#123;</span><br><span class="line">    Abort(<span class="string">&quot;File &#x27;&quot;</span> + sNewDoc + <span class="string">&quot;&#x27; does not exist.\nCannot compare the documents.&quot;</span>, <span class="string">&quot;File not found&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sBaseDoc = objScript.GetAbsolutePathName(sBaseDoc);</span><br><span class="line">sNewDoc = objScript.GetAbsolutePathName(sNewDoc);</span><br><span class="line">var sTempFolder = objScript.GetSpecialFolder(2)</span><br><span class="line">var sTempFile = <span class="string">&quot;D:\\temp.txt&quot;</span></span><br><span class="line">objScript = null;</span><br><span class="line"></span><br><span class="line">var fs = new ActiveXObject(<span class="string">&quot;Scripting.FileSystemObject&quot;</span>);</span><br><span class="line">var f = fs.CreateTextFile(sTempFile, 2, <span class="literal">true</span>)</span><br><span class="line">f.WriteLine(sBaseDoc)</span><br><span class="line">f.WriteLine(sNewDoc)</span><br><span class="line">f.close()</span><br><span class="line">fs = null</span><br><span class="line">f = null</span><br><span class="line"></span><br><span class="line">WScript</span><br><span class="line">var objShell = new ActiveXObject(<span class="string">&quot;WScript.Shell&quot;</span>);</span><br><span class="line">objShell.run(<span class="string">&#x27;&quot;C:\\Program Files\\Microsoft Office\\root\\Client\\AppVLP.exe&quot; &quot;C:\\Program Files (x86)\\Microsoft Office\\Office16\\DCF\\SPREADSHEETCOMPARE.EXE&quot; &quot;D:\\temp.txt&quot;&#x27;</span>, 0, <span class="literal">true</span>)</span><br><span class="line">objShell = null</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>æ–¹æ³•äºŒ</strong>ã€</p>
<ol>
<li><p>ä¸‹è½½æ–‡ä»¶ä¿å­˜åˆ°æœ¬åœ°ç£ç›˜Dç›®å½•ä¸‹ï¼š</p>
<p>diff-xlsx-ssc.vbs</p>
</li>
</ol>
<p>ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡ğŸ‘‡</p>
<figure class="highlight vbscript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">Option</span> <span class="keyword">Explicit</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> objArgs</span><br><span class="line"><span class="keyword">Set</span> objArgs = WScript.Arguments</span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> num</span><br><span class="line">num = objArgs.Count</span><br><span class="line"><span class="keyword">If</span> num &lt; <span class="number">2</span> <span class="keyword">Then</span></span><br><span class="line">    MsgBox <span class="string">&quot;Usage: [CScript | WScript] diff-xlsx.vbs base.xlsx new.xlsx&quot;</span>, vbExclamation, <span class="string">&quot;Invalid arguments&quot;</span></span><br><span class="line">    WScript.Quit <span class="number">1</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> sBaseFile, sNewFile</span><br><span class="line">sBaseFile = objArgs(<span class="number">0</span>)</span><br><span class="line">sNewFile = objArgs(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">Set</span> objArgs = <span class="literal">Nothing</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">Dim</span> objFileSystem</span><br><span class="line"><span class="keyword">Set</span> objFileSystem = <span class="built_in">CreateObject</span>(<span class="string">&quot;Scripting.FileSystemObject&quot;</span>)</span><br><span class="line"><span class="keyword">If</span> objFileSystem.FileExists(sBaseFile) = <span class="literal">False</span> <span class="keyword">Then</span></span><br><span class="line">    MsgBox <span class="string">&quot;File &quot;</span> + sBaseFile + <span class="string">&quot; does not exist.  Cannot compare the files.&quot;</span>, vbExclamation, <span class="string">&quot;File not found&quot;</span></span><br><span class="line">    WScript.Quit <span class="number">1</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="keyword">If</span> objFileSystem.FileExists(sNewFile) = <span class="literal">False</span> <span class="keyword">Then</span></span><br><span class="line">    MsgBox <span class="string">&quot;File &quot;</span> + sNewFile + <span class="string">&quot; does not exist.  Cannot compare the files.&quot;</span>, vbExclamation, <span class="string">&quot;File not found&quot;</span></span><br><span class="line">    WScript.Quit <span class="number">1</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;Compare file size</span></span><br><span class="line"><span class="keyword">Dim</span> fBaseFile, fNewFile, sTempFolder, sTempFile</span><br><span class="line"><span class="keyword">Set</span> fBaseFile = objFileSystem.GetFile(sBaseFile)</span><br><span class="line"><span class="keyword">Set</span> fNewFile = objFileSystem.GetFile(sNewFile)</span><br><span class="line">sTempFolder = objFileSystem.GetSpecialFolder(<span class="number">2</span>)</span><br><span class="line">sTempFile = sTempFolder + <span class="string">&quot;\temp.txt&quot;</span></span><br><span class="line"><span class="keyword">Set</span> objFileSystem = <span class="literal">Nothing</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;Create temp.txt for save path of 2 xlsx files</span></span><br><span class="line"><span class="keyword">Dim</span> fs, f</span><br><span class="line"><span class="keyword">Set</span> fs = WScript.<span class="built_in">CreateObject</span>(<span class="string">&quot;Scripting.FileSystemObject&quot;</span>)</span><br><span class="line"><span class="keyword">Set</span> f = fs.CreateTextFile(sTempFile, <span class="number">2</span>, <span class="literal">True</span>)</span><br><span class="line">f.WriteLine sBaseFile</span><br><span class="line">f.WriteLine sNewFile</span><br><span class="line">f.Close()</span><br><span class="line"><span class="keyword">Set</span> fs = <span class="literal">Nothing</span></span><br><span class="line"><span class="keyword">Set</span> f = <span class="literal">Nothing</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&#x27;Compare files using SPREADSHEETCOMPARE.exe</span></span><br><span class="line"><span class="keyword">Dim</span> WshShell, result</span><br><span class="line"><span class="keyword">Set</span> WshShell = WScript.<span class="built_in">CreateObject</span>(<span class="string">&quot;WScript.Shell&quot;</span>)</span><br><span class="line"><span class="comment">&#x27;Old office version 2016?</span></span><br><span class="line"><span class="comment">&#x27;result = WshShell.Run(&quot;&quot;&quot;C:\Program Files (x86)\Microsoft Office\Office16\DCF\SPREADSHEETCOMPARE.exe&quot;&quot; &quot; &amp; sTempFile, 0, True)</span></span><br><span class="line"><span class="comment">&#x27;Office 365</span></span><br><span class="line"><span class="comment">&#x27;Could be this result = WshShell.Run(&quot;&quot;&quot;C:\Program Files\Microsoft Office\root\vfs\ProgramFilesX86\Microsoft Office\Office16\DCF\SPREADSHEETCOMPARE.EXE&quot;&quot; &quot; &amp; sTempFile, 0, True)</span></span><br><span class="line">result = WshShell.Run(<span class="string">&quot;&quot;&quot;C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Microsoft Office Tools\Spreadsheet Compare&quot;&quot; &quot;</span> &amp; sTempFile, <span class="number">0</span>, <span class="literal">True</span>)</span><br><span class="line"><span class="keyword">Set</span> WshShell = <span class="literal">Nothing</span></span><br><span class="line"></span><br><span class="line">WScript.Quit</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<ol start="2">
<li><p>æ‰¾ä¸ªç©ºç™½åœ°æ–¹é¼ æ ‡å³é”® -&gt; TortoiseSVN -&gt; Settings -&gt; Diff Viewer -&gt; Advanced</p>
<p><a href="https://imgtu.com/i/5YUreU"><a href="https://z3.ax1x.com/2021/10/17/5YUreU.md.png" title="5YUreU.md.png" class="gallery-item" style="box-shadow: none;"> <img src="https://z3.ax1x.com/2021/10/17/5YUreU.md.png" alt="5YUreU.md.png"></a></a></p>
</li>
<li><p>ä¿®æ”¹.xlsx çš„å€¼ä¸º <code>wscript.exe &quot;D:\diff-xlsx-ssc.vbs&quot; %base %mine //E:vbscript</code></p>
<p><a href="https://imgtu.com/i/5YUBLT"><a href="https://z3.ax1x.com/2021/10/17/5YUBLT.png" title="5YUBLT.png" class="gallery-item" style="box-shadow: none;"> <img src="https://z3.ax1x.com/2021/10/17/5YUBLT.png" alt="5YUBLT.png"></a></a></p>
</li>
</ol>
<h2 id="ä½¿ç”¨è¯´æ˜"><a href="#ä½¿ç”¨è¯´æ˜" class="headerlink" title="ä½¿ç”¨è¯´æ˜"></a>ä½¿ç”¨è¯´æ˜</h2><p>å’ŒSVN/Gitå·¥å…·æ¯”å¯¹æ–‡ä»¶çš„æ“ä½œä¸€æ ·ï¼š</p>
<blockquote>
<p>é¼ æ ‡å³é”®ç‚¹å‡»æ–‡ä»¶ -&gt; TortoiseSVN -&gt; Show log</p>
<p>é€‰æ‹©è¦æ¯”å¯¹å·®å¼‚çš„ç‰ˆæœ¬</p>
<p>å³é”®ç‚¹å‡»è¦æŸ¥çœ‹çš„excelæ–‡ä»¶ -&gt; Show changes</p>
</blockquote>
<p>æ¯”å¯¹ç»“æœå¦‚ä¸‹å›¾ï¼š</p>
<p><a href="https://imgtu.com/i/5YadtH"><a href="https://z3.ax1x.com/2021/10/17/5YadtH.png" title="5YadtH.png" class="gallery-item" style="box-shadow: none;"> <img src="https://z3.ax1x.com/2021/10/17/5YadtH.png" alt="5YadtH.png"></a></a></p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>æœåŠ¡å™¨</tag>
      </tags>
  </entry>
  <entry>
    <title>TCP/UDP</title>
    <url>/tcp/</url>
    <content><![CDATA[<div class=".article-gallery"><h2 id="TCPå¸¸è§é¢è¯•é¢˜"><a href="#TCPå¸¸è§é¢è¯•é¢˜" class="headerlink" title="TCPå¸¸è§é¢è¯•é¢˜"></a>TCPå¸¸è§é¢è¯•é¢˜</h2><p><a href="https://zhuanlan.zhihu.com/p/388704023">TCP</a></p>
<h4 id="TCPåè®®é—®é¢˜"><a href="#TCPåè®®é—®é¢˜" class="headerlink" title="TCPåè®®é—®é¢˜"></a>TCPåè®®é—®é¢˜</h4><ul>
<li>è¿æ¥<ul>
<li>ä¸‰æ¬¡æ¡æ‰‹<ul>
<li>è´¹æ—¶ï¼š4Gç½‘ç»œ(3*100ms)</li>
<li>è´¹åŠ›ï¼š3ä¸ªæ•°æ®åŒ…</li>
<li>ä¼˜åŒ–ï¼š<a href="https://zh.wikipedia.org/zh/TCP%E5%BF%AB%E9%80%9F%E6%89%93%E5%BC%80">TCP Fast Open</a></li>
</ul>
</li>
<li>åŠè¿æ¥(åˆå§‹åŒ–è¿æ¥SYNè¶…æ—¶)<ul>
<li>è€—è´¹ç½‘ç»œèµ„æºï¼š5æ¬¡é‡å‘SYN-ACKåŒ…</li>
<li>è€—è´¹æœåŠ¡å™¨èµ„æºï¼š63ç§’åæ–­å¼€è¿æ¥(TIME_WAIT = 2*MSL)</li>
<li>æ˜“è¢«æ”»å‡»ï¼š<a href="https://www.jianshu.com/p/6eae45826754">SYN floodæ‹’ç»æœåŠ¡æ”»å‡»</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<span id="more"></span>

<ul>
<li><p>æ–­å¼€</p>
<ul>
<li>TIME_WAITçŠ¶æ€<ul>
<li>2*MSLï¼šsudo sysctl -a | grep time_wait</li>
<li>æœåŠ¡å™¨ï¼šTIME_WAITè¿æ¥ï¼Œå ç”¨æœºå™¨çš„å†…å­˜èµ„æº</li>
<li>å®¢æˆ·ç«¯ï¼šTIME_WAITè¿æ¥ï¼Œå ç”¨TCPåè®®çš„ç«¯å£</li>
</ul>
</li>
<li>ä¼˜åŒ–<ul>
<li>è¿æ¥æœ¬æœºæœåŠ¡ï¼Œé¦–é€‰UNIXåŸŸå¥—æ¥å­—ï¼Œ<a href="https://jaminzhang.github.io/network/the-difference-between-unix-domain-socket-and-tcp-ip-socket/">æé«˜é€šä¿¡æ•ˆç‡</a>ï¼Œä¹Ÿé¿å…æµªè´¹TCPç«¯å£</li>
<li>åŠ å¿«å›æ”¶ï¼šsudo sysctl -w net.ipv4.tcp_tw_recycle = 1</li>
<li>è¿æ¥å¤ç”¨ï¼šsudo sysctl -w net.ipv4.tcp_tw_reuse = 1</li>
</ul>
</li>
</ul>
</li>
<li><p>ä¼ è¾“</p>
<ul>
<li>ä¿åºæœºåˆ¶ï¼šæµå¼äº¤ä»˜ï¼Œå‰åºåŒ…é˜»å¡</li>
<li>ç¡®è®¤æœºåˆ¶ï¼š<ul>
<li>å»¶è¿Ÿç¡®è®¤ï¼šæ»‘åŠ¨çª—å£åœç­‰ï¼Œé™ä½ååç‡</li>
<li>å¿«é€Ÿç¡®è®¤ï¼šæ¶ˆè€—å¸¦å®½</li>
<li>ä¼˜åŒ–ï¼šå¿«é€Ÿç¡®è®¤å’Œå»¶è¿Ÿç¡®è®¤ä¸¤ç§æ¨¡å¼è‡ªåŠ¨åˆ‡æ¢</li>
</ul>
</li>
<li>è¶…æ—¶é‡ä¼ ï¼š<ul>
<li>é»˜è®¤ï¼šå¿…é¡»ç­‰å¾…RTO(Retransmission TimeOut )è¶…æ—¶ï¼Œä¸èƒ½å¿«é€Ÿå“åº”å½“å‰ç½‘ç»œçŠ¶å†µ</li>
<li>æ¯æ¬¡RTOè¶…æ—¶å¯¼è‡´é‡ä¼ åï¼ŒRTOå€¼ç¿»å€ï¼Œä¸€ç›´å°è¯•tcp_retries2æ¬¡é‡ä¼ </li>
<li>ä¼˜åŒ–ï¼š<a href="https://zhuanlan.zhihu.com/p/25596865">å¿«é€Ÿé‡ä¼ </a>ï¼ˆæ”¶åˆ°3ä¸ªé‡å¤çš„ACKå³å¼€å§‹é‡ä¼ ï¼‰</li>
</ul>
</li>
<li>é‡ä¼ æ•°é‡ï¼š<ul>
<li>é»˜è®¤ï¼šå‘é€æ–¹é‡ä¼ æ”¶åˆ°çš„ACKä¹‹åæ‰€æœ‰å·²å‘é€çš„æ•°æ®åŒ…ï¼Œæµªè´¹å¸¦å®½</li>
<li>ä¼˜åŒ–ï¼š<a href="https://zhuanlan.zhihu.com/p/25596865">é€‰æ‹©ç¡®è®¤</a>ï¼ˆåªé‡ä¼ SACKä¸­ç¼ºå°‘çš„æ•°æ®åŒ…ï¼‰</li>
</ul>
</li>
</ul>
</li>
<li><p>æµé‡æ§åˆ¶ï¼š</p>
<ul>
<li><p>ç³Šæ¶‚çª—å£ç»¼åˆç—‡</p>
<p>ï¼šæ¥æ”¶æ–¹æ¯æ¬¡åªå¤„ç†å°åŒ…ï¼Œæˆ–è€…å‘é€æ–¹ä¸€ç›´å‘é€å°åŒ…</p>
<ul>
<li>ä¼˜åŒ–ï¼š<a href="https://zh.wikipedia.org/wiki/%E4%BC%A0%E8%BE%93%E6%8E%A7%E5%88%B6%E5%8D%8F%E8%AE%AE">David D Clarkç®—æ³•ï¼ˆæ¥æ”¶ç«¯ï¼‰ï¼›Nagleç®—æ³•ï¼ˆå‘é€ç«¯ï¼‰</a>ï¼ˆé»˜è®¤æ‰“å¼€ï¼‰</li>
</ul>
</li>
<li><p>Nagleç®—æ³• + å»¶è¿Ÿç¡®è®¤</p>
<p>ï¼šHttp Serverä¸­Write-Write-Readæ¨¡å¼ä¸‹çš„40mså»¶è¿Ÿ</p>
<ul>
<li>ä¼˜åŒ–ï¼šè®¾ç½®TCP_NODELAYé€‰é¡¹ï¼Œç¦ç”¨Nagleç®—æ³•</li>
</ul>
</li>
</ul>
</li>
<li><p>æ‹¥å¡æ§åˆ¶ï¼ˆRenoç®—æ³•ï¼‰ï¼š</p>
<ul>
<li>æ¦‚å¿µï¼š<ul>
<li>RTTï¼ˆRound Trip Timeï¼‰ï¼šå¾€è¿”æ—¶é—´ï¼ˆä»æ•°æ®åŒ…å‘å‡ºåˆ°æ”¶åˆ°ACKçš„æ—¶é—´ï¼‰</li>
<li>RTOï¼ˆRetransmission Timeï¼‰ï¼šé‡ä¼ æ—¶é—´ï¼ˆæ ¹æ®RTTåŠ¨æ€è°ƒæ•´ï¼Œä½œä¸ºé‡ä¼ å®šæ—¶å™¨çš„è¶…æ—¶æ—¶é—´ï¼Œæ”¶åˆ°ACKåé‡ç½®è¿æ¥çš„é‡ä¼ å®šæ—¶å™¨ï¼‰</li>
</ul>
</li>
<li>æ…¢å¯åŠ¨ï¼ˆæŒ‡æ•°å¢é•¿ï¼‰<ul>
<li>æ¯ä¸ªRTTå†…ï¼Œcwndéšæ”¶åˆ°çš„ACKçº¿æ€§è‡ªå¢ï¼›æ¯ä¸ªRTTåï¼Œcwndç¿»å€å¢é•¿</li>
<li>ä¸¢åŒ…ï¼Œæˆ–è€…cwndè¶…è¿‡æ…¢å¯åŠ¨é—¨é™ssthreshï¼šè¿›å…¥æ‹¥å¡é¿å…é˜¶æ®µ</li>
</ul>
</li>
<li>æ‹¥å¡é¿å…ï¼ˆé€€åŠé¿è®©ï¼Œçº¿æ€§å¢é•¿ï¼‰<ul>
<li>ä¸¢åŒ…<ul>
<li>RTOè¶…æ—¶ï¼šssthreshé™ä¸ºcwnd/2ï¼Œcwndé™ä¸º1ï¼Œé‡æ–°è¿›å…¥æ…¢å¯åŠ¨è¿‡ç¨‹</li>
<li>3ä¸ªé‡å¤ACKï¼šè¿›å…¥å¿«é€Ÿé‡ä¼ é˜¶æ®µ</li>
</ul>
</li>
<li>cwndè¶…è¿‡ssthreshï¼š<ul>
<li>æ¯ä¸ªRTTå†…ï¼Œcwndéšæ”¶åˆ°çš„ACKå¢é•¿1/cwndä¸ªMSSï¼›æ¯ä¸ªRTTåï¼Œcwndå¢é•¿1ä¸ªMSS</li>
</ul>
</li>
</ul>
</li>
<li>å¿«é€Ÿé‡ä¼ <ul>
<li>ssthreshé™ä¸ºcwnd/2ï¼Œcwndé™ä¸ºssthreshï¼Œè¿›å…¥å¿«é€Ÿæ¢å¤é˜¶æ®µ</li>
</ul>
</li>
<li>å¿«é€Ÿæ¢å¤<ul>
<li>cwndè®¾ç½®ä¸ºssthresh+3ï¼Œé‡ä¼ é‡å¤ACKæŒ‡å®šçš„æ•°æ®åŒ…</li>
<li>æ”¶åˆ°é‡å¤ACKï¼šcwndè‡ªå¢</li>
<li>æ”¶åˆ°æ–°çš„éé‡å¤ACKï¼šcwndç½®ä¸ºå¿«é€Ÿé‡ä¼ é˜¶æ®µçš„åˆå§‹ssthreshï¼Œè¿›å…¥æ‹¥å¡é¿å…é˜¶æ®µ</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="TCP-åè®®è°ƒä¼˜"><a href="#TCP-åè®®è°ƒä¼˜" class="headerlink" title="TCP åè®®è°ƒä¼˜"></a>TCP åè®®è°ƒä¼˜</h4><ul>
<li><p>setsockopt</p>
<ul>
<li>SOL_SOCKET</li>
</ul>
</li>
<li><p>```<br>SO_KEEPALIVEï¼šTCPå¿ƒè·³ï¼ˆç”Ÿæ•ˆä¸å¦è¿˜å–å†³äºtcp_keepalive_xxxï¼‰</p>
<p>SO_LINGERï¼šè®¾ç½®closeè¡Œä¸ºï¼ˆFIN or RSTï¼ŒTIME_WAIT or notï¼‰</p>
<p>SO_RCVBUFï¼šè®¾ç½®æ¥æ”¶ç¼“å­˜ï¼Œè¦†ç›–tcp_rmem</p>
<p>SO_SNDBUFï¼šè®¾ç½®å‘é€ç¼“å­˜ï¼Œè¦†ç›–tcp_wmem</p>
<p>SO_REUSERADDRï¼šè®¾ç½®åœ°å€é‡ç”¨</p>
<pre><code>1. å¤šå—ç½‘å¡å¤šä¸ªåœ°å€ï¼Œé€šé…ç¬¦bind

2. é‡ç”¨å¤„äºTIME_WAITçŠ¶æ€çš„socketåœ°å€
</code></pre>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">  IPPROTO_TCP</span><br><span class="line"></span><br><span class="line">- ```</span><br><span class="line">  TCP_NODELAYï¼šç¦ç”¨Nagleç®—æ³•ï¼Œå‡å°‘å‘é€å»¶æ—¶</span><br><span class="line">  </span><br><span class="line">  TCP_DEFER_ACCEPTï¼šå‡å°‘ä¸€æ¬¡æ¡æ‰‹ï¼ˆä»…é™äºLinuxç³»ç»Ÿä¹‹é—´ï¼‰</span><br></pre></td></tr></table></figure>

<p>æ¡æ‰‹</p>
<ul>
<li><p>```<br>net.ipv4.tcp_syn_retriesï¼šå®¢æˆ·ç«¯è¯·æ±‚è¿æ¥syné‡è¯•æ¬¡æ•°</p>
<p>net.ipv4.tcp_synack_retriesï¼šæœåŠ¡å™¨å›å¤syn+acké‡è¯•æ¬¡æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">  åŠè¿æ¥é˜Ÿåˆ—</span><br><span class="line"></span><br><span class="line">- ```</span><br><span class="line">  åŠè¿æ¥é˜Ÿåˆ—æº¢å‡ºï¼š</span><br><span class="line">  </span><br><span class="line">  netstat -s | grep LISTEN</span><br><span class="line">  </span><br><span class="line">  4375 SYNs to LISTEN sockets dropped</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  åŠè¿æ¥é˜Ÿåˆ—è°ƒä¼˜ï¼š</span><br><span class="line">  </span><br><span class="line">  net.ipv4.tcp_max_syn_backlogï¼šSYNé˜Ÿåˆ—é•¿åº¦</span><br><span class="line">  </span><br><span class="line">  net.ipv4.tcp_syncookiesï¼šSYNé˜Ÿåˆ—æº¢å‡ºæ—¶å‘å¯¹æ–¹å‘é€syncookiesï¼Œé˜²èŒƒSYNFloodæ”»å‡»</span><br></pre></td></tr></table></figure>

<p>å…¨è¿æ¥é˜Ÿåˆ—</p>
</li>
</ul>
</li>
<li><p>```<br>å…¨è¿æ¥é˜Ÿåˆ—æº¢å‡ºï¼š</p>
<p>netstat -s | grep listen</p>
<p>22438 times the listen queue of a socket overflowed</p>
<p>å…¨è¿æ¥é˜Ÿåˆ—è°ƒä¼˜ï¼š</p>
<p>net.core.somaxconï¼šåŒlisten()çš„backlogå…±åŒå†³å®šaccepté˜Ÿåˆ—é•¿åº¦:min(backlog,somaxconn) </p>
<p>net.ipv4.tcp_abort_on_overflowï¼šaccepté˜Ÿåˆ—æº¢å‡ºçš„å¤„ç†æ–¹å¼</p>
<pre><code>é»˜è®¤å…³é—­ï¼šæœåŠ¡å™¨accepté˜Ÿåˆ—æº¢å‡ºåï¼Œç›´æ¥ä¸¢å¼ƒå®¢æˆ·ç«¯çš„ACKã€‚å¾…RTOè¶…æ—¶åï¼Œé‡å‘SYN+ACKç»™å®¢æˆ·ç«¯ï¼ˆä¸è¶…è¿‡net.ipv4.tcp_synack_retriesæ¬¡ï¼‰ã€‚

æ‰“å¼€è¯¥é€‰é¡¹ï¼šæœåŠ¡å™¨accepté˜Ÿåˆ—æº¢å‡ºåï¼Œç›´æ¥å‘é€RSTç»™å®¢æˆ·ç«¯ï¼ˆconnection reset by peerï¼‰ã€‚
</code></pre>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">  ç¼“å­˜</span><br><span class="line"></span><br><span class="line">- ```</span><br><span class="line">  net.ipv4.tcp_wmemï¼šå‘é€ç¼“å­˜</span><br><span class="line">  </span><br><span class="line">  net.ipv4.tcp_rmemï¼šæ¥æ”¶ç¼“å­˜</span><br><span class="line">  </span><br><span class="line">  net.ipv4.tcp_moderate_rcvbufï¼šæ¥æ”¶ç¼“å­˜è‡ªåŠ¨ä¼¸ç¼©</span><br></pre></td></tr></table></figure>

<p>å¿ƒè·³</p>
</li>
<li><p>```<br>net.ipv4.tcp_keepalive_timeï¼šæ­£å¸¸å¿ƒè·³é—´éš”</p>
<p>net.ipv4.tcp_keepalive_intvlï¼šå¤±è´¥é‡è¯•é—´éš”</p>
<p>net.ipv4.tcp_keepalive_probesï¼šå¤±è´¥é‡è¯•æ¬¡æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">  TIME_WAIT</span><br><span class="line"></span><br><span class="line">- ```</span><br><span class="line">  net.ipv4.tcp_max_tw_bucketsï¼šå¤„äºTIME_WAITçŠ¶æ€çš„socketæ•°ä¸Šé™</span><br><span class="line">  </span><br><span class="line">  net.ipv4.tcp_tw_recycleï¼šæ˜¯å¦å°½å¿«å›æ”¶TIME_WAITçŠ¶æ€çš„socket</span><br><span class="line">  </span><br><span class="line">  net.ipv4.tcp_tw_reuseï¼šæ˜¯å¦å°½é‡é‡ç”¨TIME_WAITçŠ¶æ€çš„socket</span><br><span class="line">  </span><br><span class="line">  net.netfilter.nf_conntrack_tcp_timeout_time_waitï¼šsocketå¤„äºTIME_WAITçŠ¶æ€çš„æ—¶é—´</span><br></pre></td></tr></table></figure>

<p>å…¶ä»–</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net.ipv4.tcp_fin_timeoutï¼šè¿æ¥ä¸»åŠ¨æ–­å¼€æ–¹ç­‰å¾…å¯¹ç«¯FINåŒ…çš„æœ€å¤§æ—¶é—´</span><br><span class="line"></span><br><span class="line">net.ipv4.tcp_sackï¼šé€‰æ‹©ACKå¼€å…³</span><br><span class="line"></span><br><span class="line">net.ipv4.tcp_timestampsï¼šTCPæ—¶é—´æˆ³å¼€å…³ï¼ˆåœ¨TCPåŒ…å¤´å¢åŠ 12ä¸ªå­—èŠ‚ï¼Œèƒ½å¤Ÿè¯†åˆ«è¶…æ—¶é‡å‘åŒ…ï¼Œè®¡ç®—RTTæ›´ç²¾ç¡®ï¼‰</span><br></pre></td></tr></table></figure>

<h4 id="UDP"><a href="#UDP" class="headerlink" title="UDP"></a>UDP</h4><h5 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h5><ul>
<li>é€Ÿåº¦å¿«<ul>
<li>è·¨è¿è¥å•†ç½‘ç»œçš„æƒ…å†µä¸‹ï¼ŒUDPæœ‰å¯èƒ½æ¯”TCPå—120å€</li>
</ul>
</li>
<li>ç©¿è¶Šå¼º<ul>
<li><a href="https://zh.wikipedia.org/wiki/UDP%E6%89%93%E6%B4%9E">UDP æ‰“æ´</a></li>
</ul>
</li>
</ul>
<h5 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h5><ul>
<li>ä¼ è¾“ä¸å¯é <ul>
<li>åº”ç”¨å±‚è¦è®¾è®¡<a href="https://zh.wikipedia.org/wiki/%E8%87%AA%E5%8A%A8%E9%87%8D%E4%BC%A0%E8%AF%B7%E6%B1%82">ARQåè®®</a>ï¼Œåº”å¯¹ä¸¢åŒ…</li>
</ul>
</li>
<li>éœ€è¦è€ƒè™‘æ•°æ®åŒ…å¤§å°<ul>
<li>åº”ç”¨å±‚è¦è§„åˆ’æ•°æ®åŒ…å¤§å°ï¼Œé¿å…IPå±‚åˆ†ç‰‡å½±å“ä¼ è¾“æ•ˆç‡</li>
<li>åº”ç”¨å±‚MTUå¤šå¤§åˆé€‚ï¼Ÿ<ul>
<li>UDPåŒ…æ•°æ®æ®µï¼š2^16-1-8-20=65507</li>
<li>å±€åŸŸç½‘ï¼ˆEthernetï¼‰ï¼š1500-8-20=1472</li>
<li>å¹¿åŸŸç½‘ï¼ˆInternetï¼‰ï¼š576-8-20=548</li>
<li>æ¸¸æˆå¸¸ç”¨ï¼Œä¾¿äºè®°å¿†ï¼š500</li>
</ul>
</li>
</ul>
</li>
<li>ç®€å•æ¨¡å‹ä½æ•ˆï¼Œé«˜æ€§èƒ½ç¼–ç¨‹å¤æ‚</li>
</ul>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œ</tag>
        <tag>é¢è¯•</tag>
      </tags>
  </entry>
  <entry>
    <title>UE DSæœç®¡ç†</title>
    <url>/ue_ds_manager/</url>
    <content><![CDATA[<div class=".article-gallery"><h1 id="åœºæ™¯æœç®¡ç†"><a href="#åœºæ™¯æœç®¡ç†" class="headerlink" title="åœºæ™¯æœç®¡ç†"></a>åœºæ™¯æœç®¡ç†</h1><h2 id="åœºæ™¯æœv1-0"><a href="#åœºæ™¯æœv1-0" class="headerlink" title="åœºæ™¯æœv1.0"></a>åœºæ™¯æœv1.0</h2><p>åœºæ™¯æœæœ€åˆçš„æµç¨‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>dsé™¤äº†æˆ˜åœºå¤–ï¼Œè¿˜ä¼šæ ¹æ®å¯åŠ¨å‚æ•°ï¼Œè·‘ping</li>
<li>ä¸€ä¸ªPodä¸‹å¤šä¸ªæˆ˜åœºè¿›ç¨‹ï¼Œçˆ¶è¿›ç¨‹forkå›ºå®šæ•°é‡çš„å­è¿›ç¨‹</li>
<li>æˆ˜åœºè¿›ç¨‹å°†è‡ªå·±æ³¨å†Œåˆ°etcdä¸­ï¼Œkey: $namespace/$service_type/$ip:$port/$versionï¼Œé€šè¿‡ç§Ÿçº¦å’Œè¿›ç¨‹é€€å‡ºæ—¶åˆ é™¤keyæ¥ä¿è¯keyçš„æ—¶æ•ˆ</li>
<li>åœºæ™¯æœwatch etcdä¸­æ³¨å†Œçš„keyï¼Œæ¥æ„ŸçŸ¥å½“å‰æˆ˜åœº</li>
<li>æˆ˜åœºåˆ†é…æ—¶é€šè¿‡æŠ¢å stateKey: $namespace/$service_type/$ip:$port/$version/state</li>
<li>æŠ¢å åˆ°stateåï¼Œè¡¨ç¤ºæˆ˜åœºè¢«åˆ†é…ï¼Œåœºæ™¯æœå’Œæˆ˜åœºæœå»ºç«‹è¿æ¥ï¼Œå‰©ä¸‹çš„å°±æ˜¯ä¸šåŠ¡ä¸Šçš„å†…å®¹ï¼šåˆå§‹åŒ–æˆ˜åœºã€ç©å®¶æ•°æ®ï¼Œæˆ˜åœºç»“ç®—ç­‰<br>ä¼˜åŠ¿ï¼š<br>æµç¨‹ç®€å•<br>å±€é™ï¼š</li>
<li>etcdæ³¨å†Œçš„keyå¤ªå¤š</li>
<li>æˆ˜åœºå’Œåœºæ™¯æœçš„è¿æ¥è¿‡å¤š</li>
<li>ç¼ºå°‘æˆ˜åœºç®¡ç†ï¼Œåªæœ‰ç®€å•çš„æ³¨å†Œå’Œåˆ†é…ã€‚æ— æ³•å®ç°è‡ªåŠ¨æ‰©ç¼©å®¹</li>
</ul>
<p>æ³¨æ„ï¼š</p>
<h2 id="åŠ å…¥Agones"><a href="#åŠ å…¥Agones" class="headerlink" title="åŠ å…¥Agones"></a>åŠ å…¥Agones</h2><h2 id="åœºæ™¯æœv2-0"><a href="#åœºæ™¯æœv2-0" class="headerlink" title="åœºæ™¯æœv2.0"></a>åœºæ™¯æœv2.0</h2></div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>UE</tag>
      </tags>
  </entry>
  <entry>
    <title>DSå…±äº«å†…å­˜å’Œå¤šGameInstanceæ€§èƒ½å¯¹æ¯”</title>
    <url>/ue-multiworld-fork/</url>
    <content><![CDATA[<div class=".article-gallery"><h1 id="èƒŒæ™¯æè¿°"><a href="#èƒŒæ™¯æè¿°" class="headerlink" title="èƒŒæ™¯æè¿°"></a>èƒŒæ™¯æè¿°</h1><p>DSæœç›®å‰ä½¿ç”¨å…±äº«å†…å­˜ï¼ˆForkï¼‰æ–¹æ¡ˆï¼Œä¸€æ ¸å¯ä»¥è·‘25ä¸ªï¼Œå‹æµ‹æ•°æ®å¦‚ä¸‹ï¼š<br><a href="https://github.com/zhangga/picx-images-hosting/raw/master/mf-1.9kgkm6ldpf.webp" title="insight-1" class="gallery-item" style="box-shadow: none;"> <img src="https://github.com/zhangga/picx-images-hosting/raw/master/mf-1.9kgkm6ldpf.webp" alt="insight-1"></a><br><a href="https://github.com/zhangga/picx-images-hosting/raw/master/mf-2.8z6wzvvqoh.webp" title="insight-2" class="gallery-item" style="box-shadow: none;"> <img src="https://github.com/zhangga/picx-images-hosting/raw/master/mf-2.8z6wzvvqoh.webp" alt="insight-2"></a><br><a href="https://github.com/zhangga/picx-images-hosting/raw/master/mf-3.13m62jc2gh.webp" title="insight-3" class="gallery-item" style="box-shadow: none;"> <img src="https://github.com/zhangga/picx-images-hosting/raw/master/mf-3.13m62jc2gh.webp" alt="insight-3"></a><br><a href="https://github.com/zhangga/picx-images-hosting/raw/master/mf-4.3ns0f6e9ym.webp" title="insight-4" class="gallery-item" style="box-shadow: none;"> <img src="https://github.com/zhangga/picx-images-hosting/raw/master/mf-4.3ns0f6e9ym.webp" alt="insight-4"></a></p>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>æ•°æ®</th>
</tr>
</thead>
<tbody><tr>
<td>CPUæ€»æ ¸</td>
<td>16c * 4</td>
</tr>
<tr>
<td>å†…å­˜æ€»é‡</td>
<td>64g * 4</td>
</tr>
<tr>
<td>æœºå™¨äººæ•°é‡</td>
<td>4800</td>
</tr>
<tr>
<td>è¥åœ°æ•°é‡</td>
<td>1600</td>
</tr>
<tr>
<td>CPUæœ€å¤§å ç”¨</td>
<td>&lt;60%</td>
</tr>
<tr>
<td>å†…å­˜æœ€å¤§å ç”¨</td>
<td>&lt;75%</td>
</tr>
</tbody></table>
<h1 id="é¢„æœŸç›®æ ‡"><a href="#é¢„æœŸç›®æ ‡" class="headerlink" title="é¢„æœŸç›®æ ‡"></a>é¢„æœŸç›®æ ‡</h1><p>å½“å‰DSæœä½¿ç”¨ <strong>16c*64g â€‹</strong>çš„æœºå‹ï¼Œæ ¸å¿ƒç›®æ ‡æ˜¯é™ä½å†…å­˜å ç”¨ï¼Œæœ€ç»ˆé€‚é…1:2çš„æ ‡é…æœºå‹ã€‚</p>
<h1 id="æ–¹æ¡ˆå¯¹æ¯”"><a href="#æ–¹æ¡ˆå¯¹æ¯”" class="headerlink" title="æ–¹æ¡ˆå¯¹æ¯”"></a>æ–¹æ¡ˆå¯¹æ¯”</h1><p>é‰´äºå¤š GameInstance ä¸å…±äº«å†…å­˜ä¸¤ç§æ–¹æ¡ˆå„æœ‰ä¼˜åŠ£ï¼Œéœ€é€šè¿‡å®é™…è·‘æµ‹è·å– CPU å ç”¨ã€å†…å­˜å¼€é”€ã€ç¨³å®šæ€§ç­‰æ ¸å¿ƒæ€§èƒ½æ•°æ®ï¼ŒåŸºäºå‡†ç¡®å¯¹æ¯”ç»“æœç¡®å®šæœ€ç»ˆæŠ€æœ¯æ–¹æ¡ˆã€‚</p>
<table>
<thead>
<tr>
<th>å¯¹æ¯”ç»´åº¦</th>
<th>å…±äº«å†…å­˜ï¼ˆForkï¼‰</th>
<th>å•è¿›ç¨‹å¤šGameInstance</th>
</tr>
</thead>
<tbody><tr>
<td>å†…å­˜å…±äº«æ–¹å¼</td>
<td>ç‰©ç†å†…å­˜é¡µçº§å…±äº«ï¼ˆCOWï¼‰</td>
<td>èµ„æºåªåŠ è½½ä¸€ä»½</td>
</tr>
<tr>
<td>å†…å­˜å¼€é”€</td>
<td>æœ‰COWçš„é¢å¤–å†…å­˜é¡µå¼€é”€</td>
<td>æ— é¢å¤–å¼€é”€ï¼Œèµ„æºå†…å­˜å…±äº«ï¼Œé€»è¾‘æ•°æ®å…¨éƒ¨åˆ†ç¦»</td>
</tr>
<tr>
<td>èµ„æºåŠ è½½</td>
<td>çˆ¶è¿›ç¨‹é¢„åŠ è½½ï¼Œå­è¿›ç¨‹å…±äº«</td>
<td>è¿›ç¨‹å†…åŠ è½½ä¸€æ¬¡ï¼Œæ‰€æœ‰å®ä¾‹å¤ç”¨</td>
</tr>
<tr>
<td>éš”ç¦»çº§åˆ«</td>
<td>è¿›ç¨‹çº§éš”ç¦»ï¼ˆå´©æºƒä¸æ‰©æ•£ï¼Œtické—´ç›¸äº’æ²¡å½±å“ï¼‰</td>
<td>å®ä¾‹çº§éš”ç¦»ï¼ˆå´©æºƒå½±å“æ‰€æœ‰å®ä¾‹ï¼Œtickå¡é¡¿å½±å“å…¶ä»–å®ä¾‹ï¼‰</td>
</tr>
<tr>
<td>æ¸¸æˆæµ‹è¯•</td>
<td>æ— é¢å¤–è´Ÿæ‹…</td>
<td>å¤šä¸ªInstanceè¢«åˆ†é…åˆ°åŒä¸€ä¸ªè¿›ç¨‹ä¸‹ï¼Œå¯èƒ½å’Œåˆ†é…åˆ°ä¸åŒè¿›ç¨‹ä¸‹ï¼Œè¡¨ç°ä¸ä¸€è‡´ï¼ˆæ•°æ®æ²¡éš”ç¦»çš„bugï¼‰</td>
</tr>
<tr>
<td>å®ä¾‹åˆ†é…</td>
<td>æ— é¢å¤–è´Ÿæ‹…</td>
<td>æ›´åŠ å¤æ‚çš„åˆ†é…å’Œé‡Šæ”¾å®ä¾‹çš„ç­–ç•¥</td>
</tr>
</tbody></table>
<h2 id="æµ‹è¯•ç¯å¢ƒ"><a href="#æµ‹è¯•ç¯å¢ƒ" class="headerlink" title="æµ‹è¯•ç¯å¢ƒ"></a>æµ‹è¯•ç¯å¢ƒ</h2><p>DSç‰ˆæœ¬ï¼š`LinuxServer_Trunk-Testxxxx</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ lscpu</span><br><span class="line">Architecture:                         x86_64</span><br><span class="line">CPU(s):                               32</span><br><span class="line">Model name:                           Intel(R) Xeon(R) Gold 6462C</span><br><span class="line">Thread(s) per core:                   2</span><br><span class="line">Core(s) per socket:                   16</span><br><span class="line">Socket(s):                            1</span><br><span class="line">CPU MHz:                              3899.634</span><br><span class="line">CPU max MHz:                          3900.0000</span><br><span class="line">CPU min MHz:                          800.0000</span><br><span class="line">L1d cache:                            768 KiB</span><br><span class="line">L1i cache:                            512 KiB</span><br><span class="line">L2 cache:                             32 MiB</span><br><span class="line">L3 cache:                             60 MiB</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ free -h</span><br><span class="line">               total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:            60Gi        16Gi       3.0Gi        17Gi        41Gi        26Gi</span><br><span class="line">Swap:             0B          0B          0B</span><br></pre></td></tr></table></figure>

<h2 id="æµ‹è¯•ç”¨ä¾‹"><a href="#æµ‹è¯•ç”¨ä¾‹" class="headerlink" title="æµ‹è¯•ç”¨ä¾‹"></a>æµ‹è¯•ç”¨ä¾‹</h2><p>45ä¸ªç©å®¶åˆ†æˆ15æ”¯é˜Ÿä¼ï¼Œè¿›å…¥15ä¸ªDSæœï¼Œåœ¨å…¶ä¸­ä¸åœåœ°ç§»åŠ¨å’Œæ›´æ¢è£…å¤‡ï¼ˆè¿™ä¸ªç”¨ä¾‹çš„æ“ä½œé¢‘ç‡æ˜¯è¦è¿œé«˜äºçº¿ä¸Šç©å®¶æ­£å¸¸æ“ä½œçš„ï¼‰ã€‚</p>
<h4 id="å…±äº«å†…å­˜"><a href="#å…±äº«å†…å­˜" class="headerlink" title="å…±äº«å†…å­˜"></a>å…±äº«å†…å­˜</h4><p>å¯åŠ¨15ä¸ªå­è¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹ä¸ºä¸€ä¸ªè¥åœ°å®ä¾‹</p>
<ul>
<li>çˆ¶è¿›ç¨‹</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">game     2415317 2415299  1 14:27 ?        00:00:03 /data00/ds/Latest/MyProject/Binaries/Linux/MyProjectServer-Linux-Test -SvcType=xx -DsaPid=2415299 -DsaSock=<span class="string">&quot;/data00/dsagent/2415299.sock&quot;</span> -UdpHost=10.10.10.10 -NumMultiWorld=1 -Map=<span class="string">&quot;/Game/Project/Maps/MyMap&quot;</span> -NumForks=15 -WaitAndForkCmdLinePath=/data00/ds/CmdLines -BiPath=<span class="string">&quot;/data00/ds/logs/bi&quot;</span> -ABSLOG=<span class="string">&quot;/data00/ds/logs/MyProject_MyMap.log&quot;</span> -core -nothreading -longtimeouts -unattended</span><br></pre></td></tr></table></figure>

<ul>
<li>å­è¿›ç¨‹</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">game@n253-012-090:/data00/ds/logs$ <span class="built_in">cat</span> /data00/ds/CmdLines/1</span><br><span class="line"></span><br><span class="line">-SvcType=xx -DsaPid=2415299 -DsaSock=<span class="string">&quot;/data00/dsagent/2415299.sock&quot;</span> -Port=30001 -UdpHost=10.10.10.10 -ABSLOG=<span class="string">&quot;/data00/ds/logs/MyProject_30001.log&quot;</span> -BiPath=<span class="string">&quot;/data00/ds/logs/bi&quot;</span> -core -nothreading -longtimeouts -unattended -NODEFAULTLOG</span><br></pre></td></tr></table></figure>

<h4 id="å¤šGameInstance"><a href="#å¤šGameInstance" class="headerlink" title="å¤šGameInstance"></a>å¤šGameInstance</h4><p>å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼Œå•è¿›ç¨‹ä¸‹15ä¸ªGameInstanceå®ä¾‹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">game     2430225 2430210 11 16:26 ?        00:01:25 /data00/ds/Latest/MyProject/Binaries/Linux/MyProjectServer-Linux-Test -SvcType=xx -DsaPid=2430210 -DsaSock=<span class="string">&quot;/data00/dsagent/2430210.sock&quot;</span> -UdpHost=10.10.10.10 -Port=30001 -NumMultiWorld=15 -Map=<span class="string">&quot;/Game/Project/Maps/MyMap&quot;</span> -BiPath=<span class="string">&quot;/data00/ds/logs/bi&quot;</span> -ABSLOG=<span class="string">&quot;/data00/ds/logs/MyProject_30001.log&quot;</span> -nofork -core -nothreading -longtimeouts -unattended</span><br></pre></td></tr></table></figure>

<h2 id="æµ‹è¯•ç»“æœ"><a href="#æµ‹è¯•ç»“æœ" class="headerlink" title="æµ‹è¯•ç»“æœ"></a>æµ‹è¯•ç»“æœ</h2><h4 id="Fork-vs-å¤šInstance"><a href="#Fork-vs-å¤šInstance" class="headerlink" title="Fork vs å¤šInstance"></a>Fork vs å¤šInstance</h4><p><a href="https://github.com/zhangga/picx-images-hosting/raw/master/mf-mem.6ikokz1cro.webp" title="memo" class="gallery-item" style="box-shadow: none;"> <img src="https://github.com/zhangga/picx-images-hosting/raw/master/mf-mem.6ikokz1cro.webp" alt="memo"></a></p>
<h4 id="Forkä¸‹çˆ¶å­"><a href="#Forkä¸‹çˆ¶å­" class="headerlink" title="Forkä¸‹çˆ¶å­"></a>Forkä¸‹çˆ¶å­</h4><p><a href="https://github.com/zhangga/picx-images-hosting/raw/master/mf-parent.102k4tuw06.webp" title="parent" class="gallery-item" style="box-shadow: none;"> <img src="https://github.com/zhangga/picx-images-hosting/raw/master/mf-parent.102k4tuw06.webp" alt="parent"></a><br><a href="https://github.com/zhangga/picx-images-hosting/raw/master/mf-child.3d56m196us.webp" title="child" class="gallery-item" style="box-shadow: none;"> <img src="https://github.com/zhangga/picx-images-hosting/raw/master/mf-child.3d56m196us.webp" alt="child"></a></p>
<h1 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h1><p><strong>å¤šGameInstanceæ–¹æ¡ˆåœ¨å†…å­˜ä¸Šæœ‰æ˜æ˜¾çš„ä¼˜åŠ¿ã€‚</strong></p>
<ol>
<li>åœºæ™¯å¯åŠ¨åï¼Œç©å®¶è¿˜æ²¡è¿›å…¥åœºæ™¯çš„æ—¶å€™ï¼Œä¸¤è€…å†…å­˜å ç”¨å·®ä¸å¤š</li>
<li>Forkæ¨¡å¼ä¸‹ï¼Œç©å®¶è¿›å…¥åœºæ™¯åå†…å­˜æ˜æ˜¾å¢åŠ ï¼ˆCOWï¼‰ï¼Œ5åˆ†é’Ÿåè¶‹äºç¨³å®šï¼Œå†…å­˜å¢é•¿äº†117%ï¼ˆ1557mï¼‰</li>
<li>å¤šGameInstanceæ¨¡å¼ä¸‹ï¼Œç©å®¶è¿›å…¥åœºæ™¯åå†…å­˜å°±ç¨³å®šäº†ï¼Œå†…å­˜å¢é•¿äº†15%ï¼ˆ189mï¼‰</li>
</ol>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>UE</tag>
      </tags>
  </entry>
  <entry>
    <title>umlç±»å›¾ç¬”è®°</title>
    <url>/uml/</url>
    <content><![CDATA[<div class=".article-gallery"><p>åœ¨<a href="https://www.bilibili.com/video/BV1vUL1z3EK1/?spm_id_from=333.1387.collection.video_card.click&vd_source=3f8b035622abf22b7db10506f813a904">Bç«™</a>çœ‹åˆ°ä¸€ä¸ªå¯¹UMLç±»å›¾æ€»ç»“çš„ç®€å•æ˜äº†çš„ï¼Œåšä¸‹è®°å½•ï¼Œæ–¹ä¾¿ä¹‹åç”»å›¾çš„æ—¶å€™æŸ¥æ‰¾ã€‚</p>
<p><a href="https://github.com/zhangga/picx-images-hosting/raw/master/uml.3ns0mnap0r.webp" title="pic" class="gallery-item" style="box-shadow: none;"> <img src="https://github.com/zhangga/picx-images-hosting/raw/master/uml.3ns0mnap0r.webp" alt="pic"></a></p>
<ul>
<li>èšåˆå’Œç»„åˆä¸»è¦çš„åŒºåˆ«å°±æ˜¯æ˜¯å¦æ‹¥æœ‰å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸ<br><code>å³å¦‚æœAåˆ›å»ºçš„æ—¶å€™è´Ÿè´£åˆ›å»ºçš„Bï¼Œå¹¶ä¸”Aé”€æ¯çš„æ—¶å€™è´Ÿè´£æŠŠBä¹Ÿé”€æ¯ï¼Œé‚£å°±æ˜¯ç»„åˆ</code></li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ¯”è¾ƒå®Œæ•´çš„ä¾‹å­<br><a href="https://github.com/zhangga/picx-images-hosting/raw/master/uml2.2vf54xbiiw.webp" title="pic2" class="gallery-item" style="box-shadow: none;"> <img src="https://github.com/zhangga/picx-images-hosting/raw/master/uml2.2vf54xbiiw.webp" alt="pic2"></a></p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>UE</tag>
      </tags>
  </entry>
  <entry>
    <title>UE5å•è¿›ç¨‹å¤šGameInstanceæ–¹æ¡ˆ</title>
    <url>/ue-multiworld/</url>
    <content><![CDATA[<div class=".article-gallery"><h1 id="å¦‚ä½•å¼€å¯å¤šå®ä¾‹"><a href="#å¦‚ä½•å¼€å¯å¤šå®ä¾‹" class="headerlink" title="å¦‚ä½•å¼€å¯å¤šå®ä¾‹"></a>å¦‚ä½•å¼€å¯å¤šå®ä¾‹</h1><p>ä½¿ç”¨<code>-NumMultiWorld=num</code>æ¥å¼€å¯æŒ‡å®šæ•°é‡(num)çš„GameInstanceå®ä¾‹</p>
<h1 id="ä¿®æ”¹æ€è·¯"><a href="#ä¿®æ”¹æ€è·¯" class="headerlink" title="ä¿®æ”¹æ€è·¯"></a>ä¿®æ”¹æ€è·¯</h1><p>ä¸ºäº†é™ä½å’Œå®˜æ–¹å¼•æ“çš„å·®å¼‚ï¼Œé€šè¿‡å¼•å…¥æ–°çš„<code>UMultiWorldGameEngine</code>ç»§æ‰¿è‡ª<code>UGameEngine</code>é‡å†™å¿…è¦çš„æ–¹æ³•ï¼Œæ¥å®ç°å•è¿›ç¨‹å¤šå®ä¾‹çš„æ–¹æ¡ˆã€‚</p>
<p>å‚ç…§PIEå¤åˆ¶Worldçš„æ–¹æ¡ˆï¼Œå°†åŒä¸€ä»½èµ„æºåŠ è½½å‡ºå¤šä¸ªUPackageï¼Œæ¯ä¸€ä¸ªUPackageå¯¹åº”ä¸€ä¸ªWorldã€‚åœ¨å¯¹è±¡çš„å‘½åä¸Šå‚è€ƒPIEæ¨¡å¼ï¼Œå¢åŠ å‰ç¼€UEMW_$id$_ä»¥ä½œåŒºåˆ†ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[2025.06.17-16.31.25:853][  0]LogGlobalStatus: UEngine::LoadMap Load map complete /Game/Project/Maps/MyMap/UEMW_1_MyMap</span><br></pre></td></tr></table></figure>

<h1 id="å®ç°ç»†èŠ‚"><a href="#å®ç°ç»†èŠ‚" class="headerlink" title="å®ç°ç»†èŠ‚"></a>å®ç°ç»†èŠ‚</h1><h3 id="å¼•æ“éƒ¨åˆ†"><a href="#å¼•æ“éƒ¨åˆ†" class="headerlink" title="å¼•æ“éƒ¨åˆ†"></a>å¼•æ“éƒ¨åˆ†</h3><ul>
<li><code>UEngine::LoadMap()</code>æ—¶å¢åŠ <code>MW_URLTrueMapName</code>é€‰é¡¹å‚æ•°æ¥æŒ‡å®šçœŸæ­£çš„åœ°å›¾èµ„æºï¼Œæ¯”å¦‚ä¸Šé¢logä¸­çš„<code>/Game/Project/Maps/MyMap/MyMap</code>ã€‚åŸæœ‰çš„URL.Mapé€šè¿‡å¢åŠ <code>UEMW_$id$_</code>å‰ç¼€æ¥å®ç°åŒä¸€ä»½èµ„æºåŠ è½½å‡ºä¸åŒçš„WorldPackageã€‚</li>
</ul>
<p>UnrealEngine.cpp<br><a href="https://github.com/zhangga/picx-images-hosting/raw/master/ue-multiworld-1.8ok36kfpzv.webp" title="code1" class="gallery-item" style="box-shadow: none;"> <img src="https://github.com/zhangga/picx-images-hosting/raw/master/ue-multiworld-1.8ok36kfpzv.webp" alt="code1"></a><br>World.cpp<br><a href="https://github.com/zhangga/picx-images-hosting/raw/master/ue-multiworld-2.8s3p4aamxp.webp" title="code2" class="gallery-item" style="box-shadow: none;"> <img src="https://github.com/zhangga/picx-images-hosting/raw/master/ue-multiworld-2.8s3p4aamxp.webp" alt="code2"></a></p>
<ul>
<li>å¯¹ <em>streaming levels â€‹</em>è¿›è¡Œé‡å‘½åï¼ˆè¿™é‡Œè¶Ÿè¿‡å‘ï¼‰ã€‚å‚è€ƒPIEå¯¹Worldçš„å®Œæ•´å¤„ç†æµç¨‹<code>UEngine::CreatePIEWorldByLoadingFromPackage()</code></li>
</ul>
<p>UnrealEngine.cpp<br><a href="https://github.com/zhangga/picx-images-hosting/raw/master/ue-multiworld-3.5j4l7qadwz.webp" title="code3" class="gallery-item" style="box-shadow: none;"> <img src="https://github.com/zhangga/picx-images-hosting/raw/master/ue-multiworld-3.5j4l7qadwz.webp" alt="code3"></a></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// This method refers to the above CreatePIEWorldByLoadingFromPackage().</span></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">RenameForMultiWorld</span><span class="params">(UWorld* InWorld, <span class="type">const</span> FString&amp; SourceWorldPackage, <span class="type">const</span> FString&amp; InMWPrefix)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="built_in">check</span>(InWorld);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// Rename streaming levels to MultiWorld. refers to StreamingLevel::RenameForPIE</span></span><br><span class="line">		<span class="keyword">for</span> (ULevelStreaming* StreamingLevel : InWorld-&gt;<span class="built_in">GetStreamingLevels</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// Apply the MultiWorld prefix so this level references</span></span><br><span class="line">			<span class="keyword">if</span> (!StreamingLevel-&gt;<span class="built_in">GetWorldAsset</span>().<span class="built_in">IsNull</span>())</span><br><span class="line">			&#123;</span><br><span class="line">				FName NonPrefixedName = <span class="built_in">FName</span>(<span class="built_in">StripMWPrefixFromPackageName</span>(StreamingLevel-&gt;<span class="built_in">GetWorldAssetPackageName</span>(), InMWPrefix));</span><br><span class="line">				</span><br><span class="line">				<span class="comment">// Store original name</span></span><br><span class="line">				<span class="keyword">if</span> (StreamingLevel-&gt;PackageNameToLoad == NAME_None)</span><br><span class="line">				&#123;</span><br><span class="line">					StreamingLevel-&gt;PackageNameToLoad = NonPrefixedName;</span><br><span class="line">				&#125;</span><br><span class="line">				FName CurrWorldStreamingPackageName = <span class="built_in">FName</span>(<span class="built_in">ConvertToMWPackageName</span>(StreamingLevel-&gt;<span class="built_in">GetWorldAssetPackageName</span>(), InMWPrefix));</span><br><span class="line">				FSoftObjectPath::<span class="built_in">AddPIEPackageName</span>(CurrWorldStreamingPackageName);</span><br><span class="line">				StreamingLevel-&gt;<span class="built_in">SetWorldAssetByPackageName</span>(CurrWorldStreamingPackageName);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">// Rename LOD levels if any</span></span><br><span class="line">			<span class="keyword">if</span> (StreamingLevel-&gt;LODPackageNames.<span class="built_in">Num</span>() &gt; <span class="number">0</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				StreamingLevel-&gt;LODPackageNamesToLoad.<span class="built_in">Reset</span>(StreamingLevel-&gt;LODPackageNames.<span class="built_in">Num</span>());</span><br><span class="line">				<span class="keyword">for</span> (FName&amp; LODPackageName : StreamingLevel-&gt;LODPackageNames)</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="comment">// Store LOD level original package name</span></span><br><span class="line">					StreamingLevel-&gt;LODPackageNamesToLoad.<span class="built_in">Add</span>(LODPackageName);</span><br><span class="line">					<span class="comment">// Apply MultiWorld prefix to package name</span></span><br><span class="line">					<span class="type">const</span> FName NonPrefixedLODPackageName = LODPackageName;</span><br><span class="line">					LODPackageName = <span class="built_in">FName</span>(<span class="built_in">ConvertToMWPackageName</span>(LODPackageName.<span class="built_in">ToString</span>(), InMWPrefix));</span><br><span class="line">					FSoftObjectPath::<span class="built_in">AddPIEPackageName</span>(LODPackageName);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="é¡¹ç›®éƒ¨åˆ†"><a href="#é¡¹ç›®éƒ¨åˆ†" class="headerlink" title="é¡¹ç›®éƒ¨åˆ†"></a>é¡¹ç›®éƒ¨åˆ†</h3><p>ä¸»è¦éƒ¨åˆ†</p>
<p>UMultiWorldGameEngine.cpp</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">if</span> USE_MWGAMEENGINE</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UMultiWorldGameEngine::Init</span><span class="params">(<span class="keyword">class</span> IEngineLoop* InEngineLoop)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Super::<span class="built_in">Init</span>(InEngineLoop);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Preload and hold assets for DS.</span></span><br><span class="line">    <span class="comment">// æŒ‰éœ€å®ç°ä¸‹æå‰åŠ è½½èµ„æºï¼Œæ³¨æ„ï¼ŒåŠ è½½å®Œèµ„æºåè¦ç”¨å¼ºå¼•ç”¨æŒæœ‰ï¼Œåˆ«è¢«GCã€‚</span></span><br><span class="line">    UPreloadSubsystem Preload = GEngine-&gt;<span class="built_in">GetEngineSubsystem</span>&lt;UPreloadSubsystem&gt;();</span><br><span class="line">    <span class="built_in">check</span>(Preload);</span><br><span class="line">    Preload-&gt;<span class="built_in">PreloadAssets</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!FParse::<span class="built_in">Value</span>(FCommandLine::<span class="built_in">Get</span>(), <span class="built_in">TEXT</span>(<span class="string">&quot;-NumMultiWorld=&quot;</span>), NumMultiWorld))</span><br><span class="line">    &#123;</span><br><span class="line">       NumMultiWorld = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Single game instance.</span></span><br><span class="line">â€‹    â€‹<span class="keyword">if</span> (NumMultiWorld &lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="comment">// The base GameEngine-&gt;GameInstance is the only one.</span></span><br><span class="line">       <span class="built_in">ensure</span>(MultiGameInstances.<span class="built_in">Num</span>() == <span class="number">0</span>);</span><br><span class="line">       MultiGameInstances.<span class="built_in">Add</span>(GameInstance);</span><br><span class="line">       <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¤šå®ä¾‹æ¨¡å¼ä¸‹ï¼ŒåŸºç¡€çš„ GameEngine-&gt;GameInstance ä¸å­˜æ”¾åœ¨ TArray&lt;MultiGameInstances&gt; å®¹å™¨ä¸­ã€‚</span></span><br><span class="line">    <span class="comment">// å¹¶ä¸”åŸºç¡€GameInstanceä¸è¦è¢«åˆ†é…å‡ºå»ä½¿ç”¨ï¼ˆè¢«åˆ†é…å‡ºå»ä½¿ç”¨å°±å¯èƒ½ä¼šè¢«é”€æ¯é‡Šæ”¾ï¼‰ï¼Œè¦å§‹ç»ˆä¿ç•™ã€‚ å¦‚æœå®ƒè¢«é‡Šæ”¾äº†ï¼Œæ‰€æœ‰å…¶ä»–å®ä¾‹å…±ç”¨çš„å®ƒçš„UWorldsä¹Ÿè¢«é‡Šæ”¾äº†ã€‚</span></span><br><span class="line">â€‹    â€‹<span class="comment">// Try to create $&#123;NumMultiWorld&#125; game instances.</span></span><br><span class="line">â€‹    â€‹<span class="keyword">for</span> (uint16 i = <span class="number">0</span>; i &lt; NumMultiWorld; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">       uint16 InstanceID = i;</span><br><span class="line">       <span class="built_in">ensure</span>(MultiGameInstances.<span class="built_in">Num</span>() == InstanceID);</span><br><span class="line">       FSoftClassPath GameInstanceClassName = <span class="built_in">GetDefault</span>&lt;UGameMapsSettings&gt;()-&gt;GameInstanceClass;</span><br><span class="line">       UClass* GameInstanceClass = (GameInstanceClassName.<span class="built_in">IsValid</span>() ? <span class="built_in">LoadObject</span>&lt;UClass&gt;(<span class="literal">NULL</span>, *GameInstanceClassName.<span class="built_in">ToString</span>()) : UGameInstance::<span class="built_in">StaticClass</span>());</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span> (GameInstanceClass == <span class="literal">nullptr</span>)</span><br><span class="line">       &#123;</span><br><span class="line">          <span class="built_in">UE_LOG</span>(LogEngine, Error, <span class="built_in">TEXT</span>(<span class="string">&quot;UMultiWorldGameEngine: Unable to load GameInstance Class &#x27;%s&#x27;. Falling back to generic UGameInstance.&quot;</span>), *GameInstanceClassName.<span class="built_in">ToString</span>());</span><br><span class="line">          GameInstanceClass = UGameInstance::<span class="built_in">StaticClass</span>();</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       UGameInstance* OtherGameInstance = <span class="built_in">NewObject</span>&lt;UGameInstance&gt;(<span class="keyword">this</span>, GameInstanceClass);</span><br><span class="line">       MultiGameInstances.<span class="built_in">Add</span>(OtherGameInstance);</span><br><span class="line">       OtherGameInstance-&gt;<span class="built_in">InitializeStandalone</span>();</span><br><span class="line">       <span class="built_in">UE_LOG</span>(LogEngine, Display, <span class="built_in">TEXT</span>(<span class="string">&quot;UMultiWorldGameEngine: GameInstance %d Initialized.&quot;</span>), InstanceID);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UMultiWorldGameEngine::Start</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Super::<span class="built_in">Start</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Single game instance.</span></span><br><span class="line">â€‹    â€‹<span class="keyword">if</span> (NumMultiWorld &lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// MultiWorld mode</span></span><br><span class="line">â€‹    â€‹<span class="keyword">for</span> (int32 i = <span class="number">0</span>; i &lt; MultiGameInstances.<span class="built_in">Num</span>(); ++i)</span><br><span class="line">    &#123;</span><br><span class="line">       MultiGameInstances[i]-&gt;<span class="built_in">StartGameInstance</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">UMultiWorldGameEngine::LoadMap</span><span class="params">(FWorldContext&amp; WorldContext, FURL URL, <span class="keyword">class</span> UPendingNetGame* Pending, FString&amp; Error)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// Single game instance.</span></span><br><span class="line">â€‹    â€‹<span class="keyword">if</span> (NumMultiWorld &lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="comment">// normal UE behavior</span></span><br><span class="line">â€‹       â€‹<span class="keyword">return</span> Super::<span class="built_in">LoadMap</span>(WorldContext, URL, Pending, Error);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// MultiWorld mode</span></span><br><span class="line">â€‹    â€‹uint16 MWInstanceID = <span class="built_in">GetMWIDByGameInstance</span>(WorldContext.OwningGameInstance);</span><br><span class="line">    <span class="keyword">if</span> (MWInstanceID == INSTANCE_ID_NONE)</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="comment">// set the base GameEngine-&gt;GameInstance port=1, â€‹dontâ€‹ start network.</span></span><br><span class="line">â€‹       â€‹URL.Port = <span class="number">1</span>;</span><br><span class="line">       <span class="comment">// normal UE behavior</span></span><br><span class="line">â€‹       â€‹<span class="keyword">return</span> Super::<span class="built_in">LoadMap</span>(WorldContext, URL, Pending, Error);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Note: The base GameEngine-&gt;GameInstance Package Prefix is UEMW_0_ , thus the first created instance is UEMW_1_ .</span></span><br><span class="line">    uint16 MWPackagePrefixID = MWInstanceID + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Try to strip prefix from MWPackageName</span></span><br><span class="line">â€‹    â€‹URL.Map = <span class="built_in">StripPrefixFromMWPackageName</span>(URL.Map);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// process URL before Browse</span></span><br><span class="line">â€‹    â€‹FString MultiWorldPrefix = <span class="built_in">BuildMWPackagePrefix</span>(MWPackagePrefixID);</span><br><span class="line">    FString MWPrefixOp = <span class="built_in">TEXT</span>(<span class="string">&quot;MW_Prefix=&quot;</span>) + MultiWorldPrefix;</span><br><span class="line">    URL.<span class="built_in">AddOption</span>(*MWPrefixOp);</span><br><span class="line">    FString MultiWorldMapName = <span class="built_in">ConvertToMWPackageName</span>(URL.Map, MWPackagePrefixID);</span><br><span class="line">    FString URLTrueMapNameOp = <span class="built_in">TEXT</span>(<span class="string">&quot;MW_URLTrueMapName=&quot;</span>) + URL.Map;</span><br><span class="line">    URL.Map = MultiWorldMapName;</span><br><span class="line">    URL.<span class="built_in">AddOption</span>(*URLTrueMapNameOp);</span><br><span class="line">    <span class="keyword">if</span> (URL.Port == FURL::UrlConfig.DefaultPort)</span><br><span class="line">    &#123;</span><br><span class="line">       URL.Port += MWInstanceID;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Super::<span class="built_in">LoadMap</span>(WorldContext, URL, Pending, Error);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">UMultiWorldGameEngine::NetworkRemapPath</span><span class="params">(UNetConnection* Connection, FString&amp; Str, <span class="type">bool</span> bReading <span class="comment">/*= true*/</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        Str = <span class="built_in">StripPrefixFromMWPackageName</span>(Str);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<h3 id="ä¿®æ”¹é…ç½®"><a href="#ä¿®æ”¹é…ç½®" class="headerlink" title="ä¿®æ”¹é…ç½®"></a>ä¿®æ”¹é…ç½®</h3><ol>
<li>MyProjectServer.Target.cs</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">// use MWGameEngine</span><br><span class="line">GlobalDefinitions.Add(&quot;USE_MWGAMEENGINE=1&quot;);</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>DefaultEngine.ini</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[/Script/Engine.Engine]</span><br><span class="line">GameEngine=/Script/MyProject.MultiWorldGameEngine</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>å¯åŠ¨å‚æ•°</li>
</ol>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">-NumMultiWorld=$num</span><br></pre></td></tr></table></figure>

<h3 id="æ³¨æ„ç»†èŠ‚"><a href="#æ³¨æ„ç»†èŠ‚" class="headerlink" title="æ³¨æ„ç»†èŠ‚"></a>æ³¨æ„ç»†èŠ‚</h3><ol>
<li>åŸæ¥GameInstanceé€€å‡ºçš„æ—¶å€™å°±é€€å‡ºEngineï¼Œç°åœ¨éœ€è¦åˆ¤æ–­æ‰€æœ‰GameInstanceé€€å‡ºåæ‰èƒ½é€€å‡ºEngineã€‚</li>
<li>åŸæ¥æ¸¸æˆä¸­æ˜¯å•ä¾‹çš„æ•°æ®ç»“æ„ï¼Œç°åœ¨éœ€è¦è§†æƒ…å†µè·Ÿç€GameInstanceèµ°ã€‚</li>
</ol>
<h1 id="é€‚ç”¨åœºæ™¯"><a href="#é€‚ç”¨åœºæ™¯" class="headerlink" title="é€‚ç”¨åœºæ™¯"></a>é€‚ç”¨åœºæ™¯</h1><p>åœ¨ CPU èµ„æºå ç”¨è¾ƒä½çš„åœ°å›¾åœºæ™¯ä¸­ï¼Œå¯é€šè¿‡å•è¿›ç¨‹å¤šå¼€ GameInstance çš„æ–¹å¼ï¼Œç›´æ¥å¤ç”¨è¿›ç¨‹å†…å·²åŠ è½½çš„èµ„æºå†…å­˜ï¼ˆå¦‚åœ°å›¾é…ç½®ã€é™æ€æ¨¡å‹ï¼‰ã€‚ç›¸æ¯”å…±äº«å†…å­˜ï¼ˆForkï¼‰æ¨¡å¼ï¼Œè¯¥æ–¹æ¡ˆèƒ½è¿›ä¸€æ­¥ä¼˜åŒ– CPU ä¸å†…å­˜çš„èµ„æºé…æ¯”ï¼Œæœ€ç»ˆåœ¨æ‰¿è½½ç›¸åŒæ•°é‡åœºæ™¯å®ä¾‹çš„å‰æä¸‹ï¼Œæ˜¾è‘—é™ä½æ•´ä½“å†…å­˜å ç”¨ã€‚</p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>UE</tag>
      </tags>
  </entry>
  <entry>
    <title>WordPressä¸Šä¼ æƒé™é—®é¢˜åŠä¸»é¢˜</title>
    <url>/wordpress/</url>
    <content><![CDATA[<div class=".article-gallery"><p><a href="https://imgtu.com/i/htjgKI"><a href="https://z3.ax1x.com/2021/08/30/htjgKI.md.png" title="htjgKI.md.png" class="gallery-item" style="box-shadow: none;"> <img src="https://z3.ax1x.com/2021/08/30/htjgKI.md.png" alt="htjgKI.md.png"></a></a></p>
<span id="more"></span>

<p>æ‰“å¼€æ‰€æœ‰å†™æƒé™</p>
<p>chmod 777 /usr/local/lampp/htdocs/zzq/</p>
<p>ä¿®æ”¹æ–‡ä»¶å¤¹æ‰€å±ç”¨æˆ·ç»„ã€‚æŸ¥çœ‹ç”¨æˆ·ç»„æŒ‡ä»¤ï¼šcat /etc/group   åˆ«äººéƒ½æ˜¯www:www  æˆ‘æ˜¯daemon</p>
<p>chown -R daemon:daemon zzq</p>
<p>è¿˜åŸæ–‡ä»¶å¤¹æƒé™</p>
<p>chmod 755 /usr/local/lampp/htdocs/zzq/</p>
<h2 id="ä¸»é¢˜ç½‘ç«™"><a href="#ä¸»é¢˜ç½‘ç«™" class="headerlink" title="ä¸»é¢˜ç½‘ç«™"></a>ä¸»é¢˜ç½‘ç«™</h2><p><a href="http://ztmao.com/">http://ztmao.com/</a></p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ç½‘ç«™</tag>
      </tags>
  </entry>
  <entry>
    <title>æ­å»ºWordPressä¸ªäººç«™ç‚¹</title>
    <url>/wordpress-build/</url>
    <content><![CDATA[<div class=".article-gallery"><p><a href="https://imgtu.com/i/hZViiq"><a href="https://z3.ax1x.com/2021/08/25/hZViiq.md.png" title="hZViiq.md.png" class="gallery-item" style="box-shadow: none;"> <img src="https://z3.ax1x.com/2021/08/25/hZViiq.md.png" alt="hZViiq.md.png"></a></a></p>
<h2 id="LAMPP-WordPressæ­å»º"><a href="#LAMPP-WordPressæ­å»º" class="headerlink" title="LAMPP+WordPressæ­å»º"></a>LAMPP+WordPressæ­å»º</h2><h3 id="å®˜ç½‘ï¼šhttps-wordpress-org"><a href="#å®˜ç½‘ï¼šhttps-wordpress-org" class="headerlink" title="å®˜ç½‘ï¼šhttps://wordpress.org/"></a>å®˜ç½‘ï¼š<a href="https://wordpress.org/">https://wordpress.org/</a></h3><h3 id="ä¸­æ–‡ç½‘ï¼šhttps-cn-wordpress-org"><a href="#ä¸­æ–‡ç½‘ï¼šhttps-cn-wordpress-org" class="headerlink" title="ä¸­æ–‡ç½‘ï¼šhttps://cn.wordpress.org/"></a>ä¸­æ–‡ç½‘ï¼š<a href="https://cn.wordpress.org/">https://cn.wordpress.org/</a></h3><span id="more"></span>

<p>ä¸‹è½½taråŒ…ï¼Œè§£å‹åˆ°lampp/htdocsæ–‡ä»¶å¤¹ä¸‹æ–‡ä»¶å¤¹ï¼Œä¿®æ”¹æˆè‡ªå·±å–œæ¬¢çš„åã€‚<br>è®¿é—®ç«™ç‚¹ã€‚å¦‚ï¼š<a href="http://47.95.10.167/%E7%AB%99%E7%82%B9%E6%96%87%E4%BB%B6%E5%A4%B9%E5%90%8D">http://47.95.10.167/ç«™ç‚¹æ–‡ä»¶å¤¹å</a><br>è®¾ç½®æ•°æ®åº“ï¼ˆæ•°æ®åº“éœ€è¦å…ˆå»ºåº“ï¼‰ï¼Œè®¾ç½®adminç­‰ä¿¡æ¯ã€‚ï¼ˆé…ç½®æ–‡ä»¶å­˜å‚¨åœ¨ç«™ç‚¹æ–‡ä»¶å¤¹/wp-config.phpæ–‡ä»¶ï¼‰<br>ä½¿ç”¨åŸŸåè®¿é—®æŒ‡å®šåšå®¢<br>é‡å®šå‘ã€‚åœ¨xamppç›®å½•ä¸‹ä¿®æ”¹æ–‡ä»¶é‡å®šå‘ï¼Œæˆ‘çš„æœºå™¨åœ¨/opt/lampp/htdocs/ç›®å½•ä¸‹ã€‚ä¿®æ”¹index.phpå¦‚ä¸‹ï¼š  </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	if (!empty($_SERVER[&#x27;HTTPS&#x27;]) &amp;&amp; (&#x27;on&#x27; == $_SERVER[&#x27;HTTPS&#x27;])) &#123;</span><br><span class="line">		$uri = &#x27;https://&#x27;;</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">		$uri = &#x27;http://&#x27;;</span><br><span class="line">	&#125;</span><br><span class="line">	$uri .= $_SERVER[&#x27;HTTP_HOST&#x27;];</span><br><span class="line">	header(&#x27;Location: &#x27;.$uri.&#x27;/blog/&#x27;);</span><br><span class="line">	exit;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>ç½‘ç«™</tag>
      </tags>
  </entry>
  <entry>
    <title>å·¥ä½œæµæ€»ç»“</title>
    <url>/work-flow/</url>
    <content><![CDATA[<div class=".article-gallery"><h2 id="ç ”å‘æµç¨‹"><a href="#ç ”å‘æµç¨‹" class="headerlink" title="ç ”å‘æµç¨‹"></a>ç ”å‘æµç¨‹</h2><h4 id="åˆ†æ”¯ç­–ç•¥æ¯”è¾ƒ"><a href="#åˆ†æ”¯ç­–ç•¥æ¯”è¾ƒ" class="headerlink" title="åˆ†æ”¯ç­–ç•¥æ¯”è¾ƒ"></a>åˆ†æ”¯ç­–ç•¥æ¯”è¾ƒ</h4><table>
<thead>
<tr>
<th>æ¨¡å¼</th>
<th>å¹¶å‘æ”¶ç›Š</th>
<th>å¹¶å‘ç»´æŠ¤æˆæœ¬</th>
<th>éªŒæ”¶é›†æˆæ•ˆç‡</th>
<th>åˆ†æ”¯åˆå…¥æˆæœ¬æ¶ˆè€—</th>
</tr>
</thead>
<tbody><tr>
<td>å•å¸¸é©»åˆ†æ”¯<br />(e.g. masterå¼€å‘ä¸Šçº¿)</td>
<td>1</td>
<td>ç´§æ€¥å‘å¸ƒè¦éšè—ä»£ç </td>
<td>é€šå¸¸éªŒè¯1æ¬¡</td>
<td>åˆå¹¶æ¬¡æ•°=1ï¼ŒåŠŸèƒ½åˆå…¥ä¸»å¹²</td>
</tr>
<tr>
<td>åŒå¸¸é©»åˆ†æ”¯<br />(e.g. devå¼€å‘ masterä¸Šçº¿)</td>
<td>2</td>
<td>ä¸­ç­‰ï¼Œhotfixä¸éœ€è¦éšè—ä»£ç </td>
<td>éªŒè¯2æ¬¡</td>
<td>åˆå¹¶æ¬¡æ•°=3ï¼ŒåŠŸèƒ½åˆå…¥åŒä¸»å¹²+åŒä¸»å¹²é—´é›†æˆ</td>
</tr>
<tr>
<td>ä¸‰ä¸ªä»¥ä¸Šå¸¸é©»åˆ†æ”¯<br />(e.g. æ¯ç§ç¯å¢ƒå¯¹åº”åˆ†æ”¯)</td>
<td>3</td>
<td>è¾ƒå°‘ï¼Œå¤šç¯å¢ƒä¸éœ€è¦éšè—ä»£ç </td>
<td>éœ€è¦éªŒè¯å¤šæ¬¡</td>
<td>åˆå¹¶æ¬¡æ•°=5ï¼ŒåŠŸèƒ½åˆå…¥ä¸‰ä¸»å¹²+ä¸‰ä¸»å¹²é—´ä¼ é€’</td>
</tr>
<tr>
<td>æ€»ç»“</td>
<td>å¹¶å‘æ•ˆç‡å¯ä»¥è®¤ä¸ºæ˜¯çº¿æ€§å¢é•¿çš„n</td>
<td>ä¸»å¹²è¶Šå¤šå¯¹ä»£ç ä¾µå…¥è¶Šå°</td>
<td>å½“æµ‹è¯•è‡ªåŠ¨åŒ–æµ‹è¯•å’Œç¯å¢ƒè‡ªåŠ¨åŒ–æµ‹è¯•å¤Ÿå¼ºåï¼Œè¯¥é¡¹æˆæœ¬å¹³ç¨³</td>
<td>åˆå¹¶å·¥ä½œå’Œå‡ºé”™å‡ºå†²çªä¿®å¤çš„æ¦‚ç‡çº¿æ€§å¢é•¿ 2*n-1</td>
</tr>
</tbody></table>
<h4 id="åˆ†æ”¯è§„èŒƒæœ€ä½³å®è·µ"><a href="#åˆ†æ”¯è§„èŒƒæœ€ä½³å®è·µ" class="headerlink" title="åˆ†æ”¯è§„èŒƒæœ€ä½³å®è·µ"></a>åˆ†æ”¯è§„èŒƒæœ€ä½³å®è·µ</h4><span id="more"></span>

<ul>
<li><p>ä½¿ç”¨ç‰¹æ€§åˆ†æ”¯å¼€å‘</p>
<p>æ¯ä¸ªéœ€æ±‚ä¸€ä¸ªç‹¬ç«‹åˆ†æ”¯ï¼Œä½¿ç”¨éœ€æ±‚çš„IDå·ä½œä¸ºåˆ†æ”¯åç§°ï¼Œç”¨äºéš”ç¦»å¹¶è¡Œå¼€å‘é€ æˆçš„å¹²æ‰°ã€‚</p>
<p>å¥½å¤„ï¼šæ˜¯ä¸€ç§å·¥ç¨‹å®è·µï¼Œ ä½¿ç”¨å®ƒçš„äººç›´åˆ°ä»–æ‰€å¼€å‘çš„ç‰¹æ€§â€œå®Œæˆâ€åæ‰åˆå¹¶å›ä¸»å¹²ã€‚</p>
</li>
<li><p>æŒç»­é›†æˆä¸»å¹²</p>
<p>æ‰€æœ‰éœ€æ±‚åœ¨ä¸€ä¸ªåˆ†æ”¯åšæ¯æ—¥é›†æˆï¼Œå¹¶è¾…åŠ©ä¸€äº›è‡ªåŠ¨åŒ–æµ‹è¯•æ‰‹æ®µï¼ŒåŠæ—¶å‘ç°é›†æˆé—®é¢˜ã€‚</p>
<p>å¥½å¤„ï¼šæ˜¯ä¸€ç§å·¥ç¨‹å®è·µï¼Œç”¨äºç¡®ä¿ä½ çš„è½¯ä»¶ä¸€ç›´æ˜¯å¯ä»¥å·¥ä½œçš„ï¼Œå¹¶ä¸”åœ¨å‡ åˆ†é’Ÿå†…ä½ å°±èƒ½å¤Ÿå¾—åˆ°å…³äº â€œä½ çš„ä¿®æ”¹æ˜¯å¦ç ´åäº†ç³»ç»Ÿâ€çš„åé¦ˆã€‚</p>
</li>
<li><p>ä¸“é—¨æ‹‰å–å‘å¸ƒåˆ†æ”¯è¿›è¡Œå‘å¸ƒå·¥ä½œ</p>
<p>åœ¨å‘å¸ƒæ—¶ï¼Œå°†é›†æˆå¥½çš„ä¸»å¹²æ‹‰å‡ºæˆ–åŒæ­¥åˆ°ç”¨äºå‘å¸ƒçš„åˆ†æ”¯ä¸Šï¼Œå±è”½å‘å¸ƒä¸­çš„ä¿®æ”¹ï¼Œæ”¯æŒåšä¸€äº›hotfixæˆ–ä¸´æ—¶patchåˆå…¥ã€‚</p>
</li>
</ul>
<h4 id="åˆ†æ”¯ç­–ç•¥è§£æ"><a href="#åˆ†æ”¯ç­–ç•¥è§£æ" class="headerlink" title="åˆ†æ”¯ç­–ç•¥è§£æ"></a>åˆ†æ”¯ç­–ç•¥è§£æ</h4><ul>
<li><p>è½»é‡æ¨¡å—é‡‡ç”¨â€œ<strong>å•å¸¸é©»åˆ†æ”¯æ¨¡å¼</strong>â€</p>
<p>å¯ç”¨äºæ–°é¡¹ç›®æ—©æœŸæˆ–è€…1-3äººåä½œçš„é¡¹ç›®å¼€å‘é€‚ç”¨ï¼Œä»¥masterä½œä¸ºä¸»åˆ†æ”¯ï¼ˆå¸¸é©»åˆ†æ”¯ï¼‰ï¼ŒåŸºäºmasteræ‹‰å‡ºfeatureåˆ†æ”¯ï¼Œå¼€å‘å®Œæˆååˆå¹¶å›masterï¼ŒåŸºäºmasterå‘å¸ƒã€‚</p>
<p>ä¼˜åŠ£ï¼šåˆå…¥æˆæœ¬ä½ï¼Œrevertæˆæœ¬é«˜ï¼Œéœ€è¦é…åˆä¸¥æ ¼çš„å‡†å…¥æµç¨‹ã€‚æ‰€æœ‰ç´§æ€¥æ­£å¸¸çš„ä¿®æ”¹å…¨åœ¨ä¸»å¹²ä¸Šï¼Œå¼€å‘äº†ä¸€åŠçš„ä¸œè¥¿å¦‚æœè¦ä¸Šçº¿çš„è¯ï¼Œè¦å·§å¦™çš„è—èµ·æ¥ã€‚å¯¹ç¨‹åºçš„ç»“æ„æå‡ºäº†é«˜è¦æ±‚ï¼Œåˆ†åˆ†åˆåˆè¦æ–¹ä¾¿ï¼Œç”¨å¥½çš„è¯ï¼Œéœ€è¦åŠŸèƒ½å¼€å…³é…ç½®ã€‚</p>
</li>
<li><p>é‡è¦æ¨¡å—é‡‡ç”¨<strong>â€œåŒå¸¸é©»åˆ†æ”¯æ¨¡å¼â€œ</strong></p>
<p><em><strong>masteråˆ†æ”¯ï¼š</strong></em>ä½œä¸ºå‘å¸ƒåˆ†æ”¯ï¼Œç´§æ€¥hotfixé™¤å¤–ï¼Œä¸å…è®¸å¼€å‘ç›´æ¥åˆå¹¶åˆ°masteråˆ†æ”¯ï¼Œå‘å¸ƒå®Œæˆåæ‰“tagï¼Œç‰¹å®šçš„ç‰ˆæœ¬çš„hotfixå¿…é¡»ä»¥tagä¸ºåŸºçº¿æ‹‰åˆ†æ”¯ä¿®å¤ï¼Œå®Œæˆååˆå¹¶åˆ°masterï¼Œhotfixç¡®è®¤å®Œæˆå¢åŠ hotfixç‰ˆæœ¬tagã€‚æ‰“tagæ—¶è®°å¾—å†™release noteã€‚</p>
<p><em><strong>devåˆ†æ”¯ï¼š</strong></em>æ—¥å¸¸å¼€å‘åŸºçº¿åˆ†æ”¯ï¼Œè¿­ä»£ä¸­å¼€å‘ä»devåˆ†æ”¯æ‹‰å‡ºå¼€å‘åˆ†æ”¯ï¼Œ<strong>å®Œæˆå¹¶é€šè¿‡å¼ºåˆ¶çš„code reviewååˆå¹¶å›devåˆ†æ”¯</strong>ï¼Œå¼€å‘è€…æœ‰è´£ä»»ä¿æŒç§æœ‰åˆ†æ”¯ä¸devåˆ†æ”¯åŒæ­¥å¹¶è§£å†³å¯èƒ½çš„åˆå¹¶å†²çªï¼›ç‰¹å®šç‰ˆæœ¬çš„hotfixçš„å¼€å‘è€…è´Ÿè´£å‘å¸ƒåå°†hotfixåˆå¹¶åˆ°devåˆ†æ”¯ï¼Œå¹¶è§£å†³åˆå¹¶çš„æ½œåœ¨å†²çªï¼›devåˆ†æ”¯åˆ°masteråˆ†æ”¯çš„mrç”±å›¢é˜Ÿå†…release engineerè§’è‰²çš„äººè´Ÿè´£ï¼Œåˆå¹¶æ—¶ä¸éœ€è¦è¿›è¡Œcode reviewç›´æ¥åˆå…¥ï¼Œç¼–è¯‘å‘å¸ƒåæ‰“å¯¹åº”ç‰ˆæœ¬tagã€‚</p>
<p><strong>åŸºäºä¸»å¹²çš„å¼€å‘ trunk based development</strong> <strong>ï¼ˆTBDï¼‰</strong></p>
<p>ä¸»å¹²ç”¨äºCIæŒç»­é›†æˆï¼ŒæŒ‰ç…§å®é™…åœºæ™¯å¯ä»¥ä½¿ç”¨å›ºå®šçš„masteræˆ–devåˆ†æ”¯ï¼Œæˆ–è€…å›¢é˜Ÿæˆå‘˜çº¦å®šä¸€ä¸ªåŠ¨æ€å˜åŒ–çš„dev_2019ä½œä¸ºä¸»å¹²ï¼Œæ‰€æœ‰äººä»ä¸»å¹²æ‹‰å‡ºå¼€å‘åˆ†æ”¯ï¼Œä»ä¸»å¹²åˆå…¥ã€‚</p>
<p>å‘å¸ƒåˆ†æ”¯å¯ä»¥æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªï¼Œç”¨äºå‘¨æœŸæ€§å‘å¸ƒï¼Œå¦‚å›ºå®šçš„releaseåˆ†æ”¯æˆ–è€…åŠ¨æ€åˆ†æ”¯å¦‚release1.0ï¼Œéå¿…è¦ä¸å…è®¸hotfixç›´æ¥åˆå…¥ã€‚</p>
<p><a href="https://imgtu.com/i/5ZrpdK"><a href="https://z3.ax1x.com/2021/10/11/5ZrpdK.jpg" title="5ZrpdK.jpg" class="gallery-item" style="box-shadow: none;"> <img src="https://z3.ax1x.com/2021/10/11/5ZrpdK.jpg" alt="5ZrpdK.jpg"></a></a></p>
</li>
<li><p>å¤šåˆ†æ”¯æ¨¡å¼</p>
<p>å®¢æˆ·ç«¯å¯èƒ½å¸¸è§</p>
</li>
</ul>
<h3 id="æ—¥å¸¸å¼€å‘æµç¨‹"><a href="#æ—¥å¸¸å¼€å‘æµç¨‹" class="headerlink" title="æ—¥å¸¸å¼€å‘æµç¨‹"></a>æ—¥å¸¸å¼€å‘æµç¨‹</h3><ol>
<li><p>åˆ›å»ºä»»åŠ¡å·¥å•</p>
</li>
<li><p>ä»devåˆ†æ”¯æ‹‰ä¸€ä¸ªfeatureåˆ†æ”¯å‡ºæ¥</p>
<p><code>git checkout -b WEBARCHBIZ-123456-DO-SOME-THING</code></p>
</li>
<li><p>å†™ä»£ç ï¼Œå†™å•æµ‹</p>
</li>
<li><p>ç¡®è®¤ä»£ç æ ¼å¼è§„èŒƒï¼Œæ¨èä½¿ç”¨ideçš„formatè°ƒæ•´åŠŸèƒ½</p>
</li>
<li><p>æäº¤ä»£ç </p>
<p><code>git push origin WEBARCHBIZ-123456-DO-SOME-THING</code></p>
</li>
<li><p>å‘èµ·merge requestï¼Œåœ¨descriptionä¸­å†™æ¸…æ¥šæœ¬æ¬¡æäº¤çš„å†…å®¹ï¼Œå°½é‡ä¿è¯æ¯ä¸ªmråªåšä¸€ä»¶äº‹æƒ…ï¼Œæäº¤åæé†’peeråŠæ—¶review</p>
</li>
<li><p>code reviewé€šè¿‡åï¼Œåˆå…¥devåˆ†æ”¯ï¼Œä¼šè‡ªåŠ¨å‘å¸ƒåˆ°æ²™ç›’ï¼Œå¯ä»¥åœ¨æ²™ç›’ç¯å¢ƒæµ‹è¯•å’ŒéªŒè¯ä½ çš„ä¿®æ”¹ã€‚</p>
</li>
<li><p>å¦‚æœæœ‰é‡è¦çš„åŠŸèƒ½å˜æ›´ï¼Œåœ¨æ²™ç›’é›†æˆæµ‹è¯•ä¸­è¡¥å……ç›¸åº”çš„testcase</p>
</li>
</ol>
<h3 id="ä¸Šçº¿æµç¨‹"><a href="#ä¸Šçº¿æµç¨‹" class="headerlink" title="ä¸Šçº¿æµç¨‹"></a>ä¸Šçº¿æµç¨‹</h3><ol start="9">
<li>å‘èµ·ä»devåˆ†æ”¯åˆ°masteråˆ†æ”¯çš„merge requestï¼Œapproveåæ–¹å¯åˆå…¥masterï¼ˆæ—¥å¸¸è¿­ä»£ä¸Šçº¿æ—¶é—´æ˜¯å‘¨äºŒå’Œå‘¨å››ï¼‰ã€‚</li>
<li>åˆå…¥masteråï¼Œpipelineä¼šè‡ªåŠ¨å‘èµ·ï¼Œæµç¨‹ä¸­ä¼šæœ‰ä¸€ä¸ªäººå·¥checkbpointçš„larkå¡ç‰‡é€šçŸ¥ï¼Œéœ€è¦äººå·¥ç¡®è®¤ã€‚</li>
<li>ä¸Šçº¿å®Œæˆååœ¨çº¿ä¸Šè¿›è¡ŒéªŒè¯æµ‹è¯•ï¼Œç¡®è®¤åŠŸèƒ½æ— å¼‚å¸¸ã€‚</li>
<li>å¯¹ç”¨æˆ·æœ‰æ„Ÿçš„å˜æ›´ï¼Œåœ¨äº§å“æ–‡æ¡£ä¸Šå¡«å†™release noteã€‚</li>
</ol>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>æœåŠ¡å™¨</tag>
      </tags>
  </entry>
  <entry>
    <title>JAVAç‰ˆZSetæ€§èƒ½æµ‹è¯•</title>
    <url>/zset/</url>
    <content><![CDATA[<div class=".article-gallery"><p>è‡ªå·±å®ç°çš„JAVAç‰ˆZSetçš„ä¸»è¦åŠŸèƒ½ï¼Œæºç åœ¨githubï¼š</p>
<p><a href="https://github.com/zhangga/JAVAZSet">https://github.com/zhangga/JAVAZSet</a></p>
<p><a href="https://imgtu.com/i/hBs35t"><a href="https://z3.ax1x.com/2021/09/01/hBs35t.md.png" title="hBs35t.md.png" class="gallery-item" style="box-shadow: none;"> <img src="https://z3.ax1x.com/2021/09/01/hBs35t.md.png" alt="hBs35t.md.png"></a></a></p>
<p>æ€§èƒ½æµ‹è¯•ï¼š</p>
<p>ä¸‹é¢æ•°æ®éƒ½æ˜¯åœ¨æœ¬åœ°windowsä¸‹æ‰§è¡Œ10æ¬¡çš„è¯„ä»·å€¼ï¼šJVM10G + i7-8700å¼€ç€å„ç§åº”ç”¨ã€‚Eclipse Run é¢„çƒ­å‡ æ¬¡ç¨³å®šåã€‚</p>
<h3 id="ZSetä½¿ç”¨TreeMapã€listçš„ç»„åˆå­˜æ”¾åˆ†å€¼ä¿¡æ¯ã€‚100Wæ¡æ€»æ•°æ®ï¼Œåˆ†å€¼ä¸º1Wï¼ˆ0-9999ï¼‰ä¸ªï¼Œè¿™æ ·å¹³å‡ç›¸åŒåˆ†å€¼ä¼šæœ‰100æ¡æ•°æ®åœ¨listä¸­ã€‚"><a href="#ZSetä½¿ç”¨TreeMapã€listçš„ç»„åˆå­˜æ”¾åˆ†å€¼ä¿¡æ¯ã€‚100Wæ¡æ€»æ•°æ®ï¼Œåˆ†å€¼ä¸º1Wï¼ˆ0-9999ï¼‰ä¸ªï¼Œè¿™æ ·å¹³å‡ç›¸åŒåˆ†å€¼ä¼šæœ‰100æ¡æ•°æ®åœ¨listä¸­ã€‚" class="headerlink" title="ZSetä½¿ç”¨TreeMapã€listçš„ç»„åˆå­˜æ”¾åˆ†å€¼ä¿¡æ¯ã€‚100Wæ¡æ€»æ•°æ®ï¼Œåˆ†å€¼ä¸º1Wï¼ˆ0-9999ï¼‰ä¸ªï¼Œè¿™æ ·å¹³å‡ç›¸åŒåˆ†å€¼ä¼šæœ‰100æ¡æ•°æ®åœ¨listä¸­ã€‚"></a>ZSetä½¿ç”¨TreeMapã€listçš„ç»„åˆå­˜æ”¾åˆ†å€¼ä¿¡æ¯ã€‚100Wæ¡æ€»æ•°æ®ï¼Œåˆ†å€¼ä¸º1Wï¼ˆ0-9999ï¼‰ä¸ªï¼Œè¿™æ ·å¹³å‡ç›¸åŒåˆ†å€¼ä¼šæœ‰100æ¡æ•°æ®åœ¨listä¸­ã€‚</h3><p>è·å–1000-3000åˆ†å€¼çš„æ•°æ®ï¼Œæ‰§è¡Œ1Wæ¬¡ï¼Œ</p>
<p>å–æ ·10æ¬¡ç”¨æ—¶msï¼š6604+6490+6648+6602+7718+7626+6682+7498+6588+7358=69814/10=6981</p>
<h3 id="ZSetä½¿ç”¨ConcurrentSkipListMapã€listçš„ç»„åˆå­˜æ”¾åˆ†å€¼ä¿¡æ¯ã€‚100Wæ¡æ€»æ•°æ®ï¼Œåˆ†å€¼ä¸º1Wï¼ˆ0-9999ï¼‰ä¸ªï¼Œè¿™æ ·å¹³å‡ç›¸åŒåˆ†å€¼ä¼šæœ‰100æ¡æ•°æ®åœ¨listä¸­ã€‚"><a href="#ZSetä½¿ç”¨ConcurrentSkipListMapã€listçš„ç»„åˆå­˜æ”¾åˆ†å€¼ä¿¡æ¯ã€‚100Wæ¡æ€»æ•°æ®ï¼Œåˆ†å€¼ä¸º1Wï¼ˆ0-9999ï¼‰ä¸ªï¼Œè¿™æ ·å¹³å‡ç›¸åŒåˆ†å€¼ä¼šæœ‰100æ¡æ•°æ®åœ¨listä¸­ã€‚" class="headerlink" title="ZSetä½¿ç”¨ConcurrentSkipListMapã€listçš„ç»„åˆå­˜æ”¾åˆ†å€¼ä¿¡æ¯ã€‚100Wæ¡æ€»æ•°æ®ï¼Œåˆ†å€¼ä¸º1Wï¼ˆ0-9999ï¼‰ä¸ªï¼Œè¿™æ ·å¹³å‡ç›¸åŒåˆ†å€¼ä¼šæœ‰100æ¡æ•°æ®åœ¨listä¸­ã€‚"></a>ZSetä½¿ç”¨ConcurrentSkipListMapã€listçš„ç»„åˆå­˜æ”¾åˆ†å€¼ä¿¡æ¯ã€‚100Wæ¡æ€»æ•°æ®ï¼Œåˆ†å€¼ä¸º1Wï¼ˆ0-9999ï¼‰ä¸ªï¼Œè¿™æ ·å¹³å‡ç›¸åŒåˆ†å€¼ä¼šæœ‰100æ¡æ•°æ®åœ¨listä¸­ã€‚</h3><p>è·å–1000-3000åˆ†å€¼çš„æ•°æ®ï¼Œæ‰§è¡Œ1Wæ¬¡ï¼Œ</p>
<p>å–æ ·10æ¬¡ç”¨æ—¶msï¼š7594+8279+8622+8476+7810+7397+7241+8579+8019+8554=80571/10=8057</p>
<h3 id="ZSetä¸éœ€è¦çº¿ç¨‹å®‰å…¨çš„æƒ…å½¢ä¸‹ä½¿ç”¨TreeMapçš„æ•ˆç‡ä¼šæ›´é«˜ç‚¹ã€‚"><a href="#ZSetä¸éœ€è¦çº¿ç¨‹å®‰å…¨çš„æƒ…å½¢ä¸‹ä½¿ç”¨TreeMapçš„æ•ˆç‡ä¼šæ›´é«˜ç‚¹ã€‚" class="headerlink" title="ZSetä¸éœ€è¦çº¿ç¨‹å®‰å…¨çš„æƒ…å½¢ä¸‹ä½¿ç”¨TreeMapçš„æ•ˆç‡ä¼šæ›´é«˜ç‚¹ã€‚"></a>ZSetä¸éœ€è¦çº¿ç¨‹å®‰å…¨çš„æƒ…å½¢ä¸‹ä½¿ç”¨TreeMapçš„æ•ˆç‡ä¼šæ›´é«˜ç‚¹ã€‚</h3><h2 id="è·å–é«˜åº¦æ–¹æ³•æ€§èƒ½æµ‹è¯•ï¼š"><a href="#è·å–é«˜åº¦æ–¹æ³•æ€§èƒ½æµ‹è¯•ï¼š" class="headerlink" title="è·å–é«˜åº¦æ–¹æ³•æ€§èƒ½æµ‹è¯•ï¼š"></a>è·å–é«˜åº¦æ–¹æ³•æ€§èƒ½æµ‹è¯•ï¼š</h2><p>1.ä½¿ç”¨ZSetè·å–é™„è¿‘çš„éšœç¢ç‰©ï¼Œåˆ¤æ–­æ˜¯å¦åœ¨éšœç¢ç‰©å†…ï¼Œè·å–éšœç¢ç‰©é«˜åº¦ã€‚</p>
<p>æµ‹è¯•ç”¨ä¾‹ï¼Œåœ¨ä¸€å¤„æ”¾ç½®11ä¸ªåœ†å½¢éšœç¢ç‰©ï¼Œæœç´¢2ç±³èŒƒå›´å†…çš„éšœç¢ç‰©ï¼Œè·å–é«˜åº¦ã€‚100Wæ¬¡æµ‹è¯•ï¼Œç”¨æ—¶åœ¨450ms-500msä¹‹é—´ã€‚</p>
<p>2.ä½¿ç”¨ä¸€ä¸ªæ­£å¸¸åœ°å›¾ï¼ˆ37å·åœºæ™¯ï¼‰çš„navmeshæ•°æ®ï¼Œrecastçš„è·å–é«˜åº¦ã€‚100Wæ¬¡æµ‹è¯•ï¼Œç”¨æ—¶åœ¨1000ms-1100msä¹‹é—´ã€‚</p>
</div>]]></content>
      <categories>
        <category>ç¬”è®°</category>
      </categories>
      <tags>
        <tag>JAVA</tag>
      </tags>
  </entry>
</search>
